"use strict";(self.webpackChunkSUBRIVA_BILLING=self.webpackChunkSUBRIVA_BILLING||[]).push([[676],{18796:(e,t,l)=>{l.d(t,{A:()=>P});var i=l(89379),n=l(65043),r=l(83833),o=l(26553),a=l(62305),s=l(16569),d=l(76399),c=l(62751),u=l(6051),x=l(36621),p=l(95206),m=l(47419),y=l(11645),f=l(8354),h=l(39249),v=l(87534),g=l(75388),_=l(46011),b=l(72411),j=l(67177),A=l(73847),w=l(15615),C=l(88143),k=l(53722),B=l(83537),S=l(97031),I=l(94211),D=l(70579);const{Title:G,Text:T}=r.A,{Option:E}=o.A,L=e=>{let{visible:t,onSelect:l,onCancel:r}=e;const{getEntityApi:o}=(0,B.p)(),E=o("Customer"),{items:L,loading:P}=(0,S.Sm)(E.getIdentifier("GetAll")),{loading:R}=(0,S.Sm)(E.getIdentifier("Create")),z=(null===L||void 0===L?void 0:L.items)||(null===L||void 0===L?void 0:L.result)||[],[N,V]=(0,n.useState)(""),[M,F]=(0,n.useState)(!1),[K,U]=(0,n.useState)(null),[W,q]=(0,n.useState)(-1),[H,Y]=(0,n.useState)(!1),[O,Q]=(0,n.useState)({full_name:"",email:"",mobile:"",address:"",customer_type:"regular"}),[X]=a.A.useForm(),J=(0,n.useRef)(null),Z=(0,n.useRef)(null),$=(0,n.useRef)(null),ee=(0,n.useRef)(null),te=(0,n.useRef)(null),le=(0,n.useMemo)((()=>z),[z]),ie=(0,n.useMemo)((()=>N.trim()&&!P&&0===le.length),[N,P,le.length]),ne=(0,n.useCallback)((e=>({vip:"gold",wholesale:"blue",regular:"green"}[e]||"green")),[]),re=(0,n.useCallback)((e=>{if(0===le.length)return;let t;switch(e){case"up":t=-1===W?le.length-1:Math.max(W-1,0);break;case"down":t=-1===W?0:Math.min(W+1,le.length-1);break;case"home":t=0;break;case"end":t=le.length-1;break;default:return}q(t),U(le[t]),setTimeout((()=>{const l=document.querySelector('[data-row-key="'.concat(le[t]._id,'"]'));if(l){const t="home"===e?"start":"end"===e?"end":"nearest";l.scrollIntoView({behavior:"smooth",block:t})}}),100)}),[le,W]),oe=(0,n.useCallback)((e=>{V(e),$.current&&clearTimeout($.current),$.current=setTimeout((()=>{e.trim()?E("GetAll",{searchString:e.trim()}):E("GetAll")}),500)}),[E]),ae=(0,n.useCallback)((e=>{U(e),l(e),setTimeout((()=>r()),100)}),[l,r]),se=(0,n.useCallback)((async()=>{try{if(!O.full_name.trim())return void s.Ay.error("Full name is required");if(!O.mobile.trim())return void s.Ay.error("Mobile number is required");await E("Create",O)}catch(e){s.Ay.error("Failed to create customer"),de()}}),[O,E]),de=(0,n.useCallback)((()=>{Q({full_name:"",email:"",mobile:"",address:"",customer_type:"regular"}),X.resetFields()}),[X]),ce=(0,n.useCallback)(((e,t)=>{Q((l=>(0,i.A)((0,i.A)({},l),{},{[e]:t})))}),[]),ue=(0,n.useCallback)((e=>{if("Escape"===e.key)r();else if(["ArrowDown","ArrowUp","Home","End"].includes(e.key)){e.preventDefault(),e.stopPropagation();re({ArrowDown:"down",ArrowUp:"up",Home:"home",End:"end"}[e.key])}}),[re,r]),xe=(0,n.useCallback)((e=>{if(!t)return;const l=e.target;if("INPUT"!==l.tagName&&"TEXTAREA"!==l.tagName&&!l.classList.contains("ant-select-selector")&&!l.closest(".ant-select-dropdown")){if(e.ctrlKey&&"f"===e.key)return e.preventDefault(),e.stopPropagation(),void(J.current&&(J.current.focus(),J.current.select()));if(e.ctrlKey&&"n"===e.key)return e.preventDefault(),e.stopPropagation(),void(ie&&(Y(!0),setTimeout((()=>{if(ee.current){const e=ee.current.querySelector("input");e&&(e.focus(),e.select())}}),100)));if(["ArrowDown","ArrowUp","Home","End"].includes(e.key)){e.preventDefault(),e.stopPropagation();re({ArrowDown:"down",ArrowUp:"up",Home:"home",End:"end"}[e.key])}}}),[t,re,ie]),pe=(0,n.useMemo)((()=>[{title:"",key:"select",width:60,render:(e,t)=>(0,D.jsx)("div",{style:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>{U(t);const e=le.findIndex((e=>e._id===t._id));q(e)},children:(0,D.jsx)("div",{style:{width:"18px",height:"18px",borderRadius:"50%",border:(null===K||void 0===K?void 0:K._id)===t._id?"2px solid #1890ff":"2px solid #d9d9d9",backgroundColor:(null===K||void 0===K?void 0:K._id)===t._id?"#1890ff":"white",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},children:(null===K||void 0===K?void 0:K._id)===t._id&&(0,D.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"white"}})})})},{title:"Customer Name",dataIndex:"full_name",key:"full_name",render:(e,t)=>(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,D.jsx)(T,{strong:!0,children:e}),(0,D.jsx)(d.A,{color:ne(t.customer_type),children:t.customer_type.toUpperCase()})]})},{title:"Mobile",dataIndex:"mobile",key:"mobile",render:e=>(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,D.jsx)(v.A,{style:{color:"#666"}}),(0,D.jsx)(T,{children:e})]})},{title:"Email",dataIndex:"email",key:"email",render:e=>(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,D.jsx)(g.A,{style:{color:"#666"}}),(0,D.jsx)(T,{children:e||"-"})]})},{title:"Address",dataIndex:"address",key:"address",render:e=>(0,D.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[(0,D.jsx)(_.A,{style:{color:"#666",marginTop:"2px"}}),(0,D.jsx)(T,{type:"secondary",style:{fontSize:"12px"},children:e||"-"})]})}]),[K,le,ne]),me=(0,n.useCallback)(((e,t)=>({onClick:()=>{U(e),q(null!==t&&void 0!==t?t:0)},style:{cursor:"pointer",backgroundColor:(null===K||void 0===K?void 0:K._id)===e._id?"#f0f8ff":"white",border:(null===K||void 0===K?void 0:K._id)===e._id?"2px solid #1890ff":"1px solid #f0f0f0",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:t=>{(null===K||void 0===K?void 0:K._id)!==e._id&&(t.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:t=>{(null===K||void 0===K?void 0:K._id)!==e._id&&(t.currentTarget.style.backgroundColor="white")}})),[K]);(0,n.useEffect)((()=>(t?(E("GetAll"),U(null),q(-1),Y(!1)):(V(""),U(null),q(-1),Y(!1),F(!1),de(),$.current&&(clearTimeout($.current),$.current=null)),()=>{$.current&&clearTimeout($.current)})),[t,E,de]),(0,n.useEffect)((()=>{!ie||H||M||Y(!0)}),[ie,H,M]),(0,n.useEffect)((()=>{if(t&&J.current&&!M&&!H){const e=()=>{J.current&&(J.current.focus(),J.current.select())};e();const t=setTimeout(e,100);return()=>clearTimeout(t)}}),[t,M,H]),(0,n.useEffect)((()=>{if((M||H)&&t){const e=setTimeout((()=>{te.current&&(te.current.focus(),te.current.select())}),100);return()=>clearTimeout(e)}}),[M,H,t]),(0,n.useEffect)((()=>{if(t)return document.addEventListener("keydown",xe,!0),()=>document.removeEventListener("keydown",xe,!0)}),[t,xe]),(0,I.z)({action:"create",title:"Customer",identifier:E.getIdentifier("Create"),entityApi:E});const{items:ye}=(0,S.Sm)(E.getIdentifier("Create"));(0,n.useEffect)((()=>{R?s.Ay.loading({content:"Creating customer...",key:"customer-creation",duration:0}):s.Ay.destroy("customer-creation")}),[R]),(0,n.useEffect)((()=>{if(ye)if(200===ye.statusCode){const e=ye.data||ye.result;e&&(de(),F(!1),Y(!1),E("GetAll"),setTimeout((()=>{l(e),r()}),100))}else ye.statusCode&&200!==ye.statusCode&&(s.Ay.error(ye.message||"Failed to create customer"),de())}),[ye,l,r,E,de]);const fe=(0,n.useCallback)((()=>{U(null),q(-1)}),[]);return(0,D.jsxs)(c.A,{title:"Select Customer",open:t,onCancel:r,footer:null,width:1e3,style:{top:20},afterOpenChange:e=>{e&&J.current&&!M&&!H&&setTimeout((()=>{var e,t;null===(e=J.current)||void 0===e||e.focus(),null===(t=J.current)||void 0===t||t.select()}),100)},children:[(0,D.jsx)("div",{ref:Z,style:{marginBottom:16},onKeyDown:ue,tabIndex:0,children:(0,D.jsxs)(u.A.Compact,{style:{width:"100%"},children:[(0,D.jsx)(x.A,{ref:J,placeholder:"Search customers... (Ctrl+N: New customer, \u2191\u2193: Navigate, Enter: Select, Esc: Close)",value:N,onChange:e=>oe(e.target.value),prefix:(0,D.jsx)(b.A,{}),style:{flex:1},onKeyDown:e=>{"Enter"===e.key&&K&&ae(K)},onFocus:fe,autoFocus:!M&&!H,onBlur:M||H?void 0:()=>{t&&J.current&&setTimeout((()=>{t&&J.current&&!M&&!H&&J.current.focus()}),10)},suffix:N&&P?(0,D.jsx)("div",{style:{fontSize:"12px",color:"#999"},children:"Searching..."}):null}),(0,D.jsx)(p.Ay,{type:M?"default":"primary",icon:(0,D.jsx)(j.A,{}),onClick:()=>{const e=!M;F(e),e||de()},style:{minWidth:120},children:M?"Cancel":"Add New"})]})}),(H||M)&&(0,D.jsxs)("div",{ref:ee,style:{marginBottom:20,padding:24,border:"2px solid #6366f1",borderRadius:16,backgroundColor:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",position:"relative",overflow:"hidden"},tabIndex:-1,children:[(0,D.jsx)("div",{style:{position:"absolute",top:-20,right:-20,width:100,height:100,borderRadius:"50%",background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",opacity:.1,zIndex:0}}),(0,D.jsx)("div",{style:{position:"absolute",bottom:-30,left:-30,width:80,height:80,borderRadius:"50%",background:"linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)",opacity:.1,zIndex:0}}),(0,D.jsxs)(m.A,{justify:"space-between",align:"middle",style:{marginBottom:24,position:"relative",zIndex:1},children:[(0,D.jsxs)(y.A,{children:[(0,D.jsxs)(G,{level:4,style:{margin:0,background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",fontWeight:700,fontSize:"20px"},children:[(0,D.jsx)(A.A,{style:{marginRight:8,color:"#6366f1"}}),"Create New Customer"]}),(0,D.jsx)(T,{style:{fontSize:"14px",color:"#64748b",fontWeight:500,display:"block",marginTop:4},children:"\u2728 Fill in the details below to create a new customer"})]}),(0,D.jsx)(y.A,{children:(0,D.jsxs)(u.A,{size:"middle",children:[(0,D.jsx)(p.Ay,{size:"middle",icon:(0,D.jsx)(w.A,{}),onClick:()=>{Y(!1),F(!1),E("GetAll"),de()},style:{border:"2px solid #e2e8f0",borderRadius:8,fontWeight:600,color:"#64748b",background:"white",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",height:40,padding:"0 20px"},children:"Cancel"}),(0,D.jsx)(p.Ay,{type:"primary",size:"middle",icon:(0,D.jsx)(C.A,{}),onClick:se,loading:R,style:{background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",border:"none",borderRadius:8,fontWeight:600,height:40,padding:"0 24px",boxShadow:"0 4px 12px rgba(99, 102, 241, 0.3)",transition:"all 0.3s ease"},children:"Create & Select"})]})})]}),(0,D.jsxs)(a.A,{form:X,layout:"vertical",size:"middle",style:{position:"relative",zIndex:1},children:[(0,D.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:20},children:[(0,D.jsx)(a.A.Item,{name:"full_name",label:(0,D.jsxs)("span",{style:{fontWeight:600,color:"#374151",fontSize:"14px",display:"flex",alignItems:"center",gap:6},children:[(0,D.jsx)(k.A,{style:{color:"#6366f1"}}),"Full Name"]}),rules:[{required:!0,message:"Please enter full name"}],children:(0,D.jsx)(x.A,{ref:te,name:"full_name",placeholder:"Enter full name",prefix:(0,D.jsx)(k.A,{style:{color:"#9ca3af"}}),autoFocus:M||H,value:O.full_name,onChange:e=>ce("full_name",e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),se())},style:{borderRadius:10,border:"2px solid #e5e7eb",padding:"12px 16px",fontSize:"14px",transition:"all 0.3s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",background:"white"}})}),(0,D.jsx)(a.A.Item,{name:"mobile",label:(0,D.jsxs)("span",{style:{fontWeight:600,color:"#374151",fontSize:"14px",display:"flex",alignItems:"center",gap:6},children:[(0,D.jsx)(v.A,{style:{color:"#10b981"}}),"Mobile Number"]}),rules:[{required:!0,message:"Please enter mobile number"},{pattern:/^[0-9]{10}$/,message:"Mobile must be 10 digits"}],children:(0,D.jsx)(x.A,{name:"mobile",placeholder:"Enter mobile number",prefix:(0,D.jsx)(v.A,{style:{color:"#9ca3af"}}),value:O.mobile,onChange:e=>ce("mobile",e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),se())},style:{borderRadius:10,border:"2px solid #e5e7eb",padding:"12px 16px",fontSize:"14px",transition:"all 0.3s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",background:"white"}})}),(0,D.jsx)(a.A.Item,{name:"email",label:(0,D.jsxs)("span",{style:{fontWeight:600,color:"#374151",fontSize:"14px",display:"flex",alignItems:"center",gap:6},children:[(0,D.jsx)(g.A,{style:{color:"#f59e0b"}}),"Email"]}),rules:[{type:"email",message:"Please enter valid email"}],children:(0,D.jsx)(x.A,{name:"email",placeholder:"Enter email",prefix:(0,D.jsx)(g.A,{style:{color:"#9ca3af"}}),value:O.email,onChange:e=>ce("email",e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),se())},style:{borderRadius:10,border:"2px solid #e5e7eb",padding:"12px 16px",fontSize:"14px",transition:"all 0.3s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",background:"white"}})})]}),(0,D.jsx)(a.A.Item,{name:"address",label:(0,D.jsxs)("span",{style:{fontWeight:600,color:"#374151",fontSize:"14px",display:"flex",alignItems:"center",gap:6},children:[(0,D.jsx)(_.A,{style:{color:"#ef4444"}}),"Address"]}),children:(0,D.jsx)(x.A.TextArea,{name:"address",placeholder:"Enter address",rows:3,value:O.address,onChange:e=>ce("address",e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),se())},style:{borderRadius:10,border:"2px solid #e5e7eb",padding:"12px 16px",fontSize:"14px",transition:"all 0.3s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.05)",background:"white",resize:"none"}})})]})]}),(0,D.jsx)(f.A,{style:{margin:"16px 0"}}),(0,D.jsx)("div",{style:{maxHeight:400,overflow:"auto"},children:P?(0,D.jsx)("div",{style:{textAlign:"center",padding:40},children:(0,D.jsx)(T,{children:"Loading customers..."})}):0===le.length?(0,D.jsxs)("div",{style:{textAlign:"center",padding:40},children:[(0,D.jsx)(T,{type:"secondary",children:N?"No customers found matching your search.":"No customers available."}),N&&(0,D.jsx)("div",{style:{marginTop:16},children:(0,D.jsx)(T,{type:"secondary",children:"Press Ctrl+N to create a new customer instantly"})})]}):(0,D.jsx)(h.A,{columns:pe,dataSource:le,rowKey:"_id",pagination:!1,size:"small",scroll:{y:300},onRow:me})})]})},P=n.memo(L)},21448:(e,t,l)=>{l.d(t,{A:()=>w});var i=l(89379),n=l(65043),r=l(83833),o=l(16569),a=l(62751),s=l(36621),d=l(7866),c=l(26553),u=l(93504),x=l(6051),p=l(95206),m=l(39249),y=l(73847),f=l(9316),h=l(88143),v=l(60446),g=l.n(v),_=l(36977),b=l(32054),j=l(70579);const{Text:A}=r.A,w=e=>{let{columns:t,dataSource:l,onSave:r,onAdd:v,onDelete:w,allowAdd:C=!0,allowDelete:k=!0,rowKey:B="key",loading:S=!1,compact:I=!1,enableKeyboardNav:D=!0,size:G="middle",className:T,onProductSelect:E,externalEditingCell:L}=e;const[P,R]=(0,n.useState)([]),[z,N]=(0,n.useState)([]),[V,M]=(0,n.useState)(null),F=(0,n.useRef)(!0);(0,n.useEffect)((()=>{R(l);const e=t.findIndex((e=>"product_id"===e.dataIndex));F.current&&0===l.length&&e>=0?(M({row:0,col:e}),F.current=!1):N(l.length>0?[String(l.length-1)]:[])}),[l,t]),(0,n.useEffect)((()=>{L&&M(L)}),[L]);const K=()=>{null===v||void 0===v||v();const e=t.findIndex((e=>!1!==e.editable));e>=0&&M({row:P.length,col:e})},U=(e,l,i)=>{const n=t[l];if(n.required&&(!i||""===i))return o.Ay.error("".concat(n.title," is required")),!1;if(n.validation){const e=n.validation(i);if(e)return o.Ay.error(e),!1}const a=[...P];return a[e][t[l].dataIndex]=i,R(a),r(a),!0};(0,n.useEffect)((()=>{const e=e=>{e.ctrlKey&&"s"===e.key&&(e.preventDefault(),r(P)),e.shiftKey&&"a"===e.key.toLowerCase()&&C&&(e.preventDefault(),K())};if(D)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[P,C,r,D,K]);const W={onChange:(e,t)=>{N([...e])}};function q(e,t,l){let i=e+t;for(;i>=0&&i<l.length;){if(!1!==l[i].editable)return i;i+=t}return-1}const H=e=>{var l,i;let{row:a,col:x,value:p}=e;const[m,y]=(0,n.useState)(p),f=(0,n.useRef)(null),h=t[x],[v,A]=(0,n.useState)(!1),[w,k]=(0,n.useState)(!1);(0,n.useEffect)((()=>{y(p),setTimeout((()=>{var e;null===(e=f.current)||void 0===e||e.focus()}),50)}),[p]);const B=e=>{y(e),U(a,x,e)},S=e=>{if("product"===h.type&&"Enter"===e.key)return e.stopPropagation(),void A(!0);if("stock"===h.type&&"Enter"===e.key)return e.stopPropagation(),void k(!0);if("Tab"===e.key){if(e.preventDefault(),h.required&&(!m||""===m))return void o.Ay.error("".concat(h.title," is required"));const l=e.shiftKey?x-1:x+1,i=a+(l>=t.length?1:0),n=(l+t.length)%t.length;i<P.length?M({row:i,col:n}):C&&(K(),M({row:P.length,col:n}))}else"Escape"===e.key&&M(null)},I=e=>{E&&E(e,a),A(!1),M(null)},D=e=>{const t=[...P];t[a].stock_id=e.id||e._id||"",t[a].batch_no=e.batch_no||"",R(t),r(t),k(!1),M(null)};switch(h.type){case"product":return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,j.jsx)(s.A,{ref:f,value:m,onKeyDown:S,placeholder:"Press Enter to select product"})}),v&&(0,j.jsx)(_.A,{visible:v,onSelect:I,onCancel:()=>A(!1)})]});case"stock":return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,j.jsx)(s.A,{ref:f,value:(null===(l=P[a])||void 0===l?void 0:l.batch_no)||m,onKeyDown:S,placeholder:"Press Enter to select stock",readOnly:!0})}),w&&(0,j.jsx)(b.A,{visible:w,onSelect:D,onCancel:()=>k(!1),productId:(null===(i=P[a])||void 0===i?void 0:i.product_id)||""})]});case"number":return(0,j.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,j.jsx)(d.A,{ref:f,value:m,onChange:B,onBlur:()=>M(null),controls:!1,onKeyDown:e=>{if("Tab"===e.key||"Enter"===e.key){if(e.preventDefault(),h.required&&(!m||""===m))return void o.Ay.error("".concat(h.title," is required"));const l=e.shiftKey?-1:1,i=q(x,l,t);if(-1!==i)M({row:a,col:i});else{const e=l>0?a+1:a-1;if(e>=0&&e<P.length){const l=q(-1,1,t);-1!==l&&M({row:e,col:l})}else if(l>0&&C){K();const e=q(-1,1,t);-1!==e&&M({row:P.length,col:e})}else M(null)}}else"Escape"===e.key&&M(null)},style:{width:"100%"}})});case"select":return(0,j.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,j.jsx)(c.A,{ref:f,value:m,options:h.options,onChange:e=>{if(U(a,x,e)){const e=x+1,l=a+(e>=t.length?1:0),i=(e+t.length)%t.length;l<P.length?M({row:l,col:i}):C&&(K(),M({row:P.length,col:i}))}else setTimeout((()=>{var e;null===(e=f.current)||void 0===e||e.focus()}),50)},style:{width:"100%"},onKeyDown:e=>{"Enter"!==e.key&&"Tab"!==e.key||e.preventDefault()}})});case"date":return(0,j.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,j.jsx)(u.A,{ref:f,value:m?g()(m):null,onChange:e=>{B(e?e.format("YYYY-MM-DD"):null),M(null)},onBlur:()=>M(null),onKeyDown:S,style:{width:"100%"}})});default:return(0,j.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,j.jsx)(s.A,{ref:f,value:m,onChange:e=>B(e.target.value),onBlur:()=>M(null),onKeyDown:S})})}},Y=t.map(((e,t)=>(0,i.A)((0,i.A)({},e),{},{onCell:(e,l)=>({onClick:()=>{"number"===typeof l&&M({row:l,col:t})},onContextMenu:e=>{e.preventDefault(),"number"===typeof l&&M({row:l,col:t})}}),render:(l,i,n)=>{if(V&&V.row===n&&V.col===t)return(0,j.jsx)(H,{row:n,col:t,value:i[e.dataIndex]},"".concat(n,"-").concat(t));if("function"===typeof e.render)return e.render(l,i,n);if("batch_no"===e.dataIndex)return i.batch_no||i[e.dataIndex];if("product_id"===e.dataIndex)return i.product_name||i[e.dataIndex];if("select"===e.type&&e.options){const t=e.options.find((t=>t.value===i[e.dataIndex]));return t?t.label:i[e.dataIndex]}return i[e.dataIndex]}})));return(0,j.jsxs)("div",{className:"antd-editable-table ".concat(I?"compact":""," ").concat(T||""),children:[(0,j.jsxs)("div",{className:"table-toolbar",children:[(0,j.jsxs)(x.A,{children:[C&&(0,j.jsx)(p.Ay,{type:"primary",icon:(0,j.jsx)(y.A,{}),onClick:K,children:"Add Row (Shift+A)"}),k&&(0,j.jsx)(p.Ay,{danger:!0,icon:(0,j.jsx)(f.A,{}),onClick:()=>{0!==P.length?a.A.confirm({title:"Are you sure you want to delete the selected Bill Items?",onOk:()=>{const e=P.slice(0,-1);R(e),r(e),null===w||void 0===w||w(z)}}):o.Ay.warning("No rows to delete")},children:"Delete Row"}),(0,j.jsx)(p.Ay,{type:"primary",icon:(0,j.jsx)(h.A,{}),onClick:()=>r(P),children:"Save (Ctrl+S)"})]}),(0,j.jsx)(A,{type:"secondary",className:"table-info",children:"Use Tab / Shift+Tab to navigate cells"})]}),(0,j.jsx)(m.A,{bordered:!0,dataSource:P,columns:Y,rowKey:B,loading:S,pagination:!1,size:G,scroll:{y:400},rowSelection:(0,i.A)((0,i.A)({},W),{},{type:"checkbox",selectedRowKeys:z})})]})}},32054:(e,t,l)=>{l.d(t,{A:()=>v});var i=l(65043),n=l(36621),r=l(16569),o=l(96651),a=l(76399),s=l(62751),d=l(39249),c=l(83537),u=l(97031),x=l(60446),p=l.n(x),m=l(39470),y=l(46237),f=l(70579);const{Search:h}=n.A,v=e=>{var t;let{visible:l,onSelect:n,onCancel:x,productId:v}=e;const{getEntityApi:g}=(0,c.p)(),_=g("StockAudit"),{items:b,loading:j}=(0,u.Sm)(_.getIdentifier("GetAll")),[A,w]=(0,i.useState)(""),[C,k]=(0,i.useState)(null),[B,S]=(0,i.useState)(0),[I,D]=(0,i.useState)(""),G=(0,i.useRef)(null),T=(0,i.useRef)(null),E=e=>!(!e.expiry_date||!p()(e.expiry_date).isBefore(p()())),L=e=>e.available_quantity<=0,P=e=>{const t=p()(e.expiry_date).format("DD/MM/YYYY"),l="Cannot select expired stock! This item expired on ".concat(t,". Please select a valid stock item.");D(l),r.Ay.error(l),setTimeout((()=>{D("")}),5e3)},R=e=>{const t="Cannot select out of stock item! This item has 0 available quantity. Please select a stock item with available quantity.";D(t),r.Ay.error(t),setTimeout((()=>{D("")}),5e3)},z=(null===b||void 0===b||null===(t=b.result)||void 0===t?void 0:t.filter((e=>{var t,l,i,n,r,o,a,s;const d=A.toLowerCase();return(null===(t=e.batch_no)||void 0===t?void 0:t.toLowerCase().includes(d))||(null===(l=e.ProductItem)||void 0===l||null===(i=l.name)||void 0===i?void 0:i.toLowerCase().includes(d))||(null===(n=e.ProductItem)||void 0===n||null===(r=n.VariantItem)||void 0===r||null===(o=r.variant_name)||void 0===o?void 0:o.toLowerCase().includes(d))||(null===(a=e.available_quantity)||void 0===a?void 0:a.toString().includes(d))||(null===(s=e.sell_price)||void 0===s?void 0:s.toString().includes(d))})))||[];(0,i.useEffect)((()=>{if(S(0),D(""),z.length>0){let e=0;for(;e<z.length&&(z[e].expiry_date&&p()(z[e].expiry_date).isBefore(p()())||z[e].available_quantity<=0);)e++;e<z.length?(k(z[e]._id),S(e)):k(null)}else k(null)}),[A,l,b]),(0,i.useEffect)((()=>{l&&(D(""),setTimeout((()=>{var e;null===(e=T.current)||void 0===e||e.focus()}),0))}),[l]),(0,i.useEffect)((()=>{if(G.current){var e;const t=G.current.querySelector(".ant-table-row[data-row-key='".concat(null===(e=z[B])||void 0===e?void 0:e._id,"']"));null===t||void 0===t||t.scrollIntoView({block:"nearest"})}}),[B,z]),(0,i.useEffect)((()=>{l&&v&&_("GetAll",{product:v})}),[l,v,_]);const N=[{title:"Product",dataIndex:"ProductItem",key:"product",render:e=>(null===e||void 0===e?void 0:e.name)||"N/A"},{title:"Variant",dataIndex:"ProductItem",key:"variant",render:e=>{var t;return(null===e||void 0===e||null===(t=e.VariantItem)||void 0===t?void 0:t.variant_name)||"N/A"}},{title:"Batch No",dataIndex:"batch_no",key:"batch_no"},{title:"Available",dataIndex:"available_quantity",key:"available_quantity",render:(e,t)=>{const l=e<=0;return(0,f.jsxs)("span",{style:{color:l?"#ff4d4f":"#52c41a",fontWeight:l?"bold":"normal"},children:[e,l&&(0,f.jsx)(m.A,{style:{marginLeft:4,color:"#ff4d4f"}})]})}},{title:"Price",dataIndex:"sell_price",key:"sell_price"},{title:"Expiry Date",dataIndex:"expiry_date",key:"expiry_date",render:(e,t)=>{if(!e)return(0,f.jsx)("span",{style:{color:"#999"},children:"No Expiry"});const l=p()(e),i=p()(),n=l.isBefore(i),r=l.diff(i,"days");let s="green",d=(0,f.jsx)(y.A,{}),c="Valid";return n?(s="red",d=(0,f.jsx)(m.A,{}),c="Expired"):r<=30&&(s="orange",d=(0,f.jsx)(m.A,{}),c="Expires in ".concat(r," days")),(0,f.jsx)(o.A,{title:c,children:(0,f.jsx)(a.A,{color:s,icon:d,children:l.format("DD/MM/YYYY")})})}}],V=e=>{var t;E(e)?P(e):L(e)?R():(D(""),n({id:e._id,_id:e._id,batch_no:e.batch_no,name:(null===(t=e.ProductItem)||void 0===t?void 0:t.name)||e.name||"",code:e.code,available_quantity:e.available_quantity,sell_price:e.sell_price}))};return(0,f.jsx)(s.A,{title:"Select Stock (F7 to reopen anytime)",open:l,onCancel:x,width:800,footer:null,destroyOnClose:!0,children:(0,f.jsxs)("div",{onClick:()=>{var e;null===(e=T.current)||void 0===e||e.focus()},children:[(0,f.jsx)(h,{ref:T,placeholder:"Search stocks (use \u2191\u2193 arrows to navigate, Enter to select)",onChange:e=>w(e.target.value),style:{marginBottom:16},autoFocus:!0,onKeyDown:e=>{var t;if(z.length)if("ArrowDown"===e.key)e.preventDefault(),S((e=>{let t=e+1;for(;t<z.length&&(z[t].expiry_date&&p()(z[t].expiry_date).isBefore(p()())||z[t].available_quantity<=0);)t++;const l=Math.min(t,z.length-1);return k(z[l]._id),l})),null===(t=T.current)||void 0===t||t.focus();else if("ArrowUp"===e.key){var l;e.preventDefault(),S((e=>{let t=e-1;for(;t>=0&&(z[t].expiry_date&&p()(z[t].expiry_date).isBefore(p()())||z[t].available_quantity<=0);)t--;const l=Math.max(t,0);return k(z[l]._id),l})),null===(l=T.current)||void 0===l||l.focus()}else if("Enter"===e.key){e.preventDefault();const t=z[B];t&&(V(t),E(t)||L(t)||x())}},onBlur:()=>{setTimeout((()=>{var e;l&&(null===(e=T.current)||void 0===e||e.focus())}),10)}}),I&&(0,f.jsxs)("div",{style:{marginBottom:16,padding:"12px 16px",backgroundColor:"#fff2f0",border:"1px solid #ffccc7",borderRadius:"6px",color:"#cf1322",fontSize:"14px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,f.jsx)(m.A,{style:{color:"#cf1322"}}),I]}),(0,f.jsxs)("div",{onKeyDown:e=>{var t;if(z.length)if("ArrowDown"===e.key)e.preventDefault(),S((e=>{let t=e+1;for(;t<z.length&&(z[t].expiry_date&&p()(z[t].expiry_date).isBefore(p()())||z[t].available_quantity<=0);)t++;const l=Math.min(t,z.length-1);return k(z[l]._id),l})),null===(t=T.current)||void 0===t||t.focus();else if("ArrowUp"===e.key)e.preventDefault(),S((e=>{let t=e-1;for(;t>=0&&(z[t].expiry_date&&p()(z[t].expiry_date).isBefore(p()())||z[t].available_quantity<=0);)t--;const l=Math.max(t,0);return k(z[l]._id),l}));else if("Enter"===e.key){e.preventDefault();const t=z[B];t&&(V(t),E(t)||L(t)||x())}else if("Escape"===e.key){var l;e.preventDefault(),null===(l=T.current)||void 0===l||l.focus()}else if("Tab"===e.key&&e.shiftKey){var i;e.preventDefault(),null===(i=T.current)||void 0===i||i.focus()}},tabIndex:0,ref:G,style:{outline:"none"},children:[(0,f.jsx)(d.A,{dataSource:z,columns:N,loading:j,rowKey:"_id",size:"small",pagination:!1,title:()=>(0,f.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0"},children:[(0,f.jsx)("span",{children:"Stock Items"}),(0,f.jsxs)("div",{style:{fontSize:"12px",color:"#666"},children:[(0,f.jsx)("span",{style:{color:"#52c41a"},children:"\ud83d\udfe2 Valid"}),(0,f.jsx)("span",{style:{margin:"0 8px",color:"#faad14"},children:"\ud83d\udfe0 Near Expiry"}),(0,f.jsx)("span",{style:{color:"#ff4d4f"},children:"\ud83d\udd34 Expired/Out of Stock (Disabled)"})]})]}),onRow:(e,t)=>{const l=E(e),i=L(e);return{onClick:()=>{l||i?l?P(e):i&&R():(V(e),setTimeout((()=>{var e;null===(e=T.current)||void 0===e||e.focus()}),10))},onDoubleClick:()=>{l||i?l?P(e):i&&R():V(e)},className:t===B?"ant-table-row ant-table-row-selected":"ant-table-row","data-row-key":e._id,style:{opacity:l||i?.6:1,cursor:l||i?"not-allowed":"pointer",backgroundColor:l||i?"#f5f5f5":void 0}}},rowSelection:{type:"radio",selectedRowKeys:C?[C]:[],onChange:e=>{k(e[0]);const t=z.findIndex((t=>t._id===e[0]));-1!==t&&S(t)},getCheckboxProps:e=>({disabled:E(e)||L(e)})}}),(0,f.jsxs)("div",{style:{marginTop:16,fontSize:"12px",color:"#666"},children:[(0,f.jsx)("strong",{children:"Keyboard Shortcuts:"})," \u2191\u2193 Navigate stocks | Enter Select | Escape Cancel",(0,f.jsx)("br",{}),(0,f.jsx)("strong",{children:"Tip:"})," Press F7 anytime to reopen this modal for stock changes",(0,f.jsx)("br",{}),(0,f.jsx)("strong",{children:"Note:"})," Expired items (\ud83d\udd34) and out of stock items (\ud83d\udd34) are shown but cannot be selected. Navigation automatically skips expired and out of stock items.",(0,f.jsx)("br",{}),(0,f.jsx)("strong",{children:"Error Handling:"})," Attempting to select expired or out of stock items will show an error message and prevent selection."]})]})]})})}},36977:(e,t,l)=>{l.d(t,{A:()=>f});var i=l(65043),n=l(36621),r=l(16569),o=l(62751),a=l(6051),s=l(95206),d=l(39249),c=l(47615),u=l(83537),x=l(97031),p=l(35708),m=l(70579);const{Search:y}=n.A,f=e=>{var t;let{visible:l,onSelect:n,onCancel:f}=e;const{getEntityApi:h}=(0,u.p)(),v=h("Product"),{items:g,loading:_}=(0,x.Sm)(v.getIdentifier("GetAll")),[b,j]=(0,i.useState)(""),[A,w]=(0,i.useState)(null),[C,k]=(0,i.useState)(0),[B,S]=(0,i.useState)(!1),I=(0,i.useRef)(null),D=(null===g||void 0===g||null===(t=g.result)||void 0===t?void 0:t.filter((e=>{var t,l,i,n,r,o,a;const s=b.toLowerCase();return((null===(t=e.name)||void 0===t?void 0:t.toLowerCase())||"").includes(s)||((null===(l=e.sku)||void 0===l?void 0:l.toLowerCase())||"").includes(s)||(null===(i=e.VariantItem)||void 0===i||null===(n=i.variant_name)||void 0===n?void 0:n.toLowerCase().includes(s))||(null===(r=e.VariantItem)||void 0===r||null===(o=r.variant_code)||void 0===o?void 0:o.toLowerCase().includes(s))||((null===(a=e.selling_price)||void 0===a?void 0:a.toString())||"").includes(s)})).sort(((e,t)=>{var l,i,n,r,o,a,s,d,c,u,x,p,m,y,f,h;const v=b.toLowerCase(),g=((null===(l=e.name)||void 0===l?void 0:l.toLowerCase())||"")===v||(null===(i=e.VariantItem)||void 0===i||null===(n=i.variant_name)||void 0===n?void 0:n.toLowerCase())===v||((null===(r=e.sku)||void 0===r?void 0:r.toLowerCase())||"")===v,_=((null===(o=t.name)||void 0===o?void 0:o.toLowerCase())||"")===v||(null===(a=t.VariantItem)||void 0===a||null===(s=a.variant_name)||void 0===s?void 0:s.toLowerCase())===v||((null===(d=t.sku)||void 0===d?void 0:d.toLowerCase())||"")===v;if(g&&!_)return-1;if(!g&&_)return 1;const j=((null===(c=e.name)||void 0===c?void 0:c.toLowerCase())||"").startsWith(v)||(null===(u=e.VariantItem)||void 0===u||null===(x=u.variant_name)||void 0===x?void 0:x.toLowerCase().startsWith(v))||((null===(p=e.sku)||void 0===p?void 0:p.toLowerCase())||"").startsWith(v),A=((null===(m=t.name)||void 0===m?void 0:m.toLowerCase())||"").startsWith(v)||(null===(y=t.VariantItem)||void 0===y||null===(f=y.variant_name)||void 0===f?void 0:f.toLowerCase().startsWith(v))||((null===(h=t.sku)||void 0===h?void 0:h.toLowerCase())||"").startsWith(v);return j&&!A?-1:!j&&A?1:0})))||[];(0,i.useEffect)((()=>{k(0),D.length>0?w(D[0]._id):w(null)}),[b,l,g]),(0,i.useEffect)((()=>{l&&setTimeout((()=>{var e;null===(e=I.current)||void 0===e||e.focus()}),100)}),[l]);const G=[{title:"Product & Variant",dataIndex:"name",key:"name",width:250,render:(e,t)=>{var l,i;return(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{style:{fontWeight:600,color:"#1890ff"},children:e}),(null===(l=t.VariantItem)||void 0===l?void 0:l.variant_name)&&(0,m.jsxs)("div",{style:{fontSize:"12px",color:"#52c41a",marginTop:"2px"},children:["Variant: ",t.VariantItem.variant_name,(null===(i=t.VariantItem)||void 0===i?void 0:i.variant_code)&&(0,m.jsxs)("span",{style:{marginLeft:"8px",color:"#fa8c16",fontSize:"11px"},children:["(",t.VariantItem.variant_code,")"]})]})]})}},{title:"Variant",dataIndex:"VariantItem",key:"variant",width:120,render:e=>null!==e&&void 0!==e&&e.variant_name?(0,m.jsx)("span",{style:{color:"#52c41a",fontWeight:500},children:e.variant_name}):(0,m.jsx)("span",{style:{color:"#bfbfbf",fontStyle:"italic"},children:"No variant"})},{title:"SKU",dataIndex:"sku",key:"sku",width:120},{title:"Price",dataIndex:"selling_price",key:"selling_price",width:100,render:e=>(0,m.jsxs)("span",{style:{color:"#52c41a",fontWeight:600,fontSize:"14px"},children:["\u20b9",(null===e||void 0===e?void 0:e.toFixed(2))||"0.00"]})}],T=e=>{n(e)};return(0,m.jsxs)(o.A,{title:"Select Product & Variant (F5 to reopen anytime)",open:l,onCancel:f,width:900,footer:null,destroyOnClose:!0,children:[(0,m.jsxs)("div",{onClick:()=>{var e;null===(e=I.current)||void 0===e||e.focus()},children:[(0,m.jsxs)(a.A.Compact,{style:{marginBottom:16,width:"100%"},children:[(0,m.jsx)(y,{ref:I,placeholder:"Search by product name, variant, SKU, or price (use \u2191\u2193 arrows to navigate, Enter to select)",onChange:e=>j(e.target.value),style:{flex:1},autoFocus:!0,onKeyDown:e=>{var t;if(D.length)if("ArrowDown"===e.key)e.preventDefault(),k((e=>{const t=Math.min(e+1,D.length-1);return w(D[t]._id),t})),null===(t=I.current)||void 0===t||t.focus();else if("ArrowUp"===e.key){var l;e.preventDefault(),k((e=>{const t=Math.max(e-1,0);return w(D[t]._id),t})),null===(l=I.current)||void 0===l||l.focus()}else if("Enter"===e.key){e.preventDefault();const t=D[C];t&&T(t)}else"Escape"===e.key&&(e.preventDefault(),f())},onBlur:()=>{setTimeout((()=>{var e;l&&(null===(e=I.current)||void 0===e||e.focus())}),10)},value:b}),(0,m.jsx)(s.Ay,{type:"primary",icon:(0,m.jsx)(c.A,{}),onClick:()=>S(!0),style:{minWidth:100},children:"Scan"})]}),(0,m.jsx)(d.A,{dataSource:D,columns:G,loading:_,rowKey:"_id",size:"small",pagination:!1,onRow:(e,t)=>({onClick:()=>{T(e),setTimeout((()=>{var e;null===(e=I.current)||void 0===e||e.focus()}),10)},onDoubleClick:()=>T(e),className:t===C?"ant-table-row ant-table-row-selected":"ant-table-row",style:{backgroundColor:t===C?"#e6f7ff":void 0,border:t===C?"2px solid #1890ff":void 0}}),rowSelection:{type:"radio",selectedRowKeys:A?[A]:[],onChange:e=>{w(e[0]);const t=D.findIndex((t=>t._id===e[0]));-1!==t&&k(t)}},scroll:{y:300}}),(0,m.jsxs)("div",{style:{marginTop:16,fontSize:"12px",color:"#666"},children:[(0,m.jsx)("strong",{children:"Keyboard Shortcuts:"})," \u2191\u2193 Navigate products | Enter Select | Escape Cancel",(0,m.jsx)("br",{}),(0,m.jsx)("strong",{children:"Search:"})," Product name, variant name, SKU, or price",(0,m.jsx)("br",{}),(0,m.jsx)("strong",{children:"Barcode Scanner:"}),' Click "Scan" button or use USB barcode scanner',(0,m.jsx)("br",{}),(0,m.jsx)("strong",{children:"Tip:"})," Press F5 anytime to reopen this modal for product changes"]})]}),(0,m.jsx)(p.A,{visible:B,onClose:()=>S(!1),onScan:e=>{var t;j(e),S(!1);const l=null===g||void 0===g||null===(t=g.result)||void 0===t?void 0:t.find((t=>{var l,i,n,r;const o=e.toLowerCase();return((null===(l=t.sku)||void 0===l?void 0:l.toLowerCase())||"").includes(o)||((null===(i=t.name)||void 0===i?void 0:i.toLowerCase())||"").includes(o)||(null===(n=t.VariantItem)||void 0===n||null===(r=n.variant_code)||void 0===r?void 0:r.toLowerCase().includes(o))}));l?(setTimeout((()=>{n(l)}),500),r.Ay.success("Product found: ".concat(l.name))):r.Ay.warning("No product found with barcode: ".concat(e))},title:"Scan Product Barcode",description:"Scan barcode to find product automatically"})]})}},38963:(e,t,l)=>{l.d(t,{l:()=>n});var i=l(89379);function n(e){let{items:t,productList:l,isGstIncluded:n,discount:r,discountType:o}=e;const a=t.map((e=>{var t,r;const o=null===l||void 0===l?void 0:l.find((t=>t._id===e.product_id));let a=e.tax_percentage||(null===o||void 0===o||null===(t=o.CategoryItem)||void 0===t?void 0:t.tax_percentage)||18;a&&0!==a||(a=18);const s=Number(e.qty||0)*Number(e.price||0)+Number(e.loose_qty||0)*(Number(e.price||0)/((null===o||void 0===o||null===(r=o.VariantItem)||void 0===r?void 0:r.pack_size)||1)||0);let d=s;return!n&&a>0&&(d=s+s*a/100),(0,i.A)((0,i.A)({},e),{},{tax_percentage:a,baseAmount:s,amount:d})})),s=a.reduce(((e,t)=>e+Number(t.amount)),0),d=a.reduce(((e,t)=>e+Number(t.baseAmount)),0);let c=0;r>0&&(c="percentage"===o?d*(r/100):r);let u=0,x=0,p=0;a.forEach((e=>{let t=e.baseAmount;r>0&&(t="percentage"===o?e.baseAmount-e.baseAmount*(r/100):e.baseAmount-r/d*e.baseAmount);let l=0;n?e.tax_percentage>0?(l=t*(e.tax_percentage/(100+e.tax_percentage)),x+=t-l,u+=l,p+=t):(x+=t,p+=t):e.tax_percentage>0?(l=t*(e.tax_percentage/100),x+=t,u+=l,p+=t+l):(x+=t,p+=t)}));return{sub_total:s,value_of_goods:x,total_gst:u,cgst:u/2,sgst:u/2,total_amount:p,discountValue:c}}},43281:(e,t,l)=>{l.d(t,{A:()=>m});var i=l(65043),n=l(83833),r=l(62751),o=l(76399),a=l(8354),s=l(20691),d=l(83537),c=l(97031),u=l(70579);const{Title:x,Text:p}=n.A,m=e=>{var t,l,n,m,y,f,h;let{visible:v,onCancel:g,productId:_}=e;const{getEntityApi:b}=(0,d.p)(),j=b("Product"),{items:A,loading:w}=(0,c.Sm)(j.getIdentifier("GetAll")),[C,k]=(0,i.useState)(null);(0,i.useEffect)((()=>{if(v&&_&&null!==A&&void 0!==A&&A.result){const e=A.result.find((e=>e._id===_));e&&k(e)}}),[v,_,A]),(0,i.useEffect)((()=>{!v||!_||null!==A&&void 0!==A&&A.result||j("GetAll")}),[v,_,A,j]);const B=()=>{k(null),g()};return C?(0,u.jsx)(r.A,{title:(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,u.jsx)("span",{children:"\ud83d\udce6 Product Details"}),(0,u.jsx)(o.A,{color:"blue",style:{margin:0},children:C.sku})]}),open:v,onCancel:B,footer:null,width:700,destroyOnClose:!0,children:(0,u.jsxs)("div",{style:{padding:"16px 0"},children:[(0,u.jsxs)("div",{style:{marginBottom:"24px"},children:[(0,u.jsx)(x,{level:4,style:{margin:"0 0 8px 0",color:"#1890ff"},children:C.name}),(null===(t=C.VariantItem)||void 0===t?void 0:t.variant_name)&&(0,u.jsxs)(o.A,{color:"green",style:{fontSize:"12px"},children:["Variant: ",C.VariantItem.variant_name]})]}),(0,u.jsx)(a.A,{style:{margin:"16px 0"}}),(0,u.jsxs)(s.A,{title:"Product Information",column:2,size:"small",bordered:!0,style:{marginBottom:"24px"},children:[(0,u.jsx)(s.A.Item,{label:"Product Name",span:2,children:(0,u.jsx)(p,{strong:!0,children:C.name})}),(null===(l=C.VariantItem)||void 0===l?void 0:l.variant_name)&&(0,u.jsx)(s.A.Item,{label:"Variant Name",children:(0,u.jsx)(p,{children:C.VariantItem.variant_name})}),(null===(n=C.VariantItem)||void 0===n?void 0:n.variant_code)&&(0,u.jsx)(s.A.Item,{label:"Variant Code",children:(0,u.jsx)(p,{code:!0,children:C.VariantItem.variant_code})}),(0,u.jsx)(s.A.Item,{label:"SKU",children:(0,u.jsx)(p,{code:!0,children:C.sku})}),C.brand&&(0,u.jsx)(s.A.Item,{label:"Brand",children:(0,u.jsx)(p,{children:C.brand})}),C.unit&&(0,u.jsx)(s.A.Item,{label:"Unit",children:(0,u.jsx)(p,{children:C.unit})}),C.description&&(0,u.jsx)(s.A.Item,{label:"Description",span:2,children:(0,u.jsx)(p,{children:C.description})})]}),(0,u.jsxs)(s.A,{title:"Pricing & Tax",column:2,size:"small",bordered:!0,style:{marginBottom:"24px"},children:[(0,u.jsx)(s.A.Item,{label:"Selling Price",children:(0,u.jsxs)(p,{strong:!0,style:{color:"#52c41a",fontSize:"16px"},children:["\u20b9",(null===(m=C.selling_price)||void 0===m?void 0:m.toFixed(2))||"0.00"]})}),(0,u.jsx)(s.A.Item,{label:"MRP",children:(0,u.jsxs)(p,{style:{color:"#fa8c16"},children:["\u20b9",(null===(y=C.mrp)||void 0===y?void 0:y.toFixed(2))||"0.00"]})}),(null===(f=C.CategoryItem)||void 0===f?void 0:f.name)&&(0,u.jsx)(s.A.Item,{label:"Category",children:(0,u.jsx)(p,{children:C.CategoryItem.name})}),void 0!==(null===(h=C.CategoryItem)||void 0===h?void 0:h.tax_percentage)&&(0,u.jsx)(s.A.Item,{label:"Tax Rate",children:(0,u.jsxs)(o.A,{color:"orange",children:[C.CategoryItem.tax_percentage,"%"]})})]}),(void 0!==C.min_stock||void 0!==C.max_stock)&&(0,u.jsxs)(s.A,{title:"Stock Information",column:2,size:"small",bordered:!0,children:[void 0!==C.min_stock&&(0,u.jsx)(s.A.Item,{label:"Minimum Stock",children:(0,u.jsx)(p,{children:C.min_stock})}),void 0!==C.max_stock&&(0,u.jsx)(s.A.Item,{label:"Maximum Stock",children:(0,u.jsx)(p,{children:C.max_stock})})]}),(0,u.jsx)("div",{style:{marginTop:"24px",padding:"16px",backgroundColor:"#f6f8fa",borderRadius:"8px",textAlign:"center"},children:(0,u.jsx)(p,{type:"secondary",style:{fontSize:"12px"},children:"Right-click on product field to view details \u2022 Press ESC to close"})})]})}):(0,u.jsx)(r.A,{title:"Product Details",open:v,onCancel:B,footer:null,width:600,destroyOnClose:!0,children:(0,u.jsx)("div",{style:{textAlign:"center",padding:"40px 20px"},children:w?(0,u.jsx)(p,{children:"Loading product details..."}):(0,u.jsx)(p,{type:"secondary",children:"Product not found"})})})}},61345:(e,t,l)=>{l.d(t,{A:()=>E});var i=l(65043),n=l(83833),r=l(36621),o=l(48677),a=l(95206),s=l(6051),d=l(8354),c=l(91686),u=l(99472),x=l(54522),p=l(45964),m=l(76399),y=l(96651),f=l(15615),h=l(72411),v=l(73847),g=l(36091),_=l(53722),b=l(6881),j=l(76401),A=l(61118),w=l(94834),C=l(60446),k=l.n(C),B=l(83537),S=l(97031),I=l(70579);const{Title:D,Text:G}=n.A,{Search:T}=r.A,E=e=>{let{visible:t,onClose:l,onViewBill:n,onNewBill:r}=e;const{getEntityApi:C}=(0,B.p)(),E=C("SalesRecord"),{items:L,loading:P}=(0,S.Sm)(E.getIdentifier("GetAll")),[R,z]=(0,i.useState)(""),[N,V]=(0,i.useState)([]);(0,i.useEffect)((()=>{t&&E("GetAll")}),[t]),(0,i.useEffect)((()=>{if(null!==L&&void 0!==L&&L.result){const e=L.result.filter((e=>{var t;if(!R)return!0;const l=R.toLowerCase(),i=e.invoice_no||"",n=(null===(t=e.customerDetails)||void 0===t?void 0:t.full_name)||"",r=e.date||"",o="number"===typeof e.total_amount?e.total_amount.toString():String(e.total_amount||"");return i.toLowerCase().includes(l)||n.toLowerCase().includes(l)||r.includes(R)||o.includes(R)}));V(e)}}),[L,R]);const M=(e,t)=>e&&!t?"Paid":t?"Partial":"Unpaid",F=e=>{n(e),l()},K=()=>{r(),l()};return(0,I.jsxs)(o.A,{title:(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,I.jsx)(D,{level:4,style:{margin:0,color:"#1f2937"},children:"\ud83d\udccb Bill List"}),(0,I.jsx)(a.Ay,{type:"text",icon:(0,I.jsx)(f.A,{}),onClick:l,size:"small"})]}),placement:"left",open:t,onClose:l,width:400,bodyStyle:{padding:"16px"},headerStyle:{borderBottom:"1px solid #e5e7eb",padding:"16px 16px 12px 16px"},children:[(0,I.jsx)("div",{style:{marginBottom:"16px"},children:(0,I.jsxs)(s.A,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,I.jsx)(T,{placeholder:"Search bills by invoice, customer, date...",value:R,onChange:e=>z(e.target.value),prefix:(0,I.jsx)(h.A,{}),allowClear:!0,size:"large"}),(0,I.jsx)(a.Ay,{type:"primary",icon:(0,I.jsx)(v.A,{}),onClick:K,style:{width:"100%",height:"40px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",border:"none",fontWeight:600,borderRadius:"8px"},children:"\ud83c\udd95 Create New Bill"})]})}),(0,I.jsx)(d.A,{style:{margin:"16px 0"}}),(0,I.jsx)("div",{style:{height:"calc(100vh - 250px)",overflow:"auto"},children:P?(0,I.jsxs)("div",{style:{textAlign:"center",padding:"40px"},children:[(0,I.jsx)(c.A,{size:"large"}),(0,I.jsx)("div",{style:{marginTop:"16px"},children:(0,I.jsx)(G,{type:"secondary",children:"Loading bills..."})})]}):0===N.length?(0,I.jsx)(u.A,{description:(0,I.jsxs)("div",{children:[(0,I.jsx)(G,{type:"secondary",children:R?"No bills found matching your search.":"No bills available."}),!R&&(0,I.jsx)("div",{style:{marginTop:"8px"},children:(0,I.jsx)(a.Ay,{type:"link",onClick:K,children:"Create your first bill"})})]}),style:{marginTop:"40px"}}):(0,I.jsx)(x.A,{dataSource:N,renderItem:e=>{var t,l,i;return(0,I.jsx)(x.A.Item,{style:{padding:"16px",border:"1px solid #e5e7eb",borderRadius:"8px",marginBottom:"12px",background:"white",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.1)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.boxShadow="none",e.currentTarget.style.transform="translateY(0)"},onClick:()=>F(e),children:(0,I.jsxs)("div",{style:{width:"100%"},children:[(0,I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,I.jsx)(p.A,{icon:(0,I.jsx)(g.A,{}),style:{background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white"}}),(0,I.jsx)(G,{strong:!0,style:{fontSize:"14px"},children:e.invoice_no})]}),(0,I.jsx)(m.A,{color:(l=e.is_paid,i=e.is_partially_paid,l&&!i?"success":i?"warning":"error"),children:M(e.is_paid,e.is_partially_paid)})]}),(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"6px"},children:[(0,I.jsx)(_.A,{style:{color:"#6b7280",fontSize:"12px"}}),(0,I.jsx)(G,{style:{fontSize:"12px",color:"#374151"},children:(null===(t=e.customerDetails)||void 0===t?void 0:t.full_name)||e.customer_name||"N/A"})]}),(0,I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,I.jsx)(b.A,{style:{color:"#6b7280",fontSize:"12px"}}),(0,I.jsx)(G,{style:{fontSize:"12px",color:"#6b7280"},children:e.date?k()(e.date).format("DD/MM/YYYY"):"N/A"})]}),(0,I.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,I.jsx)(j.A,{style:{color:"#10b981",fontSize:"12px"}}),(0,I.jsxs)(G,{strong:!0,style:{fontSize:"14px",color:"#10b981"},children:["\u20b9",("number"===typeof e.total_amount?e.total_amount:parseFloat(e.total_amount)||0).toFixed(2)]})]})]}),(0,I.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"12px",justifyContent:"flex-end"},children:[(0,I.jsx)(y.A,{title:"View Bill",children:(0,I.jsx)(a.Ay,{type:"text",icon:(0,I.jsx)(A.A,{}),size:"small",onClick:t=>{t.stopPropagation(),F(e)},style:{color:"#3b82f6"}})}),(0,I.jsx)(y.A,{title:"Print Bill",children:(0,I.jsx)(a.Ay,{type:"text",icon:(0,I.jsx)(w.A,{}),size:"small",onClick:e=>{e.stopPropagation()},style:{color:"#10b981"}})})]})]})})},pagination:!1})}),(0,I.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,padding:"16px",background:"white",borderTop:"1px solid #e5e7eb"},children:(0,I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,I.jsxs)(G,{type:"secondary",style:{fontSize:"12px"},children:["Total Bills: ",N.length]}),(0,I.jsx)(G,{type:"secondary",style:{fontSize:"12px"},children:"\ud83d\udca1 Click on any bill to view details"})]})})]})}},70224:(e,t,l)=>{l.d(t,{A:()=>i});const i={mainContainer:"BillDataGrid_mainContainer__Jnuo1",gradientShift:"BillDataGrid_gradientShift__hhIW9",backgroundCircle1:"BillDataGrid_backgroundCircle1__5PBPG",float:"BillDataGrid_float__1VyT0",backgroundCircle2:"BillDataGrid_backgroundCircle2__J+xMs",backgroundCircle3:"BillDataGrid_backgroundCircle3__AgoEw",backgroundCircle4:"BillDataGrid_backgroundCircle4__86Xfd",backgroundCircle5:"BillDataGrid_backgroundCircle5__qpbiT",headerContainer:"BillDataGrid_headerContainer__wfojf",slideInDown:"BillDataGrid_slideInDown__l3LU5",headerCircle1:"BillDataGrid_headerCircle1__8+aPI",headerCircle2:"BillDataGrid_headerCircle2__Z9w17",headerCircle3:"BillDataGrid_headerCircle3__3eMNm",pulse:"BillDataGrid_pulse__EVfnw",headerCircle4:"BillDataGrid_headerCircle4__fVITr",headerCircle5:"BillDataGrid_headerCircle5__0E6vl",headerContent:"BillDataGrid_headerContent__6Rnkr",titleSection:"BillDataGrid_titleSection__LBuxT",fadeInLeft:"BillDataGrid_fadeInLeft__YHJna",titleIcon:"BillDataGrid_titleIcon__qffZU",bounce:"BillDataGrid_bounce__fYaGs",titleText:"BillDataGrid_titleText__XlvSS",slideInRight:"BillDataGrid_slideInRight__+-bkg",subtitleText:"BillDataGrid_subtitleText__Hgyav",fadeInUp:"BillDataGrid_fadeInUp__Y00FE",controlsSection:"BillDataGrid_controlsSection__PSC3w",fadeInRight:"BillDataGrid_fadeInRight__eA5Bm",controlGroup:"BillDataGrid_controlGroup__AFGBT",saleTypeControl:"BillDataGrid_saleTypeControl__hzHpa",slideInUp:"BillDataGrid_slideInUp__ZuvW2",gstControl:"BillDataGrid_gstControl__AiGdY",paymentControl:"BillDataGrid_paymentControl__BD0r9",partialPaymentControl:"BillDataGrid_partialPaymentControl__unngo",controlLabel:"BillDataGrid_controlLabel__QP4fP",badgesContainer:"BillDataGrid_badgesContainer__bqqSt",itemsBadge:"BillDataGrid_itemsBadge__o0Uro",amountBadge:"BillDataGrid_amountBadge__IPSqT",badgeText:"BillDataGrid_badgeText__9cTal",invoiceDetailsGrid:"BillDataGrid_invoiceDetailsGrid__QPpaj",itemsSection:"BillDataGrid_itemsSection__vJE1b",itemsCircle1:"BillDataGrid_itemsCircle1__PQoMB",rotate:"BillDataGrid_rotate__l3nA9",itemsCircle2:"BillDataGrid_itemsCircle2__0lWcR",scaleIn:"BillDataGrid_scaleIn__xFZvA",billItemsGrid:"BillDataGrid_billItemsGrid__jpWQo",billItemsHeader:"BillDataGrid_billItemsHeader__hxL0O",billItemsTitle:"BillDataGrid_billItemsTitle__MQduV",billItemsBadge:"BillDataGrid_billItemsBadge__vdJMk",billSummary:"BillDataGrid_billSummary__yA4j-",summaryCircle1:"BillDataGrid_summaryCircle1__PuveY",summaryCircle2:"BillDataGrid_summaryCircle2__fdcks",summaryHeader:"BillDataGrid_summaryHeader__h1BtQ",summaryTitle:"BillDataGrid_summaryTitle__dSOoP",summaryRow:"BillDataGrid_summaryRow__yUShR",summaryLabel:"BillDataGrid_summaryLabel__cLnHd",summaryValue:"BillDataGrid_summaryValue__LUh-6",summaryTotal:"BillDataGrid_summaryTotal__ujvAB",summaryTable:"BillDataGrid_summaryTable__ZpVlt",totalAmountRow:"BillDataGrid_totalAmountRow__JXMuL",totalAmountLabel:"BillDataGrid_totalAmountLabel__IVRMe",totalAmountValue:"BillDataGrid_totalAmountValue__5W5mL",discountValue:"BillDataGrid_discountValue__QjPij",partialPaymentInfo:"BillDataGrid_partialPaymentInfo__OpO+-",partialPaymentRow:"BillDataGrid_partialPaymentRow__Qy-Ni",partialPaymentLabel:"BillDataGrid_partialPaymentLabel__yEvTO",partialPaymentValue:"BillDataGrid_partialPaymentValue__SLg8d",controlsContainer:"BillDataGrid_controlsContainer__2jCRg",discountControl:"BillDataGrid_discountControl__n0WOI",discountControlLabel:"BillDataGrid_discountControlLabel__0iwJ9",discountControlInputs:"BillDataGrid_discountControlInputs__TbgUU",partialPaymentControlLabel:"BillDataGrid_partialPaymentControlLabel__lxP98",summaryTotalLabel:"BillDataGrid_summaryTotalLabel__u+656",summaryTotalValue:"BillDataGrid_summaryTotalValue__sKz9B",partialPaymentBalance:"BillDataGrid_partialPaymentBalance__lFxZE",discountLabel:"BillDataGrid_discountLabel__906vd",discountInputs:"BillDataGrid_discountInputs__9BUMD",actionHub:"BillDataGrid_actionHub__SlPSg",actionButtonsContainer:"BillDataGrid_actionButtonsContainer__BcfKu",actionHubCircle1:"BillDataGrid_actionHubCircle1__ggNzA",actionHubCircle2:"BillDataGrid_actionHubCircle2__Nb-oj",actionHubCircle3:"BillDataGrid_actionHubCircle3__D2pna",actionHubCircle4:"BillDataGrid_actionHubCircle4__ayVXK",actionButtons:"BillDataGrid_actionButtons__tQbXu",saveButton:"BillDataGrid_saveButton__vWggk",billListButton:"BillDataGrid_billListButton__ahHFc",refreshButton:"BillDataGrid_refreshButton__XnoTE",printButton:"BillDataGrid_printButton__nkIDd",clearButton:"BillDataGrid_clearButton__518xA",shortcutsInfo:"BillDataGrid_shortcutsInfo__kN1Ka",shortcutsText:"BillDataGrid_shortcutsText__qGuNn",customerField:"BillDataGrid_customerField__+4wOA",customerFieldEndKey:"BillDataGrid_customerFieldEndKey__HaMh6",stockField:"BillDataGrid_stockField__BQirP",stockFieldSelected:"BillDataGrid_stockFieldSelected__x7NU5",stockFieldIcon:"BillDataGrid_stockFieldIcon__WeVkj",stockFieldWarning:"BillDataGrid_stockFieldWarning__7Lv+C",saleTypeSwitch:"BillDataGrid_saleTypeSwitch__Xa4gR","ant-switch-checked":"BillDataGrid_ant-switch-checked__rQynk",gstSwitch:"BillDataGrid_gstSwitch__ZQG0t",paymentSwitch:"BillDataGrid_paymentSwitch__KxB-J",partialPaymentSwitch:"BillDataGrid_partialPaymentSwitch__5nNFs",keyboardShortcuts:"BillDataGrid_keyboardShortcuts__2e-4z",keyboardShortcutsContent:"BillDataGrid_keyboardShortcutsContent__5FpEl",keyboardShortcutsText:"BillDataGrid_keyboardShortcutsText__A58I9",slideInLeft:"BillDataGrid_slideInLeft__TTFPm"}},73469:(e,t,l)=>{l.d(t,{A:()=>g});var i=l(65043),n=l(89472),r=l(83833),o=l(76399),a=l(62751),s=l(36621),d=l(39249),c=l(53722),u=l(87534),x=l(75388),p=l(72411),m=l(83537),y=l(97031),f=l(70579);const{Title:h,Text:v}=r.A,g=e=>{let{visible:t,onSelect:l,onCancel:r}=e;const{getEntityApi:h}=(0,m.p)(),g=h("BillingUsers"),{items:_,loading:b}=(0,y.Sm)(g.getIdentifier("GetAll")),j=(null===_||void 0===_?void 0:_.items)||(null===_||void 0===_?void 0:_.result)||[],[A,w]=(0,i.useState)(""),[C,k]=(0,i.useState)(null),[B,S]=(0,i.useState)(-1),I=(0,i.useMemo)((()=>(0,n.HW)()),[]),D=(0,i.useRef)(null),G=(0,i.useRef)(null),T=(0,i.useRef)(null),E=(0,i.useMemo)((()=>{if(!A.trim())return j;const e=A.toLowerCase();return j.filter((t=>{var l,i,n,r,o,a;return(null===(l=t.name)||void 0===l?void 0:l.toLowerCase().includes(e))||(null===(i=t.email)||void 0===i?void 0:i.toLowerCase().includes(e))||(null===(n=t.mobile)||void 0===n?void 0:n.toLowerCase().includes(e))||(null===(r=t.user_name)||void 0===r?void 0:r.toLowerCase().includes(e))||(null===(o=t.roleItems)||void 0===o||null===(a=o.name)||void 0===a?void 0:a.toLowerCase().includes(e))}))}),[j,A]),L=(0,i.useCallback)((e=>{if(0===E.length)return;let t;switch(e){case"up":t=-1===B?E.length-1:Math.max(B-1,0);break;case"down":t=-1===B?0:Math.min(B+1,E.length-1);break;case"home":t=0;break;case"end":t=E.length-1;break;default:return}S(t),k(E[t]),setTimeout((()=>{const l=document.querySelector('[data-row-key="'.concat(E[t]._id,'"]'));if(l){const t="home"===e?"start":"end"===e?"end":"nearest";l.scrollIntoView({behavior:"smooth",block:t})}}),100)}),[E,B]),P=(0,i.useCallback)((e=>{w(e),T.current&&clearTimeout(T.current),T.current=setTimeout((()=>{e.trim()?g("GetAll",{searchString:e.trim()}):g("GetAll")}),300)}),[g]),R=(0,i.useCallback)((e=>{k(e),l(e),setTimeout((()=>r()),100)}),[l,r]),z=(0,i.useCallback)((e=>{if("Escape"===e.key)r();else if(["ArrowDown","ArrowUp","Home","End"].includes(e.key)){e.preventDefault(),e.stopPropagation();L({ArrowDown:"down",ArrowUp:"up",Home:"home",End:"end"}[e.key])}}),[L,r]),N=(0,i.useCallback)((e=>{if(!t)return;const l=e.target;if("INPUT"!==l.tagName&&"TEXTAREA"!==l.tagName&&!l.classList.contains("ant-select-selector")&&!l.closest(".ant-select-dropdown")){if(e.ctrlKey&&"f"===e.key)return e.preventDefault(),e.stopPropagation(),void(D.current&&(D.current.focus(),D.current.select()));if(["ArrowDown","ArrowUp","Home","End"].includes(e.key)){e.preventDefault(),e.stopPropagation();L({ArrowDown:"down",ArrowUp:"up",Home:"home",End:"end"}[e.key])}}}),[t,L]),V=(0,i.useMemo)((()=>[{title:"",key:"select",width:60,render:(e,t)=>(0,f.jsx)("div",{style:{cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:()=>{k(t);const e=E.findIndex((e=>e._id===t._id));S(e)},children:(0,f.jsx)("div",{style:{width:"18px",height:"18px",borderRadius:"50%",border:(null===C||void 0===C?void 0:C._id)===t._id?"2px solid #1890ff":"2px solid #d9d9d9",backgroundColor:(null===C||void 0===C?void 0:C._id)===t._id?"#1890ff":"white",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease"},children:(null===C||void 0===C?void 0:C._id)===t._id&&(0,f.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:"white"}})})})},{title:"Name",dataIndex:"name",key:"name",render:(e,t)=>(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,f.jsx)(c.A,{style:{color:"#1890ff"}}),(0,f.jsxs)("div",{children:[(0,f.jsx)(v,{strong:!0,children:e}),(0,f.jsx)("br",{}),(0,f.jsxs)(v,{type:"secondary",style:{fontSize:"12px"},children:["@",t.user_name]})]})]})},{title:"Role",key:"role",render:(e,t)=>{var l;return(0,f.jsx)(o.A,{color:"blue",children:(null===(l=t.roleItems)||void 0===l?void 0:l.name)||"No Role"})}},{title:"Mobile",dataIndex:"mobile",key:"mobile",render:e=>(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,f.jsx)(u.A,{style:{color:"#666"}}),(0,f.jsx)(v,{children:e})]})},{title:"Email",dataIndex:"email",key:"email",render:e=>(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,f.jsx)(x.A,{style:{color:"#666"}}),(0,f.jsx)(v,{children:e||"-"})]})},{title:"Branch",key:"branch",render:(e,t)=>{var l;return(0,f.jsx)(v,{type:"secondary",style:{fontSize:"12px"},children:(null===(l=t.branchItems)||void 0===l?void 0:l.branch_name)||"-"})}}]),[C,E]),M=(0,i.useCallback)(((e,t)=>({onClick:()=>{k(e),S(null!==t&&void 0!==t?t:0)},style:{cursor:"pointer",backgroundColor:(null===C||void 0===C?void 0:C._id)===e._id?"#f0f8ff":"white",border:(null===C||void 0===C?void 0:C._id)===e._id?"2px solid #1890ff":"1px solid #f0f0f0",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:t=>{(null===C||void 0===C?void 0:C._id)!==e._id&&(t.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:t=>{(null===C||void 0===C?void 0:C._id)!==e._id&&(t.currentTarget.style.backgroundColor="white")}})),[C]);(0,i.useEffect)((()=>(t?(g("GetAll"),k(null),S(-1)):(w(""),k(null),S(-1),T.current&&(clearTimeout(T.current),T.current=null)),()=>{T.current&&clearTimeout(T.current)})),[t,g]),(0,i.useEffect)((()=>{if(t&&j.length>0&&null!==I&&void 0!==I&&I._id&&!C){const e=j.find((e=>e._id===I._id));if(e){k(e);const t=j.findIndex((e=>e._id===I._id));S(t),setTimeout((()=>{const t=document.querySelector('[data-row-key="'.concat(e._id,'"]'));t&&t.scrollIntoView({behavior:"smooth",block:"center"})}),200)}}}),[t,j,null===I||void 0===I?void 0:I._id,C]),(0,i.useEffect)((()=>{if(t&&D.current){const e=()=>{D.current&&(D.current.focus(),D.current.select())};e();const t=setTimeout(e,100);return()=>clearTimeout(t)}}),[t]),(0,i.useEffect)((()=>{if(t)return document.addEventListener("keydown",N,!0),()=>document.removeEventListener("keydown",N,!0)}),[t,N]);const F=(0,i.useCallback)((()=>{k(null),S(-1)}),[]);return(0,f.jsxs)(a.A,{title:"Select User (Billed By)",open:t,onCancel:r,footer:null,width:900,style:{top:20},afterOpenChange:e=>{e&&D.current&&setTimeout((()=>{var e,t;null===(e=D.current)||void 0===e||e.focus(),null===(t=D.current)||void 0===t||t.select()}),100)},children:[(0,f.jsx)("div",{ref:G,style:{marginBottom:16},onKeyDown:z,tabIndex:0,children:(0,f.jsx)(s.A,{ref:D,placeholder:"Search users... (\u2191\u2193: Navigate, Enter: Select, Esc: Close)",value:A,onChange:e=>P(e.target.value),prefix:(0,f.jsx)(p.A,{}),style:{width:"100%"},onKeyDown:e=>{"Enter"===e.key&&C&&R(C)},onFocus:F,autoFocus:!0,onBlur:()=>{t&&D.current&&setTimeout((()=>{t&&D.current&&D.current.focus()}),10)},suffix:A&&b?(0,f.jsx)("div",{style:{fontSize:"12px",color:"#999"},children:"Searching..."}):null})}),(0,f.jsx)("div",{style:{maxHeight:400,overflow:"auto"},children:b?(0,f.jsx)("div",{style:{textAlign:"center",padding:40},children:(0,f.jsx)(v,{children:"Loading users..."})}):0===E.length?(0,f.jsx)("div",{style:{textAlign:"center",padding:40},children:(0,f.jsx)(v,{type:"secondary",children:A?"No users found matching your search.":"No users available."})}):(0,f.jsx)(d.A,{columns:V,dataSource:E,rowKey:"_id",pagination:!1,size:"small",scroll:{y:300},onRow:M})})]})}},87768:(e,t,l)=>{l.d(t,{A:()=>g});l(65043);var i=l(83833),n=l(62751),r=l(8354),o=l(6051),a=l(95206),s=l(46237),d=l(36091),c=l(53722),u=l(6881),x=l(76401),p=l(73847),m=l(60446),y=l.n(m),f=l(70579);const{Title:h,Text:v}=i.A,g=e=>{let{visible:t,onNewBill:l,onContinueBill:i,onCancel:m,savedBillData:g}=e;return(0,f.jsxs)(n.A,{title:(0,f.jsxs)("div",{style:{textAlign:"center"},children:[(0,f.jsx)(s.A,{style:{color:"#52c41a",fontSize:"24px",marginRight:"8px"}}),(0,f.jsx)("span",{style:{color:"#52c41a",fontWeight:600},children:"Bill Saved Successfully!"})]}),open:t,onCancel:m,footer:null,width:500,centered:!0,maskClosable:!1,closable:!1,children:[(0,f.jsx)("div",{style:{textAlign:"center",marginBottom:"24px"},children:(0,f.jsx)(v,{type:"secondary",children:"Your bill has been saved successfully. What would you like to do next?"})}),g&&(0,f.jsxs)("div",{style:{background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",border:"1px solid #0ea5e9",borderRadius:"8px",padding:"16px",marginBottom:"24px"},children:[(0,f.jsx)(h,{level:5,style:{marginBottom:"12px",color:"#0369a1"},children:"\ud83d\udccb Bill Summary"}),(0,f.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:[(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,f.jsx)(d.A,{style:{color:"#0ea5e9"}}),(0,f.jsxs)(v,{strong:!0,children:["Invoice: ",g.invoice_no]})]}),(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,f.jsx)(c.A,{style:{color:"#0ea5e9"}}),(0,f.jsx)(v,{strong:!0,children:g.customer_name||"N/A"})]}),(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,f.jsx)(u.A,{style:{color:"#0ea5e9"}}),(0,f.jsx)(v,{strong:!0,children:y()(g.date).format("DD/MM/YYYY")})]}),(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,f.jsx)(x.A,{style:{color:"#0ea5e9"}}),(0,f.jsxs)(v,{strong:!0,children:["\u20b9",("number"===typeof g.total_amount?g.total_amount:parseFloat(g.total_amount)||0).toFixed(2)]})]})]})]}),(0,f.jsx)(r.A,{style:{margin:"20px 0"}}),(0,f.jsxs)(o.A,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,f.jsx)(a.Ay,{type:"primary",size:"large",icon:(0,f.jsx)(p.A,{}),onClick:l,style:{width:"100%",height:"48px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",border:"none",fontWeight:600,fontSize:"16px",borderRadius:"8px"},children:"\ud83c\udd95 Create New Bill"}),(0,f.jsx)(a.Ay,{size:"large",icon:(0,f.jsx)(d.A,{}),onClick:i,style:{width:"100%",height:"48px",background:"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)",color:"white",border:"none",fontWeight:600,fontSize:"16px",borderRadius:"8px"},children:"\ud83d\udcdd Continue with Current Bill"})]}),(0,f.jsx)("div",{style:{textAlign:"center",marginTop:"16px"},children:(0,f.jsx)(v,{type:"secondary",style:{fontSize:"12px"},children:'\ud83d\udca1 Tip: Use "New Bill" to start fresh or "Continue Bill" to add more items'})})]})}}}]);
//# sourceMappingURL=676.1a39082a.chunk.js.map