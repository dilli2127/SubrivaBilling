"use strict";(self.webpackChunkSUBRIVA_BILLING=self.webpackChunkSUBRIVA_BILLING||[]).push([[8819],{48819:(e,t,l)=>{l.r(t),l.d(t,{default:()=>J});var n=l(89379),a=l(65043),o=l(62305),r=l(16569),i=l(73146),d=l(76399),s=l(96651),c=l(6051),u=l(95206),h=l(60446),m=l.n(h),p=l(27089),g=l(9764),x=l(53722),y=l(85192),v=l(24228),b=l(73092),A=l(76401),_=l(6881),j=l(45229),S=l(9933),k=l(46237),w=l(39470),f=l(80132),C=l(41911),I=l(65885),D=l(70579);const q=e=>{let{onAllocate:t,onRevert:l,onStockout:n,onStorageAllocate:a}=e;return[{title:"Invoice ID",dataIndex:"invoice_id",key:"invoice_id",render:e=>(0,D.jsx)(d.A,{icon:(0,D.jsx)(p.A,{}),color:"blue",children:e})},{title:"Product",dataIndex:"ProductItem",key:"product",render:e=>(0,D.jsx)(s.A,{title:null===e||void 0===e?void 0:e.name,children:(0,D.jsxs)("span",{children:[(0,D.jsx)(g.A,{style:{marginRight:4}}),null===e||void 0===e?void 0:e.name]})})},{title:"Vendor",dataIndex:"VendorDetails",key:"vendor",render:e=>(0,D.jsx)(s.A,{title:null===e||void 0===e?void 0:e.company_name,children:(0,D.jsxs)("span",{children:[(0,D.jsx)(x.A,{style:{marginRight:4}}),(null===e||void 0===e?void 0:e.company_name)||"-"]})})},{title:"Warehouse",dataIndex:"WarehouseItem",key:"warehouse",render:e=>(0,D.jsx)(s.A,{title:null===e||void 0===e?void 0:e.warehouse_name,children:(0,D.jsxs)("span",{children:[(0,D.jsx)(y.A,{style:{marginRight:4}}),(null===e||void 0===e?void 0:e.warehouse_name)||"-"]})})},{title:"Batch Number",dataIndex:"batch_no",key:"batch_no",render:e=>(0,D.jsx)(d.A,{icon:(0,D.jsx)(v.A,{}),color:"purple",children:e||"-"})},{title:"Buy Price",dataIndex:"buy_price",key:"buy_price",render:e=>(0,D.jsxs)("span",{children:[(0,D.jsx)(b.A,{style:{marginRight:4}}),"\u20b9",e]})},{title:"Selling Price",dataIndex:"sell_price",key:"sell_price",render:e=>(0,D.jsxs)("span",{children:[(0,D.jsx)(A.A,{style:{marginRight:4}}),"\u20b9",e||"-"]})},{title:"Buy Date",dataIndex:"buyed_date",key:"buyed_date",render:e=>(0,D.jsxs)("span",{children:[(0,D.jsx)(_.A,{style:{marginRight:4}}),m()(e).format("DD/MM/YYYY")]})},{title:"MFG Date",dataIndex:"mfg_date",key:"mfg_date",render:e=>(0,D.jsxs)("span",{children:[(0,D.jsx)(j.A,{style:{marginRight:4}}),e?m()(e).format("DD/MM/YYYY"):"-"]})},{title:"Expiry Date",dataIndex:"expiry_date",key:"expiry_date",render:e=>{const t=m()(e),l=m()(),n=t.isBefore(l),a=t.diff(l,"days")<=30&&t.diff(l,"days")>0;let o="green";return n?o="red":a&&(o="orange"),(0,D.jsxs)(d.A,{color:o,children:[(0,D.jsx)(_.A,{style:{marginRight:4}}),e?m()(e).format("DD/MM/YYYY"):"-"]})}},{title:"Payment Status",dataIndex:"payment_status",key:"payment_status",render:e=>(0,D.jsx)(d.A,{color:"paid"===e?"green":"partial"===e?"orange":"red",children:e})},{title:"Total Cost",dataIndex:"total_cost",key:"total_cost",render:e=>(0,D.jsxs)("span",{style:{fontWeight:"bold"},children:["\u20b9",e]})},{title:"Buy Quantity",dataIndex:"quantity",key:"quantity",render:e=>(0,D.jsxs)(d.A,{color:"green",children:[(0,D.jsx)(S.A,{})," ",e]})},{title:"Available Qty",dataIndex:"available_quantity",key:"available_quantity",render:e=>(0,D.jsx)(d.A,{color:e>0?"green":"red",children:e})},{title:"Available Qty to Rack",dataIndex:"rack_available_to_allocate",key:"rack_available_to_allocate",render:e=>(0,D.jsx)(d.A,{color:e>0?"green":"red",children:e})},{title:"Status",dataIndex:"status",key:"status",render:(e,t)=>{const l=t.available_quantity||0,n=t.expiry_date?m()(t.expiry_date):null,a=m()();let o="Active",r="green",i=(0,D.jsx)(k.A,{});return 0===l?(o="Out of Stock",r="red",i=(0,D.jsx)(w.A,{})):n&&n.isBefore(a)?(o="Expired",r="red",i=(0,D.jsx)(w.A,{})):n&&n.diff(a,"days")<=30&&(o="Near Expiry",r="orange",i=(0,D.jsx)(w.A,{})),(0,D.jsx)(d.A,{color:r,icon:i,children:o})}},{title:"Stock Handle",key:"stock_handle",width:280,render:(e,o)=>{const r=0===(o.available_quantity||0),i=0===(o.rack_available_to_allocate||0);return(0,D.jsxs)(c.A,{size:"small",children:[(0,D.jsx)(s.A,{title:"Allocate Stock",children:(0,D.jsx)(u.Ay,{type:"primary",size:"small",icon:(0,D.jsx)(S.A,{}),onClick:()=>t(o),disabled:r,style:{fontSize:"10px",height:"24px",padding:"0 6px"},children:"Allocate"})}),(0,D.jsx)(s.A,{title:i?"Rack storage quantity not available":"Storage Allocate",children:(0,D.jsx)(u.Ay,{type:"primary",size:"small",icon:(0,D.jsx)(f.A,{}),onClick:()=>a(o),disabled:r||i,style:{fontSize:"10px",height:"24px",padding:"0 6px",backgroundColor:"#52c41a",borderColor:"#52c41a"},children:"Storage"})}),(0,D.jsx)(s.A,{title:"Revert Changes",children:(0,D.jsx)(u.Ay,{type:"default",size:"small",icon:(0,D.jsx)(C.A,{}),onClick:()=>l(o),style:{fontSize:"10px",height:"24px",padding:"0 6px"},children:"Revert"})}),(0,D.jsx)(s.A,{title:"Mark as Stockout",children:(0,D.jsx)(u.Ay,{type:"default",size:"small",icon:(0,D.jsx)(I.A,{}),onClick:()=>n(o),style:{fontSize:"10px",height:"24px",padding:"0 6px"},children:"Stockout"})})]})}}]};var P=l(26553),V=l(36621),F=l(7866),R=l(93504);const{Option:M}=P.A,O=e=>{let{productDropdown:t,vendorDropdown:l,warehouseDropdown:n}=e;return[{label:"Invoice / Reference ID",name:"invoice_id",rules:[{required:!0,message:"Enter invoice or reference ID!"}],component:(0,D.jsx)(V.A,{placeholder:"e.g., INV-1001"})},{label:"Product",name:"product",rules:[{required:!0,message:"Please select a product!"}],component:(0,D.jsx)(P.A,{placeholder:"Select product",showSearch:!0,allowClear:!0,loading:t.loading&&0===t.items.length,onSearch:t.setSearchString,onPopupScroll:t.handlePopupScroll,onDropdownVisibleChange:t.onDropdownVisibleChange,filterOption:!1,notFoundContent:t.loading?"Loading products...":0===t.items.length?"No products found. Add products first.":null,dropdownRender:e=>(0,D.jsxs)(D.Fragment,{children:[e,t.hasMore&&t.items.length>0&&(0,D.jsx)("div",{style:{textAlign:"center",padding:"8px",color:"#999"},children:t.loading?"Loading...":"Scroll for more"})]}),children:t.items.map((e=>{var t;return(0,D.jsx)(P.A.Option,{value:e._id,children:"".concat(e.name," ").concat((null===e||void 0===e||null===(t=e.VariantItem)||void 0===t?void 0:t.variant_name)||"")},e._id)}))})},{label:"Quantity",name:"quantity",rules:[{required:!0,message:"Enter quantity!"}],component:(0,D.jsx)(F.A,{min:1,placeholder:"e.g., 10",style:{width:"100%"}})},{label:"Buying Price (per unit)",name:"buy_price",rules:[{required:!0,message:"Enter buying price!"}],component:(0,D.jsx)(F.A,{min:0,step:.01,placeholder:"\u20b90.00",style:{width:"100%"}})},{label:"MRP (per unit)",name:"mrp",rules:[{required:!0,message:"Enter buying price!"}],component:(0,D.jsx)(F.A,{min:0,step:.01,placeholder:"\u20b90.00",style:{width:"100%"}})},{label:"Selling Price",name:"sell_price",rules:[],component:(0,D.jsx)(F.A,{min:0,step:.01,placeholder:"\u20b90.00",style:{width:"100%"}})},{label:"Batch Number",name:"batch_no",rules:[],component:(0,D.jsx)(V.A,{placeholder:"Optional batch number"})},{label:"Manufacturing Date",name:"mfg_date",rules:[],component:(0,D.jsx)(R.A,{format:"YYYY-MM-DD",style:{width:"100%"}})},{label:"Expiry Date",name:"expiry_date",rules:[{required:!0,message:"Enter expiry date!"},e=>{let{getFieldValue:t}=e;return{validator(e,l){const n=t("mfg_date");return n&&l&&l.isBefore(n)?Promise.reject(new Error("Expiry must be after MFG date")):Promise.resolve()}}}],component:(0,D.jsx)(R.A,{format:"YYYY-MM-DD",style:{width:"100%"}})},{label:"Vendor",name:"vendor",rules:[{required:!0,message:"Select vendor!"}],component:(0,D.jsx)(P.A,{placeholder:"Select Vendor",showSearch:!0,allowClear:!0,loading:l.loading&&0===l.items.length,onSearch:l.setSearchString,onPopupScroll:l.handlePopupScroll,onDropdownVisibleChange:l.onDropdownVisibleChange,filterOption:!1,notFoundContent:l.loading?"Loading vendors...":0===l.items.length?"No vendors found. Add vendors first.":null,dropdownRender:e=>(0,D.jsxs)(D.Fragment,{children:[e,l.hasMore&&l.items.length>0&&(0,D.jsx)("div",{style:{textAlign:"center",padding:"8px",color:"#999"},children:l.loading?"Loading...":"Scroll for more"})]}),children:l.items.map((e=>(0,D.jsx)(P.A.Option,{value:e._id,children:"".concat(e.vendor_name," ").concat((null===e||void 0===e?void 0:e.company_name)||"")},e._id)))})},{label:"Buyed Date",name:"buyed_date",initialValue:m()(),rules:[{required:!0,message:"Select the buyed date"}],component:(0,D.jsx)(R.A,{format:"YYYY-MM-DD",style:{width:"100%"}})},{label:"Payment Status",name:"payment_status",rules:[{required:!0,message:"Select payment status!"}],component:(0,D.jsxs)(P.A,{placeholder:"Select payment status",children:[(0,D.jsx)(M,{value:"paid",children:"Paid"}),(0,D.jsx)(M,{value:"pending",children:"Pending"}),(0,D.jsx)(M,{value:"partial",children:"Partial"})]})},{label:"Warehouse / Location",name:"warehouse_location",rules:[],component:(0,D.jsx)(P.A,{placeholder:"Select warehouse",showSearch:!0,allowClear:!0,loading:n.loading&&0===n.items.length,onSearch:n.setSearchString,onPopupScroll:n.handlePopupScroll,onDropdownVisibleChange:n.onDropdownVisibleChange,filterOption:!1,notFoundContent:n.loading?"Loading warehouses...":0===n.items.length?"No warehouses found":null,dropdownRender:e=>(0,D.jsxs)(D.Fragment,{children:[e,n.hasMore&&n.items.length>0&&(0,D.jsx)("div",{style:{textAlign:"center",padding:"8px",color:"#999"},children:n.loading?"Loading...":"Scroll for more"})]}),children:n.items.map((e=>(0,D.jsx)(P.A.Option,{value:e._id,children:"".concat(e.warehouse_name," ").concat((null===e||void 0===e?void 0:e.warehouse_code)||"")},e._id)))})},{label:"Note",name:"note",rules:[],component:(0,D.jsx)(V.A.TextArea,{rows:2,placeholder:"Optional remarks"})},{label:"Total Cost",name:"total_cost",rules:[],component:(0,D.jsx)(F.A,{placeholder:"Auto-calculated",disabled:!0,style:{width:"100%"}})}]};var N=l(22671);const{Option:B}=P.A,Y=e=>{let{open:t,onClose:l,onSubmit:n,record:r,branchDropdown:i,createLoading:d=!1}=e;const[s]=o.A.useForm(),c=(e=>[{name:"branch_id",label:"Branch",rules:[{required:!0,message:"Please select a branch"}],component:(0,D.jsx)(P.A,{placeholder:"Select branch",loading:e.loading&&0===e.items.length,showSearch:!0,allowClear:!0,onSearch:e.setSearchString,onPopupScroll:e.handlePopupScroll,onDropdownVisibleChange:e.onDropdownVisibleChange,filterOption:!1,notFoundContent:e.loading?"Loading branches...":0===e.items.length?"No branches found":null,dropdownRender:t=>(0,D.jsxs)(D.Fragment,{children:[t,e.hasMore&&e.items.length>0&&(0,D.jsx)("div",{style:{textAlign:"center",padding:"8px",color:"#999"},children:e.loading?"Loading...":"Scroll for more"})]}),children:e.items.map((e=>(0,D.jsx)(B,{value:e._id,children:e.branch_name},e._id)))})},{name:"added_quantity",label:"Quantity",rules:[{required:!0,message:"Please enter quantity"}],component:(0,D.jsx)(F.A,{min:1,style:{width:"100%"}})},{label:"Note",name:"note",rules:[],component:(0,D.jsx)(V.A.TextArea,{rows:3,placeholder:"Optional notes"})}])(i);return(0,a.useEffect)((()=>{t&&s.resetFields()}),[t,s,r]),(0,D.jsx)(N.A,{title:"Allocate Stock",open:t,onClose:l,width:400,children:(0,D.jsxs)(o.A,{form:s,layout:"vertical",onFinish:n,initialValues:{},children:[c.map((e=>(0,D.jsx)(o.A.Item,{name:e.name,label:e.label,rules:e.rules,children:e.component},e.name))),(0,D.jsx)(o.A.Item,{children:(0,D.jsx)(u.Ay,{type:"primary",htmlType:"submit",block:!0,disabled:d,loading:d,children:"Allocate"})})]})})},{Option:L}=P.A;var E=l(98350);const Q=e=>{var t;let{open:l,onClose:n,onSubmit:r,record:i,branchDropdown:d,loading:s}=e;const[c]=o.A.useForm(),[h,m]=(0,a.useState)(void 0),p=o.A.useWatch("branch_id",c);(0,a.useEffect)((()=>{p&&m(p)}),[p]);const g=(0,a.useMemo)((()=>({branch_id:h,stock_audit_id:null===i||void 0===i?void 0:i._id})),[h,i]),{data:x}=E.lh.useGetBranchStockQuery(g,{skip:!l||!h||!(null!==i&&void 0!==i&&null!==(t=i.ProductItem)&&void 0!==t&&t._id),refetchOnMountOrArgChange:!0}),y=(0,a.useMemo)((()=>{var e;const t=(null===x||void 0===x?void 0:x.result)||[];if(!Array.isArray(t))return 0;const l=null===i||void 0===i||null===(e=i.ProductItem)||void 0===e?void 0:e._id,n=null===i||void 0===i?void 0:i.batch_no,a=h;return t.filter((e=>{var t,o;const r=!a||(null===e||void 0===e?void 0:e.branch_id)===a||(null===e||void 0===e||null===(t=e.Branch)||void 0===t?void 0:t._id)===a,i=!l||(null===e||void 0===e?void 0:e.product)===l||(null===e||void 0===e||null===(o=e.ProductItem)||void 0===o?void 0:o._id)===l,d=!n||(null===e||void 0===e?void 0:e.batch_no)===n;return r&&i&&d})).reduce(((e,t)=>e+(Number(null===t||void 0===t?void 0:t.available_quantity)||0)),0)}),[x,i,h]),v=((e,t,l)=>{var n,a,o;return[{name:"branch_id",label:"Branch",rules:[{required:!0,message:"Please select a branch"}],component:(0,D.jsx)(P.A,{placeholder:"Select branch",loading:e.loading&&0===e.items.length,showSearch:!0,allowClear:!0,onSearch:e.setSearchString,onPopupScroll:e.handlePopupScroll,onDropdownVisibleChange:e.onDropdownVisibleChange,filterOption:!1,onChange:l.onBranchChange,notFoundContent:e.loading?"Loading branches...":0===e.items.length?"No branches found":null,dropdownRender:t=>(0,D.jsxs)(D.Fragment,{children:[t,e.hasMore&&e.items.length>0&&(0,D.jsx)("div",{style:{textAlign:"center",padding:"8px",color:"#999"},children:e.loading?"Loading...":"Scroll for more"})]}),children:e.items.map((e=>(0,D.jsx)(L,{value:e._id,children:e.branch_name},e._id)))})},{name:"available_stock",label:"Available Stock",rules:[{required:!1,message:"Please enter available stock"}],component:(0,D.jsx)(F.A,{min:1,style:{width:"100%"},disabled:!0,value:null!==(n=null!==(a=l.availableQuantity)&&void 0!==a?a:null===t||void 0===t?void 0:t.available_quantity)&&void 0!==n?n:0})},{name:"quantity",label:"Quantity",rules:[{required:!0,message:"Please enter quantity"}],component:(0,D.jsx)(F.A,{min:1,max:null!==(o=l.maxQuantity)&&void 0!==o?o:l.availableQuantity,style:{width:"100%"}})}]})(d,i,{onBranchChange:e=>{m(e)},availableQuantity:y,maxQuantity:y});return(0,a.useEffect)((()=>{l&&(c.resetFields(),m(void 0))}),[l,c,i]),(0,D.jsx)(N.A,{title:"Revert Stock",open:l,onClose:n,width:400,children:(0,D.jsxs)(o.A,{form:c,layout:"vertical",onFinish:r,initialValues:{},children:[v.map((e=>"available_stock"===e.name?(0,D.jsx)(o.A.Item,{label:e.label,children:e.component},e.name):(0,D.jsx)(o.A.Item,{name:e.name,label:e.label,rules:e.rules,children:e.component},e.name))),(0,D.jsx)(o.A.Item,{children:(0,D.jsx)(u.Ay,{type:"primary",htmlType:"submit",block:!0,loading:s,disabled:s,children:"Revert"})})]})})},{Option:T}=P.A,G=e=>{let{open:t,onClose:l,onSubmit:n,record:r,loading:i=!1}=e;const[d]=o.A.useForm(),s=(e=>{var t,l,n;return[{name:"stock_audit_id",label:"Stock In Batch",rules:[{required:!0,message:"Please select the stock batch"}],initialValue:null===e||void 0===e?void 0:e._id,component:(0,D.jsx)(P.A,{disabled:!0,children:(0,D.jsxs)(T,{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e||null===(t=e.ProductItem)||void 0===t?void 0:t.name," - ",null===e||void 0===e||null===(l=e.ProductItem)||void 0===l||null===(n=l.VariantItem)||void 0===n?void 0:n.variant_name," - ",null===e||void 0===e?void 0:e.batch_no]})})},{name:"quantity",label:"Quantity",rules:[{required:!0,message:"Enter quantity to remove"}],component:(0,D.jsx)(F.A,{min:1,placeholder:"e.g., 5",style:{width:"100%"}})},{name:"out_reason",label:"Reason",rules:[{required:!0,message:"Please enter the reason"}],component:(0,D.jsxs)(P.A,{placeholder:"Reason for stock out",children:[(0,D.jsx)(P.A.Option,{value:"expired",children:"Expired"}),(0,D.jsx)(P.A.Option,{value:"damaged",children:"Damaged"}),(0,D.jsx)(P.A.Option,{value:"internal_use",children:"Internal Use"}),(0,D.jsx)(P.A.Option,{value:"bulk_sale",children:"Bulk Sale"}),(0,D.jsx)(P.A.Option,{value:"return_to_vendor",children:"Return to Vendor"})]})},{name:"out_date",label:"Out Date",rules:[{required:!0,message:"Please select the date"}],component:(0,D.jsx)(R.A,{placeholder:"Select Date",style:{width:"100%"}})},{name:"note",label:"Note",rules:[],component:(0,D.jsx)(V.A.TextArea,{rows:3,placeholder:"Optional note"})}]})(r);return(0,a.useEffect)((()=>{t&&d.resetFields()}),[t,d]),(0,D.jsx)(N.A,{title:"Stock Out",open:t,onClose:l,width:400,children:(0,D.jsxs)(o.A,{form:d,layout:"vertical",onFinish:n,children:[s.map((e=>(0,D.jsx)(o.A.Item,{name:e.name,label:e.label,rules:e.rules,initialValue:e.initialValue,children:e.component},e.name))),(0,D.jsx)(o.A.Item,{children:(0,D.jsx)(u.Ay,{type:"primary",htmlType:"submit",block:!0,loading:i,disabled:i,children:"Stockout"})})]})})};var z=l(16874),W=l(97679),H=l(83003),U=l(39387);const J=()=>{const e=(0,H.wA)(),[t]=o.A.useForm(),[l,d]=(0,a.useState)(!1),[s,c]=(0,a.useState)(null),[u,h]=(0,a.useState)(!1),[m,p]=(0,a.useState)(null),[g,x]=(0,a.useState)(!1),[y,v]=(0,a.useState)(null),[b,A]=(0,a.useState)(!1),[_,j]=(0,a.useState)(null),S=(0,U.x)({queryHook:E.lh.useGetProductQuery,limit:20}),k=(0,U.x)({queryHook:E.lh.useGetVendorQuery,limit:20}),w=(0,U.x)({queryHook:E.lh.useGetWarehouseQuery,limit:20}),f=(0,U.x)({queryHook:E.lh.useGetBranchesQuery,limit:20}),C=(0,U.x)({queryHook:E.lh.useGetRackQuery,limit:20}),[I,{isLoading:P}]=E.lh.useCreateBranchStockMutation(),[V,{isLoading:F}]=E.lh.useCreateStockOutMutation(),[R,{isLoading:M}]=E.lh.useCreateStockStorageMutation(),[N,{isLoading:B}]=(0,W.Rr)(),L=t.getFieldValue("quantity"),T=t.getFieldValue("buy_price");(0,a.useEffect)((()=>{L&&T&&t.setFieldsValue({total_cost:L*T})}),[L,T,t]);const J=(0,a.useCallback)((e=>{c(e),d(!0)}),[]),K=(0,a.useCallback)((async t=>{try{var l;await I((0,n.A)((0,n.A)({},t),{},{stock_audit_id:s._id,product:null===(l=s.ProductItem)||void 0===l?void 0:l._id,batch_no:s.batch_no,mfg_date:s.mfg_date,mrp:s.mrp,expiry_date:s.expiry_date,invoice_id:s.invoice_id,sell_price:s.sell_price})).unwrap(),r.Ay.success("Stock allocated successfully"),e(E.lh.util.invalidateTags(["StockAudit"])),d(!1),c(null)}catch(a){r.Ay.error("Failed to allocate stock")}}),[s,I]),X=(0,a.useCallback)((e=>{p(e),h(!0)}),[]),Z=(0,a.useCallback)((async t=>{try{await N((0,n.A)((0,n.A)({},t),{},{stock_audit_id:m._id})).unwrap(),r.Ay.success("Stock reverted successfully"),e(E.lh.util.invalidateTags(["StockAudit"])),h(!1),p(null)}catch(l){r.Ay.error("Failed to revert stock")}}),[m,N]),$=(0,a.useCallback)((e=>{v(e),x(!0)}),[]),ee=(0,a.useCallback)((async t=>{try{await V((0,n.A)((0,n.A)({},t),{},{stock_audit_id:y._id})).unwrap(),r.Ay.success("Stock out created successfully"),e(E.lh.util.invalidateTags(["StockAudit"])),x(!1),v(null)}catch(l){r.Ay.error("Failed to create stock out")}}),[y,V]),te=(0,a.useCallback)((e=>{j(e),A(!0)}),[]),le=(0,a.useCallback)((async t=>{try{const l=await R((0,n.A)((0,n.A)({},t),{},{stock_audit_id:null===_||void 0===_?void 0:_._id})).unwrap();if(l&&"object"===typeof l&&"statusCode"in l&&200!==l.statusCode)throw{data:l};r.Ay.success("Storage allocated successfully"),e(E.lh.util.invalidateTags(["StockAudit"])),A(!1),j(null)}catch(a){var l;const e=(null===a||void 0===a||null===(l=a.data)||void 0===l?void 0:l.message)||(null===a||void 0===a?void 0:a.error)||"Failed to allocate storage";r.Ay.error(e)}}),[_,R]),ne=(0,a.useMemo)((()=>({title:"Stock Audit",columns:q({onAllocate:J,onRevert:X,onStockout:$,onStorageAllocate:te}),formItems:O({productDropdown:S,vendorDropdown:k,warehouseDropdown:w}),entityName:"StockAudit",formColumns:3,drawerWidth:1200})),[J,X,$,te,S,k,w]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(i.r,{config:ne,onValuesChange:(e,t,l)=>{const n=Number((null===t||void 0===t?void 0:t.quantity)||0),a=Number((null===t||void 0===t?void 0:t.buy_price)||0),o={};Number.isNaN(n)||(o.available_quantity=n),Number.isNaN(n)&&Number.isNaN(a)||(o.total_cost=(n||0)*(a||0)),l&&Object.keys(o).length>0&&l.setFieldsValue(o)}}),(0,D.jsx)(Y,{open:l,onClose:()=>d(!1),onSubmit:K,record:s,branchDropdown:f,createLoading:P}),(0,D.jsx)(Q,{open:u,onClose:()=>h(!1),onSubmit:Z,record:m,branchDropdown:f,loading:B}),(0,D.jsx)(G,{open:g,onClose:()=>x(!1),onSubmit:ee,record:y,loading:F}),(0,D.jsx)(z.A,{open:b,onClose:()=>A(!1),onSubmit:le,record:_,rackDropdown:C,createLoading:M})]})}}}]);
//# sourceMappingURL=8819.259ad05c.chunk.js.map