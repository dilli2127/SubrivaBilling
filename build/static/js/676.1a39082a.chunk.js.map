{"version":3,"file":"static/js/676.1a39082a.chunk.js","mappings":"ybAsCA,MAAM,MAAEA,EAAK,KAAEC,GAASC,EAAAA,GAClB,OAAEC,GAAWC,EAAAA,EAyBbC,EAAyEC,IAIxE,IAJyE,QAC9EC,EAAO,SACPC,EAAQ,SACRC,GACDH,EACC,MAAM,aAAEI,IAAiBC,EAAAA,EAAAA,KACnBC,EAAcF,EAAa,aAEzBG,MAAOC,EAAcC,QAASC,IAAoBC,EAAAA,EAAAA,IACxDL,EAAYM,cAAc,YAEpBH,QAASI,IAAkBF,EAAAA,EAAAA,IACjCL,EAAYM,cAAc,WAItBE,GAAwB,OAAZN,QAAY,IAAZA,OAAY,EAAZA,EAAcD,SAAqB,OAAZC,QAAY,IAAZA,OAAY,EAAZA,EAAcO,SAAU,IAE1DC,EAAYC,IAAiBC,EAAAA,EAAAA,UAAS,KACtCC,EAAaC,IAAkBF,EAAAA,EAAAA,WAAS,IACxCG,EAAkBC,IAAuBJ,EAAAA,EAAAA,UAC9C,OAEKK,EAAkBC,IAAuBN,EAAAA,EAAAA,WAAkB,IAC3DO,EAAgBC,IAAqBR,EAAAA,EAAAA,WAAS,IAC9CS,EAAiBC,IAAsBV,EAAAA,EAAAA,UAA0B,CACtEW,UAAW,GACXC,MAAO,GACPC,OAAQ,GACRC,QAAS,GACTC,cAAe,aAGVC,GAAQC,EAAAA,EAAKC,UACdC,GAAiBC,EAAAA,EAAAA,QAAY,MAC7BC,GAAWD,EAAAA,EAAAA,QAAuB,MAClCE,GAAmBF,EAAAA,EAAAA,QAA8B,MACjDG,IAAgBH,EAAAA,EAAAA,QAAuB,MACvCI,IAAoBJ,EAAAA,EAAAA,QAAY,MAGhCK,IAAoBC,EAAAA,EAAAA,UAAQ,IAAM9B,GAAW,CAACA,IAG9C+B,IAAuBD,EAAAA,EAAAA,UAAQ,IAEjC5B,EAAW8B,SAAWpC,GAAgD,IAA7BiC,GAAkBI,QAE5D,CAAC/B,EAAYN,EAAiBiC,GAAkBI,SAG7CC,IAAuBC,EAAAA,EAAAA,cAAaC,IACC,CACvCC,IAAK,OACLC,UAAW,OACXC,QAAS,SAEKH,IAAS,UACxB,IAGGI,IAAqBL,EAAAA,EAAAA,cACxBM,IACC,GAAiC,IAA7BZ,GAAkBI,OAAc,OAEpC,IAAIS,EACJ,OAAQD,GACN,IAAK,KACHC,GACwB,IAAtBjC,EACIoB,GAAkBI,OAAS,EAC3BU,KAAKC,IAAInC,EAAmB,EAAG,GACrC,MACF,IAAK,OACHiC,GACwB,IAAtBjC,EACI,EACAkC,KAAKE,IAAIpC,EAAmB,EAAGoB,GAAkBI,OAAS,GAChE,MACF,IAAK,OACHS,EAAW,EACX,MACF,IAAK,MACHA,EAAWb,GAAkBI,OAAS,EACtC,MACF,QACE,OAGJvB,EAAoBgC,GACpBlC,EAAoBqB,GAAkBa,IAGtCI,YAAW,KACT,MAAMC,EAAaC,SAASC,cAAc,kBAADC,OACrBrB,GAAkBa,GAAUS,IAAG,OAEnD,GAAIJ,EAAY,CACd,MAAMK,EACU,SAAdX,EACI,QACc,QAAdA,EACE,MACA,UACRM,EAAWM,eAAe,CACxBC,SAAU,SACVC,MAAOH,GAEX,IACC,OAEL,CAACvB,GAAmBpB,IAIhB+C,IAAerB,EAAAA,EAAAA,cAClBsB,IACCtD,EAAcsD,GAEV/B,EAAiBgC,SACnBC,aAAajC,EAAiBgC,SAGhChC,EAAiBgC,QAAUZ,YAAW,KAChCW,EAAMzB,OACRxC,EAAY,SAAU,CAAEoE,aAAcH,EAAMzB,SAE5CxC,EAAY,YAEb,OAEL,CAACA,IAIGqE,IAAuB1B,EAAAA,EAAAA,cAC1B2B,IACCtD,EAAoBsD,GACpB1E,EAAS0E,GACThB,YAAW,IAAMzD,KAAY,OAE/B,CAACD,EAAUC,IAIP0E,IAA+B5B,EAAAA,EAAAA,cAAY6B,UAC/C,IAEE,IAAKnD,EAAgBE,UAAUiB,OAE7B,YADAiC,EAAAA,GAAQC,MAAM,yBAGhB,IAAKrD,EAAgBI,OAAOe,OAE1B,YADAiC,EAAAA,GAAQC,MAAM,mCAKV1E,EAAY,SAAUqB,EAG9B,CAAE,MAAOqD,GACPD,EAAAA,GAAQC,MAAM,6BAEdC,IACF,IACC,CAACtD,EAAiBrB,IAGf2E,IAAgBhC,EAAAA,EAAAA,cAAY,KAChCrB,EAAmB,CACjBC,UAAW,GACXC,MAAO,GACPC,OAAQ,GACRC,QAAS,GACTC,cAAe,YAEjBC,EAAKgD,gBACJ,CAAChD,IAGEiD,IAAwBlC,EAAAA,EAAAA,cAC5B,CAACmC,EAA8Bb,KAC7B3C,GAAmByD,IAAIC,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAClBD,GAAI,IACP,CAACD,GAAQb,QAGb,IAMIgB,IAAgBtC,EAAAA,EAAAA,cACnBuC,IACC,GAAc,WAAVA,EAAEC,IACJtF,SACK,GAAI,CAAC,YAAa,UAAW,OAAQ,OAAOuF,SAASF,EAAEC,KAAM,CAClED,EAAEG,iBACFH,EAAEI,kBASFtC,GAPqE,CACnEuC,UAAW,OACXC,QAAS,KACTC,KAAM,OACNC,IAAK,OAGyBR,EAAEC,KACpC,IAEF,CAACnC,GAAoBnD,IAIjB8F,IAAsBhD,EAAAA,EAAAA,cACzBuC,IACC,IAAKvF,EAAS,OAGd,MAAMiG,EAASV,EAAEU,OACjB,GACqB,UAAnBA,EAAOC,SACY,aAAnBD,EAAOC,UACPD,EAAOE,UAAUC,SAAS,yBAC1BH,EAAOI,QAAQ,wBAJjB,CASA,GAAId,EAAEe,SAAqB,MAAVf,EAAEC,IAOjB,OANAD,EAAEG,iBACFH,EAAEI,uBACEvD,EAAemC,UACjBnC,EAAemC,QAAQgC,QACvBnE,EAAemC,QAAQiC,WAM3B,GAAIjB,EAAEe,SAAqB,MAAVf,EAAEC,IAiBjB,OAhBAD,EAAEG,iBACFH,EAAEI,uBACE/C,KACFnB,GAAkB,GAClBkC,YAAW,KACT,GAAInB,GAAc+B,QAAS,CACzB,MAAMkC,EAAajE,GAAc+B,QAAQT,cACvC,SAEE2C,IACFA,EAAWF,QACXE,EAAWD,SAEf,IACC,OAMP,GAAI,CAAC,YAAa,UAAW,OAAQ,OAAOf,SAASF,EAAEC,KAAM,CAC3DD,EAAEG,iBACFH,EAAEI,kBASFtC,GAPqE,CACnEuC,UAAW,OACXC,QAAS,KACTC,KAAM,OACNC,IAAK,OAGyBR,EAAEC,KACpC,CA9CA,IAgDF,CAACxF,EAASqD,GAAoBT,KAI1B8D,IAAU/D,EAAAA,EAAAA,UACd,IAAM,CACJ,CACEgE,MAAO,GACPnB,IAAK,SACLoB,MAAO,GACPC,OAAQA,CAACC,EAAcC,KACrBC,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLC,OAAQ,UACRC,QAAS,OACTC,eAAgB,SAChBC,WAAY,UAEdC,QAASA,KACPjG,EAAoB0F,GACpB,MAAMQ,EAAQ7E,GAAkB8E,WAC7BC,GAAgBA,EAAEzD,MAAQ+C,EAAO/C,MAEpCzC,EAAoBgG,IAEpBG,UAEFV,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLL,MAAO,OACPe,OAAQ,OACRC,aAAc,MACdC,QACkB,OAAhBzG,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkB4C,OAAQ+C,EAAO/C,IAC7B,oBACA,oBACN8D,iBACkB,OAAhB1G,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkB4C,OAAQ+C,EAAO/C,IAAM,UAAY,QACrDmD,QAAS,OACTE,WAAY,SACZD,eAAgB,SAChBW,WAAY,iBACZL,UAEe,OAAhBtG,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkB4C,OAAQ+C,EAAO/C,MAChCgD,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLL,MAAO,MACPe,OAAQ,MACRC,aAAc,MACdE,gBAAiB,gBAQ/B,CACEnB,MAAO,gBACPqB,UAAW,YACXxC,IAAK,YACLqB,OAAQA,CAACC,EAAcC,KACrBkB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,GAAIR,SAAA,EAC5DV,EAAAA,EAAAA,KAACtH,EAAI,CAACyI,QAAM,EAAAT,SAAEZ,KACdE,EAAAA,EAAAA,KAACoB,EAAAA,EAAG,CAACC,MAAOtF,GAAqBgE,EAAO/E,eAAe0F,SACpDX,EAAO/E,cAAcsG,oBAK9B,CACE3B,MAAO,SACPqB,UAAW,SACXxC,IAAK,SACLqB,OAASC,IACPmB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,GAAIR,SAAA,EAC5DV,EAAAA,EAAAA,KAACuB,EAAAA,EAAa,CAACtB,MAAO,CAAEoB,MAAO,WAC/BrB,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAEZ,QAIb,CACEH,MAAO,QACPqB,UAAW,QACXxC,IAAK,QACLqB,OAASC,IACPmB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,GAAIR,SAAA,EAC5DV,EAAAA,EAAAA,KAACwB,EAAAA,EAAY,CAACvB,MAAO,CAAEoB,MAAO,WAC9BrB,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAEZ,GAAQ,UAIrB,CACEH,MAAO,UACPqB,UAAW,UACXxC,IAAK,UACLqB,OAASC,IACPmB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,aAAca,IAAK,GAAIR,SAAA,EAChEV,EAAAA,EAAAA,KAACyB,EAAAA,EAAY,CAACxB,MAAO,CAAEoB,MAAO,OAAQK,UAAW,UACjD1B,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAYgE,MAAO,CAAE0B,SAAU,QAASjB,SAChDZ,GAAQ,YAMnB,CAAC1F,EAAkBsB,GAAmBK,KAIlC6F,IAAc5F,EAAAA,EAAAA,cAClB,CAAC+D,EAAkBQ,KAAc,CAC/BD,QAASA,KACPjG,EAAoB0F,GACpBxF,EAAyB,OAALgG,QAAK,IAALA,EAAAA,EAAS,IAG/BN,MAAO,CACLC,OAAQ,UACRY,iBACkB,OAAhB1G,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkB4C,OAAQ+C,EAAO/C,IAAM,UAAY,QACrD6D,QACkB,OAAhBzG,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkB4C,OAAQ+C,EAAO/C,IAC7B,oBACA,oBACN4D,aAAc,MACdG,WAAY,iBAEdc,aAAetD,KACO,OAAhBnE,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkB4C,OAAQ+C,EAAO/C,MACnCuB,EAAEuD,cAAc7B,MAAMa,gBAAkB,YAG5CiB,aAAexD,KACO,OAAhBnE,QAAgB,IAAhBA,OAAgB,EAAhBA,EAAkB4C,OAAQ+C,EAAO/C,MACnCuB,EAAEuD,cAAc7B,MAAMa,gBAAkB,aAI9C,CAAC1G,KAIH4H,EAAAA,EAAAA,YAAU,KACJhJ,GACFK,EAAY,UACZgB,EAAoB,MACpBE,GAAqB,GACrBE,GAAkB,KAElBT,EAAc,IACdK,EAAoB,MACpBE,GAAqB,GACrBE,GAAkB,GAClBN,GAAe,GACf6D,KACIzC,EAAiBgC,UACnBC,aAAajC,EAAiBgC,SAC9BhC,EAAiBgC,QAAU,OAIxB,KACDhC,EAAiBgC,SACnBC,aAAajC,EAAiBgC,YAGjC,CAACvE,EAASK,EAAa2E,MAG1BgE,EAAAA,EAAAA,YAAU,MACJpG,IAAyBpB,GAAmBN,GAC9CO,GAAkB,KAEnB,CAACmB,GAAsBpB,EAAgBN,KAG1C8H,EAAAA,EAAAA,YAAU,KACR,GAAIhJ,GAAWoC,EAAemC,UAAYrD,IAAgBM,EAAgB,CACxE,MAAMyH,EAAcA,KACd7G,EAAemC,UACjBnC,EAAemC,QAAQgC,QACvBnE,EAAemC,QAAQiC,WAI3ByC,IACA,MAAMC,EAAQvF,WAAWsF,EAAa,KAEtC,MAAO,IAAMzE,aAAa0E,EAC5B,IACC,CAAClJ,EAASkB,EAAaM,KAG1BwH,EAAAA,EAAAA,YAAU,KACR,IAAK9H,GAAeM,IAAmBxB,EAAS,CAC9C,MAAMkJ,EAAQvF,YAAW,KACnBlB,GAAkB8B,UACpB9B,GAAkB8B,QAAQgC,QAC1B9D,GAAkB8B,QAAQiC,YAE3B,KACH,MAAO,IAAMhC,aAAa0E,EAC5B,IACC,CAAChI,EAAaM,EAAgBxB,KAKjCgJ,EAAAA,EAAAA,YAAU,KACR,GAAIhJ,EAEF,OADA6D,SAASsF,iBAAiB,UAAWnD,IAAqB,GACnD,IACLnC,SAASuF,oBAAoB,UAAWpD,IAAqB,KAEhE,CAAChG,EAASgG,MAGbqD,EAAAA,EAAAA,GAAqB,CACnBC,OAAQ,SACR3C,MAAO,WACP4C,WAAYlJ,EAAYM,cAAc,UACtC6I,UAAWnJ,IAIb,MAAQC,MAAOmJ,KAAiB/I,EAAAA,EAAAA,IAC9BL,EAAYM,cAAc,YAI5BqI,EAAAA,EAAAA,YAAU,KACJpI,EAEFkE,EAAAA,GAAQtE,QAAQ,CACdkJ,QAAS,uBACTlE,IAAK,oBACLmE,SAAU,IAIZ7E,EAAAA,GAAQ8E,QAAQ,uBAEjB,CAAChJ,KAEJoI,EAAAA,EAAAA,YAAU,KACR,GAAIS,GACF,GAAgC,MAA5BA,GAAaI,WAAoB,CAEnC,MAAMC,EAAcL,GAAaM,MAAQN,GAAa3I,OAElDgJ,IAMF9E,KACA7D,GAAe,GACfM,GAAkB,GAGlBpB,EAAY,UAGZsD,YAAW,KACT1D,EAAS6J,GACT5J,MACC,KAEP,MAAWuJ,GAAaI,YAA0C,MAA5BJ,GAAaI,aAEjD/E,EAAAA,GAAQC,MAAM0E,GAAa3E,SAAW,6BAEtCE,QAGH,CAACyE,GAAcxJ,EAAUC,EAAUG,EAAa2E,KAGnD,MAAMgF,IAAoBhH,EAAAA,EAAAA,cAAY,KACpC3B,EAAoB,MACpBE,GAAqB,KACpB,IACH,OACE0G,EAAAA,EAAAA,MAACgC,EAAAA,EAAK,CACJtD,MAAM,kBACNuD,KAAMlK,EACNE,SAAUA,EACViK,OAAQ,KACRvD,MAAO,IACPK,MAAO,CAAEmD,IAAK,IACdC,gBAAiBH,IACXA,GAAQ9H,EAAemC,UAAYrD,IAAgBM,GACrDmC,YAAW,KAAO,IAAD2G,EAAAC,EACO,QAAtBD,EAAAlI,EAAemC,eAAO,IAAA+F,GAAtBA,EAAwB/D,QACF,QAAtBgE,EAAAnI,EAAemC,eAAO,IAAAgG,GAAtBA,EAAwB/D,WACvB,MAELkB,SAAA,EAEFV,EAAAA,EAAAA,KAAA,OACEwD,IAAKlI,EACL2E,MAAO,CAAEwD,aAAc,IACvBC,UAAWpF,GACXqF,SAAU,EAAEjD,UAEZO,EAAAA,EAAAA,MAAC2C,EAAAA,EAAMC,QAAO,CAAC5D,MAAO,CAAEL,MAAO,QAASc,SAAA,EACtCV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAK,CACJN,IAAKpI,EACL2I,YAAY,gGACZzG,MAAOvD,EACPiK,SAAUzF,GAAKlB,GAAakB,EAAEU,OAAO3B,OACrC2G,QAAQjE,EAAAA,EAAAA,KAACkE,EAAAA,EAAc,IACvBjE,MAAO,CAAEkE,KAAM,GACfT,UAAWnF,IAEK,UAAVA,EAAEC,KAAmBpE,GACvBsD,GAAqBtD,IAGzBgK,QAASpB,GACTqB,WAAYnK,IAAgBM,EAC5B8J,OACGpK,GAAgBM,OAgBb+J,EAfA,KAEMvL,GAAWoC,EAAemC,SAC5BZ,YAAW,KAEP3D,GACAoC,EAAemC,UACdrD,IACAM,GAEDY,EAAemC,QAAQgC,UAExB,KAKbiF,OACEzK,GAAcN,GACZuG,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAE0B,SAAU,OAAQN,MAAO,QAASX,SAAC,iBAG/C,QAGRV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAM/B,EAAc,UAAY,UAChCwK,MAAM1E,EAAAA,EAAAA,KAAC2E,EAAAA,EAAe,IACtBrE,QAASA,KACP,MAAMsE,GAAY1K,EAClBC,EAAeyK,GACVA,GAEH5G,MAIJiC,MAAO,CAAE4E,SAAU,KAAMnE,SAExBxG,EAAc,SAAW,kBAM9BM,GAAkBN,KAClB+G,EAAAA,EAAAA,MAAA,OACEuC,IAAKhI,GACLyE,MAAO,CACLwD,aAAc,GACdqB,QAAS,GACTjE,OAAQ,oBACRD,aAAc,GACdE,gBACE,oDACFiE,WAAY,oDACZC,UACE,4EACFC,SAAU,WACVC,SAAU,UAEZvB,UAAW,EAAEjD,SAAA,EAGbV,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLgF,SAAU,WACV7B,KAAM,GACN+B,OAAQ,GACRvF,MAAO,IACPe,OAAQ,IACRC,aAAc,MACdmE,WAAY,oDACZK,QAAS,GACTC,OAAQ,MAGZrF,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLgF,SAAU,WACVK,QAAS,GACTC,MAAO,GACP3F,MAAO,GACPe,OAAQ,GACRC,aAAc,MACdmE,WAAY,oDACZK,QAAS,GACTC,OAAQ,MAIZpE,EAAAA,EAAAA,MAACuE,EAAAA,EAAG,CACFC,QAAQ,gBACRC,MAAM,SACNzF,MAAO,CAAEwD,aAAc,GAAIwB,SAAU,WAAYI,OAAQ,GAAI3E,SAAA,EAE7DO,EAAAA,EAAAA,MAAC0E,EAAAA,EAAG,CAAAjF,SAAA,EACFO,EAAAA,EAAAA,MAACxI,EAAK,CACJmN,MAAO,EACP3F,MAAO,CACL4F,OAAQ,EACRd,WACE,oDACFe,qBAAsB,OACtBC,oBAAqB,cACrBC,eAAgB,OAChBC,WAAY,IACZtE,SAAU,QACVjB,SAAA,EAEFV,EAAAA,EAAAA,KAACkG,EAAAA,EAAY,CAACjG,MAAO,CAAEkG,YAAa,EAAG9E,MAAO,aAAe,0BAG/DrB,EAAAA,EAAAA,KAACtH,EAAI,CACHuH,MAAO,CACL0B,SAAU,OACVN,MAAO,UACP4E,WAAY,IACZ9F,QAAS,QACTuB,UAAW,GACXhB,SACH,kEAIHV,EAAAA,EAAAA,KAAC2F,EAAAA,EAAG,CAAAjF,UACFO,EAAAA,EAAAA,MAAC2C,EAAAA,EAAK,CAACwC,KAAK,SAAQ1F,SAAA,EAClBV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACL2B,KAAK,SACL1B,MAAM1E,EAAAA,EAAAA,KAACqG,EAAAA,EAAa,IACpB/F,QAASA,KACP7F,GAAkB,GAClBN,GAAe,GACfd,EAAY,UACZ2E,MAEFiC,MAAO,CACLY,OAAQ,oBACRD,aAAc,EACdqF,WAAY,IACZ5E,MAAO,UACP0D,WAAY,QACZC,UAAW,gCACXrE,OAAQ,GACRmE,QAAS,UACTpE,SACH,YAGDV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,UACLmK,KAAK,SACL1B,MAAM1E,EAAAA,EAAAA,KAACsG,EAAAA,EAAY,IACnBhG,QAAS1C,GACTpE,QAASI,EACTqG,MAAO,CACL8E,WACE,oDACFlE,OAAQ,OACRD,aAAc,EACdqF,WAAY,IACZtF,OAAQ,GACRmE,QAAS,SACTE,UAAW,qCACXjE,WAAY,iBACZL,SACH,6BAOPO,EAAAA,EAAAA,MAAC/F,EAAAA,EAAI,CACHD,KAAMA,EACNsL,OAAO,WACPH,KAAK,SACLnG,MAAO,CAAEgF,SAAU,WAAYI,OAAQ,GAAI3E,SAAA,EAE3CO,EAAAA,EAAAA,MAAA,OACEhB,MAAO,CACLE,QAAS,OACTqG,oBAAqB,UACrBtF,IAAK,GACLuC,aAAc,IACd/C,SAAA,EAEFV,EAAAA,EAAAA,KAAC9E,EAAAA,EAAKuL,KAAI,CACRC,KAAK,YACLC,OACE1F,EAAAA,EAAAA,MAAA,QACEhB,MAAO,CACLgG,WAAY,IACZ5E,MAAO,UACPM,SAAU,OACVxB,QAAS,OACTE,WAAY,SACZa,IAAK,GACLR,SAAA,EAEFV,EAAAA,EAAAA,KAAC4G,EAAAA,EAAY,CAAC3G,MAAO,CAAEoB,MAAO,aAAe,eAIjDwF,MAAO,CAAC,CAAEC,UAAU,EAAMhJ,QAAS,2BAA4B4C,UAE/DV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAK,CACJN,IAAK/H,GACLiL,KAAK,YACL3C,YAAY,kBACZE,QAAQjE,EAAAA,EAAAA,KAAC4G,EAAAA,EAAY,CAAC3G,MAAO,CAAEoB,MAAO,aACtCgD,UAAWnK,GAAeM,EAC1B8C,MAAO5C,EAAgBE,UACvBoJ,SAAUzF,GACRL,GAAsB,YAAaK,EAAEU,OAAO3B,OAE9CoG,UAAWnF,IACK,UAAVA,EAAEC,MACJD,EAAEG,iBACFd,OAGJqC,MAAO,CACLW,aAAc,GACdC,OAAQ,oBACRiE,QAAS,YACTnD,SAAU,OACVZ,WAAY,gBACZiE,UAAW,gCACXD,WAAY,cAKlB/E,EAAAA,EAAAA,KAAC9E,EAAAA,EAAKuL,KAAI,CACRC,KAAK,SACLC,OACE1F,EAAAA,EAAAA,MAAA,QACEhB,MAAO,CACLgG,WAAY,IACZ5E,MAAO,UACPM,SAAU,OACVxB,QAAS,OACTE,WAAY,SACZa,IAAK,GACLR,SAAA,EAEFV,EAAAA,EAAAA,KAACuB,EAAAA,EAAa,CAACtB,MAAO,CAAEoB,MAAO,aAAe,mBAIlDwF,MAAO,CACL,CAAEC,UAAU,EAAMhJ,QAAS,8BAC3B,CACEiJ,QAAS,cACTjJ,QAAS,6BAEX4C,UAEFV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAK,CACJ4C,KAAK,SACL3C,YAAY,sBACZE,QAAQjE,EAAAA,EAAAA,KAACuB,EAAAA,EAAa,CAACtB,MAAO,CAAEoB,MAAO,aACvC/D,MAAO5C,EAAgBI,OACvBkJ,SAAUzF,GACRL,GAAsB,SAAUK,EAAEU,OAAO3B,OAE3CoG,UAAWnF,IACK,UAAVA,EAAEC,MACJD,EAAEG,iBACFd,OAGJqC,MAAO,CACLW,aAAc,GACdC,OAAQ,oBACRiE,QAAS,YACTnD,SAAU,OACVZ,WAAY,gBACZiE,UAAW,gCACXD,WAAY,cAKlB/E,EAAAA,EAAAA,KAAC9E,EAAAA,EAAKuL,KAAI,CACRC,KAAK,QACLC,OACE1F,EAAAA,EAAAA,MAAA,QACEhB,MAAO,CACLgG,WAAY,IACZ5E,MAAO,UACPM,SAAU,OACVxB,QAAS,OACTE,WAAY,SACZa,IAAK,GACLR,SAAA,EAEFV,EAAAA,EAAAA,KAACwB,EAAAA,EAAY,CAACvB,MAAO,CAAEoB,MAAO,aAAe,WAIjDwF,MAAO,CAAC,CAAE5K,KAAM,QAAS6B,QAAS,6BAA8B4C,UAEhEV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAK,CACJ4C,KAAK,QACL3C,YAAY,cACZE,QAAQjE,EAAAA,EAAAA,KAACwB,EAAAA,EAAY,CAACvB,MAAO,CAAEoB,MAAO,aACtC/D,MAAO5C,EAAgBG,MACvBmJ,SAAUzF,GAAKL,GAAsB,QAASK,EAAEU,OAAO3B,OACvDoG,UAAWnF,IACK,UAAVA,EAAEC,MACJD,EAAEG,iBACFd,OAGJqC,MAAO,CACLW,aAAc,GACdC,OAAQ,oBACRiE,QAAS,YACTnD,SAAU,OACVZ,WAAY,gBACZiE,UAAW,gCACXD,WAAY,iBAgEpB/E,EAAAA,EAAAA,KAAC9E,EAAAA,EAAKuL,KAAI,CACRC,KAAK,UACLC,OACE1F,EAAAA,EAAAA,MAAA,QACEhB,MAAO,CACLgG,WAAY,IACZ5E,MAAO,UACPM,SAAU,OACVxB,QAAS,OACTE,WAAY,SACZa,IAAK,GACLR,SAAA,EAEFV,EAAAA,EAAAA,KAACyB,EAAAA,EAAY,CAACxB,MAAO,CAAEoB,MAAO,aAAe,aAGhDX,UAEDV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAMkD,SAAQ,CACbN,KAAK,UACL3C,YAAY,gBACZkD,KAAM,EACN3J,MAAO5C,EAAgBK,QACvBiJ,SAAUzF,GAAKL,GAAsB,UAAWK,EAAEU,OAAO3B,OACzDoG,UAAWnF,IACK,UAAVA,EAAEC,MACJD,EAAEG,iBAEFd,OAGJqC,MAAO,CACLW,aAAc,GACdC,OAAQ,oBACRiE,QAAS,YACTnD,SAAU,OACVZ,WAAY,gBACZiE,UAAW,gCACXD,WAAY,QACZmC,OAAQ,mBAQpBlH,EAAAA,EAAAA,KAACmH,EAAAA,EAAO,CAAClH,MAAO,CAAE4F,OAAQ,aAE1B7F,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEmH,UAAW,IAAKlC,SAAU,QAASxE,SAC9CjH,GACCuG,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEoH,UAAW,SAAUvC,QAAS,IAAKpE,UAC/CV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAC,2BAEuB,IAA7BhF,GAAkBI,QACpBmF,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEoH,UAAW,SAAUvC,QAAS,IAAKpE,SAAA,EAC/CV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAWyE,SACnB3G,EACG,2CACA,4BAELA,IACCiG,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEyB,UAAW,IAAKhB,UAC5BV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAWyE,SAAC,0DAO7BV,EAAAA,EAAAA,KAACsH,EAAAA,EAAK,CACJ5H,QAASA,GACT6H,WAAY7L,GACZ8L,OAAO,MACPC,YAAY,EACZrB,KAAK,QACLsB,OAAQ,CAAEC,EAAG,KACbC,MAAOhG,WAUnB,EAD+BiG,EAAAA,KAAW/O,E,8PC/lC1C,MAAM,KAAEJ,GAASC,EAAAA,EA+fjB,EA7d4DI,IAgBrD,IAhBsD,QAC3D2G,EAAO,WACP6H,EAAU,OACVO,EAAM,MACNC,EAAK,SACLC,EAAQ,SACRC,GAAW,EAAI,YACfC,GAAc,EAAI,OAClBV,EAAS,MAAK,QACdhO,GAAU,EAAK,QACf2O,GAAU,EAAK,kBACfC,GAAoB,EAAI,KACxBhC,EAAO,SAAQ,UACfiC,EAAS,gBACTC,EAAe,oBACfC,GACDxP,EACC,MAAOgK,EAAMyF,IAAWvO,EAAAA,EAAAA,UAAgB,KACjCwO,EAAcC,IAAmBzO,EAAAA,EAAAA,UAAgB,KACjD0O,EAAaC,IAAkB3O,EAAAA,EAAAA,UAG5B,MACJ4O,GAAexN,EAAAA,EAAAA,SAAO,IAE5B2G,EAAAA,EAAAA,YAAU,KACRwG,EAAQjB,GAER,MAAMuB,EAAuBpJ,EAAQc,WACnCuI,GAAyB,eAAlBA,EAAI/H,YAKX6H,EAAatL,SACS,IAAtBgK,EAAWzL,QACXgN,GAAwB,GAExBF,EAAe,CAAEI,IAAK,EAAGD,IAAKD,IAC9BD,EAAatL,SAAU,GAEvBmL,EAAgBnB,EAAWzL,OAAO,EAAE,CAACmN,OAAO1B,EAAWzL,OAAO,IAAI,MAEnE,CAACyL,EAAY7H,KAGhBsC,EAAAA,EAAAA,YAAU,KACJuG,GACFK,EAAeL,KAEhB,CAACA,IAEJ,MAAMW,EAAeA,KACd,OAALnB,QAAK,IAALA,GAAAA,IAEA,MAAMoB,EAAmBzJ,EAAQc,WAAUuI,IAAwB,IAAjBA,EAAIK,WAClDD,GAAoB,GACtBP,EAAe,CAAEI,IAAKjG,EAAKjH,OAAQiN,IAAKI,KAoBtCE,EAAWA,CAACL,EAAaD,EAAazL,KAC1C,MAAMgM,EAAS5J,EAAQqJ,GAGvB,GAAIO,EAAOxC,YAAcxJ,GAAmB,KAAVA,GAEhC,OADAQ,EAAAA,GAAQC,MAAM,GAADhB,OAAIuM,EAAO3J,MAAK,kBACtB,EAIT,GAAI2J,EAAOC,WAAY,CACrB,MAAMxL,EAAQuL,EAAOC,WAAWjM,GAChC,GAAIS,EAEF,OADAD,EAAAA,GAAQC,MAAMA,IACP,CAEX,CAEA,MAAMyL,EAAU,IAAIzG,GAIpB,OAHAyG,EAAQR,GAAKtJ,EAAQqJ,GAAK/H,WAAa1D,EACvCkL,EAAQgB,GACR1B,EAAO0B,IACA,IAGTxH,EAAAA,EAAAA,YAAU,KACR,MAAM1D,EAAiBC,IACjBA,EAAEe,SAAqB,MAAVf,EAAEC,MACjBD,EAAEG,iBACFoJ,EAAO/E,IAELxE,EAAEkL,UAAoC,MAAxBlL,EAAEC,IAAIkL,eAAyBzB,IAC/C1J,EAAEG,iBACFwK,MAGJ,GAAId,EAEF,OADAvL,SAASsF,iBAAiB,UAAW7D,GAC9B,IAAMzB,SAASuF,oBAAoB,UAAW9D,KAEtD,CAACyE,EAAMkF,EAAUH,EAAQM,EAAmBc,IAE/C,MAAMS,EAAgD,CACpD3F,SAAUA,CAAC4F,EAA8BnB,KACvCC,EAAgB,IAAIkB,MAKxB,SAASC,EAAmBC,EAAkBxN,EAAmBoD,GAC/D,IAAIqJ,EAAMe,EAAWxN,EACrB,KAAOyM,GAAO,GAAKA,EAAMrJ,EAAQ5D,QAAQ,CACvC,IAA8B,IAA1B4D,EAAQqJ,GAAKK,SAAoB,OAAOL,EAC5CA,GAAOzM,CACT,CACA,OAAQ,CACV,CAEA,MAAMyN,EAAeC,IAQd,IAADC,EAAAC,EAAA,IARgB,IACpBlB,EAAG,IACHD,EAAG,MACHzL,GAKD0M,EACC,MAAOG,EAAWC,IAAgBnQ,EAAAA,EAAAA,UAASqD,GACrC+M,GAAWhP,EAAAA,EAAAA,QAAY,MACvBiO,EAAS5J,EAAQqJ,IAChBuB,EAAuBC,IAA4BtQ,EAAAA,EAAAA,WAAS,IAC5DuQ,EAAqBC,IAA0BxQ,EAAAA,EAAAA,WAAS,IAE/D+H,EAAAA,EAAAA,YAAU,KACRoI,EAAa9M,GAEbX,YAAW,KAAO,IAAD+N,EACC,QAAhBA,EAAAL,EAAS9M,eAAO,IAAAmN,GAAhBA,EAAkBnL,UACjB,MACF,CAACjC,IAEJ,MAAMqN,EAAgBC,IACpBR,EAAaQ,GACbvB,EAASL,EAAKD,EAAK6B,IAGftM,EAAiBC,IACrB,GAAoB,YAAhB+K,EAAOrN,MAAgC,UAAVsC,EAAEC,IAGjC,OAFAD,EAAEI,uBACF4L,GAAyB,GAG3B,GAAoB,UAAhBjB,EAAOrN,MAA8B,UAAVsC,EAAEC,IAG/B,OAFAD,EAAEI,uBACF8L,GAAuB,GAGzB,GAAc,QAAVlM,EAAEC,IAAe,CAGnB,GAFAD,EAAEG,iBAEE4K,EAAOxC,YAAcqD,GAA2B,KAAdA,GAEpC,YADArM,EAAAA,GAAQC,MAAM,GAADhB,OAAIuM,EAAO3J,MAAK,iBAG/B,MAAMkL,EAAUtM,EAAEkL,SAAWV,EAAM,EAAIA,EAAM,EACvC+B,EAAU9B,GAAO6B,GAAWnL,EAAQ5D,OAAS,EAAI,GACjDiP,GAAYF,EAAUnL,EAAQ5D,QAAU4D,EAAQ5D,OAClDgP,EAAU/H,EAAKjH,OACjB8M,EAAe,CAAEI,IAAK8B,EAAS/B,IAAKgC,IAC3B9C,IACTiB,IACAN,EAAe,CAAEI,IAAKjG,EAAKjH,OAAQiN,IAAKgC,IAE5C,KAAqB,WAAVxM,EAAEC,KACXoK,EAAe,OAIboC,EAAuBC,IACvB3C,GACFA,EAAgB2C,EAASjC,GAE3BuB,GAAyB,GACzB3B,EAAe,OAGXsC,EAAqBC,IAEzB,MAAM3B,EAAU,IAAIzG,GACpByG,EAAQR,GAAKoC,SAAWD,EAAME,IAAMF,EAAMnO,KAAO,GACjDwM,EAAQR,GAAKsC,SAAWH,EAAMG,UAAY,GAC1C9C,EAAQgB,GACR1B,EAAO0B,GACPiB,GAAuB,GACvB7B,EAAe,OAGjB,OAAQU,EAAOrN,MACb,IAAK,UACH,OACEgF,EAAAA,EAAAA,MAAAsK,EAAAA,SAAA,CAAA7K,SAAA,EACEV,EAAAA,EAAAA,KAAA,OAAKM,QAAS/B,GAAKA,EAAEI,kBAAkB+B,UACrCV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAK,CACJN,IAAK6G,EACL/M,MAAO6M,EACPzG,UAAWpF,EACXyF,YAAY,oCAGfuG,IACCtK,EAAAA,EAAAA,KAACwL,EAAAA,EAAqB,CACpBxS,QAASsR,EACTrR,SAAU+R,EACV9R,SAAUA,IAAMqR,GAAyB,QAKnD,IAAK,QACH,OACEtJ,EAAAA,EAAAA,MAAAsK,EAAAA,SAAA,CAAA7K,SAAA,EACEV,EAAAA,EAAAA,KAAA,OAAKM,QAAS/B,GAAKA,EAAEI,kBAAkB+B,UACrCV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAK,CACJN,IAAK6G,EACL/M,OAAgB,QAAT2M,EAAAlH,EAAKiG,UAAI,IAAAiB,OAAA,EAATA,EAAWqB,WAAYnB,EAC9BzG,UAAWpF,EACXyF,YAAY,8BACZ0H,UAAQ,MAGXjB,IACCxK,EAAAA,EAAAA,KAAC0L,EAAAA,EAAmB,CAClB1S,QAASwR,EACTvR,SAAUiS,EACVhS,SAAUA,IAAMuR,GAAuB,GACvCkB,WAAoB,QAATzB,EAAAnH,EAAKiG,UAAI,IAAAkB,OAAA,EAATA,EAAW0B,aAAc,QAK9C,IAAK,SACH,OACE5L,EAAAA,EAAAA,KAAA,OAAKM,QAAS/B,GAAKA,EAAEI,kBAAkB+B,UACrCV,EAAAA,EAAAA,KAAC6L,EAAAA,EAAW,CACVrI,IAAK6G,EACL/M,MAAO6M,EACPnG,SAAU2G,EACVrG,OAAQA,IAAMsE,EAAe,MAC7BkD,UAAU,EACVpI,UAAWnF,IAET,GAAc,QAAVA,EAAEC,KAA2B,UAAVD,EAAEC,IAAiB,CAGxC,GAFAD,EAAEG,iBAEE4K,EAAOxC,YAAcqD,GAA2B,KAAdA,GAEpC,YADArM,EAAAA,GAAQC,MAAM,GAADhB,OAAIuM,EAAO3J,MAAK,iBAG/B,MAAMrD,EAAYiC,EAAEkL,UAAY,EAAI,EAC9BoB,EAAUhB,EAAmBd,EAAKzM,EAAWoD,GACnD,IAAiB,IAAbmL,EACFjC,EAAe,CAAEI,MAAKD,IAAK8B,QACtB,CAEL,MAAMC,EAAUxO,EAAY,EAAI0M,EAAM,EAAIA,EAAM,EAChD,GAAI8B,GAAW,GAAKA,EAAU/H,EAAKjH,OAAQ,CACzC,MAAMqN,EAAmBU,GAAoB,EAAG,EAAGnK,IACzB,IAAtByJ,GACFP,EAAe,CAAEI,IAAK8B,EAAS/B,IAAKI,GAExC,MAAO,GAAI7M,EAAY,GAAK2L,EAAU,CAEpCiB,IACA,MAAMC,EAAmBU,GAAoB,EAAG,EAAGnK,IACzB,IAAtByJ,GACFP,EAAe,CAAEI,IAAKjG,EAAKjH,OAAQiN,IAAKI,GAE5C,MAEEP,EAAe,KAEnB,CACF,KAAqB,WAAVrK,EAAEC,KACXoK,EAAe,OAGnB3I,MAAO,CAAEL,MAAO,YAIxB,IAAK,SACH,OACEI,EAAAA,EAAAA,KAAA,OAAKM,QAAS/B,GAAKA,EAAEI,kBAAkB+B,UACrCV,EAAAA,EAAAA,KAACnH,EAAAA,EAAM,CACL2K,IAAK6G,EACL/M,MAAO6M,EACP4B,QAASzC,EAAOyC,QAChB/H,SAAU4G,IAER,GADgBvB,EAASL,EAAKD,EAAK6B,GACtB,CAEX,MAAMC,EAAU9B,EAAM,EAChB+B,EAAU9B,GAAO6B,GAAWnL,EAAQ5D,OAAS,EAAI,GACjDiP,GAAYF,EAAUnL,EAAQ5D,QAAU4D,EAAQ5D,OAElDgP,EAAU/H,EAAKjH,OACjB8M,EAAe,CAAEI,IAAK8B,EAAS/B,IAAKgC,IAC3B9C,IACTiB,IACAN,EAAe,CAAEI,IAAKjG,EAAKjH,OAAQiN,IAAKgC,IAE5C,MAEEpO,YAAW,KAAO,IAADqP,EACC,QAAhBA,EAAA3B,EAAS9M,eAAO,IAAAyO,GAAhBA,EAAkBzM,UACjB,KAGPU,MAAO,CAAEL,MAAO,QAChB8D,UAAWnF,IACK,UAAVA,EAAEC,KAA6B,QAAVD,EAAEC,KACzBD,EAAEG,sBAOd,IAAK,OACH,OACEsB,EAAAA,EAAAA,KAAA,OAAKM,QAAS/B,GAAKA,EAAEI,kBAAkB+B,UACrCV,EAAAA,EAAAA,KAACiM,EAAAA,EAAU,CACTzI,IAAK6G,EACL/M,MAAO6M,EAAY+B,IAAM/B,GAAa,KACtCnG,SAAUmI,IACRxB,EAAawB,EAAOA,EAAKC,OAAO,cAAgB,MAChDxD,EAAe,OAEjBtE,OAAQA,IAAMsE,EAAe,MAC7BlF,UAAWpF,EACX2B,MAAO,CAAEL,MAAO,YAIxB,QACE,OACEI,EAAAA,EAAAA,KAAA,OAAKM,QAAS/B,GAAKA,EAAEI,kBAAkB+B,UACrCV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAK,CACJN,IAAK6G,EACL/M,MAAO6M,EACPnG,SAAUzF,GAAKoM,EAAapM,EAAEU,OAAO3B,OACrCgH,OAAQA,IAAMsE,EAAe,MAC7BlF,UAAWpF,QAOjB+N,EAAgB3M,EAAQ4M,KAAI,CAACvD,EAAKgC,KAAQ1M,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAC3C0K,GAAG,IACNwD,OAAQA,CAACC,EAAcC,KAAiB,CACtCnM,QAASA,KACiB,kBAAbmM,GACT7D,EAAe,CAAEI,IAAKyD,EAAU1D,IAAKgC,KAGzC2B,cAAgBnO,IACdA,EAAEG,iBACsB,kBAAb+N,GACT7D,EAAe,CAAEI,IAAKyD,EAAU1D,IAAKgC,OAI3ClL,OAAQA,CAAC+K,EAAU7K,EAAa0M,KAC9B,GACE9D,GACAA,EAAYK,MAAQyD,GACpB9D,EAAYI,MAAQgC,EAEpB,OACE/K,EAAAA,EAAAA,KAAC+J,EAAY,CAEXf,IAAKyD,EACL1D,IAAKgC,EACLzN,MAAOyC,EAAOgJ,EAAI/H,YAAW,GAAAjE,OAHrB0P,EAAQ,KAAA1P,OAAIgO,IAQ1B,GAA0B,oBAAfhC,EAAIlJ,OACb,OAAOkJ,EAAIlJ,OAAO+K,EAAK7K,EAAQ0M,GAGjC,GAAsB,aAAlB1D,EAAI/H,UACN,OAAOjB,EAAOuL,UAAYvL,EAAOgJ,EAAI/H,WAGvC,GAAsB,eAAlB+H,EAAI/H,UACN,OAAOjB,EAAO4M,cAAgB5M,EAAOgJ,EAAI/H,WAE3C,GAAiB,WAAb+H,EAAI9M,MAAqB8M,EAAIgD,QAAS,CACxC,MAAMa,EAAS7D,EAAIgD,QAAQc,MACzBC,GAAOA,EAAIxP,QAAUyC,EAAOgJ,EAAI/H,aAElC,OAAO4L,EAASA,EAAOjG,MAAQ5G,EAAOgJ,EAAI/H,UAC5C,CACA,OAAOjB,EAAOgJ,EAAI/H,gBAItB,OACEC,EAAAA,EAAAA,MAAA,OACEoH,UAAS,uBAAAtL,OAAyBoL,EAAU,UAAY,GAAE,KAAApL,OACxDsL,GAAa,IACZ3H,SAAA,EAEHO,EAAAA,EAAAA,MAAA,OAAKoH,UAAU,gBAAe3H,SAAA,EAC5BO,EAAAA,EAAAA,MAAC2C,EAAAA,EAAK,CAAAlD,SAAA,CACHuH,IACCjI,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,UACLyI,MAAM1E,EAAAA,EAAAA,KAACkG,EAAAA,EAAY,IACnB5F,QAAS4I,EAAaxI,SACvB,sBAIFwH,IACClI,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CAACsI,QAAM,EAACrI,MAAM1E,EAAAA,EAAAA,KAACgN,EAAAA,EAAc,IAAK1M,QAjY3B2M,KACF,IAAhBlK,EAAKjH,OAITmH,EAAAA,EAAMiK,QAAQ,CACZvN,MAAO,2DACPwN,KAAMA,KACJ,MAAM3D,EAAUzG,EAAKqK,MAAM,GAAI,GAC/B5E,EAAQgB,GACR1B,EAAO0B,GACC,OAARxB,QAAQ,IAARA,GAAAA,EAAWS,MATb3K,EAAAA,GAAQuP,QAAQ,sBA+XwD3M,SAAC,gBAIrEV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,UACLyI,MAAM1E,EAAAA,EAAAA,KAACsG,EAAAA,EAAY,IACnBhG,QAASA,IAAMwH,EAAO/E,GAAMrC,SAC7B,sBAIHV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAYoM,UAAU,aAAY3H,SAAC,8CAIhDV,EAAAA,EAAAA,KAACsH,EAAAA,EAAK,CACJgG,UAAQ,EACR/F,WAAYxE,EACZrD,QAAS2M,EACT7E,OAAQA,EACRhO,QAASA,EACTiO,YAAY,EACZrB,KAAMA,EACNsB,OAAQ,CAAEC,EAAG,KACbgC,cAAYtL,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAMsL,GAAY,IAAC1N,KAAK,WAAW2N,gBAAgBnB,S,+LCjgBvE,MAAM,OAAE8E,GAAWzJ,EAAAA,EAugBnB,EAtf0D/K,IAKnD,IAADyU,EAAA,IALqD,QACzDxU,EAAO,SACPC,EAAQ,SACRC,EAAQ,UACRyS,GACD5S,EACC,MAAM,aAAEI,IAAiBC,EAAAA,EAAAA,KACnBqU,EAAWtU,EAAa,eACtBG,MAAOoU,EAAM,QAAElU,IAAYE,EAAAA,EAAAA,IACjC+T,EAAS9T,cAAc,YAGlBI,EAAYC,IAAiBC,EAAAA,EAAAA,UAAS,KACtC0T,EAAgBC,IAAqB3T,EAAAA,EAAAA,UAA2B,OAChE4T,EAAkBC,IAAuB7T,EAAAA,EAAAA,UAAiB,IAC1D8T,EAAcC,IAAmB/T,EAAAA,EAAAA,UAAiB,IACnDgU,GAAe5S,EAAAA,EAAAA,QAAuB,MACtCD,GAAiBC,EAAAA,EAAAA,QAAiB,MAGlC6S,EAAkB/C,MACZA,EAAMgD,cAAejC,IAAMf,EAAMgD,aAAaC,SAASlC,QAI7DmC,EAAqBlD,GAClBA,EAAMmD,oBAAsB,EAI/BC,EAAyBpD,IAC7B,MAAMqD,EAAatC,IAAMf,EAAMgD,aAAa/B,OAAO,cAC7CqC,EAAQ,qDAAA1R,OAAwDyR,EAAU,uCAChFR,EAAgBS,GAChB3Q,EAAAA,GAAQC,MAAM0Q,GAGd9R,YAAW,KACTqR,EAAgB,MACf,MAICU,EAAuBvD,IAC3B,MAAMsD,EAAQ,2HACdT,EAAgBS,GAChB3Q,EAAAA,GAAQC,MAAM0Q,GAGd9R,YAAW,KACTqR,EAAgB,MACf,MAkBCW,GAdE,OAANjB,QAAM,IAANA,GAAc,QAARF,EAANE,EAAQ5T,cAAM,IAAA0T,OAAR,EAANA,EAAgBoB,QAAQC,IAAc,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACnC,MAAMC,EAAcvV,EAAW2P,cAC/B,OACY,QAAVoF,EAAAD,EAAEvD,gBAAQ,IAAAwD,OAAA,EAAVA,EAAYpF,cAAcjL,SAAS6Q,MACtB,QADkCP,EAC/CF,EAAEU,mBAAW,IAAAR,GAAM,QAANC,EAAbD,EAAerI,YAAI,IAAAsI,OAAN,EAAbA,EAAqBtF,cAAcjL,SAAS6Q,MAC/B,QAD2CL,EACxDJ,EAAEU,mBAAW,IAAAN,GAAa,QAAbC,EAAbD,EAAeO,mBAAW,IAAAN,GAAc,QAAdC,EAA1BD,EAA4BO,oBAAY,IAAAN,OAA3B,EAAbA,EACIzF,cACDjL,SAAS6Q,MACQ,QADIF,EACxBP,EAAEP,0BAAkB,IAAAc,OAAA,EAApBA,EAAsBM,WAAWjR,SAAS6Q,MAC9B,QAD0CD,EACtDR,EAAEc,kBAAU,IAAAN,OAAA,EAAZA,EAAcK,WAAWjR,SAAS6Q,SAEhC,IAKRtN,EAAAA,EAAAA,YAAU,KAGR,GAFA8L,EAAoB,GACpBE,EAAgB,IACZW,EAAU7S,OAAS,EAAG,CAExB,IAAI8T,EAAkB,EACtB,KACEA,EAAkBjB,EAAU7S,SAC1B6S,EAAUiB,GAAiBzB,aAC3BjC,IAAMyC,EAAUiB,GAAiBzB,aAAaC,SAASlC,QACvDyC,EAAUiB,GAAiBtB,oBAAsB,IAEnDsB,IAEEA,EAAkBjB,EAAU7S,QAC9B8R,EAAkBe,EAAUiB,GAAiB5S,KAC7C8Q,EAAoB8B,IAEpBhC,EAAkB,KAEtB,MACEA,EAAkB,QAEnB,CAAC7T,EAAYf,EAAS0U,KAEzB1L,EAAAA,EAAAA,YAAU,KACJhJ,IACFgV,EAAgB,IAChBrR,YAAW,KAAO,IAAD2G,EACO,QAAtBA,EAAAlI,EAAemC,eAAO,IAAA+F,GAAtBA,EAAwB/D,UACvB,MAEJ,CAACvG,KAEJgJ,EAAAA,EAAAA,YAAU,KACR,GAAIiM,EAAa1Q,QAAS,CAAC,IAADsS,EACxB,MAAM7G,EAAMiF,EAAa1Q,QAAQT,cAAc,gCAADC,OACe,QADf8S,EACZlB,EAAUd,UAAiB,IAAAgC,OAAA,EAA3BA,EAA6B7S,IAAG,OAE/D,OAAHgM,QAAG,IAAHA,GAAAA,EAAK9L,eAAe,CAAEE,MAAO,WAC/B,IACC,CAACyQ,EAAkBc,KAEtB3M,EAAAA,EAAAA,YAAU,KACJhJ,GAAW2S,GACb8B,EAAS,SAAU,CAAExC,QAASU,MAE/B,CAAC3S,EAAS2S,EAAW8B,IAExB,MAAM/N,EAA+B,CACnC,CACEC,MAAO,UACPqB,UAAW,cACXxC,IAAK,UACLqB,OAAS0P,IAAgC,OAAXA,QAAW,IAAXA,OAAW,EAAXA,EAAa7I,OAAQ,OAErD,CACE/G,MAAO,UACPqB,UAAW,cACXxC,IAAK,UACLqB,OAAS0P,IAAgB,IAAAO,EAAA,OACZ,OAAXP,QAAW,IAAXA,GAAwB,QAAbO,EAAXP,EAAaC,mBAAW,IAAAM,OAAb,EAAXA,EAA0BL,eAAgB,QAE9C,CAAE9P,MAAO,WAAYqB,UAAW,WAAYxC,IAAK,YACjD,CACEmB,MAAO,YACPqB,UAAW,qBACXxC,IAAK,qBACLqB,OAAQA,CAACyO,EAA4BvO,KACnC,MAAMgQ,EAAezB,GAAsB,EAC3C,OACErN,EAAAA,EAAAA,MAAA,QACEhB,MAAO,CACLoB,MAAO0O,EAAe,UAAY,UAClC9J,WAAY8J,EAAe,OAAS,UACpCrP,SAAA,CAED4N,EACAyB,IACC/P,EAAAA,EAAAA,KAACgQ,EAAAA,EAAyB,CACxB/P,MAAO,CAAEgQ,WAAY,EAAG5O,MAAO,kBAO3C,CAAE1B,MAAO,QAASqB,UAAW,aAAcxC,IAAK,cAChD,CACEmB,MAAO,cACPqB,UAAW,cACXxC,IAAK,cACLqB,OAAQA,CAACsO,EAAqBpO,KAC5B,IAAKoO,EACH,OAAOnO,EAAAA,EAAAA,KAAA,QAAMC,MAAO,CAAEoB,MAAO,QAASX,SAAC,cAEzC,MAAM8N,EAAatC,IAAMiC,GACnB+B,EAAQhE,MACRiE,EAAY3B,EAAWJ,SAAS8B,GAChCE,EAAkB5B,EAAW6B,KAAKH,EAAO,QAE/C,IAAI7O,EAAQ,QACRqD,GAAO1E,EAAAA,EAAAA,KAACsQ,EAAAA,EAAmB,IAC3BC,EAAS,QAYb,OAVIJ,GACF9O,EAAQ,MACRqD,GAAO1E,EAAAA,EAAAA,KAACgQ,EAAAA,EAAyB,IACjCO,EAAS,WACAH,GAAmB,KAC5B/O,EAAQ,SACRqD,GAAO1E,EAAAA,EAAAA,KAACgQ,EAAAA,EAAyB,IACjCO,EAAM,cAAAxT,OAAiBqT,EAAe,WAItCpQ,EAAAA,EAAAA,KAACwQ,EAAAA,EAAO,CAAC7Q,MAAO4Q,EAAO7P,UACrBV,EAAAA,EAAAA,KAACoB,EAAAA,EAAG,CAACC,MAAOA,EAAOqD,KAAMA,EAAKhE,SAC3B8N,EAAWpC,OAAO,qBAQzBqE,EAAmBtF,IAAkB,IAADuF,EAEpCxC,EAAe/C,GACjBoD,EAAsBpD,GAKpBkD,EAAkBlD,GACpBuD,KAKFV,EAAgB,IAEhB/U,EAAS,CACPoS,GAAIF,EAAMnO,IACVA,IAAKmO,EAAMnO,IACXsO,SAAUH,EAAMG,SAChB5E,MAAuB,QAAjBgK,EAAAvF,EAAMoE,mBAAW,IAAAmB,OAAA,EAAjBA,EAAmBhK,OAAQyE,EAAMzE,MAAQ,GAC/CiK,KAAMxF,EAAMwF,KACZrC,mBAAoBnD,EAAMmD,mBAC1BqB,WAAYxE,EAAMwE,eAgItB,OACE3P,EAAAA,EAAAA,KAACiD,EAAAA,EAAK,CACJtD,MAAM,sCACNuD,KAAMlK,EACNE,SAAUA,EACV0G,MAAO,IACPuD,OAAQ,KACRyN,gBAAc,EAAAlQ,UAEdO,EAAAA,EAAAA,MAAA,OAAKX,QAbgBuQ,KAAO,IAADC,EACP,QAAtBA,EAAA1V,EAAemC,eAAO,IAAAuT,GAAtBA,EAAwBvR,SAYSmB,SAAA,EAC7BV,EAAAA,EAAAA,KAACuN,EAAM,CACL/J,IAAKpI,EACL2I,YAAY,uEACZC,SAAUzF,GAAKvE,EAAcuE,EAAEU,OAAO3B,OACtC2C,MAAO,CAAEwD,aAAc,IACvBY,WAAS,EACTX,UA5IqBnF,IAGC,IAADgF,EAF3B,GAAKoL,EAAU7S,OAEf,GAAc,cAAVyC,EAAEC,IACJD,EAAEG,iBACFoP,GAAoB1P,IAClB,IAAI2S,EAAO3S,EAAO,EAElB,KACE2S,EAAOpC,EAAU7S,SACf6S,EAAUoC,GAAM5C,aAChBjC,IAAMyC,EAAUoC,GAAM5C,aAAaC,SAASlC,QAC5CyC,EAAUoC,GAAMzC,oBAAsB,IAExCyC,IAEF,MAAMC,EAAYxU,KAAKE,IAAIqU,EAAMpC,EAAU7S,OAAS,GAEpD,OADA8R,EAAkBe,EAAUqC,GAAWhU,KAChCgU,KAGa,QAAtBzN,EAAAnI,EAAemC,eAAO,IAAAgG,GAAtBA,EAAwBhE,aACnB,GAAc,YAAVhB,EAAEC,IAAmB,CAAC,IAADyS,EAC9B1S,EAAEG,iBACFoP,GAAoB1P,IAClB,IAAI8S,EAAY9S,EAAO,EAEvB,KACE8S,GAAa,IACXvC,EAAUuC,GAAW/C,aACrBjC,IAAMyC,EAAUuC,GAAW/C,aAAaC,SAASlC,QACjDyC,EAAUuC,GAAW5C,oBAAsB,IAE7C4C,IAEF,MAAMC,EAAY3U,KAAKC,IAAIyU,EAAW,GAEtC,OADAtD,EAAkBe,EAAUwC,GAAWnU,KAChCmU,KAGa,QAAtBF,EAAA7V,EAAemC,eAAO,IAAA0T,GAAtBA,EAAwB1R,OAC1B,MAAO,GAAc,UAAVhB,EAAEC,IAAiB,CAC5BD,EAAEG,iBACF,MAAM0S,EAAgBzC,EAAUd,GAC5BuD,IACFX,EAAgBW,GAGblD,EAAekD,IACf/C,EAAkB+C,IAEnBlY,IAGN,GAuFMoL,OAAQA,KAEN3H,YAAW,KACK,IAAD0U,EAATrY,IACoB,QAAtBqY,EAAAjW,EAAemC,eAAO,IAAA8T,GAAtBA,EAAwB9R,WAEzB,OAKNwO,IACC9M,EAAAA,EAAAA,MAAA,OACEhB,MAAO,CACLwD,aAAc,GACdqB,QAAS,YACThE,gBAAiB,UACjBD,OAAQ,oBACRD,aAAc,MACdS,MAAO,UACPM,SAAU,OACVxB,QAAS,OACTE,WAAY,SACZa,IAAK,OACLR,SAAA,EAEFV,EAAAA,EAAAA,KAACgQ,EAAAA,EAAyB,CAAC/P,MAAO,CAAEoB,MAAO,aAC1C0M,MAIL9M,EAAAA,EAAAA,MAAA,OACEyC,UApHoBnF,IAGE,IAAD+S,EAF3B,GAAK3C,EAAU7S,OAEf,GAAc,cAAVyC,EAAEC,IACJD,EAAEG,iBACFoP,GAAoByD,IAClB,IAAIR,EAAOQ,EAAI,EAEf,KACER,EAAOpC,EAAU7S,SACf6S,EAAUoC,GAAM5C,aAChBjC,IAAMyC,EAAUoC,GAAM5C,aAAaC,SAASlC,QAC5CyC,EAAUoC,GAAMzC,oBAAsB,IAExCyC,IAEF,MAAMC,EAAYxU,KAAKE,IAAIqU,EAAMpC,EAAU7S,OAAS,GAEpD,OADA8R,EAAkBe,EAAUqC,GAAWhU,KAChCgU,KAGa,QAAtBM,EAAAlW,EAAemC,eAAO,IAAA+T,GAAtBA,EAAwB/R,aACnB,GAAc,YAAVhB,EAAEC,IACXD,EAAEG,iBACFoP,GAAoByD,IAClB,IAAInT,EAAOmT,EAAI,EAEf,KACEnT,GAAQ,IACNuQ,EAAUvQ,GAAM+P,aAChBjC,IAAMyC,EAAUvQ,GAAM+P,aAAaC,SAASlC,QAC5CyC,EAAUvQ,GAAMkQ,oBAAsB,IAExClQ,IAEF,MAAM+S,EAAY3U,KAAKC,IAAI2B,EAAM,GAEjC,OADAwP,EAAkBe,EAAUwC,GAAWnU,KAChCmU,UAGJ,GAAc,UAAV5S,EAAEC,IAAiB,CAC5BD,EAAEG,iBACF,MAAM0S,EAAgBzC,EAAUd,GAC5BuD,IACFX,EAAgBW,GAGblD,EAAekD,IACf/C,EAAkB+C,IAEnBlY,IAGN,MAAO,GAAc,WAAVqF,EAAEC,IAAkB,CAAC,IAADgT,EAC7BjT,EAAEG,iBACoB,QAAtB8S,EAAApW,EAAemC,eAAO,IAAAiU,GAAtBA,EAAwBjS,OAC1B,MAAO,GAAc,QAAVhB,EAAEC,KAAiBD,EAAEkL,SAAU,CAAC,IAADgI,EACxClT,EAAEG,iBACoB,QAAtB+S,EAAArW,EAAemC,eAAO,IAAAkU,GAAtBA,EAAwBlS,OAC1B,GA0DMoE,SAAU,EACVH,IAAKyK,EACLhO,MAAO,CAAEyR,QAAS,QAAShR,SAAA,EAE3BV,EAAAA,EAAAA,KAACsH,EAAAA,EAAK,CACJC,WAAYoH,EACZjP,QAASA,EACTlG,QAASA,EACTgO,OAAO,MACPpB,KAAK,QACLqB,YAAY,EACZ9H,MAAOA,KACLsB,EAAAA,EAAAA,MAAA,OACEhB,MAAO,CACLE,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZyE,QAAS,SACTpE,SAAA,EAEFV,EAAAA,EAAAA,KAAA,QAAAU,SAAM,iBACNO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAE0B,SAAU,OAAQN,MAAO,QAASX,SAAA,EAC9CV,EAAAA,EAAAA,KAAA,QAAMC,MAAO,CAAEoB,MAAO,WAAYX,SAAC,wBACnCV,EAAAA,EAAAA,KAAA,QAAMC,MAAO,CAAE4F,OAAQ,QAASxE,MAAO,WAAYX,SAAC,8BAGpDV,EAAAA,EAAAA,KAAA,QAAMC,MAAO,CAAEoB,MAAO,WAAYX,SAAC,uDAMzCkH,MAAOA,CAAC7H,EAAQ4R,KACd,MAAMxB,EAAYjC,EAAenO,GAC3BgQ,EAAe1B,EAAkBtO,GACvC,MAAO,CACLO,QAASA,KACF6P,GAAcJ,EAMRI,EACT5B,EAAsBxO,GACbgQ,GACTrB,KARA+B,EAAgB1Q,GAEhBpD,YAAW,KAAO,IAADiV,EACO,QAAtBA,EAAAxW,EAAemC,eAAO,IAAAqU,GAAtBA,EAAwBrS,UACvB,MAOPsS,cAAeA,KACR1B,GAAcJ,EAERI,EACT5B,EAAsBxO,GACbgQ,GACTrB,IAJA+B,EAAgB1Q,IAOpBsI,UACEsJ,IAAQ9D,EACJ,uCACA,gBACN,eAAgB9N,EAAO/C,IACvBiD,MAAO,CACLmF,QAAS+K,GAAaJ,EAAe,GAAM,EAC3C7P,OAAQiQ,GAAaJ,EAAe,cAAgB,UACpDjP,gBACEqP,GAAaJ,EAAe,eAAYxL,KAIhDoF,aAAc,CACZ1N,KAAM,QACN2N,gBAAiB+D,EAAiB,CAACA,GAAkB,GACrD3J,SAAW8N,IACTlE,EAAkBkE,EAAK,IACvB,MAAMH,EAAMhD,EAAUnO,WAAUqO,GAAKA,EAAE7R,MAAQ8U,EAAK,MACvC,IAATH,GAAY7D,EAAoB6D,IAEtCI,iBAAmBhS,IAAa,CAC9BiS,SAAU9D,EAAenO,IAAWsO,EAAkBtO,SAI5DkB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEyB,UAAW,GAAIC,SAAU,OAAQN,MAAO,QAASX,SAAA,EAC7DV,EAAAA,EAAAA,KAAA,UAAAU,SAAQ,wBAA4B,gEAEpCV,EAAAA,EAAAA,KAAA,UACAA,EAAAA,EAAAA,KAAA,UAAAU,SAAQ,SAAa,4DAErBV,EAAAA,EAAAA,KAAA,UACAA,EAAAA,EAAAA,KAAA,UAAAU,SAAQ,UAAc,wKAGtBV,EAAAA,EAAAA,KAAA,UACAA,EAAAA,EAAAA,KAAA,UAAAU,SAAQ,oBAAwB,mH,0KClgB5C,MAAM,OAAE6M,GAAWzJ,EAAAA,EAySnB,EAtR8D/K,IAIvD,IAADkZ,EAAA,IAJyD,QAC7DjZ,EAAO,SACPC,EAAQ,SACRC,GACDH,EACC,MAAM,aAAEI,IAAiBC,EAAAA,EAAAA,KACnB8Y,EAAc/Y,EAAa,YACzBG,MAAO6Y,EAAQ,QAAE3Y,IAAYE,EAAAA,EAAAA,IACnCwY,EAAYvY,cAAc,YAGrBI,EAAYC,IAAiBC,EAAAA,EAAAA,UAAS,KACtC0T,EAAgBC,IAAqB3T,EAAAA,EAAAA,UAA2B,OAChE4T,EAAkBC,IAAuB7T,EAAAA,EAAAA,UAAiB,IAC1DmY,EAAgBC,IAAqBpY,EAAAA,EAAAA,WAAS,GAC/CmB,GAAiBC,EAAAA,EAAAA,QAAiB,MAElCiX,GACI,OAARH,QAAQ,IAARA,GAAgB,QAARF,EAARE,EAAUrY,cAAM,IAAAmY,OAAR,EAARA,EAAkBrD,QAAQ2D,IAAgB,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACvC,MAAMxD,EAAcvV,EAAW2P,cAC/B,QACS,QAAN8I,EAAAD,EAAE7L,YAAI,IAAA8L,OAAA,EAANA,EAAQ9I,gBAAiB,IAAIjL,SAAS6Q,MACjC,QAALmD,EAAAF,EAAEQ,WAAG,IAAAN,OAAA,EAALA,EAAO/I,gBAAiB,IAAIjL,SAAS6Q,KACzB,QADqCoD,EAClDH,EAAE/C,mBAAW,IAAAkD,GAAc,QAAdC,EAAbD,EAAejD,oBAAY,IAAAkD,OAAd,EAAbA,EAA6BjJ,cAAcjL,SAAS6Q,MACvC,QADmDsD,EAChEL,EAAE/C,mBAAW,IAAAoD,GAAc,QAAdC,EAAbD,EAAeI,oBAAY,IAAAH,OAAd,EAAbA,EAA6BnJ,cAAcjL,SAAS6Q,OACpC,QAAfwD,EAAAP,EAAEU,qBAAa,IAAAH,OAAA,EAAfA,EAAiBpD,aAAc,IAAIjR,SAAS6Q,MAE9C4D,MAAK,CAACC,EAAYC,KAAgB,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAElC,MAAM9E,EAAcvV,EAAW2P,cAGzB2K,IAAqB,QAANhB,EAAAF,EAAEzM,YAAI,IAAA2M,OAAA,EAANA,EAAQ3J,gBAAiB,MAAQ4F,IACrB,QAAbgE,EAAAH,EAAE3D,mBAAW,IAAA8D,GAAc,QAAdC,EAAbD,EAAe7D,oBAAY,IAAA8D,OAAd,EAAbA,EAA6B7J,iBAAkB4F,KACzC,QAALkE,EAAAL,EAAEJ,WAAG,IAAAS,OAAA,EAALA,EAAO9J,gBAAiB,MAAQ4F,EAC/CgF,IAAqB,QAANb,EAAAL,EAAE1M,YAAI,IAAA+M,OAAA,EAANA,EAAQ/J,gBAAiB,MAAQ4F,IACrB,QAAboE,EAAAN,EAAE5D,mBAAW,IAAAkE,GAAc,QAAdC,EAAbD,EAAejE,oBAAY,IAAAkE,OAAd,EAAbA,EAA6BjK,iBAAkB4F,KACzC,QAALsE,EAAAR,EAAEL,WAAG,IAAAa,OAAA,EAALA,EAAOlK,gBAAiB,MAAQ4F,EAErD,GAAI+E,IAAgBC,EAAa,OAAQ,EACzC,IAAKD,GAAeC,EAAa,OAAO,EAGxC,MAAMC,IAAqB,QAANV,EAAAV,EAAEzM,YAAI,IAAAmN,OAAA,EAANA,EAAQnK,gBAAiB,IAAI8K,WAAWlF,KAC5B,QADwCwE,EACrDX,EAAE3D,mBAAW,IAAAsE,GAAc,QAAdC,EAAbD,EAAerE,oBAAY,IAAAsE,OAAd,EAAbA,EAA6BrK,cAAc8K,WAAWlF,OAChD,QAAL0E,EAAAb,EAAEJ,WAAG,IAAAiB,OAAA,EAALA,EAAOtK,gBAAiB,IAAI8K,WAAWlF,GACtDmF,IAAqB,QAANR,EAAAb,EAAE1M,YAAI,IAAAuN,OAAA,EAANA,EAAQvK,gBAAiB,IAAI8K,WAAWlF,KAC5B,QADwC4E,EACrDd,EAAE5D,mBAAW,IAAA0E,GAAc,QAAdC,EAAbD,EAAezE,oBAAY,IAAA0E,OAAd,EAAbA,EAA6BzK,cAAc8K,WAAWlF,OAChD,QAAL8E,EAAAhB,EAAEL,WAAG,IAAAqB,OAAA,EAALA,EAAO1K,gBAAiB,IAAI8K,WAAWlF,GAE5D,OAAIiF,IAAgBE,GAAqB,GACpCF,GAAeE,EAAoB,EAEjC,OACH,IAERzS,EAAAA,EAAAA,YAAU,KACR8L,EAAoB,GAChBwE,EAAiBxW,OAAS,EACpB8R,EAAkB0E,EAAiB,GAAGtV,KAE9C4Q,EAAkB,QAEnB,CAAC7T,EAAYf,EAASmZ,KAEzBnQ,EAAAA,EAAAA,YAAU,KACJhJ,GACF2D,YAAW,KAAO,IAAD2G,EACO,QAAtBA,EAAAlI,EAAemC,eAAO,IAAA+F,GAAtBA,EAAwB/D,UACvB,OAEJ,CAACvG,IAEJ,MAAM0G,EAAiC,CACrC,CACEC,MAAO,oBACPqB,UAAW,OACXxC,IAAK,OACLoB,MAAO,IACPC,OAAQA,CAAC6G,EAAM3G,KAAM,IAAA2U,EAAAC,EAAA,OACnB1T,EAAAA,EAAAA,MAAA,OAAAP,SAAA,EACEV,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEgG,WAAY,IAAK5E,MAAO,WAAYX,SAAEgG,KACjC,QAAlBgO,EAAA3U,EAAOyP,mBAAW,IAAAkF,OAAA,EAAlBA,EAAoBjF,gBACnBxO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAE0B,SAAU,OAAQN,MAAO,UAAWK,UAAW,OAAQhB,SAAA,CAAC,YAC1DX,EAAOyP,YAAYC,cACV,QAAlBkF,EAAA5U,EAAOyP,mBAAW,IAAAmF,OAAA,EAAlBA,EAAoB3B,gBACnB/R,EAAAA,EAAAA,MAAA,QAAMhB,MAAO,CAAEgQ,WAAY,MAAO5O,MAAO,UAAWM,SAAU,QAASjB,SAAA,CAAC,IACpEX,EAAOyP,YAAYwD,aAAa,eAQhD,CAAErT,MAAO,UAAWqB,UAAW,cAAexC,IAAK,UAAWoB,MAAO,IACnEC,OAAS+U,GAAmB,OAAPA,QAAO,IAAPA,GAAAA,EAASnF,cAC5BzP,EAAAA,EAAAA,KAAA,QAAMC,MAAO,CAAEoB,MAAO,UAAW4E,WAAY,KAAMvF,SAAEkU,EAAQnF,gBAE7DzP,EAAAA,EAAAA,KAAA,QAAMC,MAAO,CAAEoB,MAAO,UAAWwT,UAAW,UAAWnU,SAAC,gBAE5D,CAAEf,MAAO,MAAOqB,UAAW,MAAOxC,IAAK,MAAOoB,MAAO,KACrD,CAAED,MAAO,QAASqB,UAAW,gBAAiBxC,IAAK,gBAAiBoB,MAAO,IACzEC,OAASiV,IACP7T,EAAAA,EAAAA,MAAA,QAAMhB,MAAO,CACXoB,MAAO,UACP4E,WAAY,IACZtE,SAAU,QACVjB,SAAA,CAAC,UACM,OAALoU,QAAK,IAALA,OAAK,EAALA,EAAOC,QAAQ,KAAM,YAKzBtE,EAAmBxF,IACvBhS,EAASgS,IAmEX,OACEhK,EAAAA,EAAAA,MAACgC,EAAAA,EAAK,CACJtD,MAAM,kDACNuD,KAAMlK,EACNE,SAAUA,EACV0G,MAAO,IACPuD,OAAQ,KACRyN,gBAAc,EAAAlQ,SAAA,EAEdO,EAAAA,EAAAA,MAAA,OAAKX,QAbgBuQ,KAAO,IAADS,EACP,QAAtBA,EAAAlW,EAAemC,eAAO,IAAA+T,GAAtBA,EAAwB/R,SAYSmB,SAAA,EAC7BO,EAAAA,EAAAA,MAAC2C,EAAAA,EAAMC,QAAO,CAAC5D,MAAO,CAAEwD,aAAc,GAAI7D,MAAO,QAASc,SAAA,EACxDV,EAAAA,EAAAA,KAACuN,EAAM,CACL/J,IAAKpI,EACL2I,YAAY,wGACZC,SAAUzF,GAAKvE,EAAcuE,EAAEU,OAAO3B,OACtC2C,MAAO,CAAEkE,KAAM,GACfE,WAAS,EACTX,UAvDmBnF,IAGC,IAADgF,EAF3B,GAAK+O,EAAiBxW,OAEtB,GAAc,cAAVyC,EAAEC,IACJD,EAAEG,iBACFoP,GAAoB1P,IAClB,MAAM2S,EAAOvU,KAAKE,IAAI0B,EAAO,EAAGkU,EAAiBxW,OAAS,GAE1D,OADA8R,EAAkB0E,EAAiBvB,GAAM/T,KAClC+T,KAGa,QAAtBxN,EAAAnI,EAAemC,eAAO,IAAAgG,GAAtBA,EAAwBhE,aACnB,GAAc,YAAVhB,EAAEC,IAAmB,CAAC,IAADyS,EAC9B1S,EAAEG,iBACFoP,GAAoB1P,IAClB,MAAM8S,EAAY1U,KAAKC,IAAI2B,EAAO,EAAG,GAErC,OADAwP,EAAkB0E,EAAiBpB,GAAWlU,KACvCkU,KAGa,QAAtBD,EAAA7V,EAAemC,eAAO,IAAA0T,GAAtBA,EAAwB1R,OAC1B,MAAO,GAAc,UAAVhB,EAAEC,IAAiB,CAC5BD,EAAEG,iBACF,MAAMsW,EAAkB1C,EAAiBzE,GACrCmH,GACFvE,EAAgBuE,EAEpB,KAAqB,WAAVzW,EAAEC,MACXD,EAAEG,iBACFxF,MA2BMoL,OAAQA,KAEN3H,YAAW,KACK,IAAD6U,EAATxY,IACoB,QAAtBwY,EAAApW,EAAemC,eAAO,IAAAiU,GAAtBA,EAAwBjS,WAEzB,KAELjC,MAAOvD,KAETiG,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,UACLyI,MAAM1E,EAAAA,EAAAA,KAACiV,EAAAA,EAAY,IACnB3U,QAASA,IAAM+R,GAAkB,GACjCpS,MAAO,CAAE4E,SAAU,KAAMnE,SAC1B,aAIHV,EAAAA,EAAAA,KAACsH,EAAAA,EAAK,CACJC,WAAY+K,EACZ5S,QAASA,EACTlG,QAASA,EACTgO,OAAO,MACPpB,KAAK,QACLqB,YAAY,EACZG,MAAOA,CAAC7H,EAAQ4R,KAAG,CACjBrR,QAASA,KACPmQ,EAAgB1Q,GAEhBpD,YAAW,KAAO,IAAD8U,EACO,QAAtBA,EAAArW,EAAemC,eAAO,IAAAkU,GAAtBA,EAAwBlS,UACvB,KAELsS,cAAeA,IAAMpB,EAAgB1Q,GACrCsI,UACEsJ,IAAQ9D,EACJ,uCACA,gBACN5N,MAAO,CACLa,gBAAiB6Q,IAAQ9D,EAAmB,eAAYtJ,EACxD1D,OAAQ8Q,IAAQ9D,EAAmB,yBAAsBtJ,KAG7DoF,aAAc,CACZ1N,KAAM,QACN2N,gBAAiB+D,EAAiB,CAACA,GAAkB,GACrD3J,SAAU8N,IACRlE,EAAkBkE,EAAK,IACvB,MAAMH,EAAMW,EAAiB9R,WAAU+R,GAAKA,EAAEvV,MAAQ8U,EAAK,MAC9C,IAATH,GAAY7D,EAAoB6D,KAGxCjK,OAAQ,CAAEC,EAAG,QAET1G,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEyB,UAAW,GAAIC,SAAU,OAAQN,MAAO,QAASX,SAAA,EACrEV,EAAAA,EAAAA,KAAA,UAAAU,SAAQ,wBAA4B,kEACpCV,EAAAA,EAAAA,KAAA,UACAA,EAAAA,EAAAA,KAAA,UAAAU,SAAQ,YAAgB,8CACxBV,EAAAA,EAAAA,KAAA,UACAA,EAAAA,EAAAA,KAAA,UAAAU,SAAQ,qBAAyB,mDACjCV,EAAAA,EAAAA,KAAA,UACAA,EAAAA,EAAAA,KAAA,UAAAU,SAAQ,SAAa,oEAKvBV,EAAAA,EAAAA,KAACkV,EAAAA,EAAc,CACblc,QAASoZ,EACT+C,QAASA,IAAM9C,GAAkB,GACjC+C,OAvJqBC,IAAqB,IAADC,EAC7Ctb,EAAcqb,GACdhD,GAAkB,GAGlB,MAAMkD,EAAuB,OAARpD,QAAQ,IAARA,GAAgB,QAARmD,EAARnD,EAAUrY,cAAM,IAAAwb,OAAR,EAARA,EAAkBzI,MAAM0F,IAAgB,IAADiD,EAAAC,EAAAC,EAAAC,EAC1D,MAAMrG,EAAc+F,EAAQ3L,cAC5B,QACQ,QAAL8L,EAAAjD,EAAEQ,WAAG,IAAAyC,OAAA,EAALA,EAAO9L,gBAAiB,IAAIjL,SAAS6Q,MAC/B,QAANmG,EAAAlD,EAAE7L,YAAI,IAAA+O,OAAA,EAANA,EAAQ/L,gBAAiB,IAAIjL,SAAS6Q,KAC1B,QADsCoG,EACnDnD,EAAE/C,mBAAW,IAAAkG,GAAc,QAAdC,EAAbD,EAAe1C,oBAAY,IAAA2C,OAAd,EAAbA,EAA6BjM,cAAcjL,SAAS6Q,OAIpDiG,GAEF5Y,YAAW,KACT1D,EAASsc,KACR,KACHzX,EAAAA,GAAQ8X,QAAQ,kBAAD7Y,OAAmBwY,EAAa7O,QAE/C5I,EAAAA,GAAQuP,QAAQ,kCAADtQ,OAAmCsY,KAmIhD1V,MAAM,uBACNkW,YAAY,kD,kDCnSb,SAASC,EAAmB/c,GAY/B,IAZgC,MAClCO,EAAK,YACLyc,EAAW,cACXC,EAAa,SACbC,EAAQ,aACRC,GAODnd,EAEC,MAAMod,EAAe7c,EAAMgT,KAAK8J,IAAU,IAADC,EAAAC,EACvC,MAAMrL,EAAqB,OAAX8K,QAAW,IAAXA,OAAW,EAAXA,EAAalJ,MAAM0F,GAAWA,EAAEvV,MAAQoZ,EAAKxK,aAE7D,IAAI2K,EAAgBH,EAAKI,iBAAyB,OAAPvL,QAAO,IAAPA,GAAqB,QAAdoL,EAAPpL,EAASwL,oBAAY,IAAAJ,OAAd,EAAPA,EAAuBG,iBAAkB,GAG/ED,GAAmC,IAAlBA,IAEpBA,EAAgB,IAKlB,MAAMG,EACJC,OAAOP,EAAKQ,KAAO,GAAKD,OAAOP,EAAKtB,OAAS,GAC7C6B,OAAOP,EAAKS,WAAa,IACtBF,OAAOP,EAAKtB,OAAS,KAAa,OAAP7J,QAAO,IAAPA,GAAoB,QAAbqL,EAAPrL,EAASuE,mBAAW,IAAA8G,OAAb,EAAPA,EAAsBQ,YAAa,IAAM,GAGzE,IAAIC,EAASL,EAIb,OAHKV,GAAiBO,EAAgB,IACpCQ,EAASL,EAAcA,EAAaH,EAAgB,MAEtDlY,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACK+X,GAAI,IACPI,eAAgBD,EAChBG,aACAK,cAKEC,EAAYb,EAAac,QAC7B,CAACC,EAAKd,IAASc,EAAMP,OAAOP,EAAKW,SACjC,GAIII,EAAiBhB,EAAac,QAClC,CAACC,EAAKd,IAASc,EAAMP,OAAOP,EAAKM,aACjC,GAIF,IAAIU,EAAgB,EAChBnB,EAAW,IAEXmB,EADmB,eAAjBlB,EACciB,GAAkBlB,EAAW,KAE7BA,GAOpB,IAAIoB,EAAY,EACZC,EAAiB,EACjBC,EAAe,EAEnBpB,EAAaqB,SAAQpB,IACnB,IAAIqB,EAAiBrB,EAAKM,WACtBT,EAAW,IAEXwB,EADmB,eAAjBvB,EACeE,EAAKM,WAAcN,EAAKM,YAAcT,EAAW,KAEjDG,EAAKM,WAAeT,EAASkB,EAAgBf,EAAKM,YAIvE,IAAIgB,EAAY,EACX1B,EAcCI,EAAKI,eAAiB,GACxBkB,EAAYD,GAAkBrB,EAAKI,gBAAkB,IAAMJ,EAAKI,iBAChEc,GAAkBG,EAAiBC,EACnCL,GAAaK,EACbH,GAAgBE,IAGhBH,GAAkBG,EAClBF,GAAgBE,GApBdrB,EAAKI,eAAiB,GACxBkB,EAAYD,GAAkBrB,EAAKI,eAAiB,KACpDc,GAAkBG,EAClBJ,GAAaK,EACbH,GAAgBE,EAAiBC,IAGjCJ,GAAkBG,EAClBF,GAAgBE,MAqBtB,MAAO,CACLT,YACAM,iBACAD,YACAM,KAPWN,EAAY,EAQvBO,KAPWP,EAAY,EAQvBE,eACAH,gBAEJ,C,yICjIA,MAAM,MAAE3e,EAAK,KAAEC,GAASC,EAAAA,EA6OxB,EAhN0DI,IAInD,IAAD8e,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,IAJqD,QACzDnf,EAAO,SACPE,EAAQ,UACRyS,GACD5S,EACC,MAAM,aAAEI,IAAiBC,EAAAA,EAAAA,KACnB8Y,EAAc/Y,EAAa,YAEzBG,MAAO6Y,EAAQ,QAAE3Y,IAAYE,EAAAA,EAAAA,IACnCwY,EAAYvY,cAAc,YAGrBye,EAAgBC,IAAqBpe,EAAAA,EAAAA,UAAgC,OAE5E+H,EAAAA,EAAAA,YAAU,KACR,GAAIhJ,GAAW2S,GAAqB,OAARwG,QAAQ,IAARA,GAAAA,EAAUrY,OAAQ,CAC5C,MAAMmR,EAAUkH,EAASrY,OAAO+S,MAAM0F,GAAWA,EAAEvV,MAAQ2O,IACvDV,GACFoN,EAAkBpN,EAEtB,IACC,CAACjS,EAAS2S,EAAWwG,KAExBnQ,EAAAA,EAAAA,YAAU,MACJhJ,IAAW2S,GAAsB,OAARwG,QAAQ,IAARA,GAAAA,EAAUrY,QAErCoY,EAAY,YAEb,CAAClZ,EAAS2S,EAAWwG,EAAUD,IAElC,MAAMoG,EAAeA,KACnBD,EAAkB,MAClBnf,KAGF,OAAKkf,GAsBHpY,EAAAA,EAAAA,KAACiD,EAAAA,EAAK,CACJtD,OACEsB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,OAAQR,SAAA,EAChEV,EAAAA,EAAAA,KAAA,QAAAU,SAAM,kCACNV,EAAAA,EAAAA,KAACoB,EAAAA,EAAG,CAACC,MAAM,OAAOpB,MAAO,CAAE4F,OAAQ,GAAInF,SACpC0X,EAAerF,SAItB7P,KAAMlK,EACNE,SAAUof,EACVnV,OAAQ,KACRvD,MAAO,IACPgR,gBAAc,EAAAlQ,UAEdO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAE6E,QAAS,UAAWpE,SAAA,EAEhCO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEwD,aAAc,QAAS/C,SAAA,EACnCV,EAAAA,EAAAA,KAACvH,EAAK,CAACmN,MAAO,EAAG3F,MAAO,CAAE4F,OAAQ,YAAaxE,MAAO,WAAYX,SAC/D0X,EAAe1R,QAES,QAA1BmR,EAAAO,EAAe5I,mBAAW,IAAAqI,OAAA,EAA1BA,EAA4BpI,gBAC3BxO,EAAAA,EAAAA,MAACG,EAAAA,EAAG,CAACC,MAAM,QAAQpB,MAAO,CAAE0B,SAAU,QAASjB,SAAA,CAAC,YACpC0X,EAAe5I,YAAYC,oBAK3CzP,EAAAA,EAAAA,KAACmH,EAAAA,EAAO,CAAClH,MAAO,CAAE4F,OAAQ,aAG1B5E,EAAAA,EAAAA,MAACsX,EAAAA,EAAY,CACX5Y,MAAM,sBACN2J,OAAQ,EACRlD,KAAK,QACLkH,UAAQ,EACRrN,MAAO,CAAEwD,aAAc,QAAS/C,SAAA,EAEhCV,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,eAAe6R,KAAM,EAAE9X,UAC9CV,EAAAA,EAAAA,KAACtH,EAAI,CAACyI,QAAM,EAAAT,SAAE0X,EAAe1R,UAGJ,QAA1BoR,EAAAM,EAAe5I,mBAAW,IAAAsI,OAAA,EAA1BA,EAA4BrI,gBAC3BzP,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,eAAcjG,UACrCV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAE0X,EAAe5I,YAAYC,kBAIX,QAA1BsI,EAAAK,EAAe5I,mBAAW,IAAAuI,OAAA,EAA1BA,EAA4B/E,gBAC3BhT,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,eAAcjG,UACrCV,EAAAA,EAAAA,KAACtH,EAAI,CAACiY,MAAI,EAAAjQ,SAAE0X,EAAe5I,YAAYwD,kBAI3ChT,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,MAAKjG,UAC5BV,EAAAA,EAAAA,KAACtH,EAAI,CAACiY,MAAI,EAAAjQ,SAAE0X,EAAerF,QAG5BqF,EAAeK,QACdzY,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,QAAOjG,UAC9BV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAE0X,EAAeK,UAIzBL,EAAeM,OACd1Y,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,OAAMjG,UAC7BV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAE0X,EAAeM,SAIzBN,EAAevC,cACd7V,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,cAAc6R,KAAM,EAAE9X,UAC7CV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAE0X,EAAevC,oBAM5B5U,EAAAA,EAAAA,MAACsX,EAAAA,EAAY,CACX5Y,MAAM,gBACN2J,OAAQ,EACRlD,KAAK,QACLkH,UAAQ,EACRrN,MAAO,CAAEwD,aAAc,QAAS/C,SAAA,EAEhCV,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,gBAAejG,UACtCO,EAAAA,EAAAA,MAACvI,EAAI,CAACyI,QAAM,EAAClB,MAAO,CAAEoB,MAAO,UAAWM,SAAU,QAASjB,SAAA,CAAC,UAC5B,QAA5BsX,EAAAI,EAAenF,qBAAa,IAAA+E,OAAA,EAA5BA,EAA8BjD,QAAQ,KAAM,aAIlD/U,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,MAAKjG,UAC5BO,EAAAA,EAAAA,MAACvI,EAAI,CAACuH,MAAO,CAAEoB,MAAO,WAAYX,SAAA,CAAC,UACb,QAAlBuX,EAAAG,EAAeO,WAAG,IAAAV,OAAA,EAAlBA,EAAoBlD,QAAQ,KAAM,aAIZ,QAA3BmD,EAAAE,EAAe3B,oBAAY,IAAAyB,OAAA,EAA3BA,EAA6BxR,QAC5B1G,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,WAAUjG,UACjCV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAE0X,EAAe3B,aAAa/P,cAIUnC,KAArB,QAA3B4T,EAAAC,EAAe3B,oBAAY,IAAA0B,OAAA,EAA3BA,EAA6B3B,kBAC5BxW,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,WAAUjG,UACjCO,EAAAA,EAAAA,MAACG,EAAAA,EAAG,CAACC,MAAM,SAAQX,SAAA,CAChB0X,EAAe3B,aAAaD,eAAe,kBAOrBjS,IAA7B6T,EAAeQ,gBAAwDrU,IAA7B6T,EAAeS,aACzD5X,EAAAA,EAAAA,MAACsX,EAAAA,EAAY,CACX5Y,MAAM,oBACN2J,OAAQ,EACRlD,KAAK,QACLkH,UAAQ,EAAA5M,SAAA,MAEsB6D,IAA7B6T,EAAeQ,YACd5Y,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,gBAAejG,UACtCV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAE0X,EAAeQ,mBAIIrU,IAA7B6T,EAAeS,YACd7Y,EAAAA,EAAAA,KAACuY,EAAAA,EAAa9R,KAAI,CAACE,MAAM,gBAAejG,UACtCV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAE0X,EAAeS,kBAO9B7Y,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CACVyB,UAAW,OACXoD,QAAS,OACThE,gBAAiB,UACjBF,aAAc,MACdyG,UAAW,UACX3G,UACAV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAYgE,MAAO,CAAE0B,SAAU,QAASjB,SAAC,mFAlKxDV,EAAAA,EAAAA,KAACiD,EAAAA,EAAK,CACJtD,MAAM,kBACNuD,KAAMlK,EACNE,SAAUof,EACVnV,OAAQ,KACRvD,MAAO,IACPgR,gBAAc,EAAAlQ,UAEdV,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEoH,UAAW,SAAUvC,QAAS,aAAcpE,SACvDlH,GACCwG,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAC,gCAENV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAWyE,SAAC,0B,2UCpDnC,MAAM,MAAEjI,EAAK,KAAEC,GAASC,EAAAA,GAClB,OAAE4U,GAAWzJ,EAAAA,EAwTnB,EA/SsD/K,IAK/C,IALgD,QACrDC,EAAO,QACPmc,EAAO,WACP2D,EAAU,UACVC,GACDhgB,EACC,MAAM,aAAEI,IAAiBC,EAAAA,EAAAA,KACnB4f,EAAc7f,EAAa,gBAEzBG,MAAO2f,EAAQ,QAAEzf,IAAYE,EAAAA,EAAAA,IACnCsf,EAAYrf,cAAc,YAGrBI,EAAYC,IAAiBC,EAAAA,EAAAA,UAAS,KACtCif,EAAeC,IAAoBlf,EAAAA,EAAAA,UAAgB,KAG1D+H,EAAAA,EAAAA,YAAU,KACJhJ,GACFggB,EAAY,YAEb,CAAChgB,KAGJgJ,EAAAA,EAAAA,YAAU,KACR,GAAY,OAARiX,QAAQ,IAARA,GAAAA,EAAUnf,OAAQ,CACpB,MAAMsf,EAAWH,EAASnf,OAAO8U,QAAQyK,IAAe,IAADC,EACrD,IAAKvf,EAAY,OAAO,EACxB,MAAMuV,EAAcvV,EAAW2P,cAGzB6P,EAAYF,EAAKG,YAAc,GAC/BC,GAAmC,QAApBH,EAAAD,EAAKK,uBAAe,IAAAJ,OAAA,EAApBA,EAAsB1e,YAAa,GAClDuR,EAAOkN,EAAKlN,MAAQ,GACpBwN,EAA2C,kBAAtBN,EAAK9B,aAA4B8B,EAAK9B,aAAa7H,WAAazG,OAAOoQ,EAAK9B,cAAgB,IAEvH,OACEgC,EAAU7P,cAAcjL,SAAS6Q,IACjCmK,EAAa/P,cAAcjL,SAAS6Q,IACpCnD,EAAK1N,SAAS1E,IACd4f,EAAYlb,SAAS1E,MAGzBof,EAAiBC,EACnB,IACC,CAACH,EAAUlf,IAEd,MAMM6f,EAAuBA,CAACC,EAAiBC,IACzCD,IAAWC,EAAwB,OACnCA,EAAwB,UACrB,SAGHC,EAAkBV,IAEtBP,EAAWO,GACXlE,KAGI6E,EAAgBA,KACpBjB,IACA5D,KAGF,OACElU,EAAAA,EAAAA,MAACgZ,EAAAA,EAAM,CACLta,OACEsB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUD,eAAgB,iBAAkBM,SAAA,EACrFV,EAAAA,EAAAA,KAACvH,EAAK,CAACmN,MAAO,EAAG3F,MAAO,CAAE4F,OAAQ,EAAGxE,MAAO,WAAYX,SAAC,4BAGzDV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,OACLyI,MAAM1E,EAAAA,EAAAA,KAACqG,EAAAA,EAAa,IACpB/F,QAAS6U,EACT/O,KAAK,aAIX8T,UAAU,OACVhX,KAAMlK,EACNmc,QAASA,EACTvV,MAAO,IACPua,UAAW,CAAErV,QAAS,QACtBsV,YAAa,CACXC,aAAc,oBACdvV,QAAS,uBACTpE,SAAA,EAGFV,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEwD,aAAc,QAAS/C,UACnCO,EAAAA,EAAAA,MAAC2C,EAAAA,EAAK,CAACtH,UAAU,WAAW8J,KAAK,SAASnG,MAAO,CAAEL,MAAO,QAASc,SAAA,EACjEV,EAAAA,EAAAA,KAACuN,EAAM,CACLxJ,YAAY,6CACZzG,MAAOvD,EACPiK,SAAWzF,GAAMvE,EAAcuE,EAAEU,OAAO3B,OACxC2G,QAAQjE,EAAAA,EAAAA,KAACkE,EAAAA,EAAc,IACvBoW,YAAU,EACVlU,KAAK,WAGPpG,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,UACLyI,MAAM1E,EAAAA,EAAAA,KAACkG,EAAAA,EAAY,IACnB5F,QAAS0Z,EACT/Z,MAAO,CACLL,MAAO,OACPe,OAAQ,OACRoE,WAAY,oDACZlE,OAAQ,OACRoF,WAAY,IACZrF,aAAc,OACdF,SACH,uCAMLV,EAAAA,EAAAA,KAACmH,EAAAA,EAAO,CAAClH,MAAO,CAAE4F,OAAQ,aAG1B7F,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEU,OAAQ,sBAAuBuE,SAAU,QAASxE,SAC7DlH,GACCyH,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEoH,UAAW,SAAUvC,QAAS,QAASpE,SAAA,EACnDV,EAAAA,EAAAA,KAACua,EAAAA,EAAI,CAACnU,KAAK,WACXpG,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEyB,UAAW,QAAShB,UAChCV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAWyE,SAAC,0BAGA,IAAzBwY,EAAcpd,QAChBkE,EAAAA,EAAAA,KAACwa,EAAAA,EAAK,CACJ3E,aACE5U,EAAAA,EAAAA,MAAA,OAAAP,SAAA,EACEV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAWyE,SACnB3G,EAAa,uCAAyC,yBAEvDA,IACAiG,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEyB,UAAW,OAAQhB,UAC/BV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CAACxI,KAAK,OAAOqE,QAAS0Z,EAActZ,SAAC,gCAOpDT,MAAO,CAAEyB,UAAW,WAGtB1B,EAAAA,EAAAA,KAACya,EAAAA,EAAI,CACHlT,WAAY2R,EACZwB,WAAarB,IAAI,IAAAsB,EA9GId,EAAiBC,EA8GrB,OACf9Z,EAAAA,EAAAA,KAACya,EAAAA,EAAKhU,KAAI,CACRxG,MAAO,CACL6E,QAAS,OACTjE,OAAQ,oBACRD,aAAc,MACd6C,aAAc,OACdsB,WAAY,QACZ7E,OAAQ,UACRa,WAAY,iBAEdc,aAAetD,IACbA,EAAEuD,cAAc7B,MAAM+E,UAAY,gCAClCzG,EAAEuD,cAAc7B,MAAM2a,UAAY,oBAEpC7Y,aAAexD,IACbA,EAAEuD,cAAc7B,MAAM+E,UAAY,OAClCzG,EAAEuD,cAAc7B,MAAM2a,UAAY,iBAEpCta,QAASA,IAAMyZ,EAAeV,GAAM3Y,UAEpCO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEL,MAAO,QAASc,SAAA,EAE5BO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CACVE,QAAS,OACTC,eAAgB,gBAChBC,WAAY,SACZoD,aAAc,OACd/C,SAAA,EACAO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,OAAQR,SAAA,EAChEV,EAAAA,EAAAA,KAAC6a,EAAAA,EAAM,CACLnW,MAAM1E,EAAAA,EAAAA,KAAC8a,EAAAA,EAAgB,IACvB7a,MAAO,CACL8E,WAAY,oDACZ1D,MAAO,YAGXrB,EAAAA,EAAAA,KAACtH,EAAI,CAACyI,QAAM,EAAClB,MAAO,CAAE0B,SAAU,QAASjB,SACtC2Y,EAAKG,iBAGVxZ,EAAAA,EAAAA,KAACoB,EAAAA,EAAG,CAACC,OAvJQwY,EAuJqBR,EAAK0B,QAvJTjB,EAuJkBT,EAAK2B,kBAtJjEnB,IAAWC,EAAwB,UACnCA,EAAwB,UACrB,SAoJiFpZ,SACrEkZ,EAAqBP,EAAK0B,QAAS1B,EAAK2B,yBAK7C/Z,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CACVE,QAAS,OACTE,WAAY,SACZa,IAAK,MACLuC,aAAc,OACd/C,SAAA,EACAV,EAAAA,EAAAA,KAAC4G,EAAAA,EAAY,CAAC3G,MAAO,CAAEoB,MAAO,UAAWM,SAAU,WACnD3B,EAAAA,EAAAA,KAACtH,EAAI,CAACuH,MAAO,CAAE0B,SAAU,OAAQN,MAAO,WAAYX,UAC7B,QAApBia,EAAAtB,EAAKK,uBAAe,IAAAiB,OAAA,EAApBA,EAAsB/f,YAAaye,EAAK4B,eAAiB,YAK9Dha,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CACVE,QAAS,OACTC,eAAgB,gBAChBC,WAAY,UACZK,SAAA,EACAO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,OAAQR,SAAA,EAChEV,EAAAA,EAAAA,KAACkb,EAAAA,EAAgB,CAACjb,MAAO,CAAEoB,MAAO,UAAWM,SAAU,WACvD3B,EAAAA,EAAAA,KAACtH,EAAI,CAACuH,MAAO,CAAE0B,SAAU,OAAQN,MAAO,WAAYX,SACjD2Y,EAAKlN,KAAOD,IAAMmN,EAAKlN,MAAMC,OAAO,cAAgB,YAGzDnL,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,OAAQR,SAAA,EAChEV,EAAAA,EAAAA,KAACmb,EAAAA,EAAc,CAAClb,MAAO,CAAEoB,MAAO,UAAWM,SAAU,WACrDV,EAAAA,EAAAA,MAACvI,EAAI,CAACyI,QAAM,EAAClB,MAAO,CAAE0B,SAAU,OAAQN,MAAO,WAAYX,SAAA,CAAC,UAC1B,kBAAtB2Y,EAAK9B,aAA4B8B,EAAK9B,aAAe6D,WAAW/B,EAAK9B,eAAiB,GAAGxC,QAAQ,aAMjH9T,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CACVE,QAAS,OACTe,IAAK,MACLQ,UAAW,OACXtB,eAAgB,YAChBM,SAAA,EACAV,EAAAA,EAAAA,KAACwQ,EAAAA,EAAO,CAAC7Q,MAAM,YAAWe,UACxBV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,OACLyI,MAAM1E,EAAAA,EAAAA,KAACqb,EAAAA,EAAW,IAClBjV,KAAK,QACL9F,QAAU/B,IACRA,EAAEI,kBACFob,EAAeV,IAEjBpZ,MAAO,CAAEoB,MAAO,gBAGpBrB,EAAAA,EAAAA,KAACwQ,EAAAA,EAAO,CAAC7Q,MAAM,aAAYe,UACzBV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,OACLyI,MAAM1E,EAAAA,EAAAA,KAACsb,EAAAA,EAAe,IACtBlV,KAAK,QACL9F,QAAU/B,IACRA,EAAEI,mBAGJsB,MAAO,CAAEoB,MAAO,wBAO5BoG,YAAY,OAMlBzH,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CACVgF,SAAU,WACVK,OAAQ,EACRC,KAAM,EACNJ,MAAO,EACPL,QAAS,OACTC,WAAY,QACZwW,UAAW,qBACX7a,UACAO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CACVE,QAAS,OACTC,eAAgB,gBAChBC,WAAY,UACZK,SAAA,EACAO,EAAAA,EAAAA,MAACvI,EAAI,CAACuD,KAAK,YAAYgE,MAAO,CAAE0B,SAAU,QAASjB,SAAA,CAAC,gBACpCwY,EAAcpd,WAE9BkE,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAYgE,MAAO,CAAE0B,SAAU,QAASjB,SAAC,2D,mCC9U9D,SAAgB,cAAgB,oCAAoC,cAAgB,oCAAoC,kBAAoB,wCAAwC,MAAQ,4BAA4B,kBAAoB,wCAAwC,kBAAoB,wCAAwC,kBAAoB,wCAAwC,kBAAoB,wCAAwC,gBAAkB,sCAAsC,YAAc,kCAAkC,cAAgB,oCAAoC,cAAgB,oCAAoC,cAAgB,oCAAoC,MAAQ,4BAA4B,cAAgB,oCAAoC,cAAgB,oCAAoC,cAAgB,oCAAoC,aAAe,mCAAmC,WAAa,iCAAiC,UAAY,gCAAgC,OAAS,6BAA6B,UAAY,gCAAgC,aAAe,mCAAmC,aAAe,mCAAmC,SAAW,+BAA+B,gBAAkB,sCAAsC,YAAc,kCAAkC,aAAe,mCAAmC,gBAAkB,sCAAsC,UAAY,gCAAgC,WAAa,iCAAiC,eAAiB,qCAAqC,sBAAwB,4CAA4C,aAAe,mCAAmC,gBAAkB,sCAAsC,WAAa,iCAAiC,YAAc,kCAAkC,UAAY,gCAAgC,mBAAqB,yCAAyC,aAAe,mCAAmC,aAAe,mCAAmC,OAAS,6BAA6B,aAAe,mCAAmC,QAAU,8BAA8B,cAAgB,oCAAoC,gBAAkB,sCAAsC,eAAiB,qCAAqC,eAAiB,qCAAqC,YAAc,kCAAkC,eAAiB,qCAAqC,eAAiB,qCAAqC,cAAgB,oCAAoC,aAAe,mCAAmC,WAAa,iCAAiC,aAAe,mCAAmC,aAAe,mCAAmC,aAAe,mCAAmC,aAAe,mCAAmC,eAAiB,qCAAqC,iBAAmB,uCAAuC,iBAAmB,uCAAuC,cAAgB,oCAAoC,mBAAqB,yCAAyC,kBAAoB,wCAAwC,oBAAsB,0CAA0C,oBAAsB,0CAA0C,kBAAoB,wCAAwC,gBAAkB,sCAAsC,qBAAuB,2CAA2C,sBAAwB,4CAA4C,2BAA6B,iDAAiD,kBAAoB,wCAAwC,kBAAoB,wCAAwC,sBAAwB,4CAA4C,cAAgB,oCAAoC,eAAiB,qCAAqC,UAAY,gCAAgC,uBAAyB,6CAA6C,iBAAmB,uCAAuC,iBAAmB,uCAAuC,iBAAmB,uCAAuC,iBAAmB,uCAAuC,cAAgB,oCAAoC,WAAa,iCAAiC,eAAiB,qCAAqC,cAAgB,oCAAoC,YAAc,kCAAkC,YAAc,kCAAkC,cAAgB,oCAAoC,cAAgB,oCAAoC,cAAgB,oCAAoC,oBAAsB,0CAA0C,WAAa,iCAAiC,mBAAqB,yCAAyC,eAAiB,qCAAqC,kBAAoB,wCAAwC,eAAiB,qCAAqC,qBAAqB,yCAAyC,UAAY,gCAAgC,cAAgB,oCAAoC,qBAAuB,2CAA2C,kBAAoB,wCAAwC,yBAA2B,+CAA+C,sBAAwB,4CAA4C,YAAc,kC,iMCuBx/K,MAAM,MAAEjI,EAAK,KAAEC,GAASC,EAAAA,EAqhBxB,EA5f8DI,IAIvD,IAJwD,QAC7DC,EAAO,SACPC,EAAQ,SACRC,GACDH,EACC,MAAM,aAAEI,IAAiBC,EAAAA,EAAAA,KACnBoiB,EAAkBriB,EAAa,iBAE7BG,MAAOmiB,EAAUjiB,QAASkiB,IAAgBhiB,EAAAA,EAAAA,IAChD8hB,EAAgB7hB,cAAc,WAI1BgiB,GAAgB,OAARF,QAAQ,IAARA,OAAQ,EAARA,EAAUniB,SAAiB,OAARmiB,QAAQ,IAARA,OAAQ,EAARA,EAAU3hB,SAAU,IAE9CC,EAAYC,IAAiBC,EAAAA,EAAAA,UAAS,KACtC2hB,EAAcC,IAAmB5hB,EAAAA,EAAAA,UAAsB,OACvDK,EAAkBC,IAAuBN,EAAAA,EAAAA,WAAkB,GAG5D6hB,GAAcngB,EAAAA,EAAAA,UAAQ,KACnBogB,EAAAA,EAAAA,OACN,IAEG3gB,GAAiBC,EAAAA,EAAAA,QAAY,MAC7BC,GAAWD,EAAAA,EAAAA,QAAuB,MAClCE,GAAmBF,EAAAA,EAAAA,QAA8B,MAGjD2gB,GAAgBrgB,EAAAA,EAAAA,UAAQ,KAC5B,IAAK5B,EAAW8B,OACd,OAAO8f,EAGT,MAAMrM,EAAcvV,EAAW2P,cAC/B,OAAOiS,EAAM/M,QAAQqN,IAAU,IAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAA,OACpB,QAATL,EAAAD,EAAKvV,YAAI,IAAAwV,OAAA,EAATA,EAAWxS,cAAcjL,SAAS6Q,MACxB,QADoC6M,EAC9CF,EAAKphB,aAAK,IAAAshB,OAAA,EAAVA,EAAYzS,cAAcjL,SAAS6Q,MACxB,QADoC8M,EAC/CH,EAAKnhB,cAAM,IAAAshB,OAAA,EAAXA,EAAa1S,cAAcjL,SAAS6Q,MACtB,QADkC+M,EAChDJ,EAAKO,iBAAS,IAAAH,OAAA,EAAdA,EAAgB3S,cAAcjL,SAAS6Q,MACzB,QADqCgN,EACnDL,EAAKQ,iBAAS,IAAAH,GAAM,QAANC,EAAdD,EAAgB5V,YAAI,IAAA6V,OAAN,EAAdA,EAAsB7S,cAAcjL,SAAS6Q,SAE9C,CAACqM,EAAO5hB,IAGL2iB,GAAiB1gB,EAAAA,EAAAA,cACpBM,IACC,GAA6B,IAAzB0f,EAAclgB,OAAc,OAEhC,IAAIS,EACJ,OAAQD,GACN,IAAK,KACHC,GACwB,IAAtBjC,EACI0hB,EAAclgB,OAAS,EACvBU,KAAKC,IAAInC,EAAmB,EAAG,GACrC,MACF,IAAK,OACHiC,GACwB,IAAtBjC,EACI,EACAkC,KAAKE,IAAIpC,EAAmB,EAAG0hB,EAAclgB,OAAS,GAC5D,MACF,IAAK,OACHS,EAAW,EACX,MACF,IAAK,MACHA,EAAWyf,EAAclgB,OAAS,EAClC,MACF,QACE,OAGJvB,EAAoBgC,GACpBsf,EAAgBG,EAAczf,IAG9BI,YAAW,KACT,MAAMC,EAAaC,SAASC,cAAc,kBAADC,OACrBif,EAAczf,GAAUS,IAAG,OAE/C,GAAIJ,EAAY,CACd,MAAMK,EACU,SAAdX,EACI,QACc,QAAdA,EACE,MACA,UACRM,EAAWM,eAAe,CACxBC,SAAU,SACVC,MAAOH,GAEX,IACC,OAEL,CAAC+e,EAAe1hB,IAIZ+C,GAAerB,EAAAA,EAAAA,cAClBsB,IACCtD,EAAcsD,GAEV/B,EAAiBgC,SACnBC,aAAajC,EAAiBgC,SAGhChC,EAAiBgC,QAAUZ,YAAW,KAChCW,EAAMzB,OACR2f,EAAgB,SAAU,CAAE/d,aAAcH,EAAMzB,SAEhD2f,EAAgB,YAEjB,OAEL,CAACA,IAIGmB,GAAmB3gB,EAAAA,EAAAA,cACtBigB,IACCJ,EAAgBI,GAChBhjB,EAASgjB,GACTtf,YAAW,IAAMzD,KAAY,OAE/B,CAACD,EAAUC,IAIPoF,GAAgBtC,EAAAA,EAAAA,cACnBuC,IACC,GAAc,WAAVA,EAAEC,IACJtF,SACK,GAAI,CAAC,YAAa,UAAW,OAAQ,OAAOuF,SAASF,EAAEC,KAAM,CAClED,EAAEG,iBACFH,EAAEI,kBASF+d,EAPqE,CACnE9d,UAAW,OACXC,QAAS,KACTC,KAAM,OACNC,IAAK,OAGqBR,EAAEC,KAChC,IAEF,CAACke,EAAgBxjB,IAIb8F,GAAsBhD,EAAAA,EAAAA,cACzBuC,IACC,IAAKvF,EAAS,OAGd,MAAMiG,EAASV,EAAEU,OACjB,GACqB,UAAnBA,EAAOC,SACY,aAAnBD,EAAOC,UACPD,EAAOE,UAAUC,SAAS,yBAC1BH,EAAOI,QAAQ,wBAJjB,CASA,GAAId,EAAEe,SAAqB,MAAVf,EAAEC,IAOjB,OANAD,EAAEG,iBACFH,EAAEI,uBACEvD,EAAemC,UACjBnC,EAAemC,QAAQgC,QACvBnE,EAAemC,QAAQiC,WAM3B,GAAI,CAAC,YAAa,UAAW,OAAQ,OAAOf,SAASF,EAAEC,KAAM,CAC3DD,EAAEG,iBACFH,EAAEI,kBASF+d,EAPqE,CACnE9d,UAAW,OACXC,QAAS,KACTC,KAAM,OACNC,IAAK,OAGqBR,EAAEC,KAChC,CAzBA,IA2BF,CAACxF,EAAS0jB,IAINhd,GAAU/D,EAAAA,EAAAA,UACd,IAAM,CACJ,CACEgE,MAAO,GACPnB,IAAK,SACLoB,MAAO,GACPC,OAAQA,CAACC,EAAcC,KACrBC,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLC,OAAQ,UACRC,QAAS,OACTC,eAAgB,SAChBC,WAAY,UAEdC,QAASA,KACPub,EAAgB9b,GAChB,MAAMQ,EAAQyb,EAAcxb,WACzBoc,GAAYA,EAAE5f,MAAQ+C,EAAO/C,MAEhCzC,EAAoBgG,IACpBG,UAEFV,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLL,MAAO,OACPe,OAAQ,OACRC,aAAc,MACdC,QACc,OAAZ+a,QAAY,IAAZA,OAAY,EAAZA,EAAc5e,OAAQ+C,EAAO/C,IACzB,oBACA,oBACN8D,iBACc,OAAZ8a,QAAY,IAAZA,OAAY,EAAZA,EAAc5e,OAAQ+C,EAAO/C,IAAM,UAAY,QACjDmD,QAAS,OACTE,WAAY,SACZD,eAAgB,SAChBW,WAAY,iBACZL,UAEW,OAAZkb,QAAY,IAAZA,OAAY,EAAZA,EAAc5e,OAAQ+C,EAAO/C,MAC5BgD,EAAAA,EAAAA,KAAA,OACEC,MAAO,CACLL,MAAO,MACPe,OAAQ,MACRC,aAAc,MACdE,gBAAiB,gBAQ/B,CACEnB,MAAO,OACPqB,UAAW,OACXxC,IAAK,OACLqB,OAAQA,CAACC,EAAcC,KACrBkB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,GAAIR,SAAA,EAC5DV,EAAAA,EAAAA,KAAC4G,EAAAA,EAAY,CAAC3G,MAAO,CAAEoB,MAAO,cAC9BJ,EAAAA,EAAAA,MAAA,OAAAP,SAAA,EACEV,EAAAA,EAAAA,KAACtH,EAAI,CAACyI,QAAM,EAAAT,SAAEZ,KACdE,EAAAA,EAAAA,KAAA,UACAiB,EAAAA,EAAAA,MAACvI,EAAI,CAACuD,KAAK,YAAYgE,MAAO,CAAE0B,SAAU,QAASjB,SAAA,CAAC,IAChDX,EAAOyc,oBAMnB,CACE7c,MAAO,OACPnB,IAAK,OACLqB,OAAQA,CAACC,EAAcC,KAAY,IAAA8c,EAAA,OACjC7c,EAAAA,EAAAA,KAACoB,EAAAA,EAAG,CAACC,MAAM,OAAMX,UACE,QAAhBmc,EAAA9c,EAAO0c,iBAAS,IAAAI,OAAA,EAAhBA,EAAkBnW,OAAQ,cAIjC,CACE/G,MAAO,SACPqB,UAAW,SACXxC,IAAK,SACLqB,OAASC,IACPmB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,GAAIR,SAAA,EAC5DV,EAAAA,EAAAA,KAACuB,EAAAA,EAAa,CAACtB,MAAO,CAAEoB,MAAO,WAC/BrB,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAEZ,QAIb,CACEH,MAAO,QACPqB,UAAW,QACXxC,IAAK,QACLqB,OAASC,IACPmB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,GAAIR,SAAA,EAC5DV,EAAAA,EAAAA,KAACwB,EAAAA,EAAY,CAACvB,MAAO,CAAEoB,MAAO,WAC9BrB,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAEZ,GAAQ,UAIrB,CACEH,MAAO,SACPnB,IAAK,SACLqB,OAAQA,CAACC,EAAcC,KAAY,IAAA+c,EAAA,OACjC9c,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAYgE,MAAO,CAAE0B,SAAU,QAASjB,UAC9B,QAAlBoc,EAAA/c,EAAOgd,mBAAW,IAAAD,OAAA,EAAlBA,EAAoBE,cAAe,UAK5C,CAACpB,EAAcI,IAIXpa,GAAc5F,EAAAA,EAAAA,cAClB,CAAC+D,EAAcQ,KAAc,CAC3BD,QAASA,KACPub,EAAgB9b,GAChBxF,EAAyB,OAALgG,QAAK,IAALA,EAAAA,EAAS,IAE/BN,MAAO,CACLC,OAAQ,UACRY,iBACc,OAAZ8a,QAAY,IAAZA,OAAY,EAAZA,EAAc5e,OAAQ+C,EAAO/C,IAAM,UAAY,QACjD6D,QACc,OAAZ+a,QAAY,IAAZA,OAAY,EAAZA,EAAc5e,OAAQ+C,EAAO/C,IACzB,oBACA,oBACN4D,aAAc,MACdG,WAAY,iBAEdc,aAAetD,KACG,OAAZqd,QAAY,IAAZA,OAAY,EAAZA,EAAc5e,OAAQ+C,EAAO/C,MAC/BuB,EAAEuD,cAAc7B,MAAMa,gBAAkB,YAG5CiB,aAAexD,KACG,OAAZqd,QAAY,IAAZA,OAAY,EAAZA,EAAc5e,OAAQ+C,EAAO/C,MAC/BuB,EAAEuD,cAAc7B,MAAMa,gBAAkB,aAI9C,CAAC8a,KAIH5Z,EAAAA,EAAAA,YAAU,KACJhJ,GACFwiB,EAAgB,UAChBK,EAAgB,MAChBthB,GAAqB,KAErBP,EAAc,IACd6hB,EAAgB,MAChBthB,GAAqB,GACjBgB,EAAiBgC,UACnBC,aAAajC,EAAiBgC,SAC9BhC,EAAiBgC,QAAU,OAIxB,KACDhC,EAAiBgC,SACnBC,aAAajC,EAAiBgC,YAGjC,CAACvE,EAASwiB,KAGbxZ,EAAAA,EAAAA,YAAU,KACR,GAAIhJ,GAAW2iB,EAAM7f,OAAS,GAAgB,OAAXggB,QAAW,IAAXA,GAAAA,EAAa9e,MAAQ4e,EAAc,CACpE,MAAMqB,EAAoBtB,EAAM9O,MAAMoP,GAAeA,EAAKjf,MAAQ8e,EAAY9e,MAC9E,GAAIigB,EAAmB,CACrBpB,EAAgBoB,GAChB,MAAM1c,EAAQob,EAAMnb,WAAWyb,GAAeA,EAAKjf,MAAQ8e,EAAY9e,MACvEzC,EAAoBgG,GAGpB5D,YAAW,KACT,MAAMC,EAAaC,SAASC,cAAc,kBAADC,OACrBkgB,EAAkBjgB,IAAG,OAErCJ,GACFA,EAAWM,eAAe,CACxBC,SAAU,SACVC,MAAO,aAGV,IACL,CACF,IACC,CAACpE,EAAS2iB,EAAkB,OAAXG,QAAW,IAAXA,OAAW,EAAXA,EAAa9e,IAAK4e,KAGtC5Z,EAAAA,EAAAA,YAAU,KACR,GAAIhJ,GAAWoC,EAAemC,QAAS,CACrC,MAAM0E,EAAcA,KACd7G,EAAemC,UACjBnC,EAAemC,QAAQgC,QACvBnE,EAAemC,QAAQiC,WAI3ByC,IACA,MAAMC,EAAQvF,WAAWsF,EAAa,KAEtC,MAAO,IAAMzE,aAAa0E,EAC5B,IACC,CAAClJ,KAGJgJ,EAAAA,EAAAA,YAAU,KACR,GAAIhJ,EAEF,OADA6D,SAASsF,iBAAiB,UAAWnD,GAAqB,GACnD,IACLnC,SAASuF,oBAAoB,UAAWpD,GAAqB,KAEhE,CAAChG,EAASgG,IAGb,MAAMgE,GAAoBhH,EAAAA,EAAAA,cAAY,KACpC6f,EAAgB,MAChBthB,GAAqB,KACpB,IAEH,OACE0G,EAAAA,EAAAA,MAACgC,EAAAA,EAAK,CACJtD,MAAM,0BACNuD,KAAMlK,EACNE,SAAUA,EACViK,OAAQ,KACRvD,MAAO,IACPK,MAAO,CAAEmD,IAAK,IACdC,gBAAiBH,IACXA,GAAQ9H,EAAemC,SACzBZ,YAAW,KAAO,IAAD2G,EAAAC,EACO,QAAtBD,EAAAlI,EAAemC,eAAO,IAAA+F,GAAtBA,EAAwB/D,QACF,QAAtBgE,EAAAnI,EAAemC,eAAO,IAAAgG,GAAtBA,EAAwB/D,WACvB,MAELkB,SAAA,EAEFV,EAAAA,EAAAA,KAAA,OACEwD,IAAKlI,EACL2E,MAAO,CAAEwD,aAAc,IACvBC,UAAWpF,EACXqF,SAAU,EAAEjD,UAEZV,EAAAA,EAAAA,KAAC8D,EAAAA,EAAK,CACJN,IAAKpI,EACL2I,YAAY,sEACZzG,MAAOvD,EACPiK,SAAUzF,GAAKlB,EAAakB,EAAEU,OAAO3B,OACrC2G,QAAQjE,EAAAA,EAAAA,KAACkE,EAAAA,EAAc,IACvBjE,MAAO,CAAEL,MAAO,QAChB8D,UAAWnF,IAEK,UAAVA,EAAEC,KAAmBod,GACvBe,EAAiBf,IAGrBxX,QAASpB,EACTqB,WAAS,EACTC,OAAQA,KAEFtL,GAAWoC,EAAemC,SAC5BZ,YAAW,KACL3D,GAAWoC,EAAemC,SAC5BnC,EAAemC,QAAQgC,UAExB,KAGPiF,OACEzK,GAAc2hB,GACZ1b,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAE0B,SAAU,OAAQN,MAAO,QAASX,SAAC,iBAG/C,UAKVV,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEmH,UAAW,IAAKlC,SAAU,QAASxE,SAC9Cgb,GACC1b,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEoH,UAAW,SAAUvC,QAAS,IAAKpE,UAC/CV,EAAAA,EAAAA,KAACtH,EAAI,CAAAgI,SAAC,uBAEmB,IAAzBsb,EAAclgB,QAChBkE,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEoH,UAAW,SAAUvC,QAAS,IAAKpE,UAC/CV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAWyE,SACnB3G,EACG,uCACA,2BAIRiG,EAAAA,EAAAA,KAACsH,EAAAA,EAAK,CACJ5H,QAASA,EACT6H,WAAYyU,EACZxU,OAAO,MACPC,YAAY,EACZrB,KAAK,QACLsB,OAAQ,CAAEC,EAAG,KACbC,MAAOhG,S,qMCzhBnB,MAAM,MAAEnJ,EAAK,KAAEC,GAASC,EAAAA,EAkIxB,EAxH4EI,IAMrE,IANsE,QAC3EC,EAAO,UACP+f,EAAS,eACTmE,EAAc,SACdhkB,EAAQ,cACRikB,GACDpkB,EACC,OACEkI,EAAAA,EAAAA,MAACgC,EAAAA,EAAK,CACJtD,OACEsB,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEoH,UAAW,UAAW3G,SAAA,EAClCV,EAAAA,EAAAA,KAACsQ,EAAAA,EAAmB,CAClBrQ,MAAO,CACLoB,MAAO,UACPM,SAAU,OACVwE,YAAa,UAGjBnG,EAAAA,EAAAA,KAAA,QAAMC,MAAO,CAAEoB,MAAO,UAAW4E,WAAY,KAAMvF,SAAC,gCAKxDwC,KAAMlK,EACNE,SAAUA,EACViK,OAAQ,KACRvD,MAAO,IACPwd,UAAQ,EACRC,cAAc,EACdC,UAAU,EAAM5c,SAAA,EAEhBV,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEoH,UAAW,SAAU5D,aAAc,QAAS/C,UACxDV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAWyE,SAAC,6EAKxByc,IACClc,EAAAA,EAAAA,MAAA,OACEhB,MAAO,CACL8E,WAAY,oDACZlE,OAAQ,oBACRD,aAAc,MACdkE,QAAS,OACTrB,aAAc,QACd/C,SAAA,EAEFV,EAAAA,EAAAA,KAACvH,EAAK,CAACmN,MAAO,EAAG3F,MAAO,CAAEwD,aAAc,OAAQpC,MAAO,WAAYX,SAAC,+BAGpEO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQqG,oBAAqB,UAAWtF,IAAK,QAASR,SAAA,EAC3EO,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,OAAQR,SAAA,EAChEV,EAAAA,EAAAA,KAAC8a,EAAAA,EAAgB,CAAC7a,MAAO,CAAEoB,MAAO,cAClCJ,EAAAA,EAAAA,MAACvI,EAAI,CAACyI,QAAM,EAAAT,SAAA,CAAC,YAAUyc,EAAc3D,kBAEvCvY,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,OAAQR,SAAA,EAChEV,EAAAA,EAAAA,KAAC4G,EAAAA,EAAY,CAAC3G,MAAO,CAAEoB,MAAO,cAC9BrB,EAAAA,EAAAA,KAACtH,EAAI,CAACyI,QAAM,EAAAT,SAAEyc,EAAclC,eAAiB,YAE/Cha,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,OAAQR,SAAA,EAChEV,EAAAA,EAAAA,KAACkb,EAAAA,EAAgB,CAACjb,MAAO,CAAEoB,MAAO,cAClCrB,EAAAA,EAAAA,KAACtH,EAAI,CAACyI,QAAM,EAAAT,SAAEwL,IAAMiR,EAAchR,MAAMC,OAAO,oBAEjDnL,EAAAA,EAAAA,MAAA,OAAKhB,MAAO,CAAEE,QAAS,OAAQE,WAAY,SAAUa,IAAK,OAAQR,SAAA,EAChEV,EAAAA,EAAAA,KAACmb,EAAAA,EAAc,CAAClb,MAAO,CAAEoB,MAAO,cAChCJ,EAAAA,EAAAA,MAACvI,EAAI,CAACyI,QAAM,EAAAT,SAAA,CAAC,UAAyC,kBAA/Byc,EAAc5F,aAA4B4F,EAAc5F,aAAe6D,WAAW+B,EAAc5F,eAAiB,GAAGxC,QAAQ,gBAM3J/U,EAAAA,EAAAA,KAACmH,EAAAA,EAAO,CAAClH,MAAO,CAAE4F,OAAQ,aAE1B5E,EAAAA,EAAAA,MAAC2C,EAAAA,EAAK,CAACtH,UAAU,WAAW8J,KAAK,SAASnG,MAAO,CAAEL,MAAO,QAASc,SAAA,EACjEV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACLxI,KAAK,UACLmK,KAAK,QACL1B,MAAM1E,EAAAA,EAAAA,KAACkG,EAAAA,EAAY,IACnB5F,QAASyY,EACT9Y,MAAO,CACLL,MAAO,OACPe,OAAQ,OACRoE,WAAY,oDACZlE,OAAQ,OACRoF,WAAY,IACZtE,SAAU,OACVf,aAAc,OACdF,SACH,kCAIDV,EAAAA,EAAAA,KAACyE,EAAAA,GAAM,CACL2B,KAAK,QACL1B,MAAM1E,EAAAA,EAAAA,KAAC8a,EAAAA,EAAgB,IACvBxa,QAAS4c,EACTjd,MAAO,CACLL,MAAO,OACPe,OAAQ,OACRoE,WAAY,oDACZ1D,MAAO,QACPR,OAAQ,OACRoF,WAAY,IACZtE,SAAU,OACVf,aAAc,OACdF,SACH,gDAKHV,EAAAA,EAAAA,KAAA,OAAKC,MAAO,CAAEoH,UAAW,SAAU3F,UAAW,QAAShB,UACrDV,EAAAA,EAAAA,KAACtH,EAAI,CAACuD,KAAK,YAAYgE,MAAO,CAAE0B,SAAU,QAASjB,SAAC,8F","sources":["pages/RetaillBill/components/CustomerSelectionModal.tsx","components/common/AntdEditableTable.tsx","pages/RetaillBill/components/StockSelectionModal.tsx","pages/RetaillBill/components/ProductSelectionModal.tsx","helpers/amount_calculations.ts","pages/RetaillBill/components/ProductDetailsModal.tsx","pages/RetaillBill/components/BillListDrawer.tsx","webpack://SUBRIVA-BILLING/./src/pages/RetaillBill/components/BillDataGrid.module.css?232c","pages/RetaillBill/components/UserSelectionModal.tsx","pages/RetaillBill/components/BillSaveConfirmationModal.tsx"],"sourcesContent":["import React, {\r\n  useState,\r\n  useEffect,\r\n  useLayoutEffect,\r\n  useRef,\r\n  useCallback,\r\n  useMemo,\r\n} from 'react';\r\nimport {\r\n  Modal,\r\n  Input,\r\n  Button,\r\n  Typography,\r\n  message,\r\n  Form,\r\n  Select,\r\n  Space,\r\n  Divider,\r\n  Tag,\r\n  Table,\r\n  Row,\r\n  Col,\r\n} from 'antd';\r\nimport {\r\n  SearchOutlined,\r\n  UserAddOutlined,\r\n  UserOutlined,\r\n  PhoneOutlined,\r\n  MailOutlined,\r\n  HomeOutlined,\r\n  PlusOutlined,\r\n  SaveOutlined,\r\n  CloseOutlined,\r\n} from '@ant-design/icons';\r\nimport { useApiActions } from '../../../services/api/useApiActions';\r\nimport { useDynamicSelector } from '../../../services/redux';\r\nimport { useHandleApiResponse } from '../../../components/common/useHandleApiResponse';\r\n\r\nconst { Title, Text } = Typography;\r\nconst { Option } = Select;\r\n\r\ninterface Customer {\r\n  _id: string;\r\n  full_name: string;\r\n  email: string;\r\n  mobile: string;\r\n  address: string;\r\n  customer_type: 'regular' | 'vip' | 'wholesale';\r\n}\r\n\r\ninterface NewCustomerData {\r\n  full_name: string;\r\n  email: string;\r\n  mobile: string;\r\n  address: string;\r\n  customer_type: 'regular' | 'vip' | 'wholesale';\r\n}\r\n\r\ninterface CustomerSelectionModalProps {\r\n  visible: boolean;\r\n  onSelect: (customer: Customer) => void;\r\n  onCancel: () => void;\r\n}\r\n\r\nconst CustomerSelectionModalComponent: React.FC<CustomerSelectionModalProps> = ({\r\n  visible,\r\n  onSelect,\r\n  onCancel,\r\n}) => {\r\n  const { getEntityApi } = useApiActions();\r\n  const CustomerApi = getEntityApi('Customer');\r\n\r\n  const { items: customerList, loading: customerLoading } = useDynamicSelector(\r\n    CustomerApi.getIdentifier('GetAll')\r\n  );\r\n  const { loading: createLoading } = useDynamicSelector(\r\n    CustomerApi.getIdentifier('Create')\r\n  );\r\n\r\n  // Extract items from customerList if it exists\r\n  const customers = customerList?.items || customerList?.result || [];\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showAddForm, setShowAddForm] = useState(false);\r\n  const [selectedCustomer, setSelectedCustomer] = useState<Customer | null>(\r\n    null\r\n  );\r\n  const [selectedRowIndex, setSelectedRowIndex] = useState<number>(-1);\r\n  const [showCreateGrid, setShowCreateGrid] = useState(false);\r\n  const [newCustomerData, setNewCustomerData] = useState<NewCustomerData>({\r\n    full_name: '',\r\n    email: '',\r\n    mobile: '',\r\n    address: '',\r\n    customer_type: 'regular',\r\n  });\r\n\r\n  const [form] = Form.useForm();\r\n  const searchInputRef = useRef<any>(null);\r\n  const modalRef = useRef<HTMLDivElement>(null);\r\n  const searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  const createGridRef = useRef<HTMLDivElement>(null);\r\n  const firstFormInputRef = useRef<any>(null);\r\n\r\n  // Memoized filtered customers\r\n  const filteredCustomers = useMemo(() => customers, [customers]);\r\n\r\n  // Check if search has no results and should show create grid\r\n  const shouldShowCreateGrid = useMemo(() => {\r\n    return (\r\n      searchTerm.trim() && !customerLoading && filteredCustomers.length === 0\r\n    );\r\n  }, [searchTerm, customerLoading, filteredCustomers.length]);\r\n\r\n  // Memoized customer type color function\r\n  const getCustomerTypeColor = useCallback((type: string) => {\r\n    const colorMap: Record<string, string> = {\r\n      vip: 'gold',\r\n      wholesale: 'blue',\r\n      regular: 'green',\r\n    };\r\n    return colorMap[type] || 'green';\r\n  }, []);\r\n\r\n  // Consolidated keyboard navigation function\r\n  const navigateToCustomer = useCallback(\r\n    (direction: 'up' | 'down' | 'home' | 'end') => {\r\n      if (filteredCustomers.length === 0) return;\r\n\r\n      let newIndex: number;\r\n      switch (direction) {\r\n        case 'up':\r\n          newIndex =\r\n            selectedRowIndex === -1\r\n              ? filteredCustomers.length - 1\r\n              : Math.max(selectedRowIndex - 1, 0);\r\n          break;\r\n        case 'down':\r\n          newIndex =\r\n            selectedRowIndex === -1\r\n              ? 0\r\n              : Math.min(selectedRowIndex + 1, filteredCustomers.length - 1);\r\n          break;\r\n        case 'home':\r\n          newIndex = 0;\r\n          break;\r\n        case 'end':\r\n          newIndex = filteredCustomers.length - 1;\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n\r\n      setSelectedRowIndex(newIndex);\r\n      setSelectedCustomer(filteredCustomers[newIndex]);\r\n\r\n      // Scroll to the selected row\r\n      setTimeout(() => {\r\n        const rowElement = document.querySelector(\r\n          `[data-row-key=\"${filteredCustomers[newIndex]._id}\"]`\r\n        ) as HTMLElement;\r\n        if (rowElement) {\r\n          const scrollBehavior =\r\n            direction === 'home'\r\n              ? 'start'\r\n              : direction === 'end'\r\n                ? 'end'\r\n                : 'nearest';\r\n          rowElement.scrollIntoView({\r\n            behavior: 'smooth',\r\n            block: scrollBehavior,\r\n          });\r\n        }\r\n      }, 100);\r\n    },\r\n    [filteredCustomers, selectedRowIndex]\r\n  );\r\n\r\n  // Debounced search function\r\n  const handleSearch = useCallback(\r\n    (value: string) => {\r\n      setSearchTerm(value);\r\n\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n      }\r\n\r\n      searchTimeoutRef.current = setTimeout(() => {\r\n        if (value.trim()) {\r\n          CustomerApi('GetAll', { searchString: value.trim() });\r\n        } else {\r\n          CustomerApi('GetAll');\r\n        }\r\n      }, 500);\r\n    },\r\n    [CustomerApi]\r\n  );\r\n\r\n  // Handle customer selection\r\n  const handleCustomerSelect = useCallback(\r\n    (customer: Customer) => {\r\n      setSelectedCustomer(customer);\r\n      onSelect(customer);\r\n      setTimeout(() => onCancel(), 100);\r\n    },\r\n    [onSelect, onCancel]\r\n  );\r\n\r\n  // Handle new customer creation from unified form\r\n  const handleCreateCustomerFromForm = useCallback(async () => {\r\n    try {\r\n      // Validate required fields - only Full Name and Mobile are mandatory\r\n      if (!newCustomerData.full_name.trim()) {\r\n        message.error('Full name is required');\r\n        return;\r\n      }\r\n      if (!newCustomerData.mobile.trim()) {\r\n        message.error('Mobile number is required');\r\n        return;\r\n      }\r\n\r\n      // Call the API - the response will be handled by the useEffect watching createResult\r\n      await CustomerApi('Create', newCustomerData);\r\n\r\n      // Note: The modal will be automatically closed by the useEffect when the API response comes back\r\n    } catch (error) {\r\n      message.error('Failed to create customer');\r\n      // Clear form data on error\r\n      clearFormData();\r\n    }\r\n  }, [newCustomerData, CustomerApi]);\r\n\r\n  // Function to clear form data\r\n  const clearFormData = useCallback(() => {\r\n    setNewCustomerData({\r\n      full_name: '',\r\n      email: '',\r\n      mobile: '',\r\n      address: '',\r\n      customer_type: 'regular',\r\n    });\r\n    form.resetFields();\r\n  }, [form]);\r\n\r\n  // Handle form field changes\r\n  const handleFormFieldChange = useCallback(\r\n    (field: keyof NewCustomerData, value: string) => {\r\n      setNewCustomerData(prev => ({\r\n        ...prev,\r\n        [field]: value,\r\n      }));\r\n    },\r\n    []\r\n  );\r\n\r\n  // Remove the navigateToNextField function as it's no longer needed\r\n\r\n  // Handle keyboard events (excluding Enter key which is handled by input field)\r\n  const handleKeyDown = useCallback(\r\n    (e: React.KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onCancel();\r\n      } else if (['ArrowDown', 'ArrowUp', 'Home', 'End'].includes(e.key)) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const directionMap: Record<string, 'up' | 'down' | 'home' | 'end'> = {\r\n          ArrowDown: 'down',\r\n          ArrowUp: 'up',\r\n          Home: 'home',\r\n          End: 'end',\r\n        };\r\n\r\n        navigateToCustomer(directionMap[e.key]);\r\n      }\r\n    },\r\n    [navigateToCustomer, onCancel]\r\n  );\r\n\r\n  // Global keyboard event handler\r\n  const handleGlobalKeyDown = useCallback(\r\n    (e: KeyboardEvent) => {\r\n      if (!visible) return;\r\n\r\n      // Don't interfere if user is typing in form inputs\r\n      const target = e.target as HTMLElement;\r\n      if (\r\n        target.tagName === 'INPUT' ||\r\n        target.tagName === 'TEXTAREA' ||\r\n        target.classList.contains('ant-select-selector') ||\r\n        target.closest('.ant-select-dropdown')\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      if (e.ctrlKey && e.key === 'f') {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (searchInputRef.current) {\r\n          searchInputRef.current.focus();\r\n          searchInputRef.current.select();\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Handle Ctrl+N for new customer creation\r\n      if (e.ctrlKey && e.key === 'n') {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (shouldShowCreateGrid) {\r\n          setShowCreateGrid(true);\r\n          setTimeout(() => {\r\n            if (createGridRef.current) {\r\n              const firstInput = createGridRef.current.querySelector(\r\n                'input'\r\n              ) as HTMLInputElement;\r\n              if (firstInput) {\r\n                firstInput.focus();\r\n                firstInput.select();\r\n              }\r\n            }\r\n          }, 100);\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Only handle navigation keys globally when not in form inputs\r\n      if (['ArrowDown', 'ArrowUp', 'Home', 'End'].includes(e.key)) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const directionMap: Record<string, 'up' | 'down' | 'home' | 'end'> = {\r\n          ArrowDown: 'down',\r\n          ArrowUp: 'up',\r\n          Home: 'home',\r\n          End: 'end',\r\n        };\r\n\r\n        navigateToCustomer(directionMap[e.key]);\r\n      }\r\n    },\r\n    [visible, navigateToCustomer, shouldShowCreateGrid]\r\n  );\r\n\r\n  // Memoized table columns\r\n  const columns = useMemo(\r\n    () => [\r\n      {\r\n        title: '',\r\n        key: 'select',\r\n        width: 60,\r\n        render: (text: string, record: Customer) => (\r\n          <div\r\n            style={{\r\n              cursor: 'pointer',\r\n              display: 'flex',\r\n              justifyContent: 'center',\r\n              alignItems: 'center',\r\n            }}\r\n            onClick={() => {\r\n              setSelectedCustomer(record);\r\n              const index = filteredCustomers.findIndex(\r\n                (c: Customer) => c._id === record._id\r\n              );\r\n              setSelectedRowIndex(index);\r\n              // Don't auto-select here, let user click the row or press Enter\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                width: '18px',\r\n                height: '18px',\r\n                borderRadius: '50%',\r\n                border:\r\n                  selectedCustomer?._id === record._id\r\n                    ? '2px solid #1890ff'\r\n                    : '2px solid #d9d9d9',\r\n                backgroundColor:\r\n                  selectedCustomer?._id === record._id ? '#1890ff' : 'white',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                transition: 'all 0.2s ease',\r\n              }}\r\n            >\r\n              {selectedCustomer?._id === record._id && (\r\n                <div\r\n                  style={{\r\n                    width: '8px',\r\n                    height: '8px',\r\n                    borderRadius: '50%',\r\n                    backgroundColor: 'white',\r\n                  }}\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Customer Name',\r\n        dataIndex: 'full_name',\r\n        key: 'full_name',\r\n        render: (text: string, record: Customer) => (\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n            <Text strong>{text}</Text>\r\n            <Tag color={getCustomerTypeColor(record.customer_type)}>\r\n              {record.customer_type.toUpperCase()}\r\n            </Tag>\r\n          </div>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Mobile',\r\n        dataIndex: 'mobile',\r\n        key: 'mobile',\r\n        render: (text: string) => (\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n            <PhoneOutlined style={{ color: '#666' }} />\r\n            <Text>{text}</Text>\r\n          </div>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Email',\r\n        dataIndex: 'email',\r\n        key: 'email',\r\n        render: (text: string) => (\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n            <MailOutlined style={{ color: '#666' }} />\r\n            <Text>{text || '-'}</Text>\r\n          </div>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Address',\r\n        dataIndex: 'address',\r\n        key: 'address',\r\n        render: (text: string) => (\r\n          <div style={{ display: 'flex', alignItems: 'flex-start', gap: 8 }}>\r\n            <HomeOutlined style={{ color: '#666', marginTop: '2px' }} />\r\n            <Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n              {text || '-'}\r\n            </Text>\r\n          </div>\r\n        ),\r\n      },\r\n    ],\r\n    [selectedCustomer, filteredCustomers, getCustomerTypeColor]\r\n  );\r\n\r\n  // Memoized table row props\r\n  const getRowProps = useCallback(\r\n    (record: Customer, index?: number) => ({\r\n      onClick: () => {\r\n        setSelectedCustomer(record);\r\n        setSelectedRowIndex(index ?? 0);\r\n        // Don't auto-select on row click, let user press Enter to confirm\r\n      },\r\n      style: {\r\n        cursor: 'pointer',\r\n        backgroundColor:\r\n          selectedCustomer?._id === record._id ? '#f0f8ff' : 'white',\r\n        border:\r\n          selectedCustomer?._id === record._id\r\n            ? '2px solid #1890ff'\r\n            : '1px solid #f0f0f0',\r\n        borderRadius: '4px',\r\n        transition: 'all 0.2s ease',\r\n      },\r\n      onMouseEnter: (e: React.MouseEvent<HTMLElement>) => {\r\n        if (selectedCustomer?._id !== record._id) {\r\n          e.currentTarget.style.backgroundColor = '#f5f5f5';\r\n        }\r\n      },\r\n      onMouseLeave: (e: React.MouseEvent<HTMLElement>) => {\r\n        if (selectedCustomer?._id !== record._id) {\r\n          e.currentTarget.style.backgroundColor = 'white';\r\n        }\r\n      },\r\n    }),\r\n    [selectedCustomer]\r\n  );\r\n\r\n  // Load customers on mount and handle modal close\r\n  useEffect(() => {\r\n    if (visible) {\r\n      CustomerApi('GetAll');\r\n      setSelectedCustomer(null);\r\n      setSelectedRowIndex(-1);\r\n      setShowCreateGrid(false);\r\n    } else {\r\n      setSearchTerm('');\r\n      setSelectedCustomer(null);\r\n      setSelectedRowIndex(-1);\r\n      setShowCreateGrid(false);\r\n      setShowAddForm(false);\r\n      clearFormData();\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n        searchTimeoutRef.current = null;\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [visible, CustomerApi, clearFormData]);\r\n\r\n  // Auto-show create form when search has no results\r\n  useEffect(() => {\r\n    if (shouldShowCreateGrid && !showCreateGrid && !showAddForm) {\r\n      setShowCreateGrid(true);\r\n    }\r\n  }, [shouldShowCreateGrid, showCreateGrid, showAddForm]);\r\n\r\n  // Focus search input when modal becomes visible (but not when create form is shown)\r\n  useEffect(() => {\r\n    if (visible && searchInputRef.current && !showAddForm && !showCreateGrid) {\r\n      const focusSearch = () => {\r\n        if (searchInputRef.current) {\r\n          searchInputRef.current.focus();\r\n          searchInputRef.current.select();\r\n        }\r\n      };\r\n\r\n      focusSearch();\r\n      const timer = setTimeout(focusSearch, 100);\r\n\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [visible, showAddForm, showCreateGrid]);\r\n\r\n  // Focus on first form field when create form is shown\r\n  useEffect(() => {\r\n    if ((showAddForm || showCreateGrid) && visible) {\r\n      const timer = setTimeout(() => {\r\n        if (firstFormInputRef.current) {\r\n          firstFormInputRef.current.focus();\r\n          firstFormInputRef.current.select();\r\n        }\r\n      }, 100);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [showAddForm, showCreateGrid, visible]); // Depend on all three to trigger when form is shown\r\n\r\n  // Remove the useLayoutEffect that was causing focus to reset\r\n\r\n  // Global keyboard event listener\r\n  useEffect(() => {\r\n    if (visible) {\r\n      document.addEventListener('keydown', handleGlobalKeyDown, true);\r\n      return () =>\r\n        document.removeEventListener('keydown', handleGlobalKeyDown, true);\r\n    }\r\n  }, [visible, handleGlobalKeyDown]);\r\n\r\n  // Handle API responses using the standard pattern\r\n  useHandleApiResponse({\r\n    action: 'create',\r\n    title: 'Customer',\r\n    identifier: CustomerApi.getIdentifier('Create'),\r\n    entityApi: CustomerApi,\r\n  });\r\n\r\n  // Watch for successful customer creation and select the new customer\r\n  const { items: createResult } = useDynamicSelector(\r\n    CustomerApi.getIdentifier('Create')\r\n  );\r\n\r\n  // Watch createLoading state to show/hide loading message\r\n  useEffect(() => {\r\n    if (createLoading) {\r\n      // Show loading message when API call starts\r\n      message.loading({\r\n        content: 'Creating customer...',\r\n        key: 'customer-creation',\r\n        duration: 0,\r\n      });\r\n    } else {\r\n      // Hide loading message when API call completes\r\n      message.destroy('customer-creation');\r\n    }\r\n  }, [createLoading]);\r\n\r\n  useEffect(() => {\r\n    if (createResult) {\r\n      if (createResult.statusCode === 200) {\r\n        // Customer created successfully, get the new customer data\r\n        const newCustomer = createResult.data || createResult.result;\r\n\r\n        if (newCustomer) {\r\n          // message.success(\r\n          //   `Customer \"${newCustomer.full_name}\" created and selected successfully!`\r\n          // );\r\n\r\n          // Clear form data on success\r\n          clearFormData();\r\n          setShowAddForm(false);\r\n          setShowCreateGrid(false);\r\n\r\n          // Refresh the customer list to include the new customer\r\n          CustomerApi('GetAll');\r\n\r\n          // Auto-select the newly created customer\r\n          setTimeout(() => {\r\n            onSelect(newCustomer);\r\n            onCancel();\r\n          }, 100);\r\n        }\r\n      } else if (createResult.statusCode && createResult.statusCode !== 200) {\r\n        // Handle error case\r\n        message.error(createResult.message || 'Failed to create customer');\r\n        // Clear form data on error\r\n        clearFormData();\r\n      }\r\n    }\r\n  }, [createResult, onSelect, onCancel, CustomerApi, clearFormData]);\r\n\r\n  // Handle search input focus\r\n  const handleSearchFocus = useCallback(() => {\r\n    setSelectedCustomer(null);\r\n    setSelectedRowIndex(-1);\r\n  }, []);\r\n  return (\r\n    <Modal\r\n      title=\"Select Customer\"\r\n      open={visible}\r\n      onCancel={onCancel}\r\n      footer={null}\r\n      width={1000}\r\n      style={{ top: 20 }}\r\n      afterOpenChange={open => {\r\n        if (open && searchInputRef.current && !showAddForm && !showCreateGrid) {\r\n          setTimeout(() => {\r\n            searchInputRef.current?.focus();\r\n            searchInputRef.current?.select();\r\n          }, 100);\r\n        }\r\n      }}\r\n    >\r\n      <div\r\n        ref={modalRef}\r\n        style={{ marginBottom: 16 }}\r\n        onKeyDown={handleKeyDown}\r\n        tabIndex={0}\r\n      >\r\n        <Space.Compact style={{ width: '100%' }}>\r\n          <Input\r\n            ref={searchInputRef}\r\n            placeholder=\"Search customers... (Ctrl+N: New customer, : Navigate, Enter: Select, Esc: Close)\"\r\n            value={searchTerm}\r\n            onChange={e => handleSearch(e.target.value)}\r\n            prefix={<SearchOutlined />}\r\n            style={{ flex: 1 }}\r\n            onKeyDown={e => {\r\n              // Only handle Enter key in search input, let other keys bubble up\r\n              if (e.key === 'Enter' && selectedCustomer) {\r\n                handleCustomerSelect(selectedCustomer);\r\n              }\r\n            }}\r\n            onFocus={handleSearchFocus}\r\n            autoFocus={!showAddForm && !showCreateGrid}\r\n            onBlur={\r\n              !showAddForm && !showCreateGrid\r\n                ? () => {\r\n                    // Only auto-focus back to search if no forms are shown\r\n                    if (visible && searchInputRef.current) {\r\n                      setTimeout(() => {\r\n                        if (\r\n                          visible &&\r\n                          searchInputRef.current &&\r\n                          !showAddForm &&\r\n                          !showCreateGrid\r\n                        ) {\r\n                          searchInputRef.current.focus();\r\n                        }\r\n                      }, 10);\r\n                    }\r\n                  }\r\n                : undefined\r\n            }\r\n            suffix={\r\n              searchTerm && customerLoading ? (\r\n                <div style={{ fontSize: '12px', color: '#999' }}>\r\n                  Searching...\r\n                </div>\r\n              ) : null\r\n            }\r\n          />\r\n          <Button\r\n            type={showAddForm ? 'default' : 'primary'}\r\n            icon={<UserAddOutlined />}\r\n            onClick={() => {\r\n              const newState = !showAddForm;\r\n              setShowAddForm(newState);\r\n              if (!newState) {\r\n                // Clear form data when switching back to search mode\r\n                clearFormData();\r\n              }\r\n              // Focus will be handled by the useEffect when visible changes\r\n            }}\r\n            style={{ minWidth: 120 }}\r\n          >\r\n            {showAddForm ? 'Cancel' : 'Add New'}\r\n          </Button>\r\n        </Space.Compact>\r\n      </div>\r\n\r\n      {/* Unified Create Form - Shows when search has no results or when Add New is clicked */}\r\n      {(showCreateGrid || showAddForm) && (\r\n        <div\r\n          ref={createGridRef}\r\n          style={{\r\n            marginBottom: 20,\r\n            padding: 24,\r\n            border: '2px solid #6366f1',\r\n            borderRadius: 16,\r\n            backgroundColor:\r\n              'linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)',\r\n            background: 'linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)',\r\n            boxShadow:\r\n              '0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',\r\n            position: 'relative',\r\n            overflow: 'hidden',\r\n          }}\r\n          tabIndex={-1}\r\n        >\r\n          {/* Decorative background elements */}\r\n          <div\r\n            style={{\r\n              position: 'absolute',\r\n              top: -20,\r\n              right: -20,\r\n              width: 100,\r\n              height: 100,\r\n              borderRadius: '50%',\r\n              background: 'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',\r\n              opacity: 0.1,\r\n              zIndex: 0,\r\n            }}\r\n          />\r\n          <div\r\n            style={{\r\n              position: 'absolute',\r\n              bottom: -30,\r\n              left: -30,\r\n              width: 80,\r\n              height: 80,\r\n              borderRadius: '50%',\r\n              background: 'linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)',\r\n              opacity: 0.1,\r\n              zIndex: 0,\r\n            }}\r\n          />\r\n\r\n          <Row\r\n            justify=\"space-between\"\r\n            align=\"middle\"\r\n            style={{ marginBottom: 24, position: 'relative', zIndex: 1 }}\r\n          >\r\n            <Col>\r\n              <Title\r\n                level={4}\r\n                style={{\r\n                  margin: 0,\r\n                  background:\r\n                    'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',\r\n                  WebkitBackgroundClip: 'text',\r\n                  WebkitTextFillColor: 'transparent',\r\n                  backgroundClip: 'text',\r\n                  fontWeight: 700,\r\n                  fontSize: '20px',\r\n                }}\r\n              >\r\n                <PlusOutlined style={{ marginRight: 8, color: '#6366f1' }} />\r\n                Create New Customer\r\n              </Title>\r\n              <Text\r\n                style={{\r\n                  fontSize: '14px',\r\n                  color: '#64748b',\r\n                  fontWeight: 500,\r\n                  display: 'block',\r\n                  marginTop: 4,\r\n                }}\r\n              >\r\n                 Fill in the details below to create a new customer\r\n              </Text>\r\n            </Col>\r\n            <Col>\r\n              <Space size=\"middle\">\r\n                <Button\r\n                  size=\"middle\"\r\n                  icon={<CloseOutlined />}\r\n                  onClick={() => {\r\n                    setShowCreateGrid(false);\r\n                    setShowAddForm(false);\r\n                    CustomerApi('GetAll');\r\n                    clearFormData();\r\n                  }}\r\n                  style={{\r\n                    border: '2px solid #e2e8f0',\r\n                    borderRadius: 8,\r\n                    fontWeight: 600,\r\n                    color: '#64748b',\r\n                    background: 'white',\r\n                    boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\r\n                    height: 40,\r\n                    padding: '0 20px',\r\n                  }}\r\n                >\r\n                  Cancel\r\n                </Button>\r\n                <Button\r\n                  type=\"primary\"\r\n                  size=\"middle\"\r\n                  icon={<SaveOutlined />}\r\n                  onClick={handleCreateCustomerFromForm}\r\n                  loading={createLoading}\r\n                  style={{\r\n                    background:\r\n                      'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',\r\n                    border: 'none',\r\n                    borderRadius: 8,\r\n                    fontWeight: 600,\r\n                    height: 40,\r\n                    padding: '0 24px',\r\n                    boxShadow: '0 4px 12px rgba(99, 102, 241, 0.3)',\r\n                    transition: 'all 0.3s ease',\r\n                  }}\r\n                >\r\n                  Create & Select\r\n                </Button>\r\n              </Space>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Form\r\n            form={form}\r\n            layout=\"vertical\"\r\n            size=\"middle\"\r\n            style={{ position: 'relative', zIndex: 1 }}\r\n          >\r\n            <div\r\n              style={{\r\n                display: 'grid',\r\n                gridTemplateColumns: '1fr 1fr',\r\n                gap: 20,\r\n                marginBottom: 20,\r\n              }}\r\n            >\r\n              <Form.Item\r\n                name=\"full_name\"\r\n                label={\r\n                  <span\r\n                    style={{\r\n                      fontWeight: 600,\r\n                      color: '#374151',\r\n                      fontSize: '14px',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: 6,\r\n                    }}\r\n                  >\r\n                    <UserOutlined style={{ color: '#6366f1' }} />\r\n                    Full Name\r\n                  </span>\r\n                }\r\n                rules={[{ required: true, message: 'Please enter full name' }]}\r\n              >\r\n                <Input\r\n                  ref={firstFormInputRef}\r\n                  name=\"full_name\"\r\n                  placeholder=\"Enter full name\"\r\n                  prefix={<UserOutlined style={{ color: '#9ca3af' }} />}\r\n                  autoFocus={showAddForm || showCreateGrid}\r\n                  value={newCustomerData.full_name}\r\n                  onChange={e =>\r\n                    handleFormFieldChange('full_name', e.target.value)\r\n                  }\r\n                  onKeyDown={e => {\r\n                    if (e.key === 'Enter') {\r\n                      e.preventDefault();\r\n                      handleCreateCustomerFromForm();\r\n                    }\r\n                  }}\r\n                  style={{\r\n                    borderRadius: 10,\r\n                    border: '2px solid #e5e7eb',\r\n                    padding: '12px 16px',\r\n                    fontSize: '14px',\r\n                    transition: 'all 0.3s ease',\r\n                    boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\r\n                    background: 'white',\r\n                  }}\r\n                />\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                name=\"mobile\"\r\n                label={\r\n                  <span\r\n                    style={{\r\n                      fontWeight: 600,\r\n                      color: '#374151',\r\n                      fontSize: '14px',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: 6,\r\n                    }}\r\n                  >\r\n                    <PhoneOutlined style={{ color: '#10b981' }} />\r\n                    Mobile Number\r\n                  </span>\r\n                }\r\n                rules={[\r\n                  { required: true, message: 'Please enter mobile number' },\r\n                  {\r\n                    pattern: /^[0-9]{10}$/,\r\n                    message: 'Mobile must be 10 digits',\r\n                  },\r\n                ]}\r\n              >\r\n                <Input\r\n                  name=\"mobile\"\r\n                  placeholder=\"Enter mobile number\"\r\n                  prefix={<PhoneOutlined style={{ color: '#9ca3af' }} />}\r\n                  value={newCustomerData.mobile}\r\n                  onChange={e =>\r\n                    handleFormFieldChange('mobile', e.target.value)\r\n                  }\r\n                  onKeyDown={e => {\r\n                    if (e.key === 'Enter') {\r\n                      e.preventDefault();\r\n                      handleCreateCustomerFromForm();\r\n                    }\r\n                  }}\r\n                  style={{\r\n                    borderRadius: 10,\r\n                    border: '2px solid #e5e7eb',\r\n                    padding: '12px 16px',\r\n                    fontSize: '14px',\r\n                    transition: 'all 0.3s ease',\r\n                    boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\r\n                    background: 'white',\r\n                  }}\r\n                />\r\n              </Form.Item>\r\n\r\n              <Form.Item\r\n                name=\"email\"\r\n                label={\r\n                  <span\r\n                    style={{\r\n                      fontWeight: 600,\r\n                      color: '#374151',\r\n                      fontSize: '14px',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: 6,\r\n                    }}\r\n                  >\r\n                    <MailOutlined style={{ color: '#f59e0b' }} />\r\n                    Email\r\n                  </span>\r\n                }\r\n                rules={[{ type: 'email', message: 'Please enter valid email' }]}\r\n              >\r\n                <Input\r\n                  name=\"email\"\r\n                  placeholder=\"Enter email\"\r\n                  prefix={<MailOutlined style={{ color: '#9ca3af' }} />}\r\n                  value={newCustomerData.email}\r\n                  onChange={e => handleFormFieldChange('email', e.target.value)}\r\n                  onKeyDown={e => {\r\n                    if (e.key === 'Enter') {\r\n                      e.preventDefault();\r\n                      handleCreateCustomerFromForm();\r\n                    }\r\n                  }}\r\n                  style={{\r\n                    borderRadius: 10,\r\n                    border: '2px solid #e5e7eb',\r\n                    padding: '12px 16px',\r\n                    fontSize: '14px',\r\n                    transition: 'all 0.3s ease',\r\n                    boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\r\n                    background: 'white',\r\n                  }}\r\n                />\r\n              </Form.Item>\r\n\r\n              {/* <Form.Item\r\n                name=\"customer_type\"\r\n                label={\r\n                  <span\r\n                    style={{\r\n                      fontWeight: 600,\r\n                      color: '#374151',\r\n                      fontSize: '14px',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      gap: 6,\r\n                    }}\r\n                  >\r\n                    <Tag\r\n                      style={{\r\n                        background:\r\n                          'linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)',\r\n                        color: 'white',\r\n                        border: 'none',\r\n                        borderRadius: 6,\r\n                        padding: '2px 8px',\r\n                        fontSize: '10px',\r\n                        fontWeight: 600,\r\n                      }}\r\n                    >\r\n                      TYPE\r\n                    </Tag>\r\n                    Customer Type\r\n                  </span>\r\n                }\r\n                initialValue=\"regular\"\r\n              >\r\n                <Select\r\n                  value={newCustomerData.customer_type}\r\n                  onChange={value =>\r\n                    handleFormFieldChange('customer_type', value)\r\n                  }\r\n                  onKeyDown={e => {\r\n                    if (e.key === 'Enter') {\r\n                      e.preventDefault();\r\n                      handleCreateCustomerFromForm();\r\n                    }\r\n                  }}\r\n                  style={{\r\n                    borderRadius: 10,\r\n                    border: '2px solid #e5e7eb',\r\n                    fontSize: '14px',\r\n                    transition: 'all 0.3s ease',\r\n                    boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\r\n                    background: 'white',\r\n                  }}\r\n                >\r\n                  <Option value=\"regular\">Regular</Option>\r\n                  <Option value=\"vip\">VIP</Option>\r\n                  <Option value=\"wholesale\">Wholesale</Option>\r\n                </Select>\r\n              </Form.Item> */}\r\n            </div>\r\n\r\n            <Form.Item\r\n              name=\"address\"\r\n              label={\r\n                <span\r\n                  style={{\r\n                    fontWeight: 600,\r\n                    color: '#374151',\r\n                    fontSize: '14px',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    gap: 6,\r\n                  }}\r\n                >\r\n                  <HomeOutlined style={{ color: '#ef4444' }} />\r\n                  Address\r\n                </span>\r\n              }\r\n            >\r\n              <Input.TextArea\r\n                name=\"address\"\r\n                placeholder=\"Enter address\"\r\n                rows={3}\r\n                value={newCustomerData.address}\r\n                onChange={e => handleFormFieldChange('address', e.target.value)}\r\n                onKeyDown={e => {\r\n                  if (e.key === 'Enter') {\r\n                    e.preventDefault();\r\n                    // If it's the last field, create the customer\r\n                    handleCreateCustomerFromForm();\r\n                  }\r\n                }}\r\n                style={{\r\n                  borderRadius: 10,\r\n                  border: '2px solid #e5e7eb',\r\n                  padding: '12px 16px',\r\n                  fontSize: '14px',\r\n                  transition: 'all 0.3s ease',\r\n                  boxShadow: '0 2px 4px rgba(0, 0, 0, 0.05)',\r\n                  background: 'white',\r\n                  resize: 'none',\r\n                }}\r\n              />\r\n            </Form.Item>\r\n          </Form>\r\n        </div>\r\n      )}\r\n\r\n      <Divider style={{ margin: '16px 0' }} />\r\n\r\n      <div style={{ maxHeight: 400, overflow: 'auto' }}>\r\n        {customerLoading ? (\r\n          <div style={{ textAlign: 'center', padding: 40 }}>\r\n            <Text>Loading customers...</Text>\r\n          </div>\r\n        ) : filteredCustomers.length === 0 ? (\r\n          <div style={{ textAlign: 'center', padding: 40 }}>\r\n            <Text type=\"secondary\">\r\n              {searchTerm\r\n                ? 'No customers found matching your search.'\r\n                : 'No customers available.'}\r\n            </Text>\r\n            {searchTerm && (\r\n              <div style={{ marginTop: 16 }}>\r\n                <Text type=\"secondary\">\r\n                  Press Ctrl+N to create a new customer instantly\r\n                </Text>\r\n              </div>\r\n            )}\r\n          </div>\r\n        ) : (\r\n          <Table\r\n            columns={columns}\r\n            dataSource={filteredCustomers}\r\n            rowKey=\"_id\"\r\n            pagination={false}\r\n            size=\"small\"\r\n            scroll={{ y: 300 }}\r\n            onRow={getRowProps}\r\n          />\r\n        )}\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\n// Memoize the component to prevent unnecessary re-renders\r\nconst CustomerSelectionModal = React.memo(CustomerSelectionModalComponent);\r\nexport default CustomerSelectionModal;\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport {\r\n  Table,\r\n  Input,\r\n  InputNumber,\r\n  Select,\r\n  DatePicker,\r\n  Button,\r\n  Space,\r\n  Modal,\r\n  Typography,\r\n  message,\r\n  TableProps,\r\n} from 'antd';\r\nimport type { SizeType } from 'antd/es/config-provider/SizeContext';\r\nimport { PlusOutlined, DeleteOutlined, SaveOutlined } from '@ant-design/icons';\r\nimport dayjs from 'dayjs';\r\nimport './AntdEditableTable.css';\r\nimport ProductSelectionModal from '../../pages/RetaillBill/components/ProductSelectionModal';\r\nimport StockSelectionModal from '../../pages/RetaillBill/components/StockSelectionModal';\r\n\r\nconst { Text } = Typography;\r\n\r\nexport interface AntdEditableColumn {\r\n  title: string;\r\n  dataIndex: string;\r\n  key?: string;\r\n  defaultValue?: any;\r\n  type?: 'text' | 'number' | 'select' | 'date' | 'product' | 'stock';\r\n  options?: { label: string; value: any }[];\r\n  required?: boolean;\r\n  width?: number;\r\n  editable?: boolean;\r\n  validation?: (value: any) => string | undefined;\r\n  render?: (value: any, record?: any, rowIndex?: number) => React.ReactNode;\r\n}\r\n\r\nexport interface AntdEditableTableProps {\r\n  columns: AntdEditableColumn[];\r\n  dataSource: any[];\r\n  onSave: (data: any[]) => void;\r\n  onAdd?: () => void;\r\n  onDelete?: (indices: number[]) => void;\r\n  onProductSelect?: (product: any, rowIndex: number) => void;\r\n  allowAdd?: boolean;\r\n  allowDelete?: boolean;\r\n  rowKey?: string;\r\n  loading?: boolean;\r\n  compact?: boolean;\r\n  enableKeyboardNav?: boolean;\r\n  size?: SizeType;\r\n  className?: string;\r\n  externalEditingCell?: { row: number; col: number } | null;\r\n}\r\n\r\nconst AntdEditableTable: React.FC<AntdEditableTableProps> = ({\r\n  columns,\r\n  dataSource,\r\n  onSave,\r\n  onAdd,\r\n  onDelete,\r\n  allowAdd = true,\r\n  allowDelete = true,\r\n  rowKey = 'key',\r\n  loading = false,\r\n  compact = false,\r\n  enableKeyboardNav = true,\r\n  size = 'middle',\r\n  className,\r\n  onProductSelect,\r\n  externalEditingCell,\r\n}) => {\r\n  const [data, setData] = useState<any[]>([]);\r\n  const [selectedRows, setSelectedRows] = useState<any[]>([]);\r\n  const [editingCell, setEditingCell] = useState<{\r\n    row: number;\r\n    col: number;\r\n  } | null>(null);\r\n  const firstLoadRef = useRef(true);\r\n\r\n  useEffect(() => {\r\n    setData(dataSource);\r\n\r\n    const firstProductColIndex = columns.findIndex(\r\n      col => col.dataIndex === 'product_id'\r\n    );\r\n\r\n    //  Auto-focus only if table is empty on first load\r\n    if (\r\n      firstLoadRef.current &&\r\n      dataSource.length === 0 &&\r\n      firstProductColIndex >= 0\r\n    ) {\r\n      setEditingCell({ row: 0, col: firstProductColIndex });\r\n      firstLoadRef.current = false; // Prevent repeat auto-focus\r\n    }else{\r\n      setSelectedRows(dataSource.length>0?[String(dataSource.length-1)]:[])\r\n    }\r\n  }, [dataSource, columns]);\r\n\r\n  // Sync editingCell with externalEditingCell prop\r\n  useEffect(() => {\r\n    if (externalEditingCell) {\r\n      setEditingCell(externalEditingCell);\r\n    }\r\n  }, [externalEditingCell]);\r\n\r\n  const handleAddRow = () => {\r\n    onAdd?.();\r\n    // Set focus to the first editable cell of the new row (after parent updates data)\r\n    const firstEditableCol = columns.findIndex(col => col.editable !== false);\r\n    if (firstEditableCol >= 0) {\r\n      setEditingCell({ row: data.length, col: firstEditableCol });\r\n    }\r\n  };\r\n\r\n  const handleDeleteRow = () => {\r\n    if (data.length === 0) {\r\n      message.warning('No rows to delete');\r\n      return;\r\n    }\r\n    Modal.confirm({\r\n      title: 'Are you sure you want to delete the selected Bill Items?',\r\n      onOk: () => {\r\n        const newData = data.slice(0, -1);\r\n        setData(newData);\r\n        onSave(newData);\r\n        onDelete?.(selectedRows);\r\n      },\r\n    });\r\n  };\r\n\r\n  const saveCell = (row: number, col: number, value: any): boolean => {\r\n    const column = columns[col];\r\n\r\n    // Basic validation\r\n    if (column.required && (!value || value === '')) {\r\n      message.error(`${column.title} is required`);\r\n      return false;\r\n    }\r\n\r\n    // Custom validation\r\n    if (column.validation) {\r\n      const error = column.validation(value);\r\n      if (error) {\r\n        message.error(error);\r\n        return false;\r\n      }\r\n    }\r\n\r\n    const newData = [...data];\r\n    newData[row][columns[col].dataIndex] = value;\r\n    setData(newData);\r\n    onSave(newData);\r\n    return true;\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleKeyDown = (e: KeyboardEvent) => {\r\n      if (e.ctrlKey && e.key === 's') {\r\n        e.preventDefault();\r\n        onSave(data);\r\n      }\r\n      if (e.shiftKey && e.key.toLowerCase() === 'a' && allowAdd) {\r\n        e.preventDefault();\r\n        handleAddRow();\r\n      }\r\n    };\r\n    if (enableKeyboardNav) {\r\n      document.addEventListener('keydown', handleKeyDown);\r\n      return () => document.removeEventListener('keydown', handleKeyDown);\r\n    }\r\n  }, [data, allowAdd, onSave, enableKeyboardNav, handleAddRow]);\r\n\r\n  const rowSelection: TableProps<any>['rowSelection'] = {\r\n    onChange: (selectedRowKeys: React.Key[], selectedRows:any[]) => {\r\n      setSelectedRows([...selectedRowKeys]);\r\n    },\r\n  };\r\n  \r\n  // Helper to find the next editable column index\r\n  function getNextEditableCol(startCol: number, direction: 1 | -1, columns: AntdEditableColumn[]): number {\r\n    let col = startCol + direction;\r\n    while (col >= 0 && col < columns.length) {\r\n      if (columns[col].editable !== false) return col;\r\n      col += direction;\r\n    }\r\n    return -1; // No editable column found\r\n  }\r\n\r\n  const EditableCell = ({\r\n    row,\r\n    col,\r\n    value,\r\n  }: {\r\n    row: number;\r\n    col: number;\r\n    value: any;\r\n  }) => {\r\n    const [cellValue, setCellValue] = useState(value);\r\n    const inputRef = useRef<any>(null);\r\n    const column = columns[col];\r\n    const [isProductModalVisible, setIsProductModalVisible] = useState(false);\r\n    const [isStockModalVisible, setIsStockModalVisible] = useState(false);\r\n\r\n    useEffect(() => {\r\n      setCellValue(value);\r\n      //  Focus input/select when cell enters edit mode\r\n      setTimeout(() => {\r\n        inputRef.current?.focus();\r\n      }, 50);\r\n    }, [value]);\r\n\r\n    const handleChange = (val: any) => {\r\n      setCellValue(val);\r\n      saveCell(row, col, val);\r\n    };\r\n\r\n    const handleKeyDown = (e: React.KeyboardEvent) => {\r\n      if (column.type === 'product' && e.key === 'Enter') {\r\n        e.stopPropagation();\r\n        setIsProductModalVisible(true);\r\n        return; // Do not validate or move cell yet!\r\n      }\r\n      if (column.type === 'stock' && e.key === 'Enter') {\r\n        e.stopPropagation();\r\n        setIsStockModalVisible(true);\r\n        return;\r\n      }\r\n      if (e.key === 'Tab') {\r\n        e.preventDefault();\r\n        // Only validate on Tab\r\n        if (column.required && (!cellValue || cellValue === '')) {\r\n          message.error(`${column.title} is required`);\r\n          return;\r\n        }\r\n        const nextCol = e.shiftKey ? col - 1 : col + 1;\r\n        const nextRow = row + (nextCol >= columns.length ? 1 : 0);\r\n        const colIndex = (nextCol + columns.length) % columns.length;\r\n        if (nextRow < data.length) {\r\n          setEditingCell({ row: nextRow, col: colIndex });\r\n        } else if (allowAdd) {\r\n          handleAddRow();\r\n          setEditingCell({ row: data.length, col: colIndex });\r\n        }\r\n      } else if (e.key === 'Escape') {\r\n        setEditingCell(null);\r\n      }\r\n    };\r\n\r\n    const handleProductSelect = (product: any) => {\r\n      if (onProductSelect) {\r\n        onProductSelect(product, row);\r\n      }\r\n      setIsProductModalVisible(false);\r\n      setEditingCell(null);\r\n    };\r\n\r\n    const handleStockSelect = (stock: any) => {\r\n      // Set stock_id and batch_no in the row\r\n      const newData = [...data];\r\n      newData[row].stock_id = stock.id || stock._id || '';\r\n      newData[row].batch_no = stock.batch_no || '';\r\n      setData(newData);\r\n      onSave(newData);\r\n      setIsStockModalVisible(false);\r\n      setEditingCell(null);\r\n    };\r\n\r\n    switch (column.type) {\r\n      case 'product':\r\n        return (\r\n          <>\r\n            <div onClick={e => e.stopPropagation()}>\r\n              <Input\r\n                ref={inputRef}\r\n                value={cellValue}\r\n                onKeyDown={handleKeyDown}\r\n                placeholder=\"Press Enter to select product\"\r\n              />\r\n            </div>\r\n            {isProductModalVisible && (\r\n              <ProductSelectionModal\r\n                visible={isProductModalVisible}\r\n                onSelect={handleProductSelect}\r\n                onCancel={() => setIsProductModalVisible(false)}\r\n              />\r\n            )}\r\n          </>\r\n        );\r\n      case 'stock':\r\n        return (\r\n          <>\r\n            <div onClick={e => e.stopPropagation()}>\r\n              <Input\r\n                ref={inputRef}\r\n                value={data[row]?.batch_no || cellValue}\r\n                onKeyDown={handleKeyDown}\r\n                placeholder=\"Press Enter to select stock\"\r\n                readOnly\r\n              />\r\n            </div>\r\n            {isStockModalVisible && (\r\n              <StockSelectionModal\r\n                visible={isStockModalVisible}\r\n                onSelect={handleStockSelect}\r\n                onCancel={() => setIsStockModalVisible(false)}\r\n                productId={data[row]?.product_id || ''}\r\n              />\r\n            )}\r\n          </>\r\n        );\r\n      case 'number':\r\n        return (\r\n          <div onClick={e => e.stopPropagation()}>\r\n            <InputNumber\r\n              ref={inputRef}\r\n              value={cellValue}\r\n              onChange={handleChange}\r\n              onBlur={() => setEditingCell(null)}\r\n              controls={false}\r\n              onKeyDown={e => {\r\n                // Allow Enter/Tab to move to next editable cell\r\n                if (e.key === 'Tab' || e.key === 'Enter') {\r\n                  e.preventDefault();\r\n                  // Only validate on Tab or Enter\r\n                  if (column.required && (!cellValue || cellValue === '')) {\r\n                    message.error(`${column.title} is required`);\r\n                    return;\r\n                  }\r\n                  const direction = e.shiftKey ? -1 : 1;\r\n                  const nextCol = getNextEditableCol(col, direction, columns);\r\n                  if (nextCol !== -1) {\r\n                    setEditingCell({ row, col: nextCol });\r\n                  } else {\r\n                    // Move to next/previous row's first editable cell\r\n                    const nextRow = direction > 0 ? row + 1 : row - 1;\r\n                    if (nextRow >= 0 && nextRow < data.length) {\r\n                      const firstEditableCol = getNextEditableCol(-1, 1, columns);\r\n                      if (firstEditableCol !== -1) {\r\n                        setEditingCell({ row: nextRow, col: firstEditableCol });\r\n                      }\r\n                    } else if (direction > 0 && allowAdd) {\r\n                      // Add new row if moving forward and at the end\r\n                      handleAddRow();\r\n                      const firstEditableCol = getNextEditableCol(-1, 1, columns);\r\n                      if (firstEditableCol !== -1) {\r\n                        setEditingCell({ row: data.length, col: firstEditableCol });\r\n                      }\r\n                    } else {\r\n                      // Exit edit mode if no more rows\r\n                      setEditingCell(null);\r\n                    }\r\n                  }\r\n                } else if (e.key === 'Escape') {\r\n                  setEditingCell(null);\r\n                }\r\n              }}\r\n              style={{ width: '100%' }}\r\n            />\r\n          </div>\r\n        );\r\n      case 'select':\r\n        return (\r\n          <div onClick={e => e.stopPropagation()}>\r\n            <Select\r\n              ref={inputRef}\r\n              value={cellValue}\r\n              options={column.options}\r\n              onChange={val => {\r\n                const success = saveCell(row, col, val);\r\n                if (success) {\r\n                  // Move to next editable cell\r\n                  const nextCol = col + 1;\r\n                  const nextRow = row + (nextCol >= columns.length ? 1 : 0);\r\n                  const colIndex = (nextCol + columns.length) % columns.length;\r\n\r\n                  if (nextRow < data.length) {\r\n                    setEditingCell({ row: nextRow, col: colIndex });\r\n                  } else if (allowAdd) {\r\n                    handleAddRow();\r\n                    setEditingCell({ row: data.length, col: colIndex });\r\n                  }\r\n                }else {\r\n                  // Validation failed; keep focus\r\n                  setTimeout(() => {\r\n                    inputRef.current?.focus();\r\n                  }, 50);\r\n                }\r\n              }}\r\n              style={{ width: '100%' }}\r\n              onKeyDown={e => {\r\n                if (e.key === 'Enter' || e.key === 'Tab') {\r\n                  e.preventDefault(); // Block default key behavior\r\n                }\r\n              }}\r\n            />\r\n          </div>\r\n        );\r\n\r\n      case 'date':\r\n        return (\r\n          <div onClick={e => e.stopPropagation()}>\r\n            <DatePicker\r\n              ref={inputRef}\r\n              value={cellValue ? dayjs(cellValue) : null}\r\n              onChange={date => {\r\n                handleChange(date ? date.format('YYYY-MM-DD') : null);\r\n                setEditingCell(null);\r\n              }}\r\n              onBlur={() => setEditingCell(null)}\r\n              onKeyDown={handleKeyDown}\r\n              style={{ width: '100%' }}\r\n            />\r\n          </div>\r\n        );\r\n      default:\r\n        return (\r\n          <div onClick={e => e.stopPropagation()}>\r\n            <Input\r\n              ref={inputRef}\r\n              value={cellValue}\r\n              onChange={e => handleChange(e.target.value)}\r\n              onBlur={() => setEditingCell(null)}\r\n              onKeyDown={handleKeyDown}\r\n            />\r\n          </div>\r\n        );\r\n    }\r\n  };\r\n\r\n  const mergedColumns = columns.map((col, colIndex) => ({\r\n    ...col,\r\n    onCell: (_record: any, rowIndex?: number) => ({\r\n      onClick: () => {\r\n        if (typeof rowIndex === 'number') {\r\n          setEditingCell({ row: rowIndex, col: colIndex });\r\n        }\r\n      },\r\n      onContextMenu: (e: React.MouseEvent) => {\r\n        e.preventDefault(); //  Prevent default context menu\r\n        if (typeof rowIndex === 'number') {\r\n          setEditingCell({ row: rowIndex, col: colIndex });\r\n        }\r\n      },\r\n    }),\r\n    render: (val: any, record: any, rowIndex: number) => {\r\n      if (\r\n        editingCell &&\r\n        editingCell.row === rowIndex &&\r\n        editingCell.col === colIndex\r\n      ) {\r\n        return (\r\n          <EditableCell\r\n            key={`${rowIndex}-${colIndex}`}\r\n            row={rowIndex}\r\n            col={colIndex}\r\n            value={record[col.dataIndex]}\r\n          />\r\n        );\r\n      }\r\n      // Use custom render if provided and not editing\r\n      if (typeof col.render === 'function') {\r\n        return col.render(val, record, rowIndex);\r\n      }\r\n      // Show batch_no for stock_id column when not editing\r\n      if (col.dataIndex === 'batch_no') {\r\n        return record.batch_no || record[col.dataIndex];\r\n      }\r\n      // Show product_name for product_id column when not editing\r\n      if (col.dataIndex === 'product_id') {\r\n        return record.product_name || record[col.dataIndex];\r\n      }\r\n      if (col.type === 'select' && col.options) {\r\n        const option = col.options.find(\r\n          opt => opt.value === record[col.dataIndex]\r\n        );\r\n        return option ? option.label : record[col.dataIndex];\r\n      }\r\n      return record[col.dataIndex];\r\n    },\r\n  }));\r\n\r\n  return (\r\n    <div\r\n      className={`antd-editable-table ${compact ? 'compact' : ''} ${\r\n        className || ''\r\n      }`}\r\n    >\r\n      <div className=\"table-toolbar\">\r\n        <Space>\r\n          {allowAdd && (\r\n            <Button\r\n              type=\"primary\"\r\n              icon={<PlusOutlined />}\r\n              onClick={handleAddRow}\r\n            >\r\n              Add Row (Shift+A)\r\n            </Button>\r\n          )}\r\n          {allowDelete && (\r\n            <Button danger icon={<DeleteOutlined />} onClick={handleDeleteRow}>\r\n              Delete Row\r\n            </Button>\r\n          )}\r\n          <Button\r\n            type=\"primary\"\r\n            icon={<SaveOutlined />}\r\n            onClick={() => onSave(data)}\r\n          >\r\n            Save (Ctrl+S)\r\n          </Button>\r\n        </Space>\r\n        <Text type=\"secondary\" className=\"table-info\">\r\n          Use Tab / Shift+Tab to navigate cells\r\n        </Text>\r\n      </div>\r\n      <Table\r\n        bordered\r\n        dataSource={data}\r\n        columns={mergedColumns}\r\n        rowKey={rowKey}\r\n        loading={loading}\r\n        pagination={false}\r\n        size={size}\r\n        scroll={{ y: 400 }}\r\n        rowSelection={{...rowSelection,type:\"checkbox\",selectedRowKeys:selectedRows}}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AntdEditableTable;\r\n","import React, { useEffect, useState, FC, KeyboardEvent, useRef } from 'react';\r\nimport { Modal, Table, Input, Tag, Tooltip, message } from 'antd';\r\nimport type { InputRef } from 'antd/es/input';\r\nimport { useApiActions } from '../../../services/api/useApiActions';\r\nimport type { ColumnType } from 'antd/es/table';\r\nimport { useDynamicSelector } from '../../../services/redux';\r\nimport dayjs from 'dayjs';\r\nimport {\r\n  ExclamationCircleOutlined,\r\n  CheckCircleOutlined,\r\n} from '@ant-design/icons';\r\nimport type { Stock } from '../../../types/entities';\r\n\r\nconst { Search } = Input;\r\n\r\ninterface StockSelectionModalProps {\r\n  visible: boolean;\r\n  onSelect: (stock: {\r\n    id: string;\r\n    _id: string;\r\n    batch_no: string;\r\n    name: string;\r\n    code?: string;\r\n    available_quantity: number;\r\n    sell_price: number;\r\n  }) => void;\r\n  onCancel: () => void;\r\n  productId: string;\r\n}\r\n\r\nconst StockSelectionModal: FC<StockSelectionModalProps> = ({\r\n  visible,\r\n  onSelect,\r\n  onCancel,\r\n  productId, // <-- Destructure\r\n}) => {\r\n  const { getEntityApi } = useApiActions();\r\n  const StockApi = getEntityApi('StockAudit');\r\n  const { items: stocks, loading } = useDynamicSelector(\r\n    StockApi.getIdentifier('GetAll')\r\n  );\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedRowKey, setSelectedRowKey] = useState<React.Key | null>(null);\r\n  const [highlightedIndex, setHighlightedIndex] = useState<number>(0);\r\n  const [errorMessage, setErrorMessage] = useState<string>('');\r\n  const tableBodyRef = useRef<HTMLDivElement>(null);\r\n  const searchInputRef = useRef<InputRef>(null);\r\n\r\n  // Helper function to check if stock is expired\r\n  const isStockExpired = (stock: Stock): boolean => {\r\n    return !!(stock.expiry_date && dayjs(stock.expiry_date).isBefore(dayjs()));\r\n  };\r\n\r\n  // Helper function to check if stock has zero quantity\r\n  const isStockOutOfStock = (stock: Stock): boolean => {\r\n    return stock.available_quantity <= 0;\r\n  };\r\n\r\n  // Helper function to show expired stock error message\r\n  const showExpiredStockError = (stock: Stock) => {\r\n    const expiryDate = dayjs(stock.expiry_date).format('DD/MM/YYYY');\r\n    const errorMsg = `Cannot select expired stock! This item expired on ${expiryDate}. Please select a valid stock item.`;\r\n    setErrorMessage(errorMsg);\r\n    message.error(errorMsg);\r\n\r\n    // Clear error message after 5 seconds\r\n    setTimeout(() => {\r\n      setErrorMessage('');\r\n    }, 5000);\r\n  };\r\n\r\n  // Helper function to show out of stock error message\r\n  const showOutOfStockError = (stock: Stock) => {\r\n    const errorMsg = `Cannot select out of stock item! This item has 0 available quantity. Please select a stock item with available quantity.`;\r\n    setErrorMessage(errorMsg);\r\n    message.error(errorMsg);\r\n\r\n    // Clear error message after 5 seconds\r\n    setTimeout(() => {\r\n      setErrorMessage('');\r\n    }, 5000);\r\n  };\r\n\r\n  const filteredStocks: Stock[] =\r\n    stocks?.result?.filter((s: Stock) => {\r\n      const searchLower = searchTerm.toLowerCase();\r\n      return (\r\n        s.batch_no?.toLowerCase().includes(searchLower) ||\r\n        s.ProductItem?.name?.toLowerCase().includes(searchLower) ||\r\n        s.ProductItem?.VariantItem?.variant_name\r\n          ?.toLowerCase()\r\n          .includes(searchLower) ||\r\n        s.available_quantity?.toString().includes(searchLower) ||\r\n        s.sell_price?.toString().includes(searchLower)\r\n      );\r\n    }) || [];\r\n\r\n  // Show all stocks including expired ones, but disable selection of expired items\r\n  const allStocks = filteredStocks;\r\n\r\n  useEffect(() => {\r\n    setHighlightedIndex(0);\r\n    setErrorMessage(''); // Clear any existing error messages\r\n    if (allStocks.length > 0) {\r\n      // Find the first valid stock (not expired and not out of stock)\r\n      let firstValidIndex = 0;\r\n      while (\r\n        firstValidIndex < allStocks.length &&\r\n        ((allStocks[firstValidIndex].expiry_date &&\r\n          dayjs(allStocks[firstValidIndex].expiry_date).isBefore(dayjs())) ||\r\n          allStocks[firstValidIndex].available_quantity <= 0)\r\n      ) {\r\n        firstValidIndex++;\r\n      }\r\n      if (firstValidIndex < allStocks.length) {\r\n        setSelectedRowKey(allStocks[firstValidIndex]._id);\r\n        setHighlightedIndex(firstValidIndex);\r\n      } else {\r\n        setSelectedRowKey(null);\r\n      }\r\n    } else {\r\n      setSelectedRowKey(null);\r\n    }\r\n  }, [searchTerm, visible, stocks]);\r\n\r\n  useEffect(() => {\r\n    if (visible) {\r\n      setErrorMessage(''); // Clear error messages when modal opens\r\n      setTimeout(() => {\r\n        searchInputRef.current?.focus();\r\n      }, 0);\r\n    }\r\n  }, [visible]);\r\n\r\n  useEffect(() => {\r\n    if (tableBodyRef.current) {\r\n      const row = tableBodyRef.current.querySelector(\r\n        `.ant-table-row[data-row-key='${allStocks[highlightedIndex]?._id}']`\r\n      ) as HTMLElement;\r\n      row?.scrollIntoView({ block: 'nearest' });\r\n    }\r\n  }, [highlightedIndex, allStocks]);\r\n\r\n  useEffect(() => {\r\n    if (visible && productId) {\r\n      StockApi('GetAll', { product: productId });\r\n    }\r\n  }, [visible, productId, StockApi]);\r\n\r\n  const columns: ColumnType<Stock>[] = [\r\n    {\r\n      title: 'Product',\r\n      dataIndex: 'ProductItem',\r\n      key: 'product',\r\n      render: (ProductItem: any) => ProductItem?.name || 'N/A',\r\n    },\r\n    {\r\n      title: 'Variant',\r\n      dataIndex: 'ProductItem',\r\n      key: 'variant',\r\n      render: (ProductItem: any) =>\r\n        ProductItem?.VariantItem?.variant_name || 'N/A',\r\n    },\r\n    { title: 'Batch No', dataIndex: 'batch_no', key: 'batch_no' },\r\n    {\r\n      title: 'Available',\r\n      dataIndex: 'available_quantity',\r\n      key: 'available_quantity',\r\n      render: (available_quantity: number, record: Stock) => {\r\n        const isOutOfStock = available_quantity <= 0;\r\n        return (\r\n          <span\r\n            style={{\r\n              color: isOutOfStock ? '#ff4d4f' : '#52c41a',\r\n              fontWeight: isOutOfStock ? 'bold' : 'normal',\r\n            }}\r\n          >\r\n            {available_quantity}\r\n            {isOutOfStock && (\r\n              <ExclamationCircleOutlined\r\n                style={{ marginLeft: 4, color: '#ff4d4f' }}\r\n              />\r\n            )}\r\n          </span>\r\n        );\r\n      },\r\n    },\r\n    { title: 'Price', dataIndex: 'sell_price', key: 'sell_price' },\r\n    {\r\n      title: 'Expiry Date',\r\n      dataIndex: 'expiry_date',\r\n      key: 'expiry_date',\r\n      render: (expiry_date: string, record: Stock) => {\r\n        if (!expiry_date)\r\n          return <span style={{ color: '#999' }}>No Expiry</span>;\r\n\r\n        const expiryDate = dayjs(expiry_date);\r\n        const today = dayjs();\r\n        const isExpired = expiryDate.isBefore(today);\r\n        const daysUntilExpiry = expiryDate.diff(today, 'days');\r\n\r\n        let color = 'green';\r\n        let icon = <CheckCircleOutlined />;\r\n        let status = 'Valid';\r\n\r\n        if (isExpired) {\r\n          color = 'red';\r\n          icon = <ExclamationCircleOutlined />;\r\n          status = 'Expired';\r\n        } else if (daysUntilExpiry <= 30) {\r\n          color = 'orange';\r\n          icon = <ExclamationCircleOutlined />;\r\n          status = `Expires in ${daysUntilExpiry} days`;\r\n        }\r\n\r\n        return (\r\n          <Tooltip title={status}>\r\n            <Tag color={color} icon={icon}>\r\n              {expiryDate.format('DD/MM/YYYY')}\r\n            </Tag>\r\n          </Tooltip>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n\r\n  const handleSelectRow = (stock: Stock) => {\r\n    // Check if stock is expired and show error message\r\n    if (isStockExpired(stock)) {\r\n      showExpiredStockError(stock);\r\n      return;\r\n    }\r\n\r\n    // Check if stock is out of stock and show error message\r\n    if (isStockOutOfStock(stock)) {\r\n      showOutOfStockError(stock);\r\n      return;\r\n    }\r\n\r\n    // Clear any existing error message\r\n    setErrorMessage('');\r\n\r\n    onSelect({\r\n      id: stock._id,\r\n      _id: stock._id,\r\n      batch_no: stock.batch_no,\r\n      name: stock.ProductItem?.name || stock.name || '',\r\n      code: stock.code,\r\n      available_quantity: stock.available_quantity,\r\n      sell_price: stock.sell_price,\r\n    });\r\n  };\r\n\r\n  const handleSearchKeyDown = (e: KeyboardEvent<HTMLInputElement>) => {\r\n    if (!allStocks.length) return;\r\n\r\n    if (e.key === 'ArrowDown') {\r\n      e.preventDefault();\r\n      setHighlightedIndex(prev => {\r\n        let next = prev + 1;\r\n        // Skip over expired and out-of-stock items\r\n        while (\r\n          next < allStocks.length &&\r\n          ((allStocks[next].expiry_date &&\r\n            dayjs(allStocks[next].expiry_date).isBefore(dayjs())) ||\r\n            allStocks[next].available_quantity <= 0)\r\n        ) {\r\n          next++;\r\n        }\r\n        const finalNext = Math.min(next, allStocks.length - 1);\r\n        setSelectedRowKey(allStocks[finalNext]._id);\r\n        return finalNext;\r\n      });\r\n      // Keep focus on search input\r\n      searchInputRef.current?.focus();\r\n    } else if (e.key === 'ArrowUp') {\r\n      e.preventDefault();\r\n      setHighlightedIndex(prev => {\r\n        let prevIndex = prev - 1;\r\n        // Skip over expired and out-of-stock items\r\n        while (\r\n          prevIndex >= 0 &&\r\n          ((allStocks[prevIndex].expiry_date &&\r\n            dayjs(allStocks[prevIndex].expiry_date).isBefore(dayjs())) ||\r\n            allStocks[prevIndex].available_quantity <= 0)\r\n        ) {\r\n          prevIndex--;\r\n        }\r\n        const finalPrev = Math.max(prevIndex, 0);\r\n        setSelectedRowKey(allStocks[finalPrev]._id);\r\n        return finalPrev;\r\n      });\r\n      // Keep focus on search input\r\n      searchInputRef.current?.focus();\r\n    } else if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      const selectedStock = allStocks[highlightedIndex];\r\n      if (selectedStock) {\r\n        handleSelectRow(selectedStock);\r\n        // Only close modal if selection was successful (not expired and not out of stock)\r\n        if (\r\n          !isStockExpired(selectedStock) &&\r\n          !isStockOutOfStock(selectedStock)\r\n        ) {\r\n          onCancel(); // Close the modal after selection\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleTableKeyDown = (e: KeyboardEvent<HTMLDivElement>) => {\r\n    if (!allStocks.length) return;\r\n\r\n    if (e.key === 'ArrowDown') {\r\n      e.preventDefault();\r\n      setHighlightedIndex(i => {\r\n        let next = i + 1;\r\n        // Skip over expired and out-of-stock items\r\n        while (\r\n          next < allStocks.length &&\r\n          ((allStocks[next].expiry_date &&\r\n            dayjs(allStocks[next].expiry_date).isBefore(dayjs())) ||\r\n            allStocks[next].available_quantity <= 0)\r\n        ) {\r\n          next++;\r\n        }\r\n        const finalNext = Math.min(next, allStocks.length - 1);\r\n        setSelectedRowKey(allStocks[finalNext]._id);\r\n        return finalNext;\r\n      });\r\n      // Keep focus on search input\r\n      searchInputRef.current?.focus();\r\n    } else if (e.key === 'ArrowUp') {\r\n      e.preventDefault();\r\n      setHighlightedIndex(i => {\r\n        let prev = i - 1;\r\n        // Skip over expired and out-of-stock items\r\n        while (\r\n          prev >= 0 &&\r\n          ((allStocks[prev].expiry_date &&\r\n            dayjs(allStocks[prev].expiry_date).isBefore(dayjs())) ||\r\n            allStocks[prev].available_quantity <= 0)\r\n        ) {\r\n          prev--;\r\n        }\r\n        const finalPrev = Math.max(prev, 0);\r\n        setSelectedRowKey(allStocks[finalPrev]._id);\r\n        return finalPrev;\r\n      });\r\n      // Keep focus on search input\r\n    } else if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      const selectedStock = allStocks[highlightedIndex];\r\n      if (selectedStock) {\r\n        handleSelectRow(selectedStock);\r\n        // Only close modal if selection was successful (not expired and not out of stock)\r\n        if (\r\n          !isStockExpired(selectedStock) &&\r\n          !isStockOutOfStock(selectedStock)\r\n        ) {\r\n          onCancel(); // Close the modal after selection\r\n        }\r\n      }\r\n    } else if (e.key === 'Escape') {\r\n      e.preventDefault();\r\n      searchInputRef.current?.focus();\r\n    } else if (e.key === 'Tab' && e.shiftKey) {\r\n      e.preventDefault();\r\n      searchInputRef.current?.focus();\r\n    }\r\n  };\r\n\r\n  // Auto-focus back to search input when clicking outside\r\n  const handleModalClick = () => {\r\n    searchInputRef.current?.focus();\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      title=\"Select Stock (F7 to reopen anytime)\"\r\n      open={visible}\r\n      onCancel={onCancel}\r\n      width={800}\r\n      footer={null}\r\n      destroyOnClose\r\n    >\r\n      <div onClick={handleModalClick}>\r\n        <Search\r\n          ref={searchInputRef}\r\n          placeholder=\"Search stocks (use  arrows to navigate, Enter to select)\"\r\n          onChange={e => setSearchTerm(e.target.value)}\r\n          style={{ marginBottom: 16 }}\r\n          autoFocus\r\n          onKeyDown={handleSearchKeyDown}\r\n          onBlur={() => {\r\n            // Re-focus after a short delay to ensure it stays focused\r\n            setTimeout(() => {\r\n              if (visible) {\r\n                searchInputRef.current?.focus();\r\n              }\r\n            }, 10);\r\n          }}\r\n        />\r\n\r\n        {/* Error Message Display */}\r\n        {errorMessage && (\r\n          <div\r\n            style={{\r\n              marginBottom: 16,\r\n              padding: '12px 16px',\r\n              backgroundColor: '#fff2f0',\r\n              border: '1px solid #ffccc7',\r\n              borderRadius: '6px',\r\n              color: '#cf1322',\r\n              fontSize: '14px',\r\n              display: 'flex',\r\n              alignItems: 'center',\r\n              gap: '8px',\r\n            }}\r\n          >\r\n            <ExclamationCircleOutlined style={{ color: '#cf1322' }} />\r\n            {errorMessage}\r\n          </div>\r\n        )}\r\n\r\n        <div\r\n          onKeyDown={handleTableKeyDown}\r\n          tabIndex={0}\r\n          ref={tableBodyRef}\r\n          style={{ outline: 'none' }}\r\n        >\r\n          <Table\r\n            dataSource={allStocks}\r\n            columns={columns}\r\n            loading={loading}\r\n            rowKey=\"_id\"\r\n            size=\"small\"\r\n            pagination={false}\r\n            title={() => (\r\n              <div\r\n                style={{\r\n                  display: 'flex',\r\n                  justifyContent: 'space-between',\r\n                  alignItems: 'center',\r\n                  padding: '8px 0',\r\n                }}\r\n              >\r\n                <span>Stock Items</span>\r\n                <div style={{ fontSize: '12px', color: '#666' }}>\r\n                  <span style={{ color: '#52c41a' }}> Valid</span>\r\n                  <span style={{ margin: '0 8px', color: '#faad14' }}>\r\n                     Near Expiry\r\n                  </span>\r\n                  <span style={{ color: '#ff4d4f' }}>\r\n                     Expired/Out of Stock (Disabled)\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            )}\r\n            onRow={(record, idx) => {\r\n              const isExpired = isStockExpired(record);\r\n              const isOutOfStock = isStockOutOfStock(record);\r\n              return {\r\n                onClick: () => {\r\n                  if (!isExpired && !isOutOfStock) {\r\n                    handleSelectRow(record);\r\n                    // Keep focus on search input after selection\r\n                    setTimeout(() => {\r\n                      searchInputRef.current?.focus();\r\n                    }, 10);\r\n                  } else if (isExpired) {\r\n                    showExpiredStockError(record);\r\n                  } else if (isOutOfStock) {\r\n                    showOutOfStockError(record);\r\n                  }\r\n                },\r\n                onDoubleClick: () => {\r\n                  if (!isExpired && !isOutOfStock) {\r\n                    handleSelectRow(record);\r\n                  } else if (isExpired) {\r\n                    showExpiredStockError(record);\r\n                  } else if (isOutOfStock) {\r\n                    showOutOfStockError(record);\r\n                  }\r\n                },\r\n                className:\r\n                  idx === highlightedIndex\r\n                    ? 'ant-table-row ant-table-row-selected'\r\n                    : 'ant-table-row',\r\n                'data-row-key': record._id,\r\n                style: {\r\n                  opacity: isExpired || isOutOfStock ? 0.6 : 1,\r\n                  cursor: isExpired || isOutOfStock ? 'not-allowed' : 'pointer',\r\n                  backgroundColor:\r\n                    isExpired || isOutOfStock ? '#f5f5f5' : undefined,\r\n                },\r\n              };\r\n            }}\r\n            rowSelection={{\r\n              type: 'radio',\r\n              selectedRowKeys: selectedRowKey ? [selectedRowKey] : [],\r\n              onChange: (keys: React.Key[]) => {\r\n                setSelectedRowKey(keys[0]);\r\n                const idx = allStocks.findIndex(s => s._id === keys[0]);\r\n                if (idx !== -1) setHighlightedIndex(idx);\r\n              },\r\n              getCheckboxProps: (record: Stock) => ({\r\n                disabled: isStockExpired(record) || isStockOutOfStock(record),\r\n              }),\r\n            }}\r\n          />\r\n          <div style={{ marginTop: 16, fontSize: '12px', color: '#666' }}>\r\n            <strong>Keyboard Shortcuts:</strong>  Navigate stocks | Enter\r\n            Select | Escape Cancel\r\n            <br />\r\n            <strong>Tip:</strong> Press F7 anytime to reopen this modal for\r\n            stock changes\r\n            <br />\r\n            <strong>Note:</strong> Expired items () and out of stock items\r\n            () are shown but cannot be selected. Navigation automatically\r\n            skips expired and out of stock items.\r\n            <br />\r\n            <strong>Error Handling:</strong> Attempting to select expired or out\r\n            of stock items will show an error message and prevent selection.\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default StockSelectionModal;\r\n","import React, { useEffect, useState, FC, KeyboardEvent, useRef } from 'react';\r\nimport { Modal, Table, Input, Button, Space, message } from 'antd';\r\nimport type { InputRef } from 'antd/es/input';\r\nimport { BarcodeOutlined, ScanOutlined } from '@ant-design/icons';\r\nimport { useApiActions } from '../../../services/api/useApiActions';\r\nimport type { ColumnType } from 'antd/es/table';\r\nimport { useDynamicSelector } from '../../../services/redux';\r\nimport BarcodeScanner from '../../../components/common/BarcodeScanner';\r\n\r\nconst { Search } = Input;\r\n\r\ninterface Product {\r\n  _id: string;\r\n  name?: string;\r\n  sku?: string;\r\n  selling_price?: number;\r\n  VariantItem?: {\r\n    variant_name?: string;\r\n    variant_code?: string;\r\n  };\r\n}\r\n\r\ninterface ProductSelectionModalProps {\r\n  visible: boolean;\r\n  onSelect: (product: Product) => void;\r\n  onCancel: () => void;\r\n}\r\n\r\nconst ProductSelectionModal: FC<ProductSelectionModalProps> = ({\r\n  visible,\r\n  onSelect,\r\n  onCancel,\r\n}) => {\r\n  const { getEntityApi } = useApiActions();\r\n  const ProductsApi = getEntityApi('Product');\r\n  const { items: products, loading } = useDynamicSelector(\r\n    ProductsApi.getIdentifier('GetAll')\r\n  );\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedRowKey, setSelectedRowKey] = useState<React.Key | null>(null);\r\n  const [highlightedIndex, setHighlightedIndex] = useState<number>(0);\r\n  const [scannerVisible, setScannerVisible] = useState(false);\r\n  const searchInputRef = useRef<InputRef>(null);\r\n\r\n  const filteredProducts: Product[] =\r\n    products?.result?.filter((p: Product) => {\r\n      const searchLower = searchTerm.toLowerCase();\r\n      return (\r\n        (p.name?.toLowerCase() || '').includes(searchLower) ||\r\n        (p.sku?.toLowerCase() || '').includes(searchLower) ||\r\n        p.VariantItem?.variant_name?.toLowerCase().includes(searchLower) ||\r\n        p.VariantItem?.variant_code?.toLowerCase().includes(searchLower) ||\r\n        (p.selling_price?.toString() || '').includes(searchLower)\r\n      );\r\n    }).sort((a: Product, b: Product) => {\r\n      // Prioritize exact matches and matches at the beginning\r\n      const searchLower = searchTerm.toLowerCase();\r\n      \r\n      // Check for exact matches first\r\n      const aExactMatch = (a.name?.toLowerCase() || '') === searchLower || \r\n                          a.VariantItem?.variant_name?.toLowerCase() === searchLower ||\r\n                          (a.sku?.toLowerCase() || '') === searchLower;\r\n      const bExactMatch = (b.name?.toLowerCase() || '') === searchLower || \r\n                          b.VariantItem?.variant_name?.toLowerCase() === searchLower ||\r\n                          (b.sku?.toLowerCase() || '') === searchLower;\r\n      \r\n      if (aExactMatch && !bExactMatch) return -1;\r\n      if (!aExactMatch && bExactMatch) return 1;\r\n      \r\n      // Then check for matches at the beginning\r\n      const aStartsWith = (a.name?.toLowerCase() || '').startsWith(searchLower) || \r\n                          a.VariantItem?.variant_name?.toLowerCase().startsWith(searchLower) ||\r\n                          (a.sku?.toLowerCase() || '').startsWith(searchLower);\r\n      const bStartsWith = (b.name?.toLowerCase() || '').startsWith(searchLower) || \r\n                          b.VariantItem?.variant_name?.toLowerCase().startsWith(searchLower) ||\r\n                          (b.sku?.toLowerCase() || '').startsWith(searchLower);\r\n      \r\n      if (aStartsWith && !bStartsWith) return -1;\r\n      if (!aStartsWith && bStartsWith) return 1;\r\n      \r\n      return 0;\r\n    }) || [];\r\n\r\n  useEffect(() => {\r\n    setHighlightedIndex(0);\r\n    if (filteredProducts.length > 0) {\r\n              setSelectedRowKey(filteredProducts[0]._id);\r\n    } else {\r\n      setSelectedRowKey(null);\r\n    }\r\n  }, [searchTerm, visible, products]);\r\n\r\n  useEffect(() => {\r\n    if (visible) {\r\n      setTimeout(() => {\r\n        searchInputRef.current?.focus();\r\n      }, 100);\r\n    }\r\n  }, [visible]);\r\n\r\n  const columns: ColumnType<Product>[] = [\r\n    { \r\n      title: 'Product & Variant', \r\n      dataIndex: 'name', \r\n      key: 'name', \r\n      width: 250,\r\n      render: (name, record) => (\r\n        <div>\r\n          <div style={{ fontWeight: 600, color: '#1890ff' }}>{name}</div>\r\n          {record.VariantItem?.variant_name && (\r\n            <div style={{ fontSize: '12px', color: '#52c41a', marginTop: '2px' }}>\r\n              Variant: {record.VariantItem.variant_name}\r\n              {record.VariantItem?.variant_code && (\r\n                <span style={{ marginLeft: '8px', color: '#fa8c16', fontSize: '11px' }}>\r\n                  ({record.VariantItem.variant_code})\r\n                </span>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n    { title: 'Variant', dataIndex: 'VariantItem', key: 'variant', width: 120, \r\n      render: (variant) => variant?.variant_name ? (\r\n        <span style={{ color: '#52c41a', fontWeight: 500 }}>{variant.variant_name}</span>\r\n      ) : (\r\n        <span style={{ color: '#bfbfbf', fontStyle: 'italic' }}>No variant</span>\r\n      ) },\r\n    { title: 'SKU', dataIndex: 'sku', key: 'sku', width: 120 },\r\n    { title: 'Price', dataIndex: 'selling_price', key: 'selling_price', width: 100,\r\n      render: (price) => (\r\n        <span style={{ \r\n          color: '#52c41a', \r\n          fontWeight: 600, \r\n          fontSize: '14px' \r\n        }}>\r\n          {price?.toFixed(2) || '0.00'}\r\n        </span>\r\n      ) },\r\n  ];\r\n\r\n  const handleSelectRow = (product: Product) => {\r\n    onSelect(product);\r\n  };\r\n\r\n  // Handle barcode scan\r\n  const handleBarcodeScan = (barcode: string) => {\r\n    setSearchTerm(barcode);\r\n    setScannerVisible(false);\r\n    \r\n    // Try to find product by barcode/SKU\r\n    const foundProduct = products?.result?.find((p: Product) => {\r\n      const searchLower = barcode.toLowerCase();\r\n      return (\r\n        (p.sku?.toLowerCase() || '').includes(searchLower) ||\r\n        (p.name?.toLowerCase() || '').includes(searchLower) ||\r\n        p.VariantItem?.variant_code?.toLowerCase().includes(searchLower)\r\n      );\r\n    });\r\n\r\n    if (foundProduct) {\r\n      // Auto-select the found product\r\n      setTimeout(() => {\r\n        onSelect(foundProduct);\r\n      }, 500);\r\n      message.success(`Product found: ${foundProduct.name}`);\r\n    } else {\r\n      message.warning(`No product found with barcode: ${barcode}`);\r\n    }\r\n  };\r\n\r\n  const handleSearchKeyDown = (e: KeyboardEvent<HTMLInputElement>) => {\r\n    if (!filteredProducts.length) return;\r\n\r\n    if (e.key === 'ArrowDown') {\r\n      e.preventDefault();\r\n      setHighlightedIndex(prev => {\r\n        const next = Math.min(prev + 1, filteredProducts.length - 1);\r\n        setSelectedRowKey(filteredProducts[next]._id);\r\n        return next;\r\n      });\r\n      // Keep focus on search input\r\n      searchInputRef.current?.focus();\r\n    } else if (e.key === 'ArrowUp') {\r\n      e.preventDefault();\r\n      setHighlightedIndex(prev => {\r\n        const prevIndex = Math.max(prev - 1, 0);\r\n        setSelectedRowKey(filteredProducts[prevIndex]._id);\r\n        return prevIndex;\r\n      });\r\n      // Keep focus on search input\r\n      searchInputRef.current?.focus();\r\n    } else if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      const selectedProduct = filteredProducts[highlightedIndex];\r\n      if (selectedProduct) {\r\n        handleSelectRow(selectedProduct);\r\n      }\r\n    } else if (e.key === 'Escape') {\r\n      e.preventDefault();\r\n      onCancel();\r\n    }\r\n  };\r\n\r\n  // Auto-focus back to search input when clicking outside\r\n  const handleModalClick = () => {\r\n    searchInputRef.current?.focus();\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      title=\"Select Product & Variant (F5 to reopen anytime)\"\r\n      open={visible}\r\n      onCancel={onCancel}\r\n      width={900}\r\n      footer={null}\r\n      destroyOnClose\r\n    >\r\n      <div onClick={handleModalClick}>\r\n        <Space.Compact style={{ marginBottom: 16, width: '100%' }}>\r\n          <Search\r\n            ref={searchInputRef}\r\n            placeholder=\"Search by product name, variant, SKU, or price (use  arrows to navigate, Enter to select)\"\r\n            onChange={e => setSearchTerm(e.target.value)}\r\n            style={{ flex: 1 }}\r\n            autoFocus\r\n            onKeyDown={handleSearchKeyDown}\r\n            onBlur={() => {\r\n              // Re-focus after a short delay to ensure it stays focused\r\n              setTimeout(() => {\r\n                if (visible) {\r\n                  searchInputRef.current?.focus();\r\n                }\r\n              }, 10);\r\n            }}\r\n            value={searchTerm}\r\n          />\r\n          <Button \r\n            type=\"primary\" \r\n            icon={<ScanOutlined />}\r\n            onClick={() => setScannerVisible(true)}\r\n            style={{ minWidth: 100 }}\r\n          >\r\n            Scan\r\n          </Button>\r\n        </Space.Compact>\r\n        <Table\r\n          dataSource={filteredProducts}\r\n          columns={columns}\r\n          loading={loading}\r\n          rowKey=\"_id\"\r\n          size=\"small\"\r\n          pagination={false}\r\n          onRow={(record, idx) => ({\r\n            onClick: () => {\r\n              handleSelectRow(record);\r\n              // Keep focus on search input after selection\r\n              setTimeout(() => {\r\n                searchInputRef.current?.focus();\r\n              }, 10);\r\n            },\r\n            onDoubleClick: () => handleSelectRow(record),\r\n            className:\r\n              idx === highlightedIndex\r\n                ? 'ant-table-row ant-table-row-selected'\r\n                : 'ant-table-row',\r\n            style: {\r\n              backgroundColor: idx === highlightedIndex ? '#e6f7ff' : undefined,\r\n              border: idx === highlightedIndex ? '2px solid #1890ff' : undefined,\r\n            },\r\n          })}\r\n          rowSelection={{\r\n            type: 'radio',\r\n            selectedRowKeys: selectedRowKey ? [selectedRowKey] : [],\r\n            onChange: keys => {\r\n              setSelectedRowKey(keys[0]);\r\n              const idx = filteredProducts.findIndex(p => p._id === keys[0]);\r\n              if (idx !== -1) setHighlightedIndex(idx);\r\n            },\r\n          }}\r\n          scroll={{ y: 300 }}\r\n        />\r\n              <div style={{ marginTop: 16, fontSize: '12px', color: '#666' }}>\r\n        <strong>Keyboard Shortcuts:</strong>  Navigate products | Enter Select | Escape Cancel\r\n        <br />\r\n        <strong>Search:</strong> Product name, variant name, SKU, or price\r\n        <br />\r\n        <strong>Barcode Scanner:</strong> Click \"Scan\" button or use USB barcode scanner\r\n        <br />\r\n        <strong>Tip:</strong> Press F5 anytime to reopen this modal for product changes\r\n      </div>\r\n      </div>\r\n\r\n      {/* Barcode Scanner Modal */}\r\n      <BarcodeScanner\r\n        visible={scannerVisible}\r\n        onClose={() => setScannerVisible(false)}\r\n        onScan={handleBarcodeScan}\r\n        title=\"Scan Product Barcode\"\r\n        description=\"Scan barcode to find product automatically\"\r\n      />\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default ProductSelectionModal;\r\n","/**\r\n * Centralized bill calculation utility\r\n * @param items - array of bill items\r\n * @param productList - product list (for tax/category lookup)\r\n * @param isGstIncluded - whether GST is included in price\r\n * @param discount - discount value\r\n * @param discountType - 'percentage' or 'amount'\r\n * @returns { totalAmount, totalGST, cgst, sgst, valueOfGoods, subtotal, itemsWithTax }\r\n */\r\nexport function calculateBillTotals({\r\n  items,\r\n  productList,\r\n  isGstIncluded,\r\n  discount,\r\n  discountType,\r\n}: {\r\n  items: any[];\r\n  productList: any[];\r\n  isGstIncluded: boolean;\r\n  discount: number;\r\n  discountType: \"percentage\" | \"amount\";\r\n}) {\r\n  // Calculate item base amounts\r\n  const itemsWithTax = items.map((item) => {\r\n    const product = productList?.find((p: any) => p._id === item.product_id);\r\n    // Use item's tax_percentage if available, otherwise get from product category, or default to 18%\r\n    let taxPercentage = item.tax_percentage || product?.CategoryItem?.tax_percentage || 18;\r\n    \r\n    // If still no tax percentage, use a default based on common GST rates\r\n    if (!taxPercentage || taxPercentage === 0) {\r\n      // Default to 18% GST for most goods\r\n      taxPercentage = 18;\r\n    }\r\n    \r\n\r\n    // Calculate base amount (before GST)\r\n    const baseAmount =\r\n      Number(item.qty || 0) * Number(item.price || 0) +\r\n      Number(item.loose_qty || 0) *\r\n        (Number(item.price || 0) / (product?.VariantItem?.pack_size || 1) || 0);\r\n    \r\n    // Calculate amount (with GST if applicable)\r\n    let amount = baseAmount;\r\n    if (!isGstIncluded && taxPercentage > 0) {\r\n      amount = baseAmount + (baseAmount * taxPercentage / 100);\r\n    }\r\n    return {\r\n      ...item,\r\n      tax_percentage: taxPercentage,\r\n      baseAmount,\r\n      amount,\r\n    };\r\n  });\r\n\r\n  // sub_total: sum of all item.amount values (table total before discount/GST)\r\n  const sub_total = itemsWithTax.reduce(\r\n    (sum, item) => sum + Number(item.amount),\r\n    0\r\n  );\r\n\r\n  // base_sub_total: sum of all item base amounts (before GST and discount)\r\n  const base_sub_total = itemsWithTax.reduce(\r\n    (sum, item) => sum + Number(item.baseAmount),\r\n    0\r\n  );\r\n\r\n  // Discount\r\n  let discountValue = 0;\r\n  if (discount > 0) {\r\n    if (discountType === \"percentage\") {\r\n      discountValue = base_sub_total * (discount / 100);\r\n    } else {\r\n      discountValue = discount;\r\n    }\r\n  }\r\n\r\n  // Discounted value of goods\r\n  const discounted_value_of_goods = base_sub_total - discountValue;\r\n\r\n  let total_gst = 0;\r\n  let value_of_goods = 0;\r\n  let total_amount = 0;\r\n  // Calculate GST and totals for each item\r\n  itemsWithTax.forEach(item => {\r\n    let discountedBase = item.baseAmount;\r\n    if (discount > 0) {\r\n      if (discountType === \"percentage\") {\r\n        discountedBase = item.baseAmount - (item.baseAmount * (discount / 100));\r\n      } else {\r\n        discountedBase = item.baseAmount - ((discount/base_sub_total)*item.baseAmount);\r\n      }\r\n    }\r\n    \r\n    let gstAmount = 0;\r\n    if (!isGstIncluded) {\r\n      // GST Excluded: GST is added on top\r\n      if (item.tax_percentage > 0) {\r\n        gstAmount = discountedBase * (item.tax_percentage / 100);\r\n        value_of_goods += discountedBase;\r\n        total_gst += gstAmount;\r\n        total_amount += discountedBase + gstAmount;\r\n      } else {\r\n        // No tax\r\n        value_of_goods += discountedBase;\r\n        total_amount += discountedBase;\r\n      }\r\n    } else {\r\n      // GST Included: GST is part of the price, extract it\r\n      if (item.tax_percentage > 0) {\r\n        gstAmount = discountedBase * (item.tax_percentage / (100 + item.tax_percentage));\r\n        value_of_goods += discountedBase - gstAmount;\r\n        total_gst += gstAmount;\r\n        total_amount += discountedBase;\r\n      } else {\r\n        // No tax\r\n        value_of_goods += discountedBase;\r\n        total_amount += discountedBase;\r\n      }\r\n    }\r\n  });\r\n\r\n  // Calculate CGST and SGST (each is total_gst / 2)\r\n  const cgst = total_gst / 2;\r\n  const sgst = total_gst / 2;\r\n\r\n  return {\r\n    sub_total,\r\n    value_of_goods,\r\n    total_gst,\r\n    cgst,\r\n    sgst,\r\n    total_amount,\r\n    discountValue,\r\n  };\r\n}\r\n","import React, { FC, useEffect, useState } from 'react';\r\nimport { Modal, Descriptions, Typography, Tag, Divider } from 'antd';\r\nimport { useApiActions } from '../../../services/api/useApiActions';\r\nimport { useDynamicSelector } from '../../../services/redux';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\ninterface ProductDetailsModalProps {\r\n  visible: boolean;\r\n  onCancel: () => void;\r\n  productId: string;\r\n}\r\n\r\ninterface ProductDetails {\r\n  _id: string;\r\n  name: string;\r\n  sku: string;\r\n  description?: string;\r\n  selling_price: number;\r\n  mrp: number;\r\n  VariantItem?: {\r\n    variant_name: string;\r\n    variant_code?: string;\r\n  };\r\n  CategoryItem?: {\r\n    name: string;\r\n    tax_percentage: number;\r\n  };\r\n  brand?: string;\r\n  unit?: string;\r\n  min_stock?: number;\r\n  max_stock?: number;\r\n}\r\n\r\nconst ProductDetailsModal: FC<ProductDetailsModalProps> = ({\r\n  visible,\r\n  onCancel,\r\n  productId,\r\n}) => {\r\n  const { getEntityApi } = useApiActions();\r\n  const ProductsApi = getEntityApi('Product');\r\n  \r\n  const { items: products, loading } = useDynamicSelector(\r\n    ProductsApi.getIdentifier('GetAll')\r\n  );\r\n\r\n  const [productDetails, setProductDetails] = useState<ProductDetails | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (visible && productId && products?.result) {\r\n      const product = products.result.find((p: any) => p._id === productId);\r\n      if (product) {\r\n        setProductDetails(product);\r\n      }\r\n    }\r\n  }, [visible, productId, products]);\r\n\r\n  useEffect(() => {\r\n    if (visible && productId && !products?.result) {\r\n      // Load products if not already loaded\r\n      ProductsApi('GetAll');\r\n    }\r\n  }, [visible, productId, products, ProductsApi]);\r\n\r\n  const handleCancel = () => {\r\n    setProductDetails(null);\r\n    onCancel();\r\n  };\r\n\r\n  if (!productDetails) {\r\n    return (\r\n      <Modal\r\n        title=\"Product Details\"\r\n        open={visible}\r\n        onCancel={handleCancel}\r\n        footer={null}\r\n        width={600}\r\n        destroyOnClose\r\n      >\r\n        <div style={{ textAlign: 'center', padding: '40px 20px' }}>\r\n          {loading ? (\r\n            <Text>Loading product details...</Text>\r\n          ) : (\r\n            <Text type=\"secondary\">Product not found</Text>\r\n          )}\r\n        </div>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      title={\r\n        <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n          <span> Product Details</span>\r\n          <Tag color=\"blue\" style={{ margin: 0 }}>\r\n            {productDetails.sku}\r\n          </Tag>\r\n        </div>\r\n      }\r\n      open={visible}\r\n      onCancel={handleCancel}\r\n      footer={null}\r\n      width={700}\r\n      destroyOnClose\r\n    >\r\n      <div style={{ padding: '16px 0' }}>\r\n        {/* Product Name and Variant */}\r\n        <div style={{ marginBottom: '24px' }}>\r\n          <Title level={4} style={{ margin: '0 0 8px 0', color: '#1890ff' }}>\r\n            {productDetails.name}\r\n          </Title>\r\n          {productDetails.VariantItem?.variant_name && (\r\n            <Tag color=\"green\" style={{ fontSize: '12px' }}>\r\n              Variant: {productDetails.VariantItem.variant_name}\r\n            </Tag>\r\n          )}\r\n        </div>\r\n\r\n        <Divider style={{ margin: '16px 0' }} />\r\n\r\n        {/* Product Information */}\r\n        <Descriptions\r\n          title=\"Product Information\"\r\n          column={2}\r\n          size=\"small\"\r\n          bordered\r\n          style={{ marginBottom: '24px' }}\r\n        >\r\n          <Descriptions.Item label=\"Product Name\" span={2}>\r\n            <Text strong>{productDetails.name}</Text>\r\n          </Descriptions.Item>\r\n          \r\n          {productDetails.VariantItem?.variant_name && (\r\n            <Descriptions.Item label=\"Variant Name\">\r\n              <Text>{productDetails.VariantItem.variant_name}</Text>\r\n            </Descriptions.Item>\r\n          )}\r\n          \r\n          {productDetails.VariantItem?.variant_code && (\r\n            <Descriptions.Item label=\"Variant Code\">\r\n              <Text code>{productDetails.VariantItem.variant_code}</Text>\r\n            </Descriptions.Item>\r\n          )}\r\n          \r\n          <Descriptions.Item label=\"SKU\">\r\n            <Text code>{productDetails.sku}</Text>\r\n          </Descriptions.Item>\r\n          \r\n          {productDetails.brand && (\r\n            <Descriptions.Item label=\"Brand\">\r\n              <Text>{productDetails.brand}</Text>\r\n            </Descriptions.Item>\r\n          )}\r\n          \r\n          {productDetails.unit && (\r\n            <Descriptions.Item label=\"Unit\">\r\n              <Text>{productDetails.unit}</Text>\r\n            </Descriptions.Item>\r\n          )}\r\n          \r\n          {productDetails.description && (\r\n            <Descriptions.Item label=\"Description\" span={2}>\r\n              <Text>{productDetails.description}</Text>\r\n            </Descriptions.Item>\r\n          )}\r\n        </Descriptions>\r\n\r\n        {/* Pricing Information */}\r\n        <Descriptions\r\n          title=\"Pricing & Tax\"\r\n          column={2}\r\n          size=\"small\"\r\n          bordered\r\n          style={{ marginBottom: '24px' }}\r\n        >\r\n          <Descriptions.Item label=\"Selling Price\">\r\n            <Text strong style={{ color: '#52c41a', fontSize: '16px' }}>\r\n              {productDetails.selling_price?.toFixed(2) || '0.00'}\r\n            </Text>\r\n          </Descriptions.Item>\r\n          \r\n          <Descriptions.Item label=\"MRP\">\r\n            <Text style={{ color: '#fa8c16' }}>\r\n              {productDetails.mrp?.toFixed(2) || '0.00'}\r\n            </Text>\r\n          </Descriptions.Item>\r\n          \r\n          {productDetails.CategoryItem?.name && (\r\n            <Descriptions.Item label=\"Category\">\r\n              <Text>{productDetails.CategoryItem.name}</Text>\r\n            </Descriptions.Item>\r\n          )}\r\n          \r\n          {productDetails.CategoryItem?.tax_percentage !== undefined && (\r\n            <Descriptions.Item label=\"Tax Rate\">\r\n              <Tag color=\"orange\">\r\n                {productDetails.CategoryItem.tax_percentage}%\r\n              </Tag>\r\n            </Descriptions.Item>\r\n          )}\r\n        </Descriptions>\r\n\r\n        {/* Stock Information */}\r\n        {(productDetails.min_stock !== undefined || productDetails.max_stock !== undefined) && (\r\n          <Descriptions\r\n            title=\"Stock Information\"\r\n            column={2}\r\n            size=\"small\"\r\n            bordered\r\n          >\r\n            {productDetails.min_stock !== undefined && (\r\n              <Descriptions.Item label=\"Minimum Stock\">\r\n                <Text>{productDetails.min_stock}</Text>\r\n              </Descriptions.Item>\r\n            )}\r\n            \r\n            {productDetails.max_stock !== undefined && (\r\n              <Descriptions.Item label=\"Maximum Stock\">\r\n                <Text>{productDetails.max_stock}</Text>\r\n              </Descriptions.Item>\r\n            )}\r\n          </Descriptions>\r\n        )}\r\n\r\n        {/* Footer Information */}\r\n        <div style={{ \r\n          marginTop: '24px', \r\n          padding: '16px', \r\n          backgroundColor: '#f6f8fa', \r\n          borderRadius: '8px',\r\n          textAlign: 'center'\r\n        }}>\r\n          <Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n            Right-click on product field to view details  Press ESC to close\r\n          </Text>\r\n        </div>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default ProductDetailsModal;\r\n","import React, { useState, useEffect } from 'react';\r\nimport { \r\n  Drawer, \r\n  List, \r\n  Typography, \r\n  Button, \r\n  Input, \r\n  Space, \r\n  Tag, \r\n  Avatar, \r\n  Badge,\r\n  Tooltip,\r\n  Divider,\r\n  Empty,\r\n  Spin\r\n} from 'antd';\r\nimport { \r\n  SearchOutlined, \r\n  FileTextOutlined, \r\n  UserOutlined, \r\n  CalendarOutlined,\r\n  DollarOutlined,\r\n  EyeOutlined,\r\n  PrinterOutlined,\r\n  PlusOutlined,\r\n  CloseOutlined\r\n} from '@ant-design/icons';\r\nimport dayjs from 'dayjs';\r\nimport { useApiActions } from '../../../services/api/useApiActions';\r\nimport { useDynamicSelector } from '../../../services/redux';\r\n\r\nconst { Title, Text } = Typography;\r\nconst { Search } = Input;\r\n\r\ninterface BillListDrawerProps {\r\n  visible: boolean;\r\n  onClose: () => void;\r\n  onViewBill: (bill: any) => void;\r\n  onNewBill: () => void;\r\n}\r\n\r\nconst BillListDrawer: React.FC<BillListDrawerProps> = ({\r\n  visible,\r\n  onClose,\r\n  onViewBill,\r\n  onNewBill\r\n}) => {\r\n  const { getEntityApi } = useApiActions();\r\n  const SalesRecord = getEntityApi('SalesRecord');\r\n  \r\n  const { items: billList, loading } = useDynamicSelector(\r\n    SalesRecord.getIdentifier('GetAll')\r\n  );\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [filteredBills, setFilteredBills] = useState<any[]>([]);\r\n\r\n  // Load bills when drawer opens\r\n  useEffect(() => {\r\n    if (visible) {\r\n      SalesRecord('GetAll');\r\n    }\r\n  }, [visible]);\r\n\r\n  // Filter bills based on search term\r\n  useEffect(() => {\r\n    if (billList?.result) {\r\n      const filtered = billList.result.filter((bill: any) => {\r\n        if (!searchTerm) return true;\r\n        const searchLower = searchTerm.toLowerCase();\r\n        \r\n        // Safely handle bill properties\r\n        const invoiceNo = bill.invoice_no || '';\r\n        const customerName = bill.customerDetails?.full_name || '';\r\n        const date = bill.date || '';\r\n        const totalAmount = typeof bill.total_amount === 'number' ? bill.total_amount.toString() : String(bill.total_amount || '');\r\n        \r\n        return (\r\n          invoiceNo.toLowerCase().includes(searchLower) ||\r\n          customerName.toLowerCase().includes(searchLower) ||\r\n          date.includes(searchTerm) ||\r\n          totalAmount.includes(searchTerm)\r\n        );\r\n      });\r\n      setFilteredBills(filtered);\r\n    }\r\n  }, [billList, searchTerm]);\r\n\r\n  const getPaymentStatusColor = (isPaid: boolean, isPartiallyPaid: boolean) => {\r\n    if (isPaid && !isPartiallyPaid) return 'success';\r\n    if (isPartiallyPaid) return 'warning';\r\n    return 'error';\r\n  };\r\n\r\n  const getPaymentStatusText = (isPaid: boolean, isPartiallyPaid: boolean) => {\r\n    if (isPaid && !isPartiallyPaid) return 'Paid';\r\n    if (isPartiallyPaid) return 'Partial';\r\n    return 'Unpaid';\r\n  };\r\n\r\n  const handleViewBill = (bill: any) => {\r\n\r\n    onViewBill(bill);\r\n    onClose();\r\n  };\r\n\r\n  const handleNewBill = () => {\r\n    onNewBill();\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <Drawer\r\n      title={\r\n        <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n          <Title level={4} style={{ margin: 0, color: '#1f2937' }}>\r\n             Bill List\r\n          </Title>\r\n          <Button\r\n            type=\"text\"\r\n            icon={<CloseOutlined />}\r\n            onClick={onClose}\r\n            size=\"small\"\r\n          />\r\n        </div>\r\n      }\r\n      placement=\"left\"\r\n      open={visible}\r\n      onClose={onClose}\r\n      width={400}\r\n      bodyStyle={{ padding: '16px' }}\r\n      headerStyle={{ \r\n        borderBottom: '1px solid #e5e7eb',\r\n        padding: '16px 16px 12px 16px'\r\n      }}\r\n    >\r\n      {/* Search and New Bill Section */}\r\n      <div style={{ marginBottom: '16px' }}>\r\n        <Space direction=\"vertical\" size=\"middle\" style={{ width: '100%' }}>\r\n          <Search\r\n            placeholder=\"Search bills by invoice, customer, date...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n            prefix={<SearchOutlined />}\r\n            allowClear\r\n            size=\"large\"\r\n          />\r\n          \r\n          <Button\r\n            type=\"primary\"\r\n            icon={<PlusOutlined />}\r\n            onClick={handleNewBill}\r\n            style={{\r\n              width: '100%',\r\n              height: '40px',\r\n              background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\r\n              border: 'none',\r\n              fontWeight: 600,\r\n              borderRadius: '8px',\r\n            }}\r\n          >\r\n             Create New Bill\r\n          </Button>\r\n        </Space>\r\n      </div>\r\n\r\n      <Divider style={{ margin: '16px 0' }} />\r\n\r\n      {/* Bill List */}\r\n      <div style={{ height: 'calc(100vh - 250px)', overflow: 'auto' }}>\r\n        {loading ? (\r\n          <div style={{ textAlign: 'center', padding: '40px' }}>\r\n            <Spin size=\"large\" />\r\n            <div style={{ marginTop: '16px' }}>\r\n              <Text type=\"secondary\">Loading bills...</Text>\r\n            </div>\r\n          </div>\r\n        ) : filteredBills.length === 0 ? (\r\n          <Empty\r\n            description={\r\n              <div>\r\n                <Text type=\"secondary\">\r\n                  {searchTerm ? 'No bills found matching your search.' : 'No bills available.'}\r\n                </Text>\r\n                {!searchTerm && (\r\n                  <div style={{ marginTop: '8px' }}>\r\n                    <Button type=\"link\" onClick={handleNewBill}>\r\n                      Create your first bill\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            }\r\n            style={{ marginTop: '40px' }}\r\n          />\r\n        ) : (\r\n          <List\r\n            dataSource={filteredBills}\r\n            renderItem={(bill) => (\r\n              <List.Item\r\n                style={{\r\n                  padding: '16px',\r\n                  border: '1px solid #e5e7eb',\r\n                  borderRadius: '8px',\r\n                  marginBottom: '12px',\r\n                  background: 'white',\r\n                  cursor: 'pointer',\r\n                  transition: 'all 0.2s ease',\r\n                }}\r\n                onMouseEnter={(e) => {\r\n                  e.currentTarget.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.1)';\r\n                  e.currentTarget.style.transform = 'translateY(-2px)';\r\n                }}\r\n                onMouseLeave={(e) => {\r\n                  e.currentTarget.style.boxShadow = 'none';\r\n                  e.currentTarget.style.transform = 'translateY(0)';\r\n                }}\r\n                onClick={() => handleViewBill(bill)}\r\n              >\r\n                <div style={{ width: '100%' }}>\r\n                  {/* Header with Invoice and Status */}\r\n                  <div style={{ \r\n                    display: 'flex', \r\n                    justifyContent: 'space-between', \r\n                    alignItems: 'center',\r\n                    marginBottom: '8px'\r\n                  }}>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n                      <Avatar \r\n                        icon={<FileTextOutlined />} \r\n                        style={{ \r\n                          background: 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',\r\n                          color: 'white'\r\n                        }} \r\n                      />\r\n                      <Text strong style={{ fontSize: '14px' }}>\r\n                        {bill.invoice_no}\r\n                      </Text>\r\n                    </div>\r\n                    <Tag color={getPaymentStatusColor(bill.is_paid, bill.is_partially_paid)}>\r\n                      {getPaymentStatusText(bill.is_paid, bill.is_partially_paid)}\r\n                    </Tag>\r\n                  </div>\r\n\r\n                  {/* Customer Info */}\r\n                  <div style={{ \r\n                    display: 'flex', \r\n                    alignItems: 'center', \r\n                    gap: '8px',\r\n                    marginBottom: '6px'\r\n                  }}>\r\n                    <UserOutlined style={{ color: '#6b7280', fontSize: '12px' }} />\r\n                    <Text style={{ fontSize: '12px', color: '#374151' }}>\r\n                      {bill.customerDetails?.full_name || bill.customer_name || 'N/A'}\r\n                    </Text>\r\n                  </div>\r\n\r\n                  {/* Date and Amount */}\r\n                  <div style={{ \r\n                    display: 'flex', \r\n                    justifyContent: 'space-between', \r\n                    alignItems: 'center'\r\n                  }}>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n                      <CalendarOutlined style={{ color: '#6b7280', fontSize: '12px' }} />\r\n                      <Text style={{ fontSize: '12px', color: '#6b7280' }}>\r\n                        {bill.date ? dayjs(bill.date).format('DD/MM/YYYY') : 'N/A'}\r\n                      </Text>\r\n                    </div>\r\n                    <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n                      <DollarOutlined style={{ color: '#10b981', fontSize: '12px' }} />\r\n                      <Text strong style={{ fontSize: '14px', color: '#10b981' }}>\r\n                        {(typeof bill.total_amount === 'number' ? bill.total_amount : parseFloat(bill.total_amount) || 0).toFixed(2)}\r\n                      </Text>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Action Buttons */}\r\n                  <div style={{ \r\n                    display: 'flex', \r\n                    gap: '8px', \r\n                    marginTop: '12px',\r\n                    justifyContent: 'flex-end'\r\n                  }}>\r\n                    <Tooltip title=\"View Bill\">\r\n                      <Button\r\n                        type=\"text\"\r\n                        icon={<EyeOutlined />}\r\n                        size=\"small\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleViewBill(bill);\r\n                        }}\r\n                        style={{ color: '#3b82f6' }}\r\n                      />\r\n                    </Tooltip>\r\n                    <Tooltip title=\"Print Bill\">\r\n                      <Button\r\n                        type=\"text\"\r\n                        icon={<PrinterOutlined />}\r\n                        size=\"small\"\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          // Handle print functionality\r\n                        }}\r\n                        style={{ color: '#10b981' }}\r\n                      />\r\n                    </Tooltip>\r\n                  </div>\r\n                </div>\r\n              </List.Item>\r\n            )}\r\n            pagination={false}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* Footer Stats */}\r\n      <div style={{ \r\n        position: 'absolute', \r\n        bottom: 0, \r\n        left: 0, \r\n        right: 0, \r\n        padding: '16px',\r\n        background: 'white',\r\n        borderTop: '1px solid #e5e7eb'\r\n      }}>\r\n        <div style={{ \r\n          display: 'flex', \r\n          justifyContent: 'space-between', \r\n          alignItems: 'center'\r\n        }}>\r\n          <Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n            Total Bills: {filteredBills.length}\r\n          </Text>\r\n          <Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n             Click on any bill to view details\r\n          </Text>\r\n        </div>\r\n      </div>\r\n    </Drawer>\r\n  );\r\n};\r\n\r\nexport default BillListDrawer;\r\n","// extracted by mini-css-extract-plugin\nexport default {\"mainContainer\":\"BillDataGrid_mainContainer__Jnuo1\",\"gradientShift\":\"BillDataGrid_gradientShift__hhIW9\",\"backgroundCircle1\":\"BillDataGrid_backgroundCircle1__5PBPG\",\"float\":\"BillDataGrid_float__1VyT0\",\"backgroundCircle2\":\"BillDataGrid_backgroundCircle2__J+xMs\",\"backgroundCircle3\":\"BillDataGrid_backgroundCircle3__AgoEw\",\"backgroundCircle4\":\"BillDataGrid_backgroundCircle4__86Xfd\",\"backgroundCircle5\":\"BillDataGrid_backgroundCircle5__qpbiT\",\"headerContainer\":\"BillDataGrid_headerContainer__wfojf\",\"slideInDown\":\"BillDataGrid_slideInDown__l3LU5\",\"headerCircle1\":\"BillDataGrid_headerCircle1__8+aPI\",\"headerCircle2\":\"BillDataGrid_headerCircle2__Z9w17\",\"headerCircle3\":\"BillDataGrid_headerCircle3__3eMNm\",\"pulse\":\"BillDataGrid_pulse__EVfnw\",\"headerCircle4\":\"BillDataGrid_headerCircle4__fVITr\",\"headerCircle5\":\"BillDataGrid_headerCircle5__0E6vl\",\"headerContent\":\"BillDataGrid_headerContent__6Rnkr\",\"titleSection\":\"BillDataGrid_titleSection__LBuxT\",\"fadeInLeft\":\"BillDataGrid_fadeInLeft__YHJna\",\"titleIcon\":\"BillDataGrid_titleIcon__qffZU\",\"bounce\":\"BillDataGrid_bounce__fYaGs\",\"titleText\":\"BillDataGrid_titleText__XlvSS\",\"slideInRight\":\"BillDataGrid_slideInRight__+-bkg\",\"subtitleText\":\"BillDataGrid_subtitleText__Hgyav\",\"fadeInUp\":\"BillDataGrid_fadeInUp__Y00FE\",\"controlsSection\":\"BillDataGrid_controlsSection__PSC3w\",\"fadeInRight\":\"BillDataGrid_fadeInRight__eA5Bm\",\"controlGroup\":\"BillDataGrid_controlGroup__AFGBT\",\"saleTypeControl\":\"BillDataGrid_saleTypeControl__hzHpa\",\"slideInUp\":\"BillDataGrid_slideInUp__ZuvW2\",\"gstControl\":\"BillDataGrid_gstControl__AiGdY\",\"paymentControl\":\"BillDataGrid_paymentControl__BD0r9\",\"partialPaymentControl\":\"BillDataGrid_partialPaymentControl__unngo\",\"controlLabel\":\"BillDataGrid_controlLabel__QP4fP\",\"badgesContainer\":\"BillDataGrid_badgesContainer__bqqSt\",\"itemsBadge\":\"BillDataGrid_itemsBadge__o0Uro\",\"amountBadge\":\"BillDataGrid_amountBadge__IPSqT\",\"badgeText\":\"BillDataGrid_badgeText__9cTal\",\"invoiceDetailsGrid\":\"BillDataGrid_invoiceDetailsGrid__QPpaj\",\"itemsSection\":\"BillDataGrid_itemsSection__vJE1b\",\"itemsCircle1\":\"BillDataGrid_itemsCircle1__PQoMB\",\"rotate\":\"BillDataGrid_rotate__l3nA9\",\"itemsCircle2\":\"BillDataGrid_itemsCircle2__0lWcR\",\"scaleIn\":\"BillDataGrid_scaleIn__xFZvA\",\"billItemsGrid\":\"BillDataGrid_billItemsGrid__jpWQo\",\"billItemsHeader\":\"BillDataGrid_billItemsHeader__hxL0O\",\"billItemsTitle\":\"BillDataGrid_billItemsTitle__MQduV\",\"billItemsBadge\":\"BillDataGrid_billItemsBadge__vdJMk\",\"billSummary\":\"BillDataGrid_billSummary__yA4j-\",\"summaryCircle1\":\"BillDataGrid_summaryCircle1__PuveY\",\"summaryCircle2\":\"BillDataGrid_summaryCircle2__fdcks\",\"summaryHeader\":\"BillDataGrid_summaryHeader__h1BtQ\",\"summaryTitle\":\"BillDataGrid_summaryTitle__dSOoP\",\"summaryRow\":\"BillDataGrid_summaryRow__yUShR\",\"summaryLabel\":\"BillDataGrid_summaryLabel__cLnHd\",\"summaryValue\":\"BillDataGrid_summaryValue__LUh-6\",\"summaryTotal\":\"BillDataGrid_summaryTotal__ujvAB\",\"summaryTable\":\"BillDataGrid_summaryTable__ZpVlt\",\"totalAmountRow\":\"BillDataGrid_totalAmountRow__JXMuL\",\"totalAmountLabel\":\"BillDataGrid_totalAmountLabel__IVRMe\",\"totalAmountValue\":\"BillDataGrid_totalAmountValue__5W5mL\",\"discountValue\":\"BillDataGrid_discountValue__QjPij\",\"partialPaymentInfo\":\"BillDataGrid_partialPaymentInfo__OpO+-\",\"partialPaymentRow\":\"BillDataGrid_partialPaymentRow__Qy-Ni\",\"partialPaymentLabel\":\"BillDataGrid_partialPaymentLabel__yEvTO\",\"partialPaymentValue\":\"BillDataGrid_partialPaymentValue__SLg8d\",\"controlsContainer\":\"BillDataGrid_controlsContainer__2jCRg\",\"discountControl\":\"BillDataGrid_discountControl__n0WOI\",\"discountControlLabel\":\"BillDataGrid_discountControlLabel__0iwJ9\",\"discountControlInputs\":\"BillDataGrid_discountControlInputs__TbgUU\",\"partialPaymentControlLabel\":\"BillDataGrid_partialPaymentControlLabel__lxP98\",\"summaryTotalLabel\":\"BillDataGrid_summaryTotalLabel__u+656\",\"summaryTotalValue\":\"BillDataGrid_summaryTotalValue__sKz9B\",\"partialPaymentBalance\":\"BillDataGrid_partialPaymentBalance__lFxZE\",\"discountLabel\":\"BillDataGrid_discountLabel__906vd\",\"discountInputs\":\"BillDataGrid_discountInputs__9BUMD\",\"actionHub\":\"BillDataGrid_actionHub__SlPSg\",\"actionButtonsContainer\":\"BillDataGrid_actionButtonsContainer__BcfKu\",\"actionHubCircle1\":\"BillDataGrid_actionHubCircle1__ggNzA\",\"actionHubCircle2\":\"BillDataGrid_actionHubCircle2__Nb-oj\",\"actionHubCircle3\":\"BillDataGrid_actionHubCircle3__D2pna\",\"actionHubCircle4\":\"BillDataGrid_actionHubCircle4__ayVXK\",\"actionButtons\":\"BillDataGrid_actionButtons__tQbXu\",\"saveButton\":\"BillDataGrid_saveButton__vWggk\",\"billListButton\":\"BillDataGrid_billListButton__ahHFc\",\"refreshButton\":\"BillDataGrid_refreshButton__XnoTE\",\"printButton\":\"BillDataGrid_printButton__nkIDd\",\"clearButton\":\"BillDataGrid_clearButton__518xA\",\"shortcutsInfo\":\"BillDataGrid_shortcutsInfo__kN1Ka\",\"shortcutsText\":\"BillDataGrid_shortcutsText__qGuNn\",\"customerField\":\"BillDataGrid_customerField__+4wOA\",\"customerFieldEndKey\":\"BillDataGrid_customerFieldEndKey__HaMh6\",\"stockField\":\"BillDataGrid_stockField__BQirP\",\"stockFieldSelected\":\"BillDataGrid_stockFieldSelected__x7NU5\",\"stockFieldIcon\":\"BillDataGrid_stockFieldIcon__WeVkj\",\"stockFieldWarning\":\"BillDataGrid_stockFieldWarning__7Lv+C\",\"saleTypeSwitch\":\"BillDataGrid_saleTypeSwitch__Xa4gR\",\"ant-switch-checked\":\"BillDataGrid_ant-switch-checked__rQynk\",\"gstSwitch\":\"BillDataGrid_gstSwitch__ZQG0t\",\"paymentSwitch\":\"BillDataGrid_paymentSwitch__KxB-J\",\"partialPaymentSwitch\":\"BillDataGrid_partialPaymentSwitch__5nNFs\",\"keyboardShortcuts\":\"BillDataGrid_keyboardShortcuts__2e-4z\",\"keyboardShortcutsContent\":\"BillDataGrid_keyboardShortcutsContent__5FpEl\",\"keyboardShortcutsText\":\"BillDataGrid_keyboardShortcutsText__A58I9\",\"slideInLeft\":\"BillDataGrid_slideInLeft__TTFPm\"};","import React, {\r\n  useState,\r\n  useEffect,\r\n  useRef,\r\n  useCallback,\r\n  useMemo,\r\n} from 'react';\r\nimport { getCurrentUser } from '../../../helpers/auth';\r\nimport {\r\n  Modal,\r\n  Input,\r\n  Typography,\r\n  Table,\r\n  Tag,\r\n} from 'antd';\r\nimport {\r\n  SearchOutlined,\r\n  UserOutlined,\r\n  PhoneOutlined,\r\n  MailOutlined,\r\n} from '@ant-design/icons';\r\nimport { useApiActions } from '../../../services/api/useApiActions';\r\nimport { useDynamicSelector } from '../../../services/redux';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\ninterface User {\r\n  _id: string;\r\n  name: string;\r\n  email: string;\r\n  mobile: string;\r\n  user_name: string;\r\n  roleItems?: {\r\n    name: string;\r\n  };\r\n  branchItems?: {\r\n    branch_name: string;\r\n  };\r\n  organisationItems?: {\r\n    name: string;\r\n  };\r\n}\r\n\r\ninterface UserSelectionModalProps {\r\n  visible: boolean;\r\n  onSelect: (user: User) => void;\r\n  onCancel: () => void;\r\n}\r\n\r\nconst UserSelectionModal: React.FC<UserSelectionModalProps> = ({\r\n  visible,\r\n  onSelect,\r\n  onCancel,\r\n}) => {\r\n  const { getEntityApi } = useApiActions();\r\n  const BillingUsersApi = getEntityApi('BillingUsers');\r\n\r\n  const { items: userList, loading: userLoading } = useDynamicSelector(\r\n    BillingUsersApi.getIdentifier('GetAll')\r\n  );\r\n\r\n  // Extract items from userList if it exists\r\n  const users = userList?.items || userList?.result || [];\r\n\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [selectedUser, setSelectedUser] = useState<User | null>(null);\r\n  const [selectedRowIndex, setSelectedRowIndex] = useState<number>(-1);\r\n  \r\n  // Get current user from session storage\r\n  const currentUser = useMemo(() => {\r\n    return getCurrentUser();\r\n  }, []);\r\n\r\n  const searchInputRef = useRef<any>(null);\r\n  const modalRef = useRef<HTMLDivElement>(null);\r\n  const searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  // Memoized filtered users\r\n  const filteredUsers = useMemo(() => {\r\n    if (!searchTerm.trim()) {\r\n      return users;\r\n    }\r\n    \r\n    const searchLower = searchTerm.toLowerCase();\r\n    return users.filter((user: User) =>\r\n      user.name?.toLowerCase().includes(searchLower) ||\r\n      user.email?.toLowerCase().includes(searchLower) ||\r\n      user.mobile?.toLowerCase().includes(searchLower) ||\r\n      user.user_name?.toLowerCase().includes(searchLower) ||\r\n      user.roleItems?.name?.toLowerCase().includes(searchLower)\r\n    );\r\n  }, [users, searchTerm]);\r\n\r\n  // Consolidated keyboard navigation function\r\n  const navigateToUser = useCallback(\r\n    (direction: 'up' | 'down' | 'home' | 'end') => {\r\n      if (filteredUsers.length === 0) return;\r\n\r\n      let newIndex: number;\r\n      switch (direction) {\r\n        case 'up':\r\n          newIndex =\r\n            selectedRowIndex === -1\r\n              ? filteredUsers.length - 1\r\n              : Math.max(selectedRowIndex - 1, 0);\r\n          break;\r\n        case 'down':\r\n          newIndex =\r\n            selectedRowIndex === -1\r\n              ? 0\r\n              : Math.min(selectedRowIndex + 1, filteredUsers.length - 1);\r\n          break;\r\n        case 'home':\r\n          newIndex = 0;\r\n          break;\r\n        case 'end':\r\n          newIndex = filteredUsers.length - 1;\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n\r\n      setSelectedRowIndex(newIndex);\r\n      setSelectedUser(filteredUsers[newIndex]);\r\n\r\n      // Scroll to the selected row\r\n      setTimeout(() => {\r\n        const rowElement = document.querySelector(\r\n          `[data-row-key=\"${filteredUsers[newIndex]._id}\"]`\r\n        ) as HTMLElement;\r\n        if (rowElement) {\r\n          const scrollBehavior =\r\n            direction === 'home'\r\n              ? 'start'\r\n              : direction === 'end'\r\n                ? 'end'\r\n                : 'nearest';\r\n          rowElement.scrollIntoView({\r\n            behavior: 'smooth',\r\n            block: scrollBehavior,\r\n          });\r\n        }\r\n      }, 100);\r\n    },\r\n    [filteredUsers, selectedRowIndex]\r\n  );\r\n\r\n  // Debounced search function\r\n  const handleSearch = useCallback(\r\n    (value: string) => {\r\n      setSearchTerm(value);\r\n\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n      }\r\n\r\n      searchTimeoutRef.current = setTimeout(() => {\r\n        if (value.trim()) {\r\n          BillingUsersApi('GetAll', { searchString: value.trim() });\r\n        } else {\r\n          BillingUsersApi('GetAll');\r\n        }\r\n      }, 300);\r\n    },\r\n    [BillingUsersApi]\r\n  );\r\n\r\n  // Handle user selection\r\n  const handleUserSelect = useCallback(\r\n    (user: User) => {\r\n      setSelectedUser(user);\r\n      onSelect(user);\r\n      setTimeout(() => onCancel(), 100);\r\n    },\r\n    [onSelect, onCancel]\r\n  );\r\n\r\n  // Handle keyboard events\r\n  const handleKeyDown = useCallback(\r\n    (e: React.KeyboardEvent) => {\r\n      if (e.key === 'Escape') {\r\n        onCancel();\r\n      } else if (['ArrowDown', 'ArrowUp', 'Home', 'End'].includes(e.key)) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const directionMap: Record<string, 'up' | 'down' | 'home' | 'end'> = {\r\n          ArrowDown: 'down',\r\n          ArrowUp: 'up',\r\n          Home: 'home',\r\n          End: 'end',\r\n        };\r\n\r\n        navigateToUser(directionMap[e.key]);\r\n      }\r\n    },\r\n    [navigateToUser, onCancel]\r\n  );\r\n\r\n  // Global keyboard event handler\r\n  const handleGlobalKeyDown = useCallback(\r\n    (e: KeyboardEvent) => {\r\n      if (!visible) return;\r\n\r\n      // Don't interfere if user is typing in form inputs\r\n      const target = e.target as HTMLElement;\r\n      if (\r\n        target.tagName === 'INPUT' ||\r\n        target.tagName === 'TEXTAREA' ||\r\n        target.classList.contains('ant-select-selector') ||\r\n        target.closest('.ant-select-dropdown')\r\n      ) {\r\n        return;\r\n      }\r\n\r\n      if (e.ctrlKey && e.key === 'f') {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (searchInputRef.current) {\r\n          searchInputRef.current.focus();\r\n          searchInputRef.current.select();\r\n        }\r\n        return;\r\n      }\r\n\r\n      // Only handle navigation keys globally when not in form inputs\r\n      if (['ArrowDown', 'ArrowUp', 'Home', 'End'].includes(e.key)) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        const directionMap: Record<string, 'up' | 'down' | 'home' | 'end'> = {\r\n          ArrowDown: 'down',\r\n          ArrowUp: 'up',\r\n          Home: 'home',\r\n          End: 'end',\r\n        };\r\n\r\n        navigateToUser(directionMap[e.key]);\r\n      }\r\n    },\r\n    [visible, navigateToUser]\r\n  );\r\n\r\n  // Memoized table columns\r\n  const columns = useMemo(\r\n    () => [\r\n      {\r\n        title: '',\r\n        key: 'select',\r\n        width: 60,\r\n        render: (text: string, record: User) => (\r\n          <div\r\n            style={{\r\n              cursor: 'pointer',\r\n              display: 'flex',\r\n              justifyContent: 'center',\r\n              alignItems: 'center',\r\n            }}\r\n            onClick={() => {\r\n              setSelectedUser(record);\r\n              const index = filteredUsers.findIndex(\r\n                (u: User) => u._id === record._id\r\n              );\r\n              setSelectedRowIndex(index);\r\n            }}\r\n          >\r\n            <div\r\n              style={{\r\n                width: '18px',\r\n                height: '18px',\r\n                borderRadius: '50%',\r\n                border:\r\n                  selectedUser?._id === record._id\r\n                    ? '2px solid #1890ff'\r\n                    : '2px solid #d9d9d9',\r\n                backgroundColor:\r\n                  selectedUser?._id === record._id ? '#1890ff' : 'white',\r\n                display: 'flex',\r\n                alignItems: 'center',\r\n                justifyContent: 'center',\r\n                transition: 'all 0.2s ease',\r\n              }}\r\n            >\r\n              {selectedUser?._id === record._id && (\r\n                <div\r\n                  style={{\r\n                    width: '8px',\r\n                    height: '8px',\r\n                    borderRadius: '50%',\r\n                    backgroundColor: 'white',\r\n                  }}\r\n                />\r\n              )}\r\n            </div>\r\n          </div>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Name',\r\n        dataIndex: 'name',\r\n        key: 'name',\r\n        render: (text: string, record: User) => (\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n            <UserOutlined style={{ color: '#1890ff' }} />\r\n            <div>\r\n              <Text strong>{text}</Text>\r\n              <br />\r\n              <Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n                @{record.user_name}\r\n              </Text>\r\n            </div>\r\n          </div>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Role',\r\n        key: 'role',\r\n        render: (text: string, record: User) => (\r\n          <Tag color=\"blue\">\r\n            {record.roleItems?.name || 'No Role'}\r\n          </Tag>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Mobile',\r\n        dataIndex: 'mobile',\r\n        key: 'mobile',\r\n        render: (text: string) => (\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n            <PhoneOutlined style={{ color: '#666' }} />\r\n            <Text>{text}</Text>\r\n          </div>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Email',\r\n        dataIndex: 'email',\r\n        key: 'email',\r\n        render: (text: string) => (\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\r\n            <MailOutlined style={{ color: '#666' }} />\r\n            <Text>{text || '-'}</Text>\r\n          </div>\r\n        ),\r\n      },\r\n      {\r\n        title: 'Branch',\r\n        key: 'branch',\r\n        render: (text: string, record: User) => (\r\n          <Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n            {record.branchItems?.branch_name || '-'}\r\n          </Text>\r\n        ),\r\n      },\r\n    ],\r\n    [selectedUser, filteredUsers]\r\n  );\r\n\r\n  // Memoized table row props\r\n  const getRowProps = useCallback(\r\n    (record: User, index?: number) => ({\r\n      onClick: () => {\r\n        setSelectedUser(record);\r\n        setSelectedRowIndex(index ?? 0);\r\n      },\r\n      style: {\r\n        cursor: 'pointer',\r\n        backgroundColor:\r\n          selectedUser?._id === record._id ? '#f0f8ff' : 'white',\r\n        border:\r\n          selectedUser?._id === record._id\r\n            ? '2px solid #1890ff'\r\n            : '1px solid #f0f0f0',\r\n        borderRadius: '4px',\r\n        transition: 'all 0.2s ease',\r\n      },\r\n      onMouseEnter: (e: React.MouseEvent<HTMLElement>) => {\r\n        if (selectedUser?._id !== record._id) {\r\n          e.currentTarget.style.backgroundColor = '#f5f5f5';\r\n        }\r\n      },\r\n      onMouseLeave: (e: React.MouseEvent<HTMLElement>) => {\r\n        if (selectedUser?._id !== record._id) {\r\n          e.currentTarget.style.backgroundColor = 'white';\r\n        }\r\n      },\r\n    }),\r\n    [selectedUser]\r\n  );\r\n\r\n  // Load users on mount and handle modal close\r\n  useEffect(() => {\r\n    if (visible) {\r\n      BillingUsersApi('GetAll');\r\n      setSelectedUser(null);\r\n      setSelectedRowIndex(-1);\r\n    } else {\r\n      setSearchTerm('');\r\n      setSelectedUser(null);\r\n      setSelectedRowIndex(-1);\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n        searchTimeoutRef.current = null;\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [visible, BillingUsersApi]);\r\n\r\n  // Auto-select current user when users are loaded\r\n  useEffect(() => {\r\n    if (visible && users.length > 0 && currentUser?._id && !selectedUser) {\r\n      const currentUserInList = users.find((user: User) => user._id === currentUser._id);\r\n      if (currentUserInList) {\r\n        setSelectedUser(currentUserInList);\r\n        const index = users.findIndex((user: User) => user._id === currentUser._id);\r\n        setSelectedRowIndex(index);\r\n        \r\n        // Scroll to the selected user after a short delay\r\n        setTimeout(() => {\r\n          const rowElement = document.querySelector(\r\n            `[data-row-key=\"${currentUserInList._id}\"]`\r\n          ) as HTMLElement;\r\n          if (rowElement) {\r\n            rowElement.scrollIntoView({\r\n              behavior: 'smooth',\r\n              block: 'center',\r\n            });\r\n          }\r\n        }, 200);\r\n      }\r\n    }\r\n  }, [visible, users, currentUser?._id, selectedUser]);\r\n\r\n  // Focus search input when modal becomes visible\r\n  useEffect(() => {\r\n    if (visible && searchInputRef.current) {\r\n      const focusSearch = () => {\r\n        if (searchInputRef.current) {\r\n          searchInputRef.current.focus();\r\n          searchInputRef.current.select();\r\n        }\r\n      };\r\n\r\n      focusSearch();\r\n      const timer = setTimeout(focusSearch, 100);\r\n\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [visible]);\r\n\r\n  // Global keyboard event listener\r\n  useEffect(() => {\r\n    if (visible) {\r\n      document.addEventListener('keydown', handleGlobalKeyDown, true);\r\n      return () =>\r\n        document.removeEventListener('keydown', handleGlobalKeyDown, true);\r\n    }\r\n  }, [visible, handleGlobalKeyDown]);\r\n\r\n  // Handle search input focus\r\n  const handleSearchFocus = useCallback(() => {\r\n    setSelectedUser(null);\r\n    setSelectedRowIndex(-1);\r\n  }, []);\r\n\r\n  return (\r\n    <Modal\r\n      title=\"Select User (Billed By)\"\r\n      open={visible}\r\n      onCancel={onCancel}\r\n      footer={null}\r\n      width={900}\r\n      style={{ top: 20 }}\r\n      afterOpenChange={open => {\r\n        if (open && searchInputRef.current) {\r\n          setTimeout(() => {\r\n            searchInputRef.current?.focus();\r\n            searchInputRef.current?.select();\r\n          }, 100);\r\n        }\r\n      }}\r\n    >\r\n      <div\r\n        ref={modalRef}\r\n        style={{ marginBottom: 16 }}\r\n        onKeyDown={handleKeyDown}\r\n        tabIndex={0}\r\n      >\r\n        <Input\r\n          ref={searchInputRef}\r\n          placeholder=\"Search users... (: Navigate, Enter: Select, Esc: Close)\"\r\n          value={searchTerm}\r\n          onChange={e => handleSearch(e.target.value)}\r\n          prefix={<SearchOutlined />}\r\n          style={{ width: '100%' }}\r\n          onKeyDown={e => {\r\n            // Only handle Enter key in search input, let other keys bubble up\r\n            if (e.key === 'Enter' && selectedUser) {\r\n              handleUserSelect(selectedUser);\r\n            }\r\n          }}\r\n          onFocus={handleSearchFocus}\r\n          autoFocus\r\n          onBlur={() => {\r\n            // Auto-focus back to search if modal is still visible\r\n            if (visible && searchInputRef.current) {\r\n              setTimeout(() => {\r\n                if (visible && searchInputRef.current) {\r\n                  searchInputRef.current.focus();\r\n                }\r\n              }, 10);\r\n            }\r\n          }}\r\n          suffix={\r\n            searchTerm && userLoading ? (\r\n              <div style={{ fontSize: '12px', color: '#999' }}>\r\n                Searching...\r\n              </div>\r\n            ) : null\r\n          }\r\n        />\r\n      </div>\r\n\r\n      <div style={{ maxHeight: 400, overflow: 'auto' }}>\r\n        {userLoading ? (\r\n          <div style={{ textAlign: 'center', padding: 40 }}>\r\n            <Text>Loading users...</Text>\r\n          </div>\r\n        ) : filteredUsers.length === 0 ? (\r\n          <div style={{ textAlign: 'center', padding: 40 }}>\r\n            <Text type=\"secondary\">\r\n              {searchTerm\r\n                ? 'No users found matching your search.'\r\n                : 'No users available.'}\r\n            </Text>\r\n          </div>\r\n        ) : (\r\n          <Table\r\n            columns={columns}\r\n            dataSource={filteredUsers}\r\n            rowKey=\"_id\"\r\n            pagination={false}\r\n            size=\"small\"\r\n            scroll={{ y: 300 }}\r\n            onRow={getRowProps}\r\n          />\r\n        )}\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default UserSelectionModal;\r\n","import React from 'react';\r\nimport { Modal, Button, Typography, Space, Divider } from 'antd';\r\nimport { \r\n  FileTextOutlined, \r\n  PlusOutlined, \r\n  CheckCircleOutlined,\r\n  DollarOutlined,\r\n  UserOutlined,\r\n  CalendarOutlined\r\n} from '@ant-design/icons';\r\nimport dayjs from 'dayjs';\r\n\r\nconst { Title, Text } = Typography;\r\n\r\ninterface BillSaveConfirmationModalProps {\r\n  visible: boolean;\r\n  onNewBill: () => void;\r\n  onContinueBill: () => void;\r\n  onCancel: () => void;\r\n  savedBillData?: any;\r\n}\r\n\r\nconst BillSaveConfirmationModal: React.FC<BillSaveConfirmationModalProps> = ({\r\n  visible,\r\n  onNewBill,\r\n  onContinueBill,\r\n  onCancel,\r\n  savedBillData\r\n}) => {\r\n  return (\r\n    <Modal\r\n      title={\r\n        <div style={{ textAlign: 'center' }}>\r\n          <CheckCircleOutlined \r\n            style={{ \r\n              color: '#52c41a', \r\n              fontSize: '24px', \r\n              marginRight: '8px' \r\n            }} \r\n          />\r\n          <span style={{ color: '#52c41a', fontWeight: 600 }}>\r\n            Bill Saved Successfully!\r\n          </span>\r\n        </div>\r\n      }\r\n      open={visible}\r\n      onCancel={onCancel}\r\n      footer={null}\r\n      width={500}\r\n      centered\r\n      maskClosable={false}\r\n      closable={false}\r\n    >\r\n      <div style={{ textAlign: 'center', marginBottom: '24px' }}>\r\n        <Text type=\"secondary\">\r\n          Your bill has been saved successfully. What would you like to do next?\r\n        </Text>\r\n      </div>\r\n\r\n      {savedBillData && (\r\n        <div\r\n          style={{\r\n            background: 'linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)',\r\n            border: '1px solid #0ea5e9',\r\n            borderRadius: '8px',\r\n            padding: '16px',\r\n            marginBottom: '24px',\r\n          }}\r\n        >\r\n          <Title level={5} style={{ marginBottom: '12px', color: '#0369a1' }}>\r\n             Bill Summary\r\n          </Title>\r\n          <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px' }}>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n              <FileTextOutlined style={{ color: '#0ea5e9' }} />\r\n              <Text strong>Invoice: {savedBillData.invoice_no}</Text>\r\n            </div>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n              <UserOutlined style={{ color: '#0ea5e9' }} />\r\n              <Text strong>{savedBillData.customer_name || 'N/A'}</Text>\r\n            </div>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n              <CalendarOutlined style={{ color: '#0ea5e9' }} />\r\n              <Text strong>{dayjs(savedBillData.date).format('DD/MM/YYYY')}</Text>\r\n            </div>\r\n            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n              <DollarOutlined style={{ color: '#0ea5e9' }} />\r\n              <Text strong>{(typeof savedBillData.total_amount === 'number' ? savedBillData.total_amount : parseFloat(savedBillData.total_amount) || 0).toFixed(2)}</Text>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <Divider style={{ margin: '20px 0' }} />\r\n\r\n      <Space direction=\"vertical\" size=\"middle\" style={{ width: '100%' }}>\r\n        <Button\r\n          type=\"primary\"\r\n          size=\"large\"\r\n          icon={<PlusOutlined />}\r\n          onClick={onNewBill}\r\n          style={{\r\n            width: '100%',\r\n            height: '48px',\r\n            background: 'linear-gradient(135deg, #10b981 0%, #059669 100%)',\r\n            border: 'none',\r\n            fontWeight: 600,\r\n            fontSize: '16px',\r\n            borderRadius: '8px',\r\n          }}\r\n        >\r\n           Create New Bill\r\n        </Button>\r\n        \r\n        <Button\r\n          size=\"large\"\r\n          icon={<FileTextOutlined />}\r\n          onClick={onContinueBill}\r\n          style={{\r\n            width: '100%',\r\n            height: '48px',\r\n            background: 'linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)',\r\n            color: 'white',\r\n            border: 'none',\r\n            fontWeight: 600,\r\n            fontSize: '16px',\r\n            borderRadius: '8px',\r\n          }}\r\n        >\r\n           Continue with Current Bill\r\n        </Button>\r\n      </Space>\r\n\r\n      <div style={{ textAlign: 'center', marginTop: '16px' }}>\r\n        <Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n           Tip: Use \"New Bill\" to start fresh or \"Continue Bill\" to add more items\r\n        </Text>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default BillSaveConfirmationModal;\r\n"],"names":["Title","Text","Typography","Option","Select","CustomerSelectionModalComponent","_ref","visible","onSelect","onCancel","getEntityApi","useApiActions","CustomerApi","items","customerList","loading","customerLoading","useDynamicSelector","getIdentifier","createLoading","customers","result","searchTerm","setSearchTerm","useState","showAddForm","setShowAddForm","selectedCustomer","setSelectedCustomer","selectedRowIndex","setSelectedRowIndex","showCreateGrid","setShowCreateGrid","newCustomerData","setNewCustomerData","full_name","email","mobile","address","customer_type","form","Form","useForm","searchInputRef","useRef","modalRef","searchTimeoutRef","createGridRef","firstFormInputRef","filteredCustomers","useMemo","shouldShowCreateGrid","trim","length","getCustomerTypeColor","useCallback","type","vip","wholesale","regular","navigateToCustomer","direction","newIndex","Math","max","min","setTimeout","rowElement","document","querySelector","concat","_id","scrollBehavior","scrollIntoView","behavior","block","handleSearch","value","current","clearTimeout","searchString","handleCustomerSelect","customer","handleCreateCustomerFromForm","async","message","error","clearFormData","resetFields","handleFormFieldChange","field","prev","_objectSpread","handleKeyDown","e","key","includes","preventDefault","stopPropagation","ArrowDown","ArrowUp","Home","End","handleGlobalKeyDown","target","tagName","classList","contains","closest","ctrlKey","focus","select","firstInput","columns","title","width","render","text","record","_jsx","style","cursor","display","justifyContent","alignItems","onClick","index","findIndex","c","children","height","borderRadius","border","backgroundColor","transition","dataIndex","_jsxs","gap","strong","Tag","color","toUpperCase","PhoneOutlined","MailOutlined","HomeOutlined","marginTop","fontSize","getRowProps","onMouseEnter","currentTarget","onMouseLeave","useEffect","focusSearch","timer","addEventListener","removeEventListener","useHandleApiResponse","action","identifier","entityApi","createResult","content","duration","destroy","statusCode","newCustomer","data","handleSearchFocus","Modal","open","footer","top","afterOpenChange","_searchInputRef$curre","_searchInputRef$curre2","ref","marginBottom","onKeyDown","tabIndex","Space","Compact","Input","placeholder","onChange","prefix","SearchOutlined","flex","onFocus","autoFocus","onBlur","undefined","suffix","Button","icon","UserAddOutlined","newState","minWidth","padding","background","boxShadow","position","overflow","right","opacity","zIndex","bottom","left","Row","justify","align","Col","level","margin","WebkitBackgroundClip","WebkitTextFillColor","backgroundClip","fontWeight","PlusOutlined","marginRight","size","CloseOutlined","SaveOutlined","layout","gridTemplateColumns","Item","name","label","UserOutlined","rules","required","pattern","TextArea","rows","resize","Divider","maxHeight","textAlign","Table","dataSource","rowKey","pagination","scroll","y","onRow","React","onSave","onAdd","onDelete","allowAdd","allowDelete","compact","enableKeyboardNav","className","onProductSelect","externalEditingCell","setData","selectedRows","setSelectedRows","editingCell","setEditingCell","firstLoadRef","firstProductColIndex","col","row","String","handleAddRow","firstEditableCol","editable","saveCell","column","validation","newData","shiftKey","toLowerCase","rowSelection","selectedRowKeys","getNextEditableCol","startCol","EditableCell","_ref2","_data$row","_data$row2","cellValue","setCellValue","inputRef","isProductModalVisible","setIsProductModalVisible","isStockModalVisible","setIsStockModalVisible","_inputRef$current","handleChange","val","nextCol","nextRow","colIndex","handleProductSelect","product","handleStockSelect","stock","stock_id","id","batch_no","_Fragment","ProductSelectionModal","readOnly","StockSelectionModal","productId","product_id","InputNumber","controls","options","_inputRef$current2","DatePicker","dayjs","date","format","mergedColumns","map","onCell","_record","rowIndex","onContextMenu","product_name","option","find","opt","danger","DeleteOutlined","handleDeleteRow","confirm","onOk","slice","warning","bordered","Search","_stocks$result","StockApi","stocks","selectedRowKey","setSelectedRowKey","highlightedIndex","setHighlightedIndex","errorMessage","setErrorMessage","tableBodyRef","isStockExpired","expiry_date","isBefore","isStockOutOfStock","available_quantity","showExpiredStockError","expiryDate","errorMsg","showOutOfStockError","allStocks","filter","s","_s$batch_no","_s$ProductItem","_s$ProductItem$name","_s$ProductItem2","_s$ProductItem2$Varia","_s$ProductItem2$Varia2","_s$available_quantity","_s$sell_price","searchLower","ProductItem","VariantItem","variant_name","toString","sell_price","firstValidIndex","_allStocks$highlighte","_ProductItem$VariantI","isOutOfStock","ExclamationCircleOutlined","marginLeft","today","isExpired","daysUntilExpiry","diff","CheckCircleOutlined","status","Tooltip","handleSelectRow","_stock$ProductItem","code","destroyOnClose","handleModalClick","_searchInputRef$curre7","next","finalNext","_searchInputRef$curre3","prevIndex","finalPrev","selectedStock","_searchInputRef$curre8","_searchInputRef$curre4","i","_searchInputRef$curre5","_searchInputRef$curre6","outline","idx","_searchInputRef$curre9","onDoubleClick","keys","getCheckboxProps","disabled","_products$result","ProductsApi","products","scannerVisible","setScannerVisible","filteredProducts","p","_p$name","_p$sku","_p$VariantItem","_p$VariantItem$varian","_p$VariantItem2","_p$VariantItem2$varia","_p$selling_price","sku","variant_code","selling_price","sort","a","b","_a$name","_a$VariantItem","_a$VariantItem$varian","_a$sku","_b$name","_b$VariantItem","_b$VariantItem$varian","_b$sku","_a$name2","_a$VariantItem2","_a$VariantItem2$varia","_a$sku2","_b$name2","_b$VariantItem2","_b$VariantItem2$varia","_b$sku2","aExactMatch","bExactMatch","aStartsWith","startsWith","bStartsWith","_record$VariantItem","_record$VariantItem2","variant","fontStyle","price","toFixed","selectedProduct","ScanOutlined","BarcodeScanner","onClose","onScan","barcode","_products$result2","foundProduct","_p$sku2","_p$name2","_p$VariantItem3","_p$VariantItem3$varia","success","description","calculateBillTotals","productList","isGstIncluded","discount","discountType","itemsWithTax","item","_product$CategoryItem","_product$VariantItem","taxPercentage","tax_percentage","CategoryItem","baseAmount","Number","qty","loose_qty","pack_size","amount","sub_total","reduce","sum","base_sub_total","discountValue","total_gst","value_of_goods","total_amount","forEach","discountedBase","gstAmount","cgst","sgst","_productDetails$Varia","_productDetails$Varia2","_productDetails$Varia3","_productDetails$selli","_productDetails$mrp","_productDetails$Categ","_productDetails$Categ2","productDetails","setProductDetails","handleCancel","Descriptions","span","brand","unit","mrp","min_stock","max_stock","onViewBill","onNewBill","SalesRecord","billList","filteredBills","setFilteredBills","filtered","bill","_bill$customerDetails","invoiceNo","invoice_no","customerName","customerDetails","totalAmount","getPaymentStatusText","isPaid","isPartiallyPaid","handleViewBill","handleNewBill","Drawer","placement","bodyStyle","headerStyle","borderBottom","allowClear","Spin","Empty","List","renderItem","_bill$customerDetails2","transform","Avatar","FileTextOutlined","is_paid","is_partially_paid","customer_name","CalendarOutlined","DollarOutlined","parseFloat","EyeOutlined","PrinterOutlined","borderTop","BillingUsersApi","userList","userLoading","users","selectedUser","setSelectedUser","currentUser","getCurrentUser","filteredUsers","user","_user$name","_user$email","_user$mobile","_user$user_name","_user$roleItems","_user$roleItems$name","user_name","roleItems","navigateToUser","handleUserSelect","u","_record$roleItems","_record$branchItems","branchItems","branch_name","currentUserInList","onContinueBill","savedBillData","centered","maskClosable","closable"],"sourceRoot":""}