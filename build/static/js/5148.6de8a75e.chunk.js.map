{"version":3,"file":"static/js/5148.6de8a75e.chunk.js","mappings":";6jBA4BA,MAAMA,EAA0F,CAC9FC,MAAO,CAAEC,MAAO,UAAWC,MAAMC,EAAAA,EAAAA,KAACC,EAAAA,EAAY,IAAKC,MAAO,SAC1DC,iBAAkB,CAAEL,MAAO,UAAWC,MAAMC,EAAAA,EAAAA,KAACI,EAAAA,EAAmB,IAAKF,MAAO,oBAC5EG,SAAU,CAAEP,MAAO,UAAWC,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAAKJ,MAAO,YACpEK,SAAU,CAAET,MAAO,QAASC,MAAMC,EAAAA,EAAAA,KAACQ,EAAAA,EAAmB,IAAKN,MAAO,YAClEO,KAAM,CAAEX,MAAO,aAAcC,MAAMC,EAAAA,EAAAA,KAACU,EAAAA,EAAY,IAAKR,MAAO,QAC5DS,UAAW,CAAEb,MAAO,OAAQC,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAAKJ,MAAO,aAClEU,mBAAoB,CAAEd,MAAO,SAAUC,MAAMC,EAAAA,EAAAA,KAACa,EAAAA,EAAa,IAAKX,MAAO,sBACvEY,eAAgB,CAAEhB,MAAO,QAASC,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAAKJ,MAAO,kBACxEa,UAAW,CAAEjB,MAAO,MAAOC,MAAMC,EAAAA,EAAAA,KAACgB,EAAAA,EAAY,IAAKd,MAAO,aAC1De,OAAQ,CAAEnB,MAAO,UAAWC,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAAKJ,MAAO,qGCTpE,MAqXA,EArX0DgB,IAInD,IAJoD,MACzDC,EAAQ,GAAE,SACVC,EAAQ,SACRC,GAAW,GACZH,EAEC,MAAMI,GAAcC,EAAAA,EAAAA,UAAQ,MAASC,WAAY,EAAGC,UAAW,OAAQ,KAC/DC,KAAMC,EAAcC,UAAWC,GAAoBC,EAAAA,GAASC,mBAAmBT,GAEjFU,GAAWT,EAAAA,EAAAA,UAAQ,KAAmB,OAAZI,QAAY,IAAZA,OAAY,EAAZA,EAAsBM,SAAU,IAAI,CAACN,IAG/DO,GAAgBC,EAAAA,EAAAA,cAAY,KAgBxB,OAARf,QAAQ,IAARA,GAAAA,EAAW,IAAID,EAfsB,CACnCiB,WAAY,GACZC,aAAc,GACdC,aAAc,GACdC,YAAa,GACbC,SAAU,EACVC,WAAY,EACZC,eAAgB,EAChBC,SAAU,EACVC,cAAe,aACfC,WAAY,EACZC,kBAAmB,EACnBC,iBAAkB,OAInB,CAAC5B,EAAOC,IAGL4B,GAAmBb,EAAAA,EAAAA,cAAac,IACpC,MAAMC,EAAW/B,EAAMgC,QAAO,CAACC,EAAGC,IAAMA,IAAMJ,IACtC,OAAR7B,QAAQ,IAARA,GAAAA,EAAW8B,KACV,CAAC/B,EAAOC,IAGLkC,GAAqBnB,EAAAA,EAAAA,cAAaoB,IACtC,MAAMC,EAAMC,OAAOF,EAAKf,WAAa,EAC/BkB,EAAQD,OAAOF,EAAKd,aAAe,EACnCkB,EAASF,OAAOF,EAAKb,iBAAmB,EACxCkB,EAAcH,OAAOF,EAAKZ,WAAa,EAG7C,IAAIkB,EAAWL,EAAME,EAInBG,GADmB,gBALAN,EAAKX,eAAiB,cAMlBiB,EAAWD,EAAc,IAE1BA,EAOxB,MAAO,CACLf,WAAYY,QAHAI,EADIA,GAAYF,EAAS,MAIZG,QAAQ,IACjCf,iBAAkBS,GAAOD,EAAKT,mBAAqB,MAEpD,IAGGiB,GAAoB5B,EAAAA,EAAAA,cAAY,CAACc,EAAee,EAAeC,KACnE,MAAMf,EAAW,IAAI/B,GACfoC,GAAIW,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQhB,EAASD,IAAM,IAAE,CAACe,GAAQC,IAG5C,GAAI,CAAC,WAAY,aAAc,iBAAkB,WAAY,iBAAiBE,SAASH,GAAQ,CAC7F,MAAMI,EAAad,EAAmBC,GACtCc,OAAOC,OAAOf,EAAMa,EACtB,CAEAlB,EAASD,GAASM,EACV,OAARnC,QAAQ,IAARA,GAAAA,EAAW8B,KACV,CAAC/B,EAAOC,EAAUkC,IAGfiB,GAAsBpC,EAAAA,EAAAA,cAAY,CAACc,EAAeuB,KAAuB,IAADC,EAC5E,MAAMC,EAAU1C,EAAS2C,MAAMC,GAAWA,EAAEC,MAAQL,IACpD,IAAKE,EAAS,OAEd,MAAMxB,EAAW,IAAI/B,GACfoC,GAAIW,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACLhB,EAASD,IAAM,IAClBb,WAAYoC,EACZnC,aAAcqC,EAAQI,KACtBxC,cAAiC,QAAnBmC,EAAAC,EAAQK,mBAAW,IAAAN,OAAA,EAAnBA,EAAqBnC,eAAgB,GACnDC,YAAamC,EAAQnC,aAAe,GAEpCG,eAAgB,EAChBD,WAAY,IAGR2B,EAAad,EAAmBC,GACtCL,EAASD,IAAMiB,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAAQX,GAASa,GACxB,OAARhD,QAAQ,IAARA,GAAAA,EAAW8B,KACV,CAAC/B,EAAOC,EAAUY,EAAUsB,IAGzB0B,GAASzD,EAAAA,EAAAA,UAAQ,KACrB,MAAMsC,EAAW1C,EAAM8D,QAAO,CAACC,EAAK3B,KAClC,MAAMC,EAAMC,OAAOF,EAAKf,WAAa,EAC/BkB,EAAQD,OAAOF,EAAKd,aAAe,EACnCmB,EAAcH,OAAOF,EAAKZ,WAAa,EAG7C,IAAIwC,EAAe3B,EAAME,EAOzB,OALEyB,GADmB,gBAHA5B,EAAKX,eAAiB,cAIVuC,EAAevB,EAAc,IAE9BA,EAGzBsB,EAAMC,IACZ,GAEGC,EAAYjE,EAAM8D,QAAO,CAACC,EAAK3B,KACnC,MAAMC,EAAMC,OAAOF,EAAKf,WAAa,EAC/BkB,EAAQD,OAAOF,EAAKd,aAAe,EACnCkB,EAASF,OAAOF,EAAKb,iBAAmB,EACxCkB,EAAcH,OAAOF,EAAKZ,WAAa,EAG7C,IAAIwC,EAAe3B,EAAME,EAOzB,OALEyB,GADmB,gBAHA5B,EAAKX,eAAiB,cAIVuC,EAAevB,EAAc,IAE9BA,EAGzBsB,EAAOC,EAAexB,EAAS,MACrC,GAEG0B,EAAQxB,EAAWuB,EAEzB,MAAO,CACLvB,SAAUJ,OAAOI,EAASC,QAAQ,IAClCsB,UAAW3B,OAAO2B,EAAUtB,QAAQ,IACpCuB,MAAO5B,OAAO4B,EAAMvB,QAAQ,OAE7B,CAAC3C,IAGEmE,EAAU,CACd,CACEC,MAAO,IACPC,IAAK,QACLC,MAAO,GACPC,OAAQA,CAACtC,EAAQuC,EAAS1C,IAAkBA,EAAQ,GAEtD,CACEsC,OAAOvF,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,cACtCL,IAAK,UACLC,MAAO,IACPC,OAAQA,CAACtC,EAAQ0C,EAAoB7C,KACnCjD,EAAAA,EAAAA,KAAC+F,EAAAA,EAAM,CACLC,YAAU,EACVC,YAAU,EACVC,YAAY,iBACZN,MAAO,CAAEH,MAAO,QAChBtE,MAAO2E,EAAO1D,iBAAc+D,EAC5B/E,SAAWgF,GAAQ7B,EAAoBtB,EAAOmD,GAC9C/E,SAAUA,EACVgF,QAASxE,EACTyE,aAAcA,CAACC,EAAOC,IACNC,QAAa,OAAND,QAAM,IAANA,OAAM,EAANA,EAAQX,WAAY,IAC5Ba,cAAcvC,SAASoC,EAAMG,eAE5CC,gBAAiB9E,EAAkB,sBAAwB,oBAAoBgE,SAE9E7D,EAAS4E,KAAKlC,IAAY,IAAAmC,EAAA,OACzBC,EAAAA,EAAAA,MAACf,EAAAA,EAAOgB,OAAM,CAAmB5F,MAAOuD,EAAQG,IAAIgB,SAAA,CACjDnB,EAAQI,KAAK,IAAqB,QAAnB+B,EAAAnC,EAAQK,mBAAW,IAAA8B,GAAnBA,EAAqBvE,aAAY,KAAA0E,OAAQtC,EAAQK,YAAYzC,cAAiB,KAD5EoC,EAAQG,WAOpC,CACEU,MAAO,cACPC,IAAK,cACLC,MAAO,IACPC,OAAQA,CAACtC,EAAQ0C,EAAoB7C,KACnCjD,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CACJf,YAAY,cACZ/E,MAAO2E,EAAOvD,YACdnB,SAAW8F,GAAMnD,EAAkBd,EAAO,cAAeiE,EAAEC,OAAOhG,OAClEE,SAAUA,KAIhB,CACEkE,OAAOvF,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,eACtCL,IAAK,WACLC,MAAO,IACPC,OAAQA,CAACtC,EAAQ0C,EAAoB7C,KACnCjD,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLC,UAAW,EACXpB,YAAY,MACZN,MAAO,CAAEH,MAAO,QAChBtE,MAAO2E,EAAOtD,SACdpB,SAAWgF,GAAQrC,EAAkBd,EAAO,WAAYmD,GACxD/E,SAAUA,KAIhB,CACEkE,MAAO,aACPC,IAAK,aACLC,MAAO,IACPC,OAAQA,CAACtC,EAAQ0C,EAAoB7C,KACnCjD,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLC,UAAW,EACXpB,YAAY,mBACZqB,OAAO,SACP3B,MAAO,CAAEH,MAAO,QAChBtE,MAAO2E,EAAOrD,WACdrB,SAAWgF,GAAQrC,EAAkBd,EAAO,aAAcmD,GAC1D/E,UAAU,KAIhB,CACEkE,MAAO,QACPC,IAAK,iBACLC,MAAO,GACPC,OAAQA,CAACtC,EAAQ0C,EAAoB7C,KACnCjD,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLG,IAAK,IACLF,UAAW,EACXpB,YAAY,mBACZuB,OAAO,IACP7B,MAAO,CAAEH,MAAO,QAChBtE,MAAO2E,EAAOpD,eACdtB,SAAWgF,GAAQrC,EAAkBd,EAAO,iBAAkBmD,GAC9D/E,UAAU,KAIhB,CACEkE,MAAO,WACPC,IAAK,WACLC,MAAO,IACPC,OAAQA,CAACtC,EAAQ0C,EAAoB7C,KACnC6D,EAAAA,EAAAA,MAACY,EAAAA,EAAMC,QAAO,CAAC/B,MAAO,CAAEH,MAAO,QAASI,SAAA,EACtC7F,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLC,UAAW,EACXpB,YAAY,mBACZN,MAAO,CAAEH,MAAO,OAChBtE,MAAO2E,EAAOnD,SACdvB,SAAWgF,GAAQrC,EAAkBd,EAAO,WAAYmD,GACxD/E,UAAU,KAEZyF,EAAAA,EAAAA,MAACf,EAAAA,EAAM,CACLH,MAAO,CAAEH,MAAO,OAChBtE,MAAO2E,EAAOlD,cACdxB,SAAWgF,GAAQrC,EAAkBd,EAAO,gBAAiBmD,GAC7D/E,UAAU,EAAKwE,SAAA,EAEf7F,EAAAA,EAAAA,KAAC+F,EAAAA,EAAOgB,OAAM,CAAC5F,MAAM,aAAY0E,SAAC,OAClC7F,EAAAA,EAAAA,KAAC+F,EAAAA,EAAOgB,OAAM,CAAC5F,MAAM,SAAQ0E,SAAC,kBAKtC,CACEN,MAAO,aACPC,IAAK,aACLC,MAAO,IACPC,OAAQA,CAACtC,EAAQ0C,KACf9F,EAAAA,EAAAA,KAAC4H,EAAAA,EAAO,CAACrC,MAAOO,EAAOrD,WAAa,EAAC,QAAAuE,OAAWlB,EAAOtD,SAAQ,gBAAAwE,OAAOlB,EAAOrD,YAAe,+BAA+BoD,UACzH7F,EAAAA,EAAAA,KAAA,UAAQ4F,MAAO,CAAE9F,MAAOgG,EAAOrD,WAAa,EAAI,UAAY,QAASoD,SAClEC,EAAOrD,WAAa,EAAC,SAAAuE,QACblB,EAAOjD,YAAc,GAAGgF,eAAe,QAAS,CAAEC,sBAAuB,KAC9E,WAKZ,CACEvC,MAAO,gBACPC,IAAK,yBACLC,MAAO,IACPC,OAAQA,CAACtC,EAAQ0C,EAAoB7C,KACnCjD,EAAAA,EAAAA,KAAC+H,EAAAA,EAAU,CACTC,OAAO,aACPpC,MAAO,CAAEH,MAAO,QAChBtE,MAAO2E,EAAOmC,uBAAyBC,IAAMpC,EAAOmC,6BAA0B9B,EAC9E/E,SAAW+G,GAASpE,EAAkBd,EAAO,yBAA8B,OAAJkF,QAAI,IAAJA,OAAI,EAAJA,EAAMH,OAAO,eACpF3G,SAAUA,KAIhB,CACEkE,MAAO,UACPC,IAAK,UACLC,MAAO,GACPC,OAAQA,CAACtC,EAAQ0C,EAAoB7C,KACnCjD,EAAAA,EAAAA,KAACoI,EAAAA,EAAU,CACT7C,MAAM,yBACN8C,UAAWA,IAAMrF,EAAiBC,GAClC5B,SAAUA,GAA6B,IAAjBF,EAAMmH,OAAazC,UAEzC7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CACLC,KAAK,OACLC,QAAM,EACNC,KAAK,QACL3I,MAAMC,EAAAA,EAAAA,KAAC2I,EAAAA,EAAc,IACrBtH,SAAUA,GAA6B,IAAjBF,EAAMmH,aAOtC,OACExB,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEH,MAAO,QAASI,SAAA,EAC5BiB,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEgD,aAAc,GAAIC,QAAS,OAAQC,eAAgB,gBAAiBC,WAAY,UAAWlD,SAAA,EACvG7F,EAAAA,EAAAA,KAAA,UAAQ4F,MAAO,CAAEoD,SAAU,QAASnD,SAAC,gBACrC7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CACLC,KAAK,SACLzI,MAAMC,EAAAA,EAAAA,KAACiJ,EAAAA,EAAY,IACnBC,QAAShH,EACTb,SAAUA,EAASwE,SACpB,iBAKH7F,EAAAA,EAAAA,KAACmJ,EAAAA,EAAK,CACJ7D,QAASA,EACT8D,WAAYjI,EACZkI,YAAY,EACZX,KAAK,QACLY,OAAQ,CAAEC,EAAG,eACbC,OAAQA,CAAC1D,EAAQ7C,IAAK,QAAA+D,OAAa/D,GACnCwG,UAAQ,EACRC,OAAQA,KACN1J,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAE+D,UAAW,SAAU9D,UACjCiB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAACkC,UAAU,WAAWlB,KAAK,QAAQ9C,MAAO,CAAEH,MAAO,QAASI,SAAA,EAChEiB,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,WAAYe,IAAK,QAAShE,SAAA,EACvE7F,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,eACNiB,EAAAA,EAAAA,MAAA,UAAAjB,SAAA,CAAQ,SAAEb,EAAOnB,SAASgE,eAAe,QAAS,CAAEC,sBAAuB,WAE7EhB,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,WAAYe,IAAK,QAAShE,SAAA,EACvE7F,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,iBACNiB,EAAAA,EAAAA,MAAA,UAAAjB,SAAA,CAAQ,SAAEb,EAAOI,UAAUyC,eAAe,QAAS,CAAEC,sBAAuB,WAE9EhB,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,WAAYe,IAAK,OAAQb,SAAU,OAAQlJ,MAAO,WAAY+F,SAAA,EAC3GiB,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,EAAM7F,EAAAA,EAAAA,KAAC8J,EAAAA,EAAkB,IAAG,cAC5BhD,EAAAA,EAAAA,MAAA,UAAAjB,SAAA,CAAQ,SAAEb,EAAOK,MAAMwC,eAAe,QAAS,CAAEC,sBAAuB,iBAOhE,IAAjB3G,EAAMmH,SACLtI,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAE+D,UAAW,SAAUI,QAAS,OAAQjK,MAAO,QAAS+F,SAAC,8ICvW7E,MAslBA,GAtlBsD3E,IAI/C,IAJgD,KACrD8I,EAAI,QACJC,EAAO,cACPC,GACDhJ,EACC,MAAOiJ,GAAQC,EAAAA,EAAKC,WACbC,EAAWC,IAAgBC,EAAAA,EAAAA,UAAgB,KAC3CC,EAAoBC,IAAyBF,EAAAA,EAAAA,WAAS,IACtDG,EAAcC,IAAmBJ,EAAAA,EAAAA,UAAiB,IAElDK,GAAc,UAAEjJ,KAAekJ,EAAAA,EAAAA,OAGtCC,EAAAA,EAAAA,YAAU,KACR,GAAiB,OAAbb,QAAa,IAAbA,GAAAA,EAAec,MAAO,CACxB,MAAMA,EAAQd,EAAcc,MAAMpE,KAAKrD,IAASW,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GAC3CX,GAAI,IACP0H,gBAAiB1H,EAAKsB,IACtBqG,iBAAkB3H,EAAKf,SACvBM,kBAAmBS,EAAKR,kBAAqBQ,EAAKf,UAAYe,EAAKT,mBAAqB,GACxFqI,kBAAmB,EACnBC,kBAAmB7H,EAAKR,kBAAqBQ,EAAKf,UAAYe,EAAKT,mBAAqB,GACxFuI,SAAU,GACVC,cAAUnF,EACVoF,iBAAapF,EACbqF,MAAO,GAEP/I,WAAYc,EAAKd,YAAc,EAC/BC,eAAgBa,EAAKb,gBAAkB,EACvCC,SAAUY,EAAKZ,UAAY,EAC3BC,cAAeW,EAAKX,eAAiB,iBAEvC2H,EAAaS,EACf,CAEiB,OAAbd,QAAa,IAAbA,GAAAA,EAAeuB,cACjBb,EAAgBV,EAAcuB,eAE9Bb,EAAgB,KAEjB,CAACV,IAGJ,MAAMwB,GAAuBvJ,EAAAA,EAAAA,cAAY,CAACc,EAAee,EAAe7C,KACtE,MAAM+B,EAAW,IAAIoH,GACrBpH,EAASD,GAAOe,GAAS7C,EAEX,sBAAV6C,GAA2C,sBAAVA,IACnCd,EAASD,GAAOmI,mBACblI,EAASD,GAAOH,mBAAqB,IAAMI,EAASD,GAAOkI,mBAAqB,IAGrFZ,EAAarH,KACZ,CAACoH,IAGEvG,GAAoB5B,EAAAA,EAAAA,cAAY,CAACc,EAAee,EAAe7C,KACnE,MAAM+B,EAAW,IAAIoH,GACrBpH,EAASD,GAAOe,GAAS7C,EACzBoJ,EAAarH,KACZ,CAACoH,IA0EEtF,EAAS,CACb2G,QAASrB,EAAUrF,QAAO,CAACC,EAAK3B,IAAS2B,GAAO3B,EAAK2H,kBAAoB,IAAI,GAC7EU,SAAUtB,EAAUrF,QAAO,CAACC,EAAK3B,IAAS2B,GAAO3B,EAAKT,mBAAqB,IAAI,GAC/EvC,SAAU+J,EAAUrF,QAAO,CAACC,EAAK3B,IAAS2B,GAAO3B,EAAK4H,mBAAqB,IAAI,GAC/EU,SAAUvB,EAAUrF,QAAO,CAACC,EAAK3B,IAAS2B,GAAO3B,EAAK6H,mBAAqB,IAAI,IAI3EU,GAAkBvK,EAAAA,EAAAA,UAAQ,KAC9B,MAAMwK,EAAgBzB,EAAUnH,QAAOI,GAAQA,EAAKT,kBAAoB,IACxE,IAAIe,EAAW,EACXmI,EAAiB,EACjB5G,EAAY,EAEhB2G,EAAcE,SAAQ1I,IACpB,MAAMC,EAAMD,EAAK6H,mBAAqB,EAChC1H,EAAQD,OAAOF,EAAKd,aAAe,EACnCkB,EAASF,OAAOF,EAAKb,iBAAmB,EACxCkB,EAAcH,OAAOF,EAAKZ,WAAa,EACvCuJ,EAAe3I,EAAKX,eAAiB,aAE3C,GAAIc,EAAQ,EAAG,CACb,IAAIyB,EAAe3B,EAAME,EAGrByI,EAAe,EAEjBA,EADmB,eAAjBD,EACa/G,GAAgBvB,EAAc,KAE9BA,EAEjBuB,GAA8BgH,EAE9BtI,GAAYsB,EACZ6G,GAAkBG,EAClB/G,GAAaD,GAAgBxB,EAAS,IACxC,KAGF,MAAMyI,EAAW3I,OAAOkH,IAAiB,EACnCtF,EAAQxB,EAAWuB,EAAYgH,EAErC,MAAO,CACLvI,SAAUJ,OAAOI,EAASC,QAAQ,IAClCkI,eAAgBvI,OAAOuI,EAAelI,QAAQ,IAC9CsB,UAAW3B,OAAO2B,EAAUtB,QAAQ,IACpC6G,aAAclH,OAAO2I,EAAStI,QAAQ,IACtCuB,MAAO5B,OAAO4B,EAAMvB,QAAQ,OAE7B,CAACwG,EAAWK,IAGTrF,EAAU,CACd,CACEC,MAAO,UACPC,IAAK,UACLC,MAAO,IACPC,OAASI,IACPgB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAA,UAAA6F,SAASC,EAAOzD,eACfyD,EAAOxD,eACNtC,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAC7CC,EAAOxD,mBAMlB,CACEiD,MAAO,cACP8G,UAAW,mBACX7G,IAAK,mBACLC,MAAO,IACPC,OAASlC,IAAgBxD,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAM+F,SAAErC,KAE9C,CACE+B,MAAO,mBACP8G,UAAW,oBACX7G,IAAK,mBACLC,MAAO,IACPC,OAAQA,CAAClC,EAAasC,KACpB,MAAMyG,EAAkBzG,EAAOoF,iBAAmBpF,EAAO/C,iBACzD,OAAOwJ,EAAkB,GACvBvM,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,QAAO+F,SAAE0G,KAEpBvM,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,QAAS+F,SAAC,QAItC,CACEN,MAAO,UACPC,IAAK,UACLC,MAAO,IACPC,OAASI,IACP9F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,SAAQ+F,SAAEC,EAAO/C,kBAAoB,KAGpD,CACEwC,OAAOvF,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,kBACtCL,IAAK,cACLC,MAAO,IACPC,OAAQA,CAACI,EAAa1C,EAAQH,KAC5BjD,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLG,IAAK1B,EAAO/C,kBAAoB+C,EAAOoF,iBACvC/J,MAAO2E,EAAOhD,kBACd1B,SAAWgF,GAAQsF,EAAqBzI,EAAO,oBAAqBmD,GAAO,GAC3ER,MAAO,CAAEH,MAAO,WAItB,CACEF,MAAO,WACPC,IAAK,WACLC,MAAO,IACPC,OAAQA,CAACI,EAAa1C,EAAQH,KAC5BjD,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLG,IAAK1B,EAAOhD,kBACZ3B,MAAO2E,EAAOqF,kBACd/J,SAAWgF,GAAQsF,EAAqBzI,EAAO,oBAAqBmD,GAAO,GAC3ER,MAAO,CAAEH,MAAO,WAItB,CACEF,MAAO,WACP8G,UAAW,oBACX7G,IAAK,oBACLC,MAAO,IACPC,OAASlC,IACPxD,EAAAA,EAAAA,KAAA,UAAQ4F,MAAO,CAAE9F,MAAO,WAAY+F,SAAErC,KAG1C,CACE+B,OACEuB,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAM,eACO7F,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,SAG9CL,IAAK,aACLC,MAAO,IACPC,OAAQA,CAACI,EAAa1C,EAAQH,KAC5B,MACMuJ,EADa1G,EAAOhD,kBAAoB,KACbgD,EAAOrD,YAAcqD,EAAOrD,YAAc,GAC3E,OACEzC,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLC,UAAW,EACXpB,YAAY,aACZqB,OAAO,SACP3B,MAAO,CACLH,MAAO,OACPgH,YAAaD,EAAW,eAAYrG,GAEtChF,MAAO2E,EAAOrD,WACdrB,SAAWgF,GAAQrC,EAAkBd,EAAO,aAAcmD,GAAO,GACjE/E,SAAuC,IAA7ByE,EAAOhD,kBACjB4J,UAAWF,EAAW,yBAA2B,OAKzD,CACEjH,OACEuB,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAM,UACE7F,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,SAGzCL,IAAK,iBACLC,MAAO,IACPC,OAAQA,CAACI,EAAa1C,EAAQH,KAC5B,MACMuJ,EADa1G,EAAOhD,kBAAoB,SACYqD,IAA1BL,EAAOpD,gBAA0D,OAA1BoD,EAAOpD,gBAC9E,OACE1C,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLG,IAAK,IACLF,UAAW,EACXpB,YAAY,MACZuB,OAAO,IACP7B,MAAO,CACLH,MAAO,OACPgH,YAAaD,EAAW,eAAYrG,GAEtChF,MAAO2E,EAAOpD,eACdtB,SAAWgF,GAAQrC,EAAkBd,EAAO,iBAAkBmD,GAAO,GACrE/E,SAAuC,IAA7ByE,EAAOhD,kBACjB4J,UAAWF,EAAW,yBAA2B,OAKzD,CACEjH,MAAO,WACPC,IAAK,WACLC,MAAO,IACPC,OAAQA,CAACI,EAAa1C,EAAQH,KAC5B6D,EAAAA,EAAAA,MAACY,EAAAA,EAAMC,QAAO,CAAC/B,MAAO,CAAEH,MAAO,QAASI,SAAA,EACtC7F,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLC,UAAW,EACXpB,YAAY,IACZN,MAAO,CAAEH,MAAO,OAChBtE,MAAO2E,EAAOnD,SACdvB,SAAWgF,GAAQrC,EAAkBd,EAAO,WAAYmD,GAAO,GAC/D/E,SAAuC,IAA7ByE,EAAOhD,qBAEnBgE,EAAAA,EAAAA,MAACf,EAAAA,EAAM,CACLH,MAAO,CAAEH,MAAO,OAChBtE,MAAO2E,EAAOlD,cACdxB,SAAWgF,GAAQrC,EAAkBd,EAAO,gBAAiBmD,GAC7D/E,SAAuC,IAA7ByE,EAAOhD,kBAAwB+C,SAAA,EAEzC7F,EAAAA,EAAAA,KAAC+F,EAAAA,EAAOgB,OAAM,CAAC5F,MAAM,aAAY0E,SAAC,OAClC7F,EAAAA,EAAAA,KAAC+F,EAAAA,EAAOgB,OAAM,CAAC5F,MAAM,SAAQ0E,SAAC,kBAKtC,CACEN,MAAO,WACPC,IAAK,WACLC,MAAO,IACPC,OAAQA,CAACI,EAAa1C,EAAQH,KAC5BjD,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CACJf,YAAY,QACZ/E,MAAO2E,EAAOuF,SACdjK,SAAW8F,GAAMnD,EAAkBd,EAAO,WAAYiE,EAAEC,OAAOhG,UAIrE,CACEoE,MAAO,WACPC,IAAK,WACLC,MAAO,IACPC,OAAQA,CAACI,EAAa1C,EAAQH,KAC5BjD,EAAAA,EAAAA,KAAC+H,EAAAA,EAAU,CACTC,OAAO,aACP7G,MAAO2E,EAAOwF,SAAWpD,IAAMpC,EAAOwF,eAAYnF,EAClD/E,SAAW+G,GAASpE,EAAkBd,EAAO,WAAYkF,GACzDvC,MAAO,CAAEH,MAAO,QAChBkH,aAAeC,GAAYA,GAAWA,EAAU1E,MAAQ2E,MAAM,UAIpE,CACEtH,OACEuB,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAM,gBACQ7F,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,SAG/CL,IAAK,cACLC,MAAO,IACPC,OAAQA,CAACI,EAAa1C,EAAQH,KAC5B,MAAM6J,EAAahH,EAAOhD,kBAAoB,EACxC0J,EAAWM,IAAehH,EAAOyF,YACvC,OACEvL,EAAAA,EAAAA,KAAC+H,EAAAA,EAAU,CACTC,OAAO,aACP7G,MAAO2E,EAAOyF,YAAcrD,IAAMpC,EAAOyF,kBAAepF,EACxD/E,SAAW+G,GAASpE,EAAkBd,EAAO,cAAekF,GAC5DvC,MAAO,CACLH,MAAO,OACPgH,YAAaD,EAAW,eAAYrG,GAEtCwG,aAAeC,GAAYA,GAAWA,EAAU1E,MAAQ2E,MAAM,OAC9D3G,YAAa4G,EAAa,aAAe,cACzCJ,UAAWF,EAAW,mBAAqB,QAOrD,OACE1F,EAAAA,EAAAA,MAACiG,EAAAA,EAAK,CACJxH,OACEuB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAACa,EAAAA,EAAa,CAAC+E,MAAO,CAAE9F,MAAO,cAC/BgH,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAM,uBAAkC,OAAbqE,QAAa,IAAbA,OAAa,EAAbA,EAAe8C,gBAG9ChD,KAAMA,EACNiD,SAAUhD,EACVxE,MAAO,KACPiE,OAAQ,EACN1J,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CAAcW,QAASe,EAAQpE,SAAC,UAA3B,WAGZ7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CAELC,KAAK,UACLzI,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAC1B+F,QAASzE,EACTsH,QA9WagE,UACnB,IACE,MAAMC,QAAehD,EAAKiD,iBAI1B,IADyB9C,EAAU+C,MAAK9J,GAAQA,EAAK6H,kBAAoB,IAGvE,YADAkC,EAAAA,GAAQC,MAAM,oCAKhB,MAAMC,EAA4BlD,EAAUnH,QAAOI,GAAQA,EAAKT,kBAAoB,IAEpF,GAD2B0K,EAA0BrK,QAAOI,IAASA,EAAKgI,cACnDjD,OAAS,EAE9B,YADAgF,EAAAA,GAAQC,MAAM,kDAMhB,GADqBC,EAA0BrK,QAAOI,IAASA,EAAKd,YAAcc,EAAKd,YAAc,IACpF6F,OAAS,EAExB,YADAgF,EAAAA,GAAQC,MAAM,iDAIhB,GADmBC,EAA0BrK,QAAOI,QAAgC4C,IAAxB5C,EAAKb,gBAAwD,OAAxBa,EAAKb,iBACvF4F,OAAS,EAEtB,YADAgF,EAAAA,GAAQC,MAAM,qDAKhB,MAAMvC,EAAQV,EACXnH,QAAOI,GAAQA,EAAKT,kBAAoB,IACxC8D,KAAIrD,IAAI,CACP0H,gBAAiB1H,EAAK0H,gBACtBnI,kBAAmBS,EAAKT,kBACxBqI,kBAAmB5H,EAAK4H,mBAAqB,EAC7CE,SAAU9H,EAAK8H,SACfC,SAAU/H,EAAK+H,SAAWpD,IAAM3E,EAAK+H,UAAUtD,OAAO,mBAAgB7B,EACtEoF,YAAahI,EAAKgI,YAAcrD,IAAM3E,EAAKgI,aAAavD,OAAO,mBAAgB7B,EAC/EqF,MAAOjI,EAAKiI,MAEZ/I,WAAYc,EAAKd,WACjBC,eAAgBa,EAAKb,eACrBC,SAAUY,EAAKZ,UAAY,EAC3BC,cAAeW,EAAKX,eAAiB,iBAGnC6K,EAAU,CACdC,GAAIxD,EAAcrF,IAClBmG,QACA2C,kBAAmBR,EAAOQ,kBAC1BC,oBAAqBT,EAAOS,oBAC1B1F,IAAMiF,EAAOS,qBAAqB5F,OAAO,mBAAgB7B,EAC3DqF,MAAO2B,EAAO3B,MACdC,cAAed,GAAgB,EAC/BkD,qBAAsBpD,SAGlBI,EAAa4C,GAASK,SAE5BR,EAAAA,GAAQS,QAAQ,gCAChB5D,EAAK6D,cACL/D,GACF,CAAE,MAAOsD,GAAa,IAADU,EACnBX,EAAAA,GAAQC,OAAW,OAALA,QAAK,IAALA,GAAW,QAANU,EAALV,EAAO7L,YAAI,IAAAuM,OAAN,EAALA,EAAaX,UAAW,0BACxC,GA2S4BzH,SACvB,8BALK,WAQNA,SAAA,EAEF7F,EAAAA,EAAAA,KAACkO,EAAAA,EAAK,CACJZ,QAAQ,2BACR/K,YAAY,sOACZiG,KAAK,OACL2F,UAAQ,EACRvI,MAAO,CAAEgD,aAAc,OAGzB9B,EAAAA,EAAAA,MAACsD,EAAAA,EAAI,CAACD,KAAMA,EAAMiE,OAAO,WAAUvI,SAAA,EACjCiB,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,SAAA,EACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,oBACL5E,OACE4G,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAM,0BACkB7F,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,SAGzD6I,MAAO,CACL,CAAEC,UAAU,EAAMrB,QAAS,sCAC3B,CAAEsB,YAAY,EAAMtB,QAAS,0CAC7BzH,UAEF7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,uCAGvBlG,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,sBACL5E,MAAM,sBAAqB2F,UAE3B7F,EAAAA,EAAAA,KAAC+H,EAAAA,EAAU,CAACnC,MAAO,CAAEH,MAAO,QAAUuC,OAAO,oBAGjDhI,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CAACvO,MAAM,WAAU2F,UACzB7F,EAAAA,EAAAA,KAAC+H,EAAAA,EAAU,CACT5G,MAAO+G,MACP7G,UAAQ,EACRuE,MAAO,CAAEH,MAAO,QAChBuC,OAAO,uBAMfhI,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAAAhJ,SAAC,mBAETiB,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAI1I,MAAO,CAAEgD,aAAc,IAAK/C,SAAA,EAC3C7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CAACvJ,MAAM,gBAAgBpE,MAAO6D,EAAO2G,aAEjD3L,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CAACvJ,MAAM,gBAAgBpE,MAAO6D,EAAO4G,SAAUmD,WAAY,CAAEjP,MAAO,gBAEhFE,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CAACvJ,MAAM,WAAWpE,MAAO6D,EAAOzE,SAAUwO,WAAY,CAAEjP,MAAO,gBAE3EE,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CAACvJ,MAAM,WAAWpE,MAAO6D,EAAO6G,SAAUkD,WAAY,CAAEjP,MAAO,mBAI7EE,EAAAA,EAAAA,KAACmJ,EAAAA,EAAK,CACJ7D,QAASA,EACT8D,WAAYkB,EACZd,OAAO,kBACPH,YAAY,EACZC,OAAQ,CAAEC,EAAG,MACbb,KAAK,QACLe,UAAQ,KAGVzJ,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,IAGP/C,EAAgBzG,MAAQ,IACvByB,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAI1I,MAAO,CAAEgD,aAAc,GAAImB,QAAS,OAAQiF,WAAY,UAAWC,aAAc,OAAQpJ,SAAA,EACxG7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,4BACNpE,MAAO2K,EAAgBjI,SACvB0D,OAAO,SACPwH,WAAY,CAAE/F,SAAU,YAG3B8C,EAAgBE,eAAiB,IAChChM,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,WACNpE,MAAO2K,EAAgBE,eACvBzE,OAAO,SACPwH,WAAY,CAAE/F,SAAU,OAAQlJ,MAAO,gBAI7CE,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,aACNpE,MAAO2K,EAAgB1G,UACvBmC,OAAO,SACPwH,WAAY,CAAE/F,SAAU,YAG3B8C,EAAgBnB,aAAe,IAC9B3K,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,gBACNpE,MAAO2K,EAAgBnB,aACvBpD,OAAO,SACPwH,WAAY,CAAE/F,SAAU,aAI9BhJ,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM1C,EAAgBnB,aAAe,EAAI,EAAImB,EAAgBE,eAAiB,EAAI,EAAI,GAAGnG,UAC5F7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,eACNpE,MAAO2K,EAAgBzG,MACvBkC,OAAO,SACPwH,WAAY,CAAE/F,SAAU,OAAQlJ,MAAO,UAAWoP,WAAY,gBAMtEpI,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,SAAA,EACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,GAAG3I,UACZ7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CAAC3J,KAAK,QAAQ5E,MAAM,QAAO2F,UACnC7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAMkI,SAAQ,CACbC,KAAM,EACNlJ,YAAY,wCAIlBY,EAAAA,EAAAA,MAACyH,GAAAA,EAAG,CAACC,KAAM,GAAG3I,SAAA,EACZ7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CAACvO,MAAM,gBAAe2F,UAC9B7F,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVC,IAAK,EACLC,UAAW,EACXpB,YAAY,aACZqB,OAAO,SACP3B,MAAO,CAAEH,MAAO,QAChBtE,MAAOwJ,EACPvJ,SAAWgF,GAAQwE,EAAgBxE,GAAO,QAG9CU,EAAAA,EAAAA,MAACuI,GAAAA,EAAQ,CACPC,QAAS7E,EACTrJ,SAAW8F,GAAMwD,EAAsBxD,EAAEC,OAAOmI,SAChD1J,MAAO,CAAE2J,UAAW,IAAK1J,SAAA,EAEzB7F,EAAAA,EAAAA,KAAA,UAAA6F,SAAQ,+BACR7F,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAAC,oFCnmB/D,MAmIA,GAnIwD3E,IAIjD,IAADsO,EAAAC,EAAAC,EAAA,IAJmD,KACvD1F,EAAI,QACJC,EAAO,cACPC,GACDhJ,EACC,MAAOiJ,GAAQC,EAAAA,EAAKC,WACbsF,EAAiBC,IAAsBpF,EAAAA,EAAAA,WAAS,IAChDqF,EAAiBC,IAAsBtF,EAAAA,EAAAA,UAAS,KAEhDuF,GAAanO,UAAWoO,KAAeC,EAAAA,EAAAA,OACvCC,GAAYtO,UAAWuO,KAAeC,EAAAA,EAAAA,MAmC7C,OACEtJ,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACEiB,EAAAA,EAAAA,MAACiG,EAAAA,EAAK,CACJxH,MAAM,kCACNyE,KAAMA,EACNiD,SAAUhD,EACVxE,MAAO,IACPiE,OAAQ,EACN1J,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CAELE,QAAM,EACN1I,MAAMC,EAAAA,EAAAA,KAACQ,EAAAA,EAAmB,IAC1B6F,QAAS8J,EACTjH,QAjBcoH,KACtBV,GAAmB,IAgBc/J,SAC1B,UALK,WAQN7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CAELC,KAAK,UACLzI,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAC1B+F,QAAS2J,EACT9G,QAvDYgE,UACpB,IACE,MAAMC,QAAehD,EAAKiD,uBACpB2C,EAAU,CAAErC,GAAIxD,EAAcrF,IAAK0L,SAAUpD,EAAOoD,WAAYzC,SACtER,EAAAA,GAAQS,QAAQ,wCAChB5D,EAAK6D,cACL/D,GACF,CAAE,MAAOsD,GAAa,IAADU,EACnBX,EAAAA,GAAQC,OAAW,OAALA,QAAK,IAALA,GAAW,QAANU,EAALV,EAAO7L,YAAI,IAAAuM,OAAN,EAALA,EAAaX,UAAW,uBACxC,GA8C+BzH,SACxB,WALK,YAQNA,SAAA,EAEJiB,EAAAA,EAAAA,MAAC0J,GAAAA,EAAY,CAAC/G,UAAQ,EAACgH,OAAQ,EAAG/H,KAAK,QAAO7C,SAAA,EAC5C7F,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,YAAYsO,KAAM,EAAE3I,UAC3C7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAM+F,SAAe,OAAbqE,QAAa,IAAbA,OAAa,EAAbA,EAAe8C,eAEpChN,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,SAASsO,KAAM,EAAE3I,SAC1B,OAAbqE,QAAa,IAAbA,GAAqB,QAARsF,EAAbtF,EAAewG,cAAM,IAAAlB,OAAR,EAAbA,EAAuBmB,eAE1B3Q,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,eAAesO,KAAM,EAAE3I,UAC9CiB,EAAAA,EAAAA,MAAA,UAAQlB,MAAO,CAAE9F,MAAO,WAAY+F,SAAA,CAAC,SACpB,OAAbqE,QAAa,IAAbA,GAA2B,QAAduF,EAAbvF,EAAe0G,oBAAY,IAAAnB,OAAd,EAAbA,EAA6B5H,eAAe,QAAS,CAAEC,sBAAuB,UAGpFhB,EAAAA,EAAAA,MAAC0J,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,QAAQsO,KAAM,EAAE3I,SAAA,CACzB,OAAbqE,QAAa,IAAbA,GAAoB,QAAPwF,EAAbxF,EAAec,aAAK,IAAA0E,OAAP,EAAbA,EAAsBpH,OAAO,aAEhCtI,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,aAAasO,KAAM,EAAE3I,SAC9B,OAAbqE,QAAa,IAAbA,OAAa,EAAbA,EAAe2G,sBAIpB7Q,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,KAER7O,EAAAA,EAAAA,KAACoK,EAAAA,EAAI,CAACD,KAAMA,EAAMiE,OAAO,WAAUvI,UACjC7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,WACL5E,MAAM,sBAAqB2F,UAE3B7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAMkI,SAAQ,CAACC,KAAM,EAAGlJ,YAAY,gCAM3ClG,EAAAA,EAAAA,KAAC+M,EAAAA,EAAK,CACJxH,MAAM,wBACNyE,KAAM2F,EACN1C,SAAUA,IAAM2C,GAAmB,GACnCkB,KAtFiB5D,UACnB,IACE,IAAK2C,EAEH,YADAvC,EAAAA,GAAQC,MAAM,2CAGV2C,EAAS,CAAExC,GAAIxD,EAAcrF,IAAKkM,OAAQlB,IAAmB/B,SACnER,EAAAA,GAAQS,QAAQ,2BAChB5D,EAAK6D,cACL8B,EAAmB,IACnBF,GAAmB,GACnB3F,GACF,CAAE,MAAOsD,GAAa,IAADyD,EACnB1D,EAAAA,GAAQC,OAAW,OAALA,QAAK,IAALA,GAAW,QAANyD,EAALzD,EAAO7L,YAAI,IAAAsP,OAAN,EAALA,EAAa1D,UAAW,sBACxC,GAyEE2D,eAAgBd,EAChBe,OAAO,SACPC,cAAe,CAAE1I,QAAQ,GAAO5C,UAEhC7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACRvO,MAAM,mBACNyO,UAAQ,EAAA9I,UAER7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAMkI,SAAQ,CACbC,KAAM,EACNjO,MAAO0O,EACPzO,SAAW8F,GAAM4I,EAAmB5I,EAAEC,OAAOhG,OAC7C+E,YAAY,kEC1CtB,GAjFgDhF,IAIzC,IAADkQ,EAAA,IAJ2C,KAC/CpH,EAAI,QACJC,EAAO,cACPC,GACDhJ,EACC,MAAOiJ,GAAQC,EAAAA,EAAKC,WAEbgH,GAAQ,UAAEzP,KAAe0P,EAAAA,EAAAA,MAmBhC,OACExK,EAAAA,EAAAA,MAACiG,EAAAA,EAAK,CACJxH,OACEuB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAACU,EAAAA,EAAY,CAACkF,MAAO,CAAE9F,MAAO,cAC9BE,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,qCAGVmE,KAAMA,EACNiD,SAAUhD,EACV6G,KA3Be5D,UACjB,IACE,MAAMC,QAAehD,EAAKiD,uBACpBiE,EAAO,CACX3D,GAAIxD,EAAcrF,IAClB0M,MAAOpE,EAAOoE,MACdjE,QAASH,EAAOG,UACfQ,SAEHR,EAAAA,GAAQS,QAAQ,8CAChB5D,EAAK6D,cACL/D,GACF,CAAE,MAAOsD,GAAa,IAADU,EACnBX,EAAAA,GAAQC,OAAW,OAALA,QAAK,IAALA,GAAW,QAANU,EAALV,EAAO7L,YAAI,IAAAuM,OAAN,EAALA,EAAaX,UAAW,oBACxC,GAcE2D,eAAgBrP,EAChBsP,OAAO,aACPzL,MAAO,IAAII,SAAA,EAEX7F,EAAAA,EAAAA,KAACkO,EAAAA,EAAK,CACJZ,QAAQ,uBACR/K,YAAW,sBAAAyE,OAAqC,OAAbkD,QAAa,IAAbA,OAAa,EAAbA,EAAe8C,UAAS,uDAC3DxE,KAAK,OACL2F,UAAQ,EACRvI,MAAO,CAAEgD,aAAc,OAGzB9B,EAAAA,EAAAA,MAACsD,EAAAA,EAAI,CACHD,KAAMA,EACNiE,OAAO,WACPoD,cAAe,CACbD,OAAoB,OAAbrH,QAAa,IAAbA,OAAa,EAAbA,EAAeuH,gBAA6B,OAAbvH,QAAa,IAAbA,GAAyB,QAAZkH,EAAblH,EAAewH,kBAAU,IAAAN,OAAZ,EAAbA,EAA2BG,QACjE1L,SAAA,EAEF7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,QACL5E,MAAM,eACNwO,MAAO,CACL,CAAEC,UAAU,EAAMrB,QAAS,qBAC3B,CAAE9E,KAAM,QAAS8E,QAAS,wBAC1BzH,UAEF7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,0BAGrBlG,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,UACL5E,MAAM,qBAAoB2F,UAE1B7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAMkI,SAAQ,CACbC,KAAM,EACNlJ,YAAY,6GCrDxB,MAAM,KAAEyL,IAASC,GAAAA,EA68BjB,GAp8BgD1Q,IAKzC,IAAD2Q,EAAAC,EAAA,IAL2C,KAC/C9H,EAAI,QACJC,EAAO,cACPC,EAAa,iBACb6H,GACD7Q,EAGC,MAAM8Q,EACJ9H,IACCA,EAAcwH,YACfxH,EAAc+H,WACdjI,GACMtI,KAAMwQ,GAAepQ,EAAAA,GAASqQ,uBACvB,OAAbjI,QAAa,IAAbA,OAAa,EAAbA,EAAe+H,YAAa,GAC5B,CAAEG,MAAOJ,IAILK,EACJnI,IACCA,EAAcoI,eACfpI,EAAcqI,cACdvI,GACMtI,KAAM8Q,GAAkB1Q,EAAAA,GAAS2Q,0BAC1B,OAAbvI,QAAa,IAAbA,OAAa,EAAbA,EAAeqI,eAAgB,GAC/B,CAAEH,MAAOC,KAIH3Q,KAAMgR,EAAcC,QAASC,IACnCC,EAAAA,GAAAA,KAAmC,OAAb3I,QAAa,IAAbA,OAAa,EAAbA,EAAerF,MAAO,GAAI,CAC9CuN,OAAoB,OAAblI,QAAa,IAAbA,GAAAA,EAAerF,OAAQmF,KAI1BtI,KAAMoR,IAAiBC,EAAAA,GAAAA,KAChB,OAAb7I,QAAa,IAAbA,OAAa,EAAbA,EAAerF,MAAO,GACtB,CAAEuN,OAAoB,OAAblI,QAAa,IAAbA,GAAAA,EAAerF,OAAQmF,KAI1BtI,KAAMsR,IAAmBC,EAAAA,GAAAA,KAClB,OAAb/I,QAAa,IAAbA,OAAa,EAAbA,EAAerF,MAAO,GACtB,CAAEuN,OAAoB,OAAblI,QAAa,IAAbA,GAAAA,EAAerF,OAAQmF,IAI5BkJ,GAAa3R,EAAAA,EAAAA,UAAQ,KACzB,IAAK2I,EAAe,OAAO,KAG3B,GAAIA,EAAcwH,YAAcxH,EAAcwH,WAAWf,YACvD,OAAOzG,EAAcwH,WAIvB,GAAIM,GAAqBE,EAAY,CACnC,MAAMxB,GAAoB,OAAVwB,QAAU,IAAVA,OAAU,EAAVA,EAAoBjQ,SAAUiQ,EAC9C,GAAIxB,IAAWA,EAAOC,aAAeD,EAAO5L,MAC1C,MAAO,CACL6L,YAAaD,EAAOC,aAAeD,EAAO5L,KAC1CqO,aAAczC,EAAOyC,aACrB5B,MAAOb,EAAOa,MACd6B,MAAO1C,EAAO0C,OAAS1C,EAAO2C,eAC9BC,QAAS5C,EAAO4C,QAGtB,CAGA,OAAIpJ,EAAcyG,YACT,CACLA,YAAazG,EAAcyG,YAC3BwC,aAAcjJ,EAAcqJ,oBAC5BhC,MAAOrH,EAAcuH,aACrB2B,MAAOlJ,EAAcsJ,aACrBF,QAASpJ,EAAcuJ,gBAKpB,OACN,CACDvJ,EACa,OAAbA,QAAa,IAAbA,OAAa,EAAbA,EAAewH,WACF,OAAbxH,QAAa,IAAbA,OAAa,EAAbA,EAAeyG,YACF,OAAbzG,QAAa,IAAbA,OAAa,EAAbA,EAAe+H,UACfC,EACAF,IAII0B,GAAgBnS,EAAAA,EAAAA,UAAQ,KAC5B,IAAK2I,EAAe,OAAO,KAG3B,GACEA,EAAcoI,eACdpI,EAAcoI,cAAcqB,eAE5B,OAAOzJ,EAAcoI,cAIvB,GAAID,GAAwBG,EAAe,CACzC,MAAMoB,GAA0B,OAAbpB,QAAa,IAAbA,OAAa,EAAbA,EAAuBvQ,SAAUuQ,EACpD,GAAIoB,IAAcA,EAAUD,gBAAkBC,EAAU9O,MACtD,MAAO,CACL6O,eAAgBC,EAAUD,gBAAkBC,EAAU9O,KACtD+O,eAAgBD,EAAUC,gBAAkBD,EAAUE,KACtDR,QAASM,EAAUN,QACnBS,QAASH,EAAUG,QAGzB,CAGA,OAAI7J,EAAcyJ,eACT,CACLA,eAAgBzJ,EAAcyJ,eAC9BE,eAAgB3J,EAAc2J,eAC9BP,QAASpJ,EAAc8J,kBACvBD,QAAS7J,EAAc+J,mBAKpB,OACN,CACD/J,EACa,OAAbA,QAAa,IAAbA,OAAa,EAAbA,EAAeoI,cACF,OAAbpI,QAAa,IAAbA,OAAa,EAAbA,EAAeyJ,eACF,OAAbzJ,QAAa,IAAbA,OAAa,EAAbA,EAAeqI,aACfC,EACAH,IAIF,IAAKnI,EAAe,OAAO,KAE3B,MAAMtK,EAAoC,CACxCC,MAAO,CAAEC,MAAO,UAAWI,MAAO,SAClCC,iBAAkB,CAAEL,MAAO,UAAWI,MAAO,oBAC7CG,SAAU,CAAEP,MAAO,UAAWI,MAAO,YACrCK,SAAU,CAAET,MAAO,QAASI,MAAO,YACnCO,KAAM,CAAEX,MAAO,aAAcI,MAAO,QACpCS,UAAW,CAAEb,MAAO,OAAQI,MAAO,aACnCU,mBAAoB,CAAEd,MAAO,SAAUI,MAAO,sBAC9CY,eAAgB,CAAEhB,MAAO,QAASI,MAAO,kBACzCa,UAAW,CAAEjB,MAAO,MAAOI,MAAO,aAClCe,OAAQ,CAAEnB,MAAO,UAAWI,MAAO,WAG/BgU,EACJtU,EAAasK,EAAciK,SAAWvU,EAAaC,MAQ/CuU,EAAc,CAClB,CACE7O,MAAO,UACPC,IAAK,UACLE,OAASI,IACPgB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAA,UAAA6F,SAASC,EAAOzD,eACfyD,EAAOxD,eACNtC,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAC7CC,EAAOxD,mBAMlB,CACEiD,MAAO,cACP8G,UAAW,cACX7G,IAAK,eAEP,CACED,MAAO,WACP8G,UAAW,WACX7G,IAAK,WACLE,OAASlC,IAAaxD,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAM+F,SAAEpC,OAAOD,IAAQ,KAE1D,CACE+B,MAAO,aACP8G,UAAW,aACX7G,IAAK,aACLE,OAAShC,GAAU,SAAAsD,QAlCHvD,OAkCyBC,IAlCP,GACnBI,QAAQ,KAmCzB,CACEyB,MAAO,QACP8G,UAAW,iBACX7G,IAAK,iBACLE,OAAS2O,IACP,MAAMC,EAAS7Q,OAAO4Q,GACtB,OAAOC,EAAM,GAAAtN,OAAMsN,EAAM,KAAM,MAGnC,CACE/O,MAAO,WACPC,IAAK,WACLE,OAASI,IACP,MAAMnD,EAAWc,OAAOqC,EAAOnD,WAAa,EAC5C,OAAIA,EAAW,EACP,GAANqE,OAAUrE,GAAQqE,OAA4B,eAAzBlB,EAAOlD,cAAiC,IAAM,UAE9D,MAGX,CACE2C,MAAO,aACP8G,UAAW,aACX7G,IAAK,aACLE,OAASL,IACP,MAAMkP,EAAW9Q,OAAO4B,IAAU,EAClC,OACEyB,EAAAA,EAAAA,MAAA,UAAQlB,MAAO,CAAE9F,MAAO,WAAY+F,SAAA,CAAC,SACjC0O,EAAS1M,eAAe,QAAS,CAAEC,sBAAuB,SAKpE,CACEvC,MAAO,WACP8G,UAAW,oBACX7G,IAAK,oBACLE,OAAQA,CAACkG,EAAe9F,KACtB,MAAM0O,EAAc/Q,OAAOmI,IAAa,EAElC6I,GADchR,OAAOqC,EAAOtD,WAAa,GACjBgS,EAC9B,OACE1N,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,QAAO+F,SAAE2O,IACnBC,EAAU,IAAK3N,EAAAA,EAAAA,MAACwF,EAAAA,EAAG,CAACxM,MAAM,SAAQ+F,SAAA,CAAC,YAAU4O,WAOxD,OACE3N,EAAAA,EAAAA,MAACiG,EAAAA,EAAK,CACJxH,OACEuB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAAC0U,EAAAA,EAAgB,CAAC9O,MAAO,CAAE9F,MAAO,cAClCE,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,8BAGVmE,KAAMA,EACNiD,SAAUhD,EACVxE,MAAO,KACPiE,OAAQ,EACN1J,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CAAaC,KAAK,UAAUU,QAASe,EAAQpE,SAAC,SAAzC,UAGZA,SAAA,EAEFiB,EAAAA,EAAAA,MAAC0J,GAAAA,EAAY,CAAC/G,UAAQ,EAACgH,OAAQ,EAAG/H,KAAK,QAAO7C,SAAA,EAC5C7F,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,YAAYsO,KAAM,EAAE3I,UAC3C7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAOC,MAAMC,EAAAA,EAAAA,KAAC0U,EAAAA,EAAgB,IAAI7O,SAC1CqE,EAAc8C,eAGnBhN,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,SAASsO,KAAM,EAAE3I,UACxC7F,EAAAA,EAAAA,KAAC2U,EAAAA,EAAK,CACJR,OAAQD,EAAcpU,MACtB8U,MAAM5U,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAOoU,EAAcpU,MAAM+F,SAAEqO,EAAchU,aAI1DF,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,SAASsO,KAAM,EAAE3I,SACvCqN,GACCpM,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAAC6U,EAAAA,EAAY,CAACjP,MAAO,CAAEkP,YAAa,MACpC9U,EAAAA,EAAAA,KAAA,UAAA6F,SAASqN,EAAWvC,aAAe,QAClCuC,EAAWC,eACVnT,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,OAAQyP,UAAW,GAAI1J,SAC3DqN,EAAWC,eAGfD,EAAW3B,QACVzK,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,OAAQyP,UAAW,GAAI1J,SAAA,CAAC,gBACzDqN,EAAW3B,SAGlB2B,EAAWE,QACVtM,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAAA,CAAC,gBAC3CqN,EAAWE,SAGlBF,EAAWI,UACVxM,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,OAAQyP,UAAW,GAAI1J,SAAA,CAAC,gBACzDqN,EAAWI,eAKrBxM,EAAAA,EAAAA,MAAA,QAAMlB,MAAO,CAAE9F,MAAO,QAAS+F,SAAA,EAC7B7F,EAAAA,EAAAA,KAAC6U,EAAAA,EAAY,CAACjP,MAAO,CAAEkP,YAAa,KAAO,yCAMjDhO,EAAAA,EAAAA,MAAC0J,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,UAAS2F,SAAA,EAChC7F,EAAAA,EAAAA,KAAC+U,EAAAA,EAAgB,CAACnP,MAAO,CAAEkP,YAAa,KACvC5M,IAAMgC,EAAc8K,SAAShN,OAAO,kBAEvClB,EAAAA,EAAAA,MAAC0J,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,oBAAmB2F,SAAA,EAC1C7F,EAAAA,EAAAA,KAAC+U,EAAAA,EAAgB,CAACnP,MAAO,CAAEkP,YAAa,KACvC5K,EAAcjC,uBACXC,IAAMgC,EAAcjC,wBAAwBD,OAAO,cACnD,QAGNhI,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,YAAW2F,SACjC6N,GACC5M,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAACiV,GAAAA,EAAY,CAACrP,MAAO,CAAEkP,YAAa,MACpC9U,EAAAA,EAAAA,KAAA,UAAA6F,SAAS6N,EAAcC,gBAAkB,QACxCD,EAAcG,iBACb/M,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,OAAQyP,UAAW,GAAI1J,SAAA,CAAC,SACtD6N,EAAcG,kBAGxBH,EAAcJ,UACbxM,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,OAAQyP,UAAW,GAAI1J,SAAA,CAAC,gBACzD6N,EAAcJ,WAGrBI,EAAcK,UACbjN,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,OAAQyP,UAAW,GAAI1J,SAAA,CAAC,yBAChD6N,EAAcK,eAKjCjN,EAAAA,EAAAA,MAAA,QAAMlB,MAAO,CAAE9F,MAAO,QAAS+F,SAAA,EAC7B7F,EAAAA,EAAAA,KAACiV,GAAAA,EAAY,CAACrP,MAAO,CAAEkP,YAAa,KAAO,4CAKjD9U,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,gBAAe2F,SACV,QADUgM,EACrC3H,EAAcgL,qBAAa,IAAArD,OAAA,EAA3BA,EAA6BsD,QAAQ,IAAK,KAAKC,iBAGlDpV,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,aAAasO,KAAM,EAAE3I,SAC3CqE,EAAc2G,sBAInB7Q,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACwG,YAAY,OAAMxP,SAAC,uBAE5BiB,EAAAA,EAAAA,MAAC0J,GAAAA,EAAY,CAAC/G,UAAQ,EAACgH,OAAQ,EAAG/H,KAAK,QAAO7C,SAAA,EAC5CiB,EAAAA,EAAAA,MAAC0J,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,WAAU2F,SAAA,EACjC7F,EAAAA,EAAAA,KAACsV,EAAAA,EAAc,CAAC1P,MAAO,CAAEkP,YAAa,KAAO,UAC3CrR,OAAOyG,EAAcrG,WAAa,GAAGgE,eAAe,QAAS,CAC7DC,sBAAuB,QAG3BhB,EAAAA,EAAAA,MAAC0J,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,aAAY2F,SAAA,CAAC,UAElCpC,OAAOyG,EAAcqL,aAAe,GAAG1N,eAAe,QAAS,CAC/DC,sBAAuB,QAG3B9H,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,eAAc2F,UACrCiB,EAAAA,EAAAA,MAAA,UAAQlB,MAAO,CAAE9F,MAAO,UAAWkJ,SAAU,QAASnD,SAAA,CAAC,UAEnDpC,OAAOyG,EAAc0G,eAAiB,GAAG/I,eAAe,QAAS,CACjEC,sBAAuB,UAI7B9H,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,cAAa2F,UACpCiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAC6D,QAAM,EAAC5P,MAAO,CAAE9F,MAAO,WAAY+F,SAAA,CAAC,UAEtCpC,OAAOyG,EAAcuL,cAAgB,GAAG5N,eAAe,QAAS,CAChEC,sBAAuB,UAI7B9H,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,cAAcsO,KAAM,EAAE3I,UAC7CiB,EAAAA,EAAAA,MAAA,UAAQlB,MAAO,CAAE9F,MAAO,UAAWkJ,SAAU,QAASnD,SAAA,CAAC,UAEnDpC,OAAOyG,EAAcwL,qBAAuB,GAAG7N,eAC/C,QACA,CAAEC,sBAAuB,aAMjC9H,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACwG,YAAY,OAAMxP,SAAC,gBAE5B7F,EAAAA,EAAAA,KAACmJ,EAAAA,EAAK,CACJ7D,QAAS8O,EACThL,WAAYc,EAAcc,OAAS,GACnCxB,OAAQA,CAAC1D,EAAQ7C,IAAK,QAAA+D,OAAa/D,GACnCoG,YAAY,EACZX,KAAK,QACLe,UAAQ,EACRH,OAAQ,CAAEC,EAAG,OAId,MACC,MAAMoM,GAAwB,OAAZ7C,QAAY,IAAZA,OAAY,EAAZA,EAAsB7Q,SAAU6Q,GAAgB,GAC5D8C,EAAcC,MAAMC,QAAQH,GAAYA,EAAW,GAEzD,OAAIC,EAAYtN,OAAS,GAErBxB,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACwG,YAAY,OAAMxP,UACzBiB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAACa,EAAAA,EAAa,KACdiG,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAM,iBAAe+P,EAAYtN,OAAO,aAI5CtI,EAAAA,EAAAA,KAACmJ,EAAAA,EAAK,CACJ7D,QAAS,CACP,CACEC,MAAO,aACP8G,UAAW,aACX7G,IAAK,aACLE,OAASkP,IACP5U,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAOC,MAAMC,EAAAA,EAAAA,KAAC0U,EAAAA,EAAgB,IAAI7O,SAC1C+O,KAIP,CACErP,MAAO,WACP8G,UAAW,WACX7G,IAAK,WACLE,OAASyC,GAAiBD,IAAMC,GAAMH,OAAO,eAE/C,CACEzC,MAAO,iBACPC,IAAK,iBACLE,OAASI,IACP9F,EAAAA,EAAAA,KAAA,OAAA6F,SACGC,EAAO6H,mBACN7G,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAAA,OAAA6F,SAAMC,EAAO6H,oBACZ7H,EAAO8H,sBACN5N,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAC7CqC,IAAMpC,EAAO8H,qBAAqB5F,OACjC,oBAMRhI,EAAAA,EAAAA,KAAC2R,GAAI,CAACnJ,KAAK,YAAW3C,SAAC,SAK/B,CACEN,MAAO,eACP8G,UAAW,eACX7G,IAAK,eACLE,OAASqQ,IACPjP,EAAAA,EAAAA,MAAC6K,GAAI,CAAC6D,QAAM,EAAA3P,SAAA,CAAC,UAETpC,OAAOsS,IAAW,GAAGlO,eAAe,QAAS,CAC7CC,sBAAuB,QAK/B,CACEvC,MAAO,cACP8G,UAAW,mBACX7G,IAAK,mBACLE,OAASZ,GAAiBA,GAAQ,MAGtCsE,WAAYwM,EACZpM,OAAQ1D,GAAUA,EAAOjB,KAAOiB,EAAO4H,GACvCrE,YAAY,EACZX,KAAK,QACLe,UAAQ,OAKT,IACR,EApFA,GAuFAuJ,IACClM,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACwG,YAAY,OAAMxP,UACzBiB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,KACpBN,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,yCAIV7F,EAAAA,EAAAA,KAACmJ,EAAAA,EAAK,CACJ7D,QAAS,CACP,CACEC,MAAO,UACPC,IAAK,UACLE,OAASI,IACPgB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAC6D,QAAM,EAAA3P,SAAEC,EAAOzD,cAAgB,QACpCyD,EAAOxD,eACNtC,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAC7CC,EAAOxD,mBAMlB,CACEiD,MAAO,UACP8G,UAAW,mBACX7G,IAAK,mBACLE,OAASlC,IAAgBxD,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAM+F,SAAErC,GAAO,KAErD,CACE+B,MAAO,WACP8G,UAAW,oBACX7G,IAAK,oBACLE,OAAQA,CAAClC,EAAasC,KACpB,MAAM6F,EAAUlI,OAAOqC,EAAOoF,mBAAqB,EAC7CU,EAAWnI,OAAOD,IAAQ,EAC1BiR,EAAU9I,EAAUC,EACpBoK,EACJrK,EAAU,GAAMC,EAAWD,EAAW,KAAK7H,QAAQ,GAAK,IAE1D,OACEgD,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CACFxM,MACE8L,IAAaD,EACT,QACAC,EAAW,EACT,SACA,UACP/F,SAEA+F,IAEF6I,EAAU,IACT3N,EAAAA,EAAAA,MAAA,OACElB,MAAO,CACLoD,SAAU,OACVlJ,MAAO,OACPyP,UAAW,GACX1J,SAAA,CACH,YACW4O,EAAQ,KAAGuB,EAAW,uBAO5C,CACEzQ,MAAO,SACPC,IAAK,qBACLE,OAASI,IACP,MAAM6F,EAAUlI,OAAOqC,EAAOoF,mBAAqB,EAC7CU,EAAWnI,OAAOqC,EAAOhD,oBAAsB,EAErD,OAAiB,IAAb8I,GACK5L,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,UAAS+F,SAAC,iBACnB+F,IAAaD,GAEpB3L,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,QAAQC,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAAIuF,SAAC,mBAI3C+F,EAAWD,GACb3L,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,SAAQ+F,SAAC,wBAEpB7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,MAAK+F,SAAC,qBAKhCuD,YACiB,OAAd4J,QAAc,IAAdA,GAA8B,QAAhBlB,EAAdkB,EAAwB/Q,cAAM,IAAA6P,OAAhB,EAAfA,EAAiC9G,SAClB,OAAdgI,QAAc,IAAdA,OAAc,EAAdA,EAAwBhI,QACzB,GAEFxB,OAAQA,CAAC1D,EAAQ7C,IAAK,cAAA+D,OAAmB/D,GACzCoG,YAAY,EACZX,KAAK,QACLe,UAAQ,OAKbS,EAAcsB,QACb1E,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACwG,YAAY,OAAMxP,SAAC,WAC5B7F,EAAAA,EAAAA,KAAA,OACE4F,MAAO,CACLmE,QAAS,OACTiF,WAAY,UACZC,aAAc,OACdpJ,SAEDqE,EAAcsB,YAMrBxL,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACwG,YAAY,OAAMxP,UACzBiB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAACiW,EAAAA,EAAkB,KACnBjW,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,yBAIT,MAGC,IAAIqQ,EAAkB,GACtB,GAAIxD,EAAc,CAChB,MAAMhR,EAAOgR,EACTmD,MAAMC,QAAQpU,GAChBwU,EAAWxU,EACFA,EAAKO,SACV4T,MAAMC,QAAQpU,EAAKO,QACrBiU,EAAWxU,EAAKO,OAEhBP,EAAKO,OAAOiU,UACZL,MAAMC,QAAQpU,EAAKO,OAAOiU,YAE1BA,EAAWxU,EAAKO,OAAOiU,UAG7B,CACA,MAAMC,EAAcD,EAEpB,GAA2B,IAAvBC,EAAY7N,OACd,OACExB,EAAAA,EAAAA,MAAA,OACElB,MAAO,CAAEmE,QAAS,OAAQJ,UAAW,SAAU7J,MAAO,QAAS+F,SAAA,EAE/D7F,EAAAA,EAAAA,KAACiW,EAAAA,EAAkB,CACjBrQ,MAAO,CAAEoD,SAAU,OAAQJ,aAAc,UAE3C5I,EAAAA,EAAAA,KAAA,OAAA6F,SAAK,gCAKX,MAAMuQ,EAAiB,CACrB,CACE7Q,MAAO,eACP8G,UAAW,eACX7G,IAAK,eACL6Q,OAAQA,CAACC,EAAQC,IACfrO,IAAMoO,EAAEE,cAAcC,OAASvO,IAAMqO,EAAEC,cAAcC,OACvD/Q,OAAQA,CAACyC,EAAcrC,KACrBgB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAAC+U,EAAAA,EAAgB,IAChB7M,IAAMC,GAAMH,OAAO,cACK,YAAxBlC,EAAO4Q,eACN1W,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,SAAQ+F,SAAC,gBAK5B,CACEN,MAAO,iBACP8G,UAAW,iBACX7G,IAAK,iBACLE,OAASqQ,IACPjP,EAAAA,EAAAA,MAAC6K,GAAI,CAAC6D,QAAM,EAAC5P,MAAO,CAAE9F,MAAO,UAAWkJ,SAAU,QAASnD,SAAA,CAAC,UAExDpC,OAAOsS,IAAW,GAAGlO,eAAe,QAAS,CAC7CC,sBAAuB,QAK/B,CACEvC,MAAO,eACP8G,UAAW,eACX7G,IAAK,eACLE,OAASiR,IAUL3W,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAToC,CACzC8W,KAAM,QACNC,IAAK,OACLC,KAAM,SACNC,cAAe,OACfC,OAAQ,SACRC,MAAO,WAGgBN,IAAS,UAAU9Q,UACnC,OAAJ8Q,QAAI,IAAJA,OAAI,EAAJA,EAAMxB,QAAQ,IAAK,KAAKC,gBAAiB,SAKlD,CACE7P,MAAO,sBACPC,IAAK,sBACLE,OAASI,GACHA,EAAOoR,eAEPpQ,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACEiB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,CAAK,WAASC,EAAOoR,iBACpBpR,EAAOqR,YACNrQ,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAAA,CAAC,SACxCC,EAAOqR,gBAMpBrR,EAAOsR,gBAEPtQ,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACEiB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,CAAK,WAASC,EAAOsR,kBACpBtR,EAAOqR,YACNrQ,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAAA,CAAC,SACxCC,EAAOqR,gBAMpBrR,EAAOuR,kBACFvQ,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,CAAK,QAAMC,EAAOuR,oBAEpB,KAGX,CACE9R,MAAO,QACP8G,UAAW,QACX7G,IAAK,QACLE,OAAS8F,GAAkBA,GAAS,KAEtC,CACEjG,MAAO,UACP8G,UAAW,eACX7G,IAAK,eACLE,OAASZ,GAAiBA,GAAQ,MAKhCwS,EAAYnB,EAAYlR,QAC5B,CAACC,EAAaqS,IACZrS,GAAOzB,OAAO8T,EAAQC,iBAAmB,IAC3C,GAiBIC,EAbkBtB,EAAYhT,QAAQoU,GAKf,YAAzBA,EAAQb,cACPa,EAAQf,eACM,OAAbtM,QAAa,IAAbA,OAAa,EAAbA,EAAewN,uBACf,IAAIC,KAAKJ,EAAQf,cACf,IAAImB,KAAKzN,EAAcwN,wBAIMzS,QACnC,CAACC,EAAaqS,IACZrS,GAAOzB,OAAO8T,EAAQC,iBAAmB,IAC3C,GAGII,EAAcN,EAAYG,EAC1BI,EAAcpU,OAAoB,OAAbyG,QAAa,IAAbA,OAAa,EAAbA,EAAe0G,eAAiB,EACrDkH,EACJrU,OAAoB,OAAbyG,QAAa,IAAbA,OAAa,EAAbA,EAAewL,qBAAuB,EACzCqC,EAAcD,GAAqB,EAEzC,OACEhR,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EAEE7F,EAAAA,EAAAA,KAAA,OACE4F,MAAO,CACLoJ,WAAY,UACZjF,QAAS,GACTkF,aAAc,EACdrG,aAAc,GACdoP,OAAQ,qBACRnS,UAEFiB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CACJkC,UAAU,WACVhE,MAAO,CAAEH,MAAO,QAChBiD,KAAK,QAAO7C,SAAA,EAEZiB,EAAAA,EAAAA,MAAA,OACElB,MAAO,CACLiD,QAAS,OACTC,eAAgB,gBAChBC,WAAY,UACZlD,SAAA,EAEF7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAC6D,QAAM,EAAC5P,MAAO,CAAEoD,SAAU,QAASnD,SAAC,oBAGzCkS,IACC/X,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,QAAQC,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAAIuF,SAAC,mBAKtD7F,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACjJ,MAAO,CAAEqS,OAAQ,YAC1BnR,EAAAA,EAAAA,MAAA,OACElB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,iBAAkBjD,SAAA,EAE5D7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAA9L,SAAC,mBACNiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAC6D,QAAM,EAAA3P,SAAA,CAAC,SAEVgS,EAAYhQ,eAAe,QAAS,CACnCC,sBAAuB,WAI7BhB,EAAAA,EAAAA,MAAA,OACElB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,iBAAkBjD,SAAA,EAE5D7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAA9L,SAAC,iBACNiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAC6D,QAAM,EAAC5P,MAAO,CAAE9F,MAAO,WAAY+F,SAAA,CAAC,SAEvCyR,EAAUzP,eAAe,QAAS,CACjCC,sBAAuB,UAI5B2P,EAAe,IACd3Q,EAAAA,EAAAA,MAAA,OACElB,MAAO,CACLiD,QAAS,OACTC,eAAgB,gBAChBE,SAAU,OACVlJ,MAAO,QACP+F,SAAA,EAEF7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAA9L,SAAC,wBACNiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAA9L,SAAA,CAAC,SAEH4R,EAAa5P,eAAe,QAAS,CACpCC,sBAAuB,UAK9B8P,EAAc,IACb9Q,EAAAA,EAAAA,MAAA,OACElB,MAAO,CACLiD,QAAS,OACTC,eAAgB,gBAChBE,SAAU,OACVlJ,MAAO,QACP+F,SAAA,EAEF7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAA9L,SAAC,8BACNiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAA9L,SAAA,CAAC,SAEH+R,EAAY/P,eAAe,QAAS,CACnCC,sBAAuB,WAK/BhB,EAAAA,EAAAA,MAAA,OACElB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,iBAAkBjD,SAAA,EAE5D7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAC6D,QAAM,EAAA3P,SAAC,kBACbiB,EAAAA,EAAAA,MAAC6K,GAAI,CACH6D,QAAM,EACN5P,MAAO,CACL9F,MAAOgY,EAAoB,EAAI,UAAY,WAC3CjS,SAAA,CACH,SAEEiS,EAAkBjQ,eAAe,QAAS,CACzCC,sBAAuB,WAI7BhB,EAAAA,EAAAA,MAAA,OACElB,MAAO,CACLiD,QAAS,OACTC,eAAgB,gBAChBE,SAAU,OACVlJ,MAAO,QACP+F,SAAA,EAEF7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAA9L,SAAC,qBACNiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAA9L,SAAA,CACFsQ,EAAY7N,OAAO,eACI,IAAvB6N,EAAY7N,OAAe,IAAM,eAM1CtI,EAAAA,EAAAA,KAACmJ,EAAAA,EAAK,CACJ7D,QAAS8Q,EACThN,WAAY+M,EACZ3M,OAAQ1D,GAAUA,EAAOjB,KAAOiB,EAAO4H,GACvCrE,YAAY,EACZX,KAAK,QACLe,UAAQ,MAIf,EA5SA,GA8SAS,EAAcsB,QACb1E,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACwG,YAAY,OAAMxP,SAAC,WAC5B7F,EAAAA,EAAAA,KAAA,OACE4F,MAAO,CACLmE,QAAS,OACTiF,WAAY,UACZC,aAAc,OACdpJ,SAEDqE,EAAcsB,WAKpBtB,EAAcgO,mBACbpR,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACwG,YAAY,OAAMxP,SAAC,wBAC5B7F,EAAAA,EAAAA,KAAA,OACE4F,MAAO,CACLmE,QAAS,OACTiF,WAAY,UACZC,aAAc,OACdpJ,SAEDqE,EAAcgO,sDCz8B3B,MAAM,SAAE/I,IAAalI,EAAAA,GACf,OAAEF,IAAWhB,EAAAA,GACX4L,KAAK,IAAIC,GAAAA,EAkfjB,GAzesD1Q,IAK/C,IALgD,KACrD8I,EAAI,QACJC,EAAO,cACPC,EAAa,UACbiO,GACDjX,EACC,MAAOiJ,GAAQC,EAAAA,EAAKC,WACb+N,GAAe,UAAExW,KAAeyW,EAAAA,GAAAA,OAChCC,EAAaC,IAAkB/N,EAAAA,EAAAA,UAAiB,QACjDgO,GAAcC,EAAAA,GAAAA,kBAGdZ,EAAcpU,OAAoB,OAAbyG,QAAa,IAAbA,OAAa,EAAbA,EAAe0G,eAAiB,EACrD8H,EAAajV,OAAoB,OAAbyG,QAAa,IAAbA,OAAa,EAAbA,EAAeuL,cAAgB,EACnDkD,EAAwBC,KAAKpR,IAAI,EAAGqQ,EAAca,GAGlDG,OAAgE1S,KAAzB,OAAb+D,QAAa,IAAbA,OAAa,EAAbA,EAAewL,qBAA0E,QAAzB,OAAbxL,QAAa,IAAbA,OAAa,EAAbA,EAAewL,oBAC9FjS,OAAOyG,EAAcwL,oBACrB,KAGEoD,EAAmD,OAA5BD,GAAqCE,MAAMF,GAEpEF,EADAC,KAAKpR,IAAI,EAAGqR,GAIVG,EAAYC,GAAAA,EAAyBC,QAAQ,SAC7CC,GAA8B,OAAbjP,QAAa,IAAbA,OAAa,EAAbA,EAAekP,mBAA8B,OAAXZ,QAAW,IAAXA,OAAW,EAAXA,EAAaY,mBAA4B,OAATJ,QAAS,IAATA,OAAS,EAATA,EAAWG,gBAC9FE,GAAwB,OAAbnP,QAAa,IAAbA,OAAa,EAAbA,EAAeoP,aAAwB,OAAXd,QAAW,IAAXA,OAAW,EAAXA,EAAac,aAAsB,OAATN,QAAS,IAATA,OAAS,EAATA,EAAWK,UAC5EE,GAAwB,OAAbrP,QAAa,IAAbA,OAAa,EAAbA,EAAesP,aAAsB,OAATR,QAAS,IAATA,OAAS,EAATA,EAAWO,WAExDxO,EAAAA,EAAAA,YAAU,KACJf,GAAQE,IAEVC,EAAKsP,eAAe,CAClBjD,aAActO,MACdsP,oBAAgBrR,EAChBuT,aAAc,gBACdtC,oBAAgBjR,EAChB+Q,mBAAe/Q,EACfgR,eAAWhR,EACXkR,sBAAkBlR,IAEpBoS,EAAe,oBAEhB,CAACvO,EAAME,EAAeC,IAGzB,MAAMwP,EAAoB3D,IACxB,MAAMD,EAAU+C,EAAuB9C,EAAc,IACrD7L,EAAKsP,eAAe,CAAEjC,eAAgB/T,OAAOsS,EAAOjS,QAAQ,OAGxD8V,EAAe1M,UACnB,IACE,MAAMC,QAAehD,EAAKiD,iBAG1B,GAAID,EAAOqK,gBAAkB,EAE3B,YADAlK,EAAAA,GAAQC,MAAM,yCAIhB,GAAIJ,EAAOqK,eAAiBsB,EAE1B,YADAxL,EAAAA,GAAQC,MAAM,4DAADvG,OAAwD8R,EAAqBhV,QAAQ,KAKpG,MAAM+V,EAAkB,CAAC,OAAQ,YAAa,qBAAsB,iBAAkB,UAChF3F,EAA6B,OAAbhK,QAAa,IAAbA,OAAa,EAAbA,EAAeiK,OAErC,IAAK0F,EAAgB1V,SAAS+P,GAE5B,YADA5G,EAAAA,GAAQC,MAAM,0CAADvG,OAA2CkN,EAAa,+CAKvE,IAAKiF,IAAmBI,EAEtB,YADAjM,EAAAA,GAAQC,MAAM,mDAKhB,MAAMuM,EAAmB,CAAC,OAAQ,aAAa3V,SAAS+P,MACf,OAAbhK,QAAa,IAAbA,GAAAA,EAAe6P,0BAAuC,OAAb7P,QAAa,IAAbA,GAAAA,EAAe8P,mBAGpF,GAAkB,OAAb9P,QAAa,IAAbA,IAAAA,EAAerF,IAElB,YADAyI,EAAAA,GAAQC,MAAM,gCAIhB,MAIME,EAAe,CACnBwM,kBALW/P,EAAcrF,IAMzB2R,aAAcrJ,EAAOqJ,aAAaxO,OAAO,cACzCwP,eAAgBrK,EAAOqK,eACvBkC,aAAcvM,EAAOuM,aACrBN,gBAAiBD,EACjBK,UAAWD,EACX/N,MAAO2B,EAAO3B,YAASrF,EACvB+T,YAAuB,OAAX1B,QAAW,IAAXA,OAAW,EAAXA,EAAa3T,WAAOsB,EAChCgU,cAAyB,OAAX3B,QAAW,IAAXA,OAAW,EAAXA,EAAa4B,YAAuB,OAAX5B,QAAW,IAAXA,OAAW,EAAXA,EAAa1T,YAAQqB,GAI1DkT,IACF5L,EAAQ6L,UAAYD,GAIM,WAAxBlM,EAAOuM,cACLvM,EAAO+J,gBAAezJ,EAAQyJ,cAAgB/J,EAAO+J,eACrD/J,EAAOgK,YAAW1J,EAAQ0J,UAAYhK,EAAOgK,YACxC,CAAC,MAAO,OAAQ,iBAAiBhT,SAASgJ,EAAOuM,gBACtDvM,EAAOiK,iBAAgB3J,EAAQ2J,eAAiBjK,EAAOiK,gBACvDjK,EAAOgK,WAAqC,kBAAxBhK,EAAOuM,eAC7BjM,EAAQ0J,UAAYhK,EAAOgK,YAK3BhK,EAAOkK,mBACT5J,EAAQ4J,iBAAmBlK,EAAOkK,wBAG9Be,EAAc3K,GAASK,SAG7B,MAAMuM,EAAkBvB,EAAuB3L,EAAOqK,eAChD8C,EAAcR,EAAmB,WAAa,GAEhDO,EAAkB,EACpB/M,EAAAA,GAAQS,QAAQ,GAAD/G,OACVsT,EAAW,qBAAAtT,OAAemG,EAAOqK,eAAe1T,QAAQ,GAAE,oDAAAkD,OAA8CqT,EAAgBvW,QAAQ,IACnI,GAGFwJ,EAAAA,GAAQS,QAAQ,GAAD/G,OAAIsT,EAAW,oEAAoE,GAGpGnQ,EAAK6D,cACI,OAATmK,QAAS,IAATA,GAAAA,IACAlO,GACF,CAAE,MAAOsD,GAAa,IAADU,EAAA+C,EACnBuJ,QAAQhN,MAAM,0BAA2BA,GACzC,MAAMiN,GAAoB,OAALjN,QAAK,IAALA,GAAW,QAANU,EAALV,EAAO7L,YAAI,IAAAuM,OAAN,EAALA,EAAaX,WAAgB,OAALC,QAAK,IAALA,GAAW,QAANyD,EAALzD,EAAO7L,YAAI,IAAAsP,OAAN,EAALA,EAAazD,SAAc,OAALA,QAAK,IAALA,OAAK,EAALA,EAAOD,UAAW,2BACrFA,EAAAA,GAAQC,MAAMiN,EAChB,GAGIC,EAAeA,KACnBtQ,EAAK6D,cACL/D,KAGF,OACEnD,EAAAA,EAAAA,MAACiG,EAAAA,EAAK,CACJxH,OACEuB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAACsV,EAAAA,EAAc,CAAC1P,MAAO,CAAE9F,MAAO,cAChCE,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,sBAGVmE,KAAMA,EACNiD,SAAUwN,EACVhV,MAAO,IACPiE,OAAQ,EACN5C,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAc9B,MAAO,CAAEH,MAAO,OAAQqD,eAAgB,YAAajD,SAAA,EACvE7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CAACW,QAASuR,EAAa5U,SAAC,YAC/B7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CACLC,KAAK,UACLU,QAAS0Q,EACTvT,QAASzE,EACTgE,MAAO,CAAE8U,gBAAiB,UAAWjO,YAAa,WAAY5G,SAC/D,qBAPQ,WAWXA,SAAA,EAEF7F,EAAAA,EAAAA,KAACkO,EAAAA,EAAK,CACJZ,QAAQ,sBACR/K,aACEuE,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACEiB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EAAK7F,EAAAA,EAAAA,KAAA,UAAA6F,SAAQ,eAAmB,KAAe,OAAbqE,QAAa,IAAbA,OAAa,EAAbA,EAAe8C,YAAa,SAC7D8L,EAAuB,IACtB9Y,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAE2J,UAAW,EAAGvG,SAAU,OAAQlJ,MAAO,QAAS+F,SAAC,kHAMrE2C,KAAK,OACL2F,UAAQ,EACRvI,MAAO,CAAEgD,aAAc,OAIzB5I,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CACVoJ,WAAY,UACZjF,QAAS,GACTkF,aAAc,EACdrG,aAAc,IACd/C,UACAiB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAACkC,UAAU,WAAWhE,MAAO,CAAEH,MAAO,QAAUiD,KAAK,QAAO7C,SAAA,EAChEiB,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,iBAAkBjD,SAAA,EAC/D7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAC6D,QAAM,EAAA3P,SAAC,mBACbiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAC6D,QAAM,EAAA3P,SAAA,CAAC,UAAGpC,OAAOoU,IAAgB,GAAGhQ,eAAe,QAAS,CAChEC,sBAAuB,EACvB6S,sBAAuB,WAG3B7T,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,iBAAkBjD,SAAA,EAC/D7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAA9L,SAAC,kBACNiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAC/L,MAAO,CAAE9F,MAAO,WAAY+F,SAAA,CAAC,UAC9BpC,OAAOiV,IAAe,GAAG7Q,eAAe,QAAS,CAClDC,sBAAuB,EACvB6S,sBAAuB,UAI5BjC,EAAa,IACZ5R,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,gBAAiBE,SAAU,OAAQlJ,MAAO,QAAS+F,SAAA,EAChG7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAA9L,SAAC,uBACNiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAA9L,SAAA,EACApC,OAAOiV,GAAcjV,OAAOoU,GAAgB,KAAK/T,QAAQ,GAAG,WAIrE9D,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAACjJ,MAAO,CAAEqS,OAAQ,YAC1BnR,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEiD,QAAS,OAAQC,eAAgB,iBAAkBjD,SAAA,EAC/D7F,EAAAA,EAAAA,KAAC2R,GAAI,CAAC6D,QAAM,EAAA3P,SAAC,yBACbiB,EAAAA,EAAAA,MAAC6K,GAAI,CAAC6D,QAAM,EAAC5P,MAAO,CAAE9F,MAAO,UAAWkJ,SAAU,QAASnD,SAAA,CAAC,SACxDiT,EAAqBjR,eAAe,QAAS,CAC7CC,sBAAuB,EACvB6S,sBAAuB,gBAOjC7T,EAAAA,EAAAA,MAACsD,EAAAA,EAAI,CACHD,KAAMA,EACNiE,OAAO,WACPwM,SAAUhB,EAAa/T,SAAA,EAEvBiB,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,SAAA,EACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,eACL5E,OACE4G,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAAC+U,EAAAA,EAAgB,KACjB/U,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,oBAGV6I,MAAO,CAAC,CAAEC,UAAU,EAAMrB,QAAS,+BAAgCzH,UAEnE7F,EAAAA,EAAAA,KAAC+H,EAAAA,EAAU,CACTnC,MAAO,CAAEH,MAAO,QAChBuC,OAAO,aACP2E,aAAeC,GAAYA,GAAWA,EAAU1E,MAAQ2E,MAAM,cAKpE7M,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,iBACL5E,OACE4G,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAACsV,EAAAA,EAAc,KACftV,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,oBACN7F,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,SAGnCkV,MACEjC,EAAuB,GACrBhS,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAE2J,UAAW,GAAI1J,SAAA,EAC3B7F,EAAAA,EAAAA,KAAC2R,GAAI,CAACnJ,KAAK,YAAY5C,MAAO,CAAEoD,SAAU,OAAQH,QAAS,QAASD,aAAc,GAAI/C,SAAC,wDAGvFiB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAACgB,KAAK,QAAQsS,MAAI,EAAAnV,SAAA,EACtB7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CACLG,KAAK,QACLF,KAAK,OACLU,QAASA,IAAMyQ,EAAiB,IAChC/T,MAAO,CAAEmE,QAAS,QAASf,SAAU,QAASnD,SAC/C,SAGD7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CACLG,KAAK,QACLF,KAAK,OACLU,QAASA,IAAMyQ,EAAiB,IAChC/T,MAAO,CAAEmE,QAAS,QAASf,SAAU,QAASnD,SAC/C,SAGD7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CACLG,KAAK,QACLF,KAAK,OACLU,QAASA,IAAMyQ,EAAiB,IAChC/T,MAAO,CAAEmE,QAAS,QAASf,SAAU,QAASnD,SAC/C,SAGDiB,EAAAA,EAAAA,MAACyB,EAAAA,GAAM,CACLG,KAAK,QACLF,KAAK,OACLU,QAASA,IAAMyQ,EAAiB,KAChC/T,MAAO,CAAEmE,QAAS,QAASf,SAAU,OAAQlJ,MAAO,WAAY+F,SAAA,CACjE,eACSiT,EAAqBhV,QAAQ,GAAG,cAK9CgD,EAAAA,EAAAA,MAAC6K,GAAI,CAACnJ,KAAK,YAAY5C,MAAO,CAAEoD,SAAU,QAASnD,SAAA,CAAC,oCACrBiT,EAAqBhV,QAAQ,GAAG,OAInE4K,MAAO,CACL,CAAEC,UAAU,EAAMrB,QAAS,+BAC3B,CAAE9E,KAAM,SAAUnB,IAAK,IAAMiG,QAAS,iCACtC,CACE2N,UAAWA,CAAC7X,EAAGjC,IACTA,GAASA,EAAQ2X,EACZoC,QAAQC,OAAO,IAAIC,MAAM,oDAADpU,OAAgD8R,EAAqBhV,QAAQ,MAEvGoX,QAAQG,YAGnBxV,UAEF7F,EAAAA,EAAAA,KAACoH,EAAAA,EAAW,CACVxB,MAAO,CAAEH,MAAO,QAChB8B,OAAO,SACPrB,YAAW,4BAAAc,OAAyB8R,EAAqBhV,QAAQ,GAAE,KACnEuD,IAAK,IACLG,IAAKsR,EACLwC,KAAM,IACNhU,UAAW,EACXiU,UAAYpa,GAAU,GAAA6F,OAAG7F,GAAQgU,QAAQ,wBAAyB,KAClEqG,OAASra,IACP,MAAMsa,GAAc,OAALta,QAAK,IAALA,OAAK,EAALA,EAAOgU,QAAQ,cAAe,MAAO,IACpD,OAAO1R,OAAOgY,IAAW,aAOnC3U,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,SAAA,EACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,eACL5E,OACE4G,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAACiW,EAAAA,EAAkB,KACnBjW,EAAAA,EAAAA,KAAA,QAAA6F,SAAM,kBACN7F,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,OAAQ+F,SAAC,SAGnC6I,MAAO,CAAC,CAAEC,UAAU,EAAMrB,QAAS,+BAAgCzH,UAEnEiB,EAAAA,EAAAA,MAACf,EAAAA,EAAM,CACLG,YAAY,sBACZ9E,SAAWD,GAAUoX,EAAepX,GAAO0E,SAAA,EAE3C7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,OAAM0E,SAAC,UACrB7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,MAAK0E,SAAC,SACpB7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,OAAM0E,SAAC,UACrB7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,gBAAe0E,SAAC,mBAC9B7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,SAAQ0E,SAAC,YACvB7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,QAAO0E,SAAC,iBAMX,UAAhByS,IACCtY,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,mBACL5E,MAAM,8BACN6a,MAAM,wCAAuClV,UAE7C7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,4CAOV,WAAhBoS,IACCxR,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,SAAA,EACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,gBACL5E,MAAM,gBAAe2F,UAErB7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,6BAGvBlG,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,YACL5E,MAAM,YAAW2F,UAEjB7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,2BAM1B,CAAC,MAAO,QAAQ/B,SAASmU,KACxBtY,EAAAA,EAAAA,KAACqO,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,UACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,iBACL5E,MAAM,iBAAgB2F,UAEtB7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,+BAMV,kBAAhBoS,IACCxR,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,SAAA,EACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,iBACL5E,MAAM,iBAAgB2F,UAEtB7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,kDAGvBlG,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,YACL5E,MAAM,YAAW2F,UAEjB7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,2BAMV,UAAhBoS,IACCtY,EAAAA,EAAAA,KAACqO,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,UACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAIC,GAAI,GAAGjV,UAClB7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,mBACL5E,MAAM,mBAAkB2F,UAExB7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,kCAM3BlG,EAAAA,EAAAA,KAACqO,GAAAA,EAAG,CAACC,OAAQ,GAAGzI,UACd7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACsM,GAAI,GAAGhV,UACV7F,EAAAA,EAAAA,KAACoK,EAAAA,EAAKqE,KAAI,CACR3J,KAAK,QACL5E,MAAM,QAAO2F,UAEb7F,EAAAA,EAAAA,KAACmP,GAAQ,CACPC,KAAM,EACNlJ,YAAY,mFCve5B,MAiOA,GAjOkDhF,IAK3C,IAADwa,EAAAC,EAAAC,EAAA,IAL6C,KACjD5R,EAAI,QACJC,EAAO,MACP4R,EAAK,QACLC,GACD5a,EACC,MAAQQ,KAAMqa,EAAa,UAAEna,IAAcoa,EAAAA,EAAAA,IAAoCH,GAAS,GAAI,CAC1FzJ,MAAOpI,IAAS6R,KAAWC,IAGvBG,EAAMH,IAAyB,OAAbC,QAAa,IAAbA,OAAa,EAAbA,EAAuB9Z,SAAU,CAAC,EAGpDmS,EAAc,CAClB,CACE7O,MAAO,UACPC,IAAK,UACLC,MAAO,IACPC,OAASI,IAAW,IAAAoW,EAAA,OAClBpV,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAA,UAAA6F,SAASC,EAAOzD,eAAkC,QAAtB6Z,EAAIpW,EAAOqW,mBAAW,IAAAD,OAAA,EAAlBA,EAAoBpX,OAAQ,MAC3DgB,EAAOxD,eACNtC,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAC7CC,EAAOxD,oBAMlB,CACEiD,MAAO,cACPC,IAAK,mBACLC,MAAO,IACPC,OAASI,IACP9F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAM+F,SAAEC,EAAOoF,kBAAoB,KAGlD,CACE3F,MAAO,eACPC,IAAK,oBACLC,MAAO,IACPC,OAASI,IACP9F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,QAAO+F,SAAEC,EAAOhD,mBAAqB,KAGpD,CACEyC,MAAO,eACPC,IAAK,oBACLC,MAAO,IACPC,OAASI,GACPA,EAAOqF,kBAAoB,GACzBnL,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,MAAK+F,SAAEC,EAAOqF,qBAEzBnL,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,QAAS+F,SAAC,OAItC,CACEN,MAAO,eACPC,IAAK,oBACLC,MAAO,IACPC,OAASI,IACP9F,EAAAA,EAAAA,KAAA,UAAQ4F,MAAO,CAAE9F,MAAO,WAAY+F,SACjCC,EAAOsF,mBAAqB,KAInC,CACE7F,MAAO,aACPC,IAAK,aACLC,MAAO,IACPC,OAASI,IACPgB,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAM,UAAGpC,OAAOqC,EAAOrD,aAAe,GAAGqB,QAAQ,OAGrD,CACEyB,MAAO,QACPC,IAAK,iBACLC,MAAO,GACPC,OAASI,IACPgB,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAOC,EAAOpD,gBAAkB,EAAE,QAGtC,CACE6C,MAAO,WACPC,IAAK,WACLC,MAAO,IACPC,OAASI,GAAgBA,EAAOuF,UAAY,KAE9C,CACE9F,MAAO,cACPC,IAAK,cACLC,MAAO,IACPC,OAASI,GACPA,EAAOyF,YAAcrD,IAAMpC,EAAOyF,aAAavD,OAAO,cAAgB,MAK5E,OACElB,EAAAA,EAAAA,MAACiG,EAAAA,EAAK,CACJxH,OACEuB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAAC0U,EAAAA,EAAgB,CAAC9O,MAAO,CAAE9F,MAAO,cAClCgH,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,CAAM,iBAAeoW,EAAIG,iBAG7BpS,KAAMA,EACNiD,SAAUhD,EACVxE,MAAO,KACPiE,OAAQ,KAAK7D,SAAA,EAEb7F,EAAAA,EAAAA,KAACkO,EAAAA,EAAK,CACJZ,QAAQ,2BACR/K,YAAY,qGACZiG,KAAK,OACL2F,UAAQ,EACRvI,MAAO,CAAEgD,aAAc,OAGzB9B,EAAAA,EAAAA,MAAC0J,GAAAA,EAAY,CAAC/G,UAAQ,EAACgH,OAAQ,EAAG/H,KAAK,QAAQ9C,MAAO,CAAEgD,aAAc,IAAK/C,SAAA,EACzE7F,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,aAAY2F,UACnC7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,SAAS8F,MAAO,CAAEoD,SAAU,QAASnD,SAC7CoW,EAAIG,gBAGTpc,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,WAAU2F,UACjCiB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAAC+U,EAAAA,EAAgB,IAChBkH,EAAII,SAAWnU,IAAM+T,EAAII,UAAUrU,OAAO,cAAgB,UAG/DhI,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,YAAW2F,UAClC7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAM+F,SACdoW,EAAIjP,YAAkC,QAAzB0O,EAAIO,EAAIK,yBAAiB,IAAAZ,OAAA,EAArBA,EAAuB1O,YAAa,SAG1DhN,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,SAAQ2F,UACpB,QAAV8V,EAAAM,EAAIvL,cAAM,IAAAiL,OAAA,EAAVA,EAAYhL,cAAesL,EAAItL,aAAe,OAEjD3Q,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,wBAAuB2F,SAC7CoW,EAAItO,mBACH3N,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,QAAO+F,SAAEoW,EAAItO,oBAExB,OAGJ3N,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,sBAAqB2F,SAC3CoW,EAAIrO,oBAAsB1F,IAAM+T,EAAIrO,qBAAqB5F,OAAO,cAAgB,OAEnFhI,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,cAAa2F,SACnCoW,EAAIM,kBAAoB,OAE3Bvc,EAAAA,EAAAA,KAACwQ,GAAAA,EAAa/B,KAAI,CAACvO,MAAM,YAAW2F,UACpB,QAAb+V,EAAAK,EAAIrI,iBAAS,IAAAgI,OAAA,EAAbA,EAAejI,iBAAkBsI,EAAItI,gBAAkB,UAI5D3T,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAAAhJ,SAAC,oBAET7F,EAAAA,EAAAA,KAACmJ,EAAAA,EAAK,CACJ7D,QAAS8O,EACThL,WAAY6S,EAAIjR,OAAS,GACzBxB,OAAQA,CAAC1D,EAAQ7C,IAAK,QAAA+D,OAAa/D,GACnCoD,QAASzE,EACTyH,YAAY,EACZX,KAAK,QACLe,UAAQ,EACRH,OAAQ,CAAEC,EAAG,SAGfvJ,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAAAhJ,SAAC,uBAETiB,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACC,OAAQ,GAAI1I,MAAO,CAAEgD,aAAc,IAAK/C,SAAA,EAC3C7F,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,WACNpE,MAAOsC,OAAOwY,EAAIpY,WAAa,EAC/B0D,OAAO,SACPD,UAAW,OAGftH,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,aACNpE,MAAOsC,OAAOwY,EAAI1G,aAAe,EACjChO,OAAO,SACPD,UAAW,EACXyH,WAAY,CAAEjP,MAAO,gBAGzBE,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,gBACNpE,MAAOsC,OAAOwY,EAAIxQ,gBAAkB,EACpClE,OAAO,SACPD,UAAW,OAGftH,EAAAA,EAAAA,KAACuO,GAAAA,EAAG,CAACC,KAAM,EAAE3I,UACX7F,EAAAA,EAAAA,KAAC8O,GAAAA,EAAS,CACRvJ,MAAM,eACNpE,MAAOsC,OAAOwY,EAAIrL,eAAiB,EACnCrJ,OAAO,SACPD,UAAW,EACXyH,WAAY,CAAEjP,MAAO,UAAWkJ,SAAU,OAAQkG,WAAY,eAKnE+M,EAAIzQ,QACH1E,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAAC6O,GAAAA,EAAO,CAAAhJ,SAAC,WACT7F,EAAAA,EAAAA,KAACkO,EAAAA,EAAK,CACJZ,QAAS2O,EAAIzQ,MACbhD,KAAK,OACL2F,UAAU,EACVvI,MAAO,CAAEgD,aAAc,aCZnC,GAxN6B4T,KAC3B,MAAOC,EAAYC,IAAiBlS,EAAAA,EAAAA,UAAS,KACtCnB,EAAYsT,IAAiBnS,EAAAA,EAAAA,UAAS,CAC3CoC,QAAS,EACTgQ,SAAU,MAELC,EAAaC,IAAkBtS,EAAAA,EAAAA,UAAc,OAC7CuS,EAAeC,IAAoBxS,EAAAA,EAAAA,WAAS,IAG3C9I,KAAMub,EAAQ,UAAErb,IAAcsb,EAAAA,EAAAA,IAAiC,CACrE1b,WAAY6H,EAAWuD,QACvBnL,UAAW4H,EAAWuT,SACtBO,aAAcV,EAAWnU,OAAS,GAA2B,IAAtBmU,EAAWnU,OAAemU,OAAatW,IAG1EiX,GAAW7b,EAAAA,EAAAA,UAAQ,KAAe,OAAR0b,QAAQ,IAARA,OAAQ,EAARA,EAAkBhb,SAAU,IAAI,CAACgb,IAC3DI,GAAiB9b,EAAAA,EAAAA,UAAQ,KAAe,OAAR0b,QAAQ,IAARA,OAAQ,EAARA,EAAkB5T,aAAc,CAAC,GAAG,CAAC4T,IAErEK,GAAenb,EAAAA,EAAAA,cAAahB,IAChCub,EAAcvb,GACdwb,GAAazY,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAImF,GAAU,IAAEuD,QAAS,OACvC,CAACvD,IAaE/D,EAAU,CACd,CACEC,MAAO,aACPC,IAAK,aACLC,MAAO,IACPC,OAASI,IACP9F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,SAAS8F,MAAO,CAAEoD,SAAU,OAAQe,QAAS,YAAalE,SAClEC,EAAOsW,cAId,CACE7W,MAAO,WACPC,IAAK,WACLC,MAAO,IACPC,OAASI,IACPgB,EAAAA,EAAAA,MAACY,EAAAA,EAAK,CAAA7B,SAAA,EACJ7F,EAAAA,EAAAA,KAAC+U,EAAAA,EAAgB,IAChB7M,IAAMpC,EAAOuW,UAAUrU,OAAO,kBAIrC,CACEzC,MAAO,YACPC,IAAK,YACLC,MAAO,IACPC,OAASI,IAAW,IAAAyX,EAAA,OAClBvd,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,OAAM+F,SACdC,EAAOkH,YAAqC,QAA5BuQ,EAAIzX,EAAOwW,yBAAiB,IAAAiB,OAAA,EAAxBA,EAA0BvQ,YAAa,QAIlE,CACEzH,MAAO,SACPC,IAAK,SACLC,MAAO,IACPC,OAASI,IAAW,IAAA0X,EAAAC,EAAA,OAClB3W,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAA,UAAA6F,UAAsB,QAAb2X,EAAA1X,EAAO4K,cAAM,IAAA8M,OAAA,EAAbA,EAAe7M,cAAe7K,EAAO6K,aAAe,OAC3C,QAAjB8M,EAAA3X,EAAO4L,kBAAU,IAAA+L,OAAA,EAAjBA,EAAmBtK,gBAClBnT,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAC7CC,EAAO4L,WAAWyB,oBAM7B,CACE5N,MAAO,iBACPC,IAAK,iBACLC,MAAO,IACPC,OAASI,IACP9F,EAAAA,EAAAA,KAAA,OAAA6F,SACGC,EAAO6H,mBACN7G,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,QAAO+F,SAAEC,EAAO6H,oBAC1B7H,EAAO8H,sBACN5N,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,OAAQyP,UAAW,OAAQ1J,SAC/DqC,IAAMpC,EAAO8H,qBAAqB5F,OAAO,oBAKhDhI,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,QAAS+F,SAAC,SAKxC,CACEN,MAAO,QACPC,IAAK,cACLC,MAAO,IACPC,OAASI,IAAW,IAAA4X,EAAA,OAClB5W,EAAAA,EAAAA,MAACwF,EAAAA,EAAG,CAAAzG,SAAA,EACW,QAAZ6X,EAAA5X,EAAOkF,aAAK,IAAA0S,OAAA,EAAZA,EAAcpV,SAAU,EAAE,cAIjC,CACE/C,MAAO,cACPC,IAAK,cACLC,MAAO,IACPC,OAASI,GAAgBA,EAAOyW,kBAAoB,KAEtD,CACEhX,MAAO,WACPC,IAAK,WACLC,MAAO,IACPC,OAASI,IACPgB,EAAAA,EAAAA,MAAA,QAAMlB,MAAO,CAAEsJ,WAAY,KAAMrJ,SAAA,CAAC,UAC7BpC,OAAOqC,EAAOjC,WAAa,GAAGgE,eAAe,QAAS,CAAEC,sBAAuB,QAIxF,CACEvC,MAAO,aACPC,IAAK,aACLC,MAAO,IACPC,OAASI,IACPgB,EAAAA,EAAAA,MAAA,QAAMlB,MAAO,CAAE9F,MAAO,WAAY+F,SAAA,CAAC,UAC9BpC,OAAOqC,EAAOyP,aAAe,GAAG1N,eAAe,QAAS,CAAEC,sBAAuB,QAI1F,CACEvC,MAAO,eACPC,IAAK,eACLC,MAAO,IACPC,OAASI,IACPgB,EAAAA,EAAAA,MAAA,UAAQlB,MAAO,CAAE9F,MAAO,UAAWkJ,SAAU,QAASnD,SAAA,CAAC,UAClDpC,OAAOqC,EAAO8K,eAAiB,GAAG/I,eAAe,QAAS,CAAEC,sBAAuB,QAI5F,CACEvC,MAAO,UACPC,IAAK,UACLC,MAAO,IACPkY,MAAO,QACPjY,OAAQA,CAACtC,EAAQ0C,KACf9F,EAAAA,EAAAA,KAAC0H,EAAAA,EAAK,CAAA7B,UACJ7F,EAAAA,EAAAA,KAAC4H,EAAAA,EAAO,CAACrC,MAAM,mBAAkBM,UAC/B7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CACLC,KAAK,OACLzI,MAAMC,EAAAA,EAAAA,KAAC4d,EAAAA,EAAW,IAClB1U,QAASA,IApIDpD,KAClBgX,EAAehX,GACfkX,GAAiB,IAkIQa,CAAW/X,GAAQD,SACnC,eASX,OACEiB,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACEiB,EAAAA,EAAAA,MAACuH,GAAAA,EAAG,CAACyP,QAAQ,gBAAgBC,MAAM,SAASnY,MAAO,CAAEgD,aAAc,IAAK/C,SAAA,EACtEiB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAA,MAAI4F,MAAO,CAAEqS,OAAQ,EAAGjP,SAAU,OAAQkG,WAAY,KAAMrJ,SAAC,+BAG7D7F,EAAAA,EAAAA,KAAA,KAAG4F,MAAO,CAAEqS,OAAQ,YAAanY,MAAO,OAAQkJ,SAAU,QAASnD,SAAC,gDAItE7F,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEiD,QAAS,OAAQgB,IAAK,OAAQd,WAAY,UAAWlD,UACjE7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CACJf,YAAY,gDACZqB,QAAQvH,EAAAA,EAAAA,KAACge,GAAAA,EAAc,IACvB7c,MAAOsb,EACPrb,SAAW8F,GAAMoW,EAAapW,EAAEC,OAAOhG,OACvCyE,MAAO,CAAEH,MAAO,KAChBQ,YAAU,UAKhBjG,EAAAA,EAAAA,KAACie,GAAAA,EAAW,CACV3Y,QAASA,EACT5D,KAAM0b,EACN5T,OAAO,MACPnD,QAASzE,EACTsc,WAAYb,EAAea,YAAc,EACzCzc,UAAW4b,EAAe5b,WAAa,GACvC0c,mBAhLyBC,CAAC5c,EAAoBC,KAClDkb,EAAc,CAAE/P,QAASpL,EAAYob,SAAUnb,QAkL7CzB,EAAAA,EAAAA,KAACqe,GAAY,CACXrU,KAAM+S,EACN9S,QAASA,KACP+S,GAAiB,GACjBF,EAAe,OAEjBjB,MAAkB,OAAXgB,QAAW,IAAXA,OAAW,EAAXA,EAAahY,IACpBiX,QAASe,SC/MT1N,SAAS,IAAIlI,EAAAA,GACbF,OAAO,IAAIhB,EAAAA,EAiZnB,GA/YoCuY,KAClC,MAAM9F,GAAcC,EAAAA,GAAAA,mBACb8F,EAAWC,IAAgBhU,EAAAA,EAAAA,UAAS,oBAGpCiU,EAAkBC,IAAuBlU,EAAAA,EAAAA,WAAS,IAClDmU,EAAmBC,IAAwBpU,EAAAA,EAAAA,WAAS,IACpDqU,EAAeC,IAAoBtU,EAAAA,EAAAA,WAAS,IAC5CuS,EAAeC,IAAoBxS,EAAAA,EAAAA,WAAS,IAC5CuU,EAAkBC,IAAuBxU,EAAAA,EAAAA,WAAS,IAClDyU,GAAYC,KAAiB1U,EAAAA,EAAAA,UAAc,MAG5ClJ,IAAcC,EAAAA,EAAAA,UAAQ,MAASC,WAAY,EAAGC,UAAW,OAAQ,KAC/DC,KAAMyd,GAAavd,UAAWwd,IAAmBtd,EAAAA,GAASud,kBAAkB/d,KAC5EI,KAAM4d,GAAgB1d,UAAW2d,IAAsBzd,EAAAA,GAAS0d,qBAAqBle,IAEvFme,IAAUle,EAAAA,EAAAA,UAAQ,KAAkB,OAAX4d,SAAW,IAAXA,QAAW,EAAXA,GAAqBld,SAAU,IAAI,CAACkd,KAC7DO,IAAane,EAAAA,EAAAA,UAAQ,KAAqB,OAAd+d,SAAc,IAAdA,QAAc,EAAdA,GAAwBrd,SAAU,IAAI,CAACqd,MAGlEK,KAAYC,EAAAA,EAAAA,OACZ1P,KAAYE,EAAAA,EAAAA,OACZyP,KAAYC,EAAAA,EAAAA,MAGbC,IAAkB5d,EAAAA,EAAAA,cAAaoB,IACnC,MAAMC,EAAMC,OAAOF,EAAKf,WAAa,EAC/BkB,EAAQD,OAAOF,EAAKd,aAAe,EACnCmB,EAAcH,OAAOF,EAAKZ,WAAa,EAG7C,IAAIwC,EAAe3B,EAAME,EAOzB,OALEyB,GADmB,gBAHA5B,EAAKX,eAAiB,cAIzBuC,EAAevB,EAAc,IAE7BA,EAGXuB,IACN,IAGG6a,IAAkB7d,EAAAA,EAAAA,cAAY,WAAwB,IACtD0B,EAAW,EACX0R,EAAa,EACb0K,EAAkB,GAHyBC,UAAA5X,OAAA,QAAAnC,IAAA+Z,UAAA,GAAAA,UAAA,GAAG,IAK5CjU,SAAQ1I,IACZ,MAAMC,EAAMC,OAAOF,EAAKf,WAAa,EAC/BkB,EAAQD,OAAOF,EAAKd,aAAe,EAEzC,GAAIiB,EAAQ,EAAG,CACb,MAAMyc,EAAY3c,EAAME,EAClByB,EAAe4a,GAAgBxc,GAC/BI,EAASF,OAAOF,EAAKb,iBAAmB,EAE9CmB,GAAYsB,EACZoQ,GAAcpQ,GAAgBxB,EAAS,KACvCsc,GAAmBE,EAAYhb,CACjC,KAGF,MAAMyL,EAAe/M,EAAW0R,EAEhC,MAAO,CACL1R,SAAUJ,OAAOI,EAASC,QAAQ,IAClCyR,WAAY9R,OAAO8R,EAAWzR,QAAQ,IACtCmc,gBAAiBxc,OAAOwc,EAAgBnc,QAAQ,IAChD8M,aAAcnN,OAAOmN,EAAa9M,QAAQ,IAC1C4R,mBAAoBjS,OAAOmN,EAAa9M,QAAQ,IAEpD,GAAG,CAACic,KAGEK,IAAY7e,EAAAA,EAAAA,UAAQ,IAAM,CAC9B,CACEuD,KAAM,YACN5E,MAAO,YACPwO,MAAO,CAAC,CAAEC,UAAU,EAAOrB,QAAS,0BACpC+S,WAAWrgB,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,sCAEhC,CACEpB,KAAM,UACN5E,MAAO,UACPogB,aAAcpY,MACdwG,MAAO,CAAC,CAAEC,UAAU,EAAMrB,QAAS,wBACnC+S,WAAWrgB,EAAAA,EAAAA,KAAC+H,EAAAA,EAAU,CAACnC,MAAO,CAAEH,MAAO,QAAUuC,OAAO,gBAE1D,CACElD,KAAM,YACN5E,MAAO,SACPwO,MAAO,CAAC,CAAEC,UAAU,EAAMrB,QAAS,uBACnC+S,WACErgB,EAAAA,EAAAA,KAAC+F,EAAAA,EAAM,CACLC,YAAU,EACVE,YAAY,gBACZG,QAAS+Y,GACT9Y,aAAcA,CAACC,EAAOC,IACpBC,QAAa,OAAND,QAAM,IAANA,OAAM,EAANA,EAAQX,WAAY,IAAIa,cAAcvC,SAASoC,EAAMG,eAC7Db,SAEA4Z,GAAQ7Y,KAAK8J,IACZ1Q,EAAAA,EAAAA,KAAC+G,GAAM,CAAkB5F,MAAOuP,EAAO7L,IAAIgB,SACxC6K,EAAOC,aADGD,EAAO7L,UAO5B,CACEC,KAAM,yBACN5E,MAAO,yBACPmgB,WAAWrgB,EAAAA,EAAAA,KAAC+H,EAAAA,EAAU,CAACnC,MAAO,CAAEH,MAAO,QAAUuC,OAAO,gBAE1D,CACElD,KAAM,eACN5E,MAAO,qBACPwO,MAAO,CAAC,CAAEC,UAAU,EAAMrB,QAAS,0BACnC+S,WACErgB,EAAAA,EAAAA,KAAC+F,EAAAA,EAAM,CACLC,YAAU,EACVE,YAAY,mBACZG,QAASkZ,GACTjZ,aAAcA,CAACC,EAAOC,IACpBC,QAAa,OAAND,QAAM,IAANA,OAAM,EAANA,EAAQX,WAAY,IAAIa,cAAcvC,SAASoC,EAAMG,eAC7Db,SAEA6Z,GAAW9Y,KAAKgN,IACf5T,EAAAA,EAAAA,KAAC+G,GAAM,CAAqB5F,MAAOyS,EAAU/O,IAAIgB,SAC9C+N,EAAUD,gBADAC,EAAU/O,UAO/B,CACEC,KAAM,gBACN5E,MAAO,gBACPogB,aAAc,SACdD,WACEvZ,EAAAA,EAAAA,MAACf,EAAAA,EAAM,CAAAF,SAAA,EACL7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,YAAW0E,SAAC,eAC1B7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,QAAO0E,SAAC,gBACtB7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,SAAQ0E,SAAC,iBACvB7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,SAAQ0E,SAAC,iBACvB7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,SAAQ0E,SAAC,iBACvB7F,EAAAA,EAAAA,KAAC+G,GAAM,CAAC5F,MAAM,SAAQ0E,SAAC,oBAI7B,CACEf,KAAM,mBACN5E,MAAO,mBACPmgB,WAAWrgB,EAAAA,EAAAA,KAACmP,GAAQ,CAACC,KAAM,EAAGlJ,YAAY,sBAE5C,CACEpB,KAAM,kBACN5E,MAAO,kBACPmgB,WAAWrgB,EAAAA,EAAAA,KAACiH,EAAAA,EAAK,CAACf,YAAY,qCAEhC,CACEpB,KAAM,QACN5E,MAAO,QACPmgB,WAAWrgB,EAAAA,EAAAA,KAACmP,GAAQ,CAACC,KAAM,EAAGlJ,YAAY,sCAE5C,CACEpB,KAAM,mBACN5E,MAAO,qBACPmgB,WAAWrgB,EAAAA,EAAAA,KAACmP,GAAQ,CAACC,KAAM,EAAGlJ,YAAY,sCAE5C,CACEpB,KAAM,QACN5E,MAAO,aACPwO,MAAO,CACL,CAAEC,UAAU,EAAMrB,QAAS,iCAC3B,CACE2N,UAAW/N,MAAO9J,EAAQ4H,KACxB,IAAKA,GAA0B,IAAjBA,EAAM1C,OAClB,MAAM,IAAI8S,MAAM,iCAKlB,GAHwBpQ,EAAMqC,MAC5B9J,IAASA,EAAKnB,aAAemB,EAAKf,WAGlC,MAAM,IAAI4Y,MAAM,+CAKxBiF,WAAWrgB,EAAAA,EAAAA,KAACugB,EAAgB,IAC5BC,QAAS,KAEV,CAACf,GAASC,GAAYN,GAAgBG,KAGnCkB,IAAgBlf,EAAAA,EAAAA,UAAQ,MAC5Bmf,OAAS5a,IACPoZ,GAAcpZ,GACdkX,GAAiB,IAEnB2D,OAAQA,OACRC,SAAU1T,SAAuBI,EAAAA,GAAQuT,KAAK,qCAC9CC,SAAU5T,UACRH,EAAAA,EAAMgU,QAAQ,CACZxb,MAAO,sCACPyb,QAAS,yEACTlQ,KAAM5D,UACJ,UACQyS,GAAS,CAAEjS,GAAI5H,EAAOjB,MAAOiJ,SACnCR,EAAAA,GAAQS,QAAQ,wCAClB,CAAE,MAAOR,GAAa,IAADU,EACnBX,EAAAA,GAAQC,OAAW,OAALA,QAAK,IAALA,GAAW,QAANU,EAALV,EAAO7L,YAAI,IAAAuM,OAAN,EAALA,EAAaX,UAAW,sBACxC,MAIN2T,UAAYnb,IACVoZ,GAAcpZ,GACd8Y,GAAqB,IAEvBsC,SAAUhU,UACRH,EAAAA,EAAMgU,QAAQ,CACZxb,MAAO,yBACPyb,SACEla,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAA,KAAA6F,SAAG,4CACH7F,EAAAA,EAAAA,KAACiH,EAAAA,EAAMkI,SAAQ,CACbC,KAAM,EACN1B,GAAG,mBACHxH,YAAY,uBAIlB4K,KAAM5D,UAAa,IAADiU,EAChB,MAAMpQ,EAAqD,QAA/CoQ,EAAIC,SAASC,eAAe,2BAAmB,IAAAF,OAAA,EAA5CA,EAAsEhgB,MACrF,IAAK4P,EAEH,OADAzD,EAAAA,GAAQC,MAAM,gCACP2N,QAAQC,SAEjB,UACQjL,GAAS,CAAExC,GAAI5H,EAAOjB,IAAKkM,WAAUjD,SAC3CR,EAAAA,GAAQS,QAAQ,0BAClB,CAAE,MAAOR,GAAa,IAADyD,EACnB1D,EAAAA,GAAQC,OAAW,OAALA,QAAK,IAALA,GAAW,QAANyD,EAALzD,EAAO7L,YAAI,IAAAsP,OAAN,EAALA,EAAa1D,UAAW,sBACxC,MAINgU,OAASxb,IACPoZ,GAAcpZ,GACdgZ,GAAiB,IAEnByC,UAAYzb,IACVoZ,GAAcpZ,GACd4Y,GAAoB,IAEtB8C,MAAQ1b,IACNoZ,GAAcpZ,GACdkZ,GAAoB,IAEtB/R,SAAUC,UACRH,EAAAA,EAAMgU,QAAQ,CACZxb,MAAO,yBACPyb,QAAS,2CACTlQ,KAAM5D,UACJ,UACQ2S,GAAS,CAAEnS,GAAI5H,EAAOjB,MAAOiJ,SACnCR,EAAAA,GAAQS,QAAQ,2BAClB,CAAE,MAAOR,GAAa,IAADkU,EACnBnU,EAAAA,GAAQC,OAAW,OAALA,QAAK,IAALA,GAAW,QAANkU,EAALlU,EAAO7L,YAAI,IAAA+f,OAAN,EAALA,EAAanU,UAAW,sBACxC,MAINoU,QAASA,IAAMpU,EAAAA,GAAQuT,KAAK,sCAC1B,CAAClB,GAAUzP,GAAU2P,KAGnB8B,IAAmBxf,EAAAA,EAAAA,cAAagL,IACpC,MAAMnI,EAASgb,GAAgB7S,EAAOnC,OAAS,IAE/C,OAAA9G,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAA,GACKiJ,GACAnI,GAAM,IACTgQ,QAAS7H,EAAO6H,QAAU9M,IAAMiF,EAAO6H,SAAShN,OAAO,cAAgBE,MAAQF,OAAO,cACtFC,uBAAwBkF,EAAOlF,uBAC7BC,IAAMiF,EAAOlF,wBAAwBD,OAAO,mBAAgB7B,EAC9DgO,OAAQhH,EAAOtI,IAAMsI,EAAOgH,OAAS,QACrCyN,cAA0B,OAAXpJ,QAAW,IAAXA,OAAW,EAAXA,EAAa3T,IAC5BgM,gBAA4B,OAAX2H,QAAW,IAAXA,OAAW,EAAXA,EAAa4B,SAC9B3E,YAAatI,EAAOsI,aAAe,MAEpC,CAACuK,GAAiBxH,IAGfqJ,IAAStgB,EAAAA,EAAAA,UAAQ,YACrBgE,MAAO,kBACPuc,WAAY,gBACZxc,ST7QiCyc,ES6QHtB,GT7Q8B,CAC9D,CACElb,MAAO,YACP8G,UAAW,YACX7G,IAAK,YACLmY,MAAO,OACPlY,MAAO,IACPC,OAAQA,CAACkP,EAAc9O,KACrBgB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACvM,MAAMC,EAAAA,EAAAA,KAAC0U,EAAAA,EAAgB,IAAK5U,MAAM,OAAO8F,MAAO,CAAEoD,SAAU,QAASnD,SACvE+O,IAEF9O,EAAOkc,YACNhiB,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,MAAM8F,MAAO,CAAE2J,UAAW,GAAI1J,SAAC,eAOlD,CACEN,MAAO,SACP8G,UAAW,SACX7G,IAAK,SACLC,MAAO,IACPwc,QAAS5d,OAAO6d,KAAKtiB,GAAcgH,KAAIpB,IAAG,CACxCoP,KAAMhV,EAAa4F,GAAiBtF,MACpCiB,MAAOqE,MAET2c,SAAUA,CAAChhB,EAAY2E,IAAgBA,EAAOqO,SAAWhT,EACzDuE,OAAQA,CAACyO,EAAkBrO,KACzB,MAAM+b,EAASjiB,EAAauU,IAAWvU,EAAaC,MAC9CuiB,EAAYtc,EAAOmC,wBACvBC,IAAMpC,EAAOmC,wBAAwBoa,SAASna,SAC7C,CAAC,iBAAkB,YAAa,UAAU/D,SAASgQ,GAEtD,OACErN,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAC2U,EAAAA,EAAK,CACJR,OAAQ0N,EAAO/hB,MACf8U,MACE5U,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAO+hB,EAAO/hB,MAAOC,KAAM8hB,EAAO9hB,KAAK8F,SACzCgc,EAAO3hB,UAIbkiB,IACCpiB,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,MAAMC,MAAMC,EAAAA,EAAAA,KAACsiB,EAAAA,EAAe,IAAK1c,MAAO,CAAE2J,UAAW,GAAI1J,SAAC,iBAQ/E,CACEN,MAAO,SACP8G,UAAW,aACX7G,IAAK,SACLC,MAAO,IACPC,OAAQA,CAACgL,EAAa5K,KACpB,MAAMoM,EAAaxB,GAAU,CAAEC,YAAa7K,EAAO6K,YAAawC,aAAc,IAC9E,OACEnT,EAAAA,EAAAA,KAAC4H,EAAAA,EAAO,CAACrC,MAAO2M,EAAWiB,cAAgB,kBAAkBtN,UAC3DiB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAC6U,EAAAA,EAAY,CAACjP,MAAO,CAAEkP,YAAa,EAAGhV,MAAO,cAC9CE,EAAAA,EAAAA,KAAA,UAAA6F,SAASqM,EAAWvB,aAAe,MAClCuB,EAAWiB,eACVnT,EAAAA,EAAAA,KAAA,OAAK4F,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAC7CqM,EAAWiB,sBAQ1B,CACE5N,MAAO,UACP8G,UAAW,UACX7G,IAAK,UACLC,MAAO,IACP4Q,OAAQA,CAACC,EAAQC,IAAWrO,IAAMoO,EAAEtB,SAASyB,OAASvO,IAAMqO,EAAEvB,SAASyB,OACvE/Q,OAASyC,IACPrB,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAC+U,EAAAA,EAAgB,CAACnP,MAAO,CAAEkP,YAAa,KACvC5M,IAAMC,GAAMH,OAAO,kBAI1B,CACEzC,MAAO,oBACP8G,UAAW,yBACX7G,IAAK,yBACLC,MAAO,IACP4Q,OAAQA,CAACC,EAAQC,IACfrO,IAAMoO,EAAErO,wBAA0B,GAAGwO,OAASvO,IAAMqO,EAAEtO,wBAA0B,GAAGwO,OACrF/Q,OAAQA,CAACyC,EAAcrC,KACrB,IAAKqC,EAAM,OAAOnI,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAE9F,MAAO,QAAS+F,SAAC,MAElD,MAAMuc,EAAYla,IAAMC,GAAMka,SAASna,SACpC,CAAC,iBAAkB,YAAa,UAAU/D,SAAS2B,EAAOqO,QACvDoO,EAAWra,IAAMC,GAAMqa,KAAKta,MAAS,QAE3C,OACElI,EAAAA,EAAAA,KAAC4H,EAAAA,EAAO,CAACrC,MAAO6c,EAAY,WAAU,GAAApb,OAAMub,EAAQ,cAAa1c,UAC/DiB,EAAAA,EAAAA,MAAA,QAAMlB,MAAO,CAAE9F,MAAOsiB,EAAY,UAAYG,GAAY,EAAI,UAAY,WAAY1c,SAAA,EACpF7F,EAAAA,EAAAA,KAAC+U,EAAAA,EAAgB,CAACnP,MAAO,CAAEkP,YAAa,KACvC5M,IAAMC,GAAMH,OAAO,qBAM9B,CACEzC,MAAO,QACP8G,UAAW,QACX7G,IAAK,cACLC,MAAO,GACPsY,MAAO,SACPrY,OAASsF,IACPlE,EAAAA,EAAAA,MAACwF,EAAAA,EAAG,CAACxM,MAAM,WAAU+F,SAAA,EAAO,OAALmF,QAAK,IAALA,OAAK,EAALA,EAAO1C,SAAU,EAAE,aAG9C,CACE/C,MAAO,eACP8G,UAAW,eACX7G,IAAK,eACLC,MAAO,IACP4Q,OAAQA,CAACC,EAAQC,KAAYD,EAAE1F,cAAgB,IAAM2F,EAAE3F,cAAgB,GACvElL,OAASqQ,IACPjP,EAAAA,EAAAA,MAAA,QAAMlB,MAAO,CAAEsJ,WAAY,OAAQpP,MAAO,WAAY+F,SAAA,EACpD7F,EAAAA,EAAAA,KAACsV,EAAAA,EAAc,CAAC1P,MAAO,CAAEkP,YAAa,KAAO,SACrC,OAANiB,QAAM,IAANA,OAAM,EAANA,EAAQlO,eAAe,QAAS,CAAEC,sBAAuB,QAIjE,CACEvC,MAAO,cACP8G,UAAW,cACX7G,IAAK,cACLC,MAAO,IACPC,OAAQA,CAAC+c,EAAc3c,KACrB,MAAMT,EAAQS,EAAO8K,cAAgB,EAC/BoF,EAAa3Q,EAAQ,GAAMod,GAAQ,GAAKpd,EAAS,IAAM,EAE7D,OACErF,EAAAA,EAAAA,KAAC4H,EAAAA,EAAO,CAACrC,MAAK,GAAAyB,OAAKgP,EAAWlS,QAAQ,GAAE,UAAS+B,UAC/CiB,EAAAA,EAAAA,MAAA,OAAAjB,SAAA,EACEiB,EAAAA,EAAAA,MAAA,QAAMlB,MAAO,CAAE9F,MAAsB,MAAfkW,EAAqB,UAAY,WAAYnQ,SAAA,CAAC,UAC/D4c,GAAQ,GAAG5a,eAAe,QAAS,CAAEC,sBAAuB,OAEhEkO,EAAa,GAAKA,EAAa,MAC9BlP,EAAAA,EAAAA,MAAA,OAAKlB,MAAO,CAAEoD,SAAU,OAAQlJ,MAAO,QAAS+F,SAAA,CAAC,IAC7CmQ,EAAWlS,QAAQ,GAAG,eAQtC,CACEyB,MAAO,cACP8G,UAAW,qBACX7G,IAAK,qBACLC,MAAO,IACPC,OAASgd,IACP5b,EAAAA,EAAAA,MAAA,QAAMlB,MAAO,CAAE9F,MAAO4iB,EAAc,EAAI,UAAY,WAAY7c,SAAA,CAAC,UAC5D6c,GAAe,GAAG7a,eAAe,QAAS,CAAEC,sBAAuB,QAI5E,CACEvC,MAAO,iBACPC,IAAK,iBACLC,MAAO,IACPC,OAASI,IAAiB,IAAD4X,EAAAiF,EACvB,MAAMC,GAAyB,QAAZlF,EAAA5X,EAAOkF,aAAK,IAAA0S,OAAA,EAAZA,EAAcpV,SAAU,EACrCyD,GAA4B,QAAZ4W,EAAA7c,EAAOkF,aAAK,IAAA2X,OAAA,EAAZA,EAAcxf,QAAQI,GAC1CA,EAAKT,mBAAqBS,EAAKf,WAC/B8F,SAAU,EAEZ,OAAsB,IAAlByD,GACK/L,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,UAAS+F,SAAC,iBACnBkG,IAAkB6W,GACpB5iB,EAAAA,EAAAA,KAACsM,EAAAA,EAAG,CAACxM,MAAM,QAAQC,MAAMC,EAAAA,EAAAA,KAACM,EAAAA,EAAmB,IAAIuF,SAAC,cAGvDiB,EAAAA,EAAAA,MAACwF,EAAAA,EAAG,CAACxM,MAAM,SAASC,MAAMC,EAAAA,EAAAA,KAACI,EAAAA,EAAmB,IAAIyF,SAAA,CAC/CkG,EAAc,IAAE6W,OAM3B,CACErd,MAAO,aACP8G,UAAW,gBACX7G,IAAK,aACLC,MAAO,IACPC,OAASmd,IACP7iB,EAAAA,EAAAA,KAAC4H,EAAAA,EAAO,CAACrC,MAAW,OAAJsd,QAAI,IAAJA,OAAI,EAAJA,EAAMtR,MAAM1L,UAC1B7F,EAAAA,EAAAA,KAAA,QAAM4F,MAAO,CAAEoD,SAAU,QAASnD,UAC3B,OAAJgd,QAAI,IAAJA,OAAI,EAAJA,EAAMzI,WAAY,SAK3B,CACE7U,MAAO,UACPC,IAAK,UACLmY,MAAO,QACPlY,MAAO,IACPC,OAASI,IAEP,MAAMgd,GAAcC,EAAAA,EAAAA,IAAQC,EAAAA,GAAUC,gBAChCC,GAAgBC,EAAAA,EAAAA,IAAUH,EAAAA,GAAUC,gBACpCG,GAAgBC,EAAAA,EAAAA,IAAUL,EAAAA,GAAUC,gBAWpCK,GARkB,CAAC,QAAS,YAAYnf,SAAS2B,EAAOqO,QAC9CrO,EAAOqO,QAQrBrN,EAAAA,EAAAA,MAACyc,EAAAA,EAAI,CAAA1d,SAAA,CAEFid,IACC9iB,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAAC4d,EAAAA,EAAW,IAClB1U,QAASA,IAAM6Y,EAAQrB,OAAO5a,GAAQD,SACvC,gBAHK,QASPqd,IACCljB,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAACwjB,EAAAA,EAAc,IACrBta,QAASA,IAAM6Y,EAAQjB,SAAShb,GAChCF,MAAO,CAAE9F,MAAO,WAChBuB,SAA4B,UAAlByE,EAAOqO,OAAmBtO,SACrC,uBALK,UAWPqd,IACCljB,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAACyjB,EAAAA,EAAa,IACpBva,QAASA,IAAM6Y,EAAQd,UAAUnb,GACjCF,MAAO,CAAE9F,MAAO,WAChBuB,SAA4B,qBAAlByE,EAAOqO,OAA8BtO,SAChD,cALK,WAWPqd,IACCljB,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAACQ,EAAAA,EAAmB,IAC1B0I,QAASA,IAAM6Y,EAAQb,SAASpb,GAChC2C,QAAM,EACNpH,UAAW,CAAC,mBAAoB,YAAY8C,SAAS2B,EAAOqO,QAAQtO,SACrE,aALK,UAWPqd,IACCljB,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAACU,EAAAA,EAAY,IACnBwI,QAASA,IAAM6Y,EAAQT,OAAOxb,GAC9BzE,SAA4B,aAAlByE,EAAOqO,OAAsBtO,SACxC,kBAJK,QAUPqd,IACCljB,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAACa,EAAAA,EAAa,IACpBqI,QAASA,IAAM6Y,EAAQR,UAAUzb,GACjCF,MAAO,CAAE9F,MAAO,WAChBuB,UAAW,CAAC,OAAQ,YAAa,sBAAsB8C,SAAS2B,EAAOqO,QAAQtO,SAChF,iBALK,WAWPid,IACC9iB,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAAC0jB,EAAAA,EAAgB,IACvBxa,QAASA,IAAM6Y,EAAQL,QAAQ5b,GAAQD,SACxC,oBAHK,SASPqd,GAAiBpd,EAAO4P,mBAAqB,IAC5C5O,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAACujB,EAAAA,EAAK1U,QAAO,KACb7O,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAACiW,EAAAA,EAAkB,IACzB/M,QAASA,IAAM6Y,EAAQP,MAAM1b,GAC7BF,MAAO,CAAE9F,MAAO,WAChBuB,UAAW,CAAC,OAAQ,YAAa,qBAAsB,iBAAkB,UAAU8C,SAAS2B,EAAOqO,QAAQtO,SAC5G,kBALK,UAYTqd,IACCpc,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAACujB,EAAAA,EAAK1U,QAAO,KACb7O,EAAAA,EAAAA,KAACujB,EAAAA,EAAK9U,KAAI,CAER1O,MAAMC,EAAAA,EAAAA,KAACgB,EAAAA,EAAY,IACnBkI,QAASA,KAEWya,OAAO5C,QAAQ,gCAClBgB,EAAQ9U,SAASnH,IAElC2C,QAAM,EACNpH,SAAU,CAAC,YAAa,SAAU,kBAAkB8C,SAAS2B,EAAOqO,QAAQtO,SAC7E,aATK,iBAkBd,OAAKid,GAAgBI,GAAkBE,GAKrCpjB,EAAAA,EAAAA,KAAC0H,EAAAA,EAAK,CAACgB,KAAK,QAAO7C,UAuCfid,GAAeI,KACfljB,EAAAA,EAAAA,KAAC4jB,EAAAA,EAAQ,CAACC,QAASP,EAAeQ,QAAS,CAAC,SAAUC,UAAU,cAAale,UAC3E7F,EAAAA,EAAAA,KAAC4H,EAAAA,EAAO,CAACrC,MAAM,cAAaM,UAC1B7F,EAAAA,EAAAA,KAACuI,EAAAA,GAAM,CACLC,KAAK,UACLE,KAAK,QACL3I,MAAMC,EAAAA,EAAAA,KAACgkB,EAAAA,EAAY,IAAIne,SACxB,kBAlDF,SSvFXua,aACA6D,YAAa,EACbC,YAAa,KACbC,WAAYxC,GACZyC,UAAWA,KAAMA,EAAAA,EAAAA,IAAUpB,EAAAA,GAAUC,gBACrCoB,QAAUve,IACR,MAAMwe,GAAgBnB,EAAAA,EAAAA,IAAUH,EAAAA,GAAUC,gBACpCsB,EAAkB,CAAC,QAAS,YAAYpgB,SAAe,OAAN2B,QAAM,IAANA,OAAM,EAANA,EAAQqO,QAC/D,OAAOmQ,GAAiBC,GAE1BlB,UAAYvd,IACV,MAAMwe,GAAgBjB,EAAAA,EAAAA,IAAUL,EAAAA,GAAUC,gBACpCuB,EAA6B,WAAb,OAAN1e,QAAM,IAANA,OAAM,EAANA,EAAQqO,QACxB,OAAOmQ,GAAiBE,IT3ROzC,QS6R/B,CAACtB,GAAeL,GAAWuB,KAE/B,OACE7a,EAAAA,EAAAA,MAAAuJ,EAAAA,SAAA,CAAAxK,SAAA,EACE7F,EAAAA,EAAAA,KAACykB,EAAAA,EAAI,CACHC,UAAWnG,EACXnd,SAAUod,EACVhW,KAAK,OACLE,KAAK,QACLsC,MAAO,CACL,CACExF,IAAK,kBACLtF,OACE4G,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAC2kB,EAAAA,EAAgB,IAAG,sBAGxB9e,UAAU7F,EAAAA,EAAAA,KAAC4kB,EAAAA,EAAe,CAAC/C,OAAQA,MAErC,CACErc,IAAK,MACLtF,OACE4G,EAAAA,EAAAA,MAAA,QAAAjB,SAAA,EACE7F,EAAAA,EAAAA,KAAC0U,EAAAA,EAAgB,IAAG,UAGxB7O,UAAU7F,EAAAA,EAAAA,KAACwc,GAAU,SAK3Bxc,EAAAA,EAAAA,KAAC6kB,GAAc,CACb7a,KAAMyU,EACNxU,QAASA,KACPyU,GAAoB,GACpBQ,GAAc,OAEhBhV,cAAe+U,MAGjBjf,EAAAA,EAAAA,KAAC8kB,GAAe,CACd9a,KAAM2U,EACN1U,QAASA,KACP2U,GAAqB,GACrBM,GAAc,OAEhBhV,cAAe+U,MAGjBjf,EAAAA,EAAAA,KAAC+kB,GAAW,CACV/a,KAAM6U,EACN5U,QAASA,KACP6U,GAAiB,GACjBI,GAAc,OAEhBhV,cAAe+U,MAGjBjf,EAAAA,EAAAA,KAACglB,GAAW,CACVhb,KAAM+S,EACN9S,QAASA,KACP+S,GAAiB,GACjBkC,GAAc,OAEhBhV,cAAe+U,MAGjBjf,EAAAA,EAAAA,KAACilB,GAAc,CACbjb,KAAM+U,EACN9U,QAASA,KACP+U,GAAoB,GACpBE,GAAc,OAEhBhV,cAAe+U,GACf9G,UAAWA,KAGT6G,GAAoB,iFCja9B,SAASkG,IAAiS,OAApRA,EAAW7gB,OAAOC,OAASD,OAAOC,OAAO6gB,OAAS,SAAUhe,GAAU,IAAK,IAAI9D,EAAI,EAAGA,EAAI6c,UAAU5X,OAAQjF,IAAK,CAAE,IAAI+hB,EAASlF,UAAU7c,GAAI,IAAK,IAAImC,KAAO4f,EAAc/gB,OAAOghB,UAAUC,eAAeC,KAAKH,EAAQ5f,KAAQ2B,EAAO3B,GAAO4f,EAAO5f,GAAU,CAAE,OAAO2B,CAAQ,EAAU+d,EAASM,MAAMC,KAAMvF,UAAY,CAOlV,MAAMuD,EAAgBA,CAACiC,EAAOC,IAAqBC,EAAAA,cAAoBC,EAAAA,EAAUX,EAAS,CAAC,EAAGQ,EAAO,CACnGC,IAAKA,EACL5lB,KAAM+lB,EAAAA,KAQR,QAJ6BF,EAAAA,WAAiBnC,oDCX9C,QADqB,CAAE,KAAQ,CAAE,IAAO,MAAO,MAAS,CAAE,QAAW,gBAAiB,UAAa,SAAW,SAAY,CAAC,CAAE,IAAO,OAAQ,MAAS,CAAE,EAAK,gTAAoT,KAAQ,SAAU,MAAS,2BCD3e,SAASyB,IAAiS,OAApRA,EAAW7gB,OAAOC,OAASD,OAAOC,OAAO6gB,OAAS,SAAUhe,GAAU,IAAK,IAAI9D,EAAI,EAAGA,EAAI6c,UAAU5X,OAAQjF,IAAK,CAAE,IAAI+hB,EAASlF,UAAU7c,GAAI,IAAK,IAAImC,KAAO4f,EAAc/gB,OAAOghB,UAAUC,eAAeC,KAAKH,EAAQ5f,KAAQ2B,EAAO3B,GAAO4f,EAAO5f,GAAU,CAAE,OAAO2B,CAAQ,EAAU+d,EAASM,MAAMC,KAAMvF,UAAY,CAOlV,MAAMsD,EAAiBA,CAACkC,EAAOC,IAAqBC,EAAAA,cAAoBC,EAAAA,EAAUX,EAAS,CAAC,EAAGQ,EAAO,CACpGC,IAAKA,EACL5lB,KAAMgmB,KAQR,QAJ6BH,EAAAA,WAAiBpC","sources":["pages/PurchaseOrders/columns.tsx","pages/PurchaseOrders/POLineItemsTable.tsx","pages/PurchaseOrders/POReceiveModal.tsx","pages/PurchaseOrders/POApprovalModal.tsx","pages/PurchaseOrders/POSendModal.tsx","pages/PurchaseOrders/POViewModal.tsx","pages/PurchaseOrders/POPaymentModal.tsx","pages/PurchaseOrders/GRNViewModal.tsx","pages/PurchaseOrders/GRNListTab.tsx","pages/PurchaseOrders/PurchaseOrderCrud.tsx","../node_modules/@ant-design/icons/es/icons/CheckOutlined.js","../node_modules/@ant-design/icons-svg/es/asn/UploadOutlined.js","../node_modules/@ant-design/icons/es/icons/UploadOutlined.js"],"sourcesContent":["import React from 'react';\r\nimport { Tag, Tooltip, Button, Space, Badge, Popconfirm, Dropdown, Menu } from 'antd';\r\nimport dayjs from 'dayjs';\r\nimport {\r\n  FileTextOutlined,\r\n  UserOutlined,\r\n  CalendarOutlined,\r\n  DollarOutlined,\r\n  CheckCircleOutlined,\r\n  ClockCircleOutlined,\r\n  CloseCircleOutlined,\r\n  SendOutlined,\r\n  EyeOutlined,\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  DownloadOutlined,\r\n  CheckOutlined,\r\n  StopOutlined,\r\n  InboxOutlined,\r\n  WarningOutlined,\r\n  MoreOutlined,\r\n  UploadOutlined,\r\n  CreditCardOutlined,\r\n} from '@ant-design/icons';\r\nimport { POStatus } from '../../types/purchaseOrder';\r\nimport { canRead, canUpdate, canDelete, RESOURCES } from '../../helpers/permissionHelper';\r\n\r\n// Status Configuration\r\nconst statusConfig: Record<POStatus, { color: string; icon: React.ReactNode; label: string }> = {\r\n  draft: { color: 'default', icon: <EditOutlined />, label: 'Draft' },\r\n  pending_approval: { color: 'warning', icon: <ClockCircleOutlined />, label: 'Pending Approval' },\r\n  approved: { color: 'success', icon: <CheckCircleOutlined />, label: 'Approved' },\r\n  rejected: { color: 'error', icon: <CloseCircleOutlined />, label: 'Rejected' },\r\n  sent: { color: 'processing', icon: <SendOutlined />, label: 'Sent' },\r\n  confirmed: { color: 'cyan', icon: <CheckCircleOutlined />, label: 'Confirmed' },\r\n  partially_received: { color: 'purple', icon: <InboxOutlined />, label: 'Partially Received' },\r\n  fully_received: { color: 'green', icon: <CheckCircleOutlined />, label: 'Fully Received' },\r\n  cancelled: { color: 'red', icon: <StopOutlined />, label: 'Cancelled' },\r\n  closed: { color: 'default', icon: <CheckCircleOutlined />, label: 'Closed' },\r\n};\r\n\r\ninterface ColumnActions {\r\n  onView: (record: any) => void;\r\n  onEdit: (record: any) => void;\r\n  onDelete: (record: any) => void;\r\n  onSubmit: (record: any) => void;\r\n  onApprove: (record: any) => void;\r\n  onReject: (record: any) => void;\r\n  onSend: (record: any) => void;\r\n  onReceive: (record: any) => void;\r\n  onPay: (record: any) => void;\r\n  onCancel: (record: any) => void;\r\n  onPrint: (record: any) => void;\r\n}\r\n\r\nexport const purchaseOrderColumns = (actions: ColumnActions) => [\r\n  {\r\n    title: 'PO Number',\r\n    dataIndex: 'po_number',\r\n    key: 'po_number',\r\n    fixed: 'left' as const,\r\n    width: 140,\r\n    render: (text: string, record: any) => (\r\n      <div>\r\n        <Tag icon={<FileTextOutlined />} color=\"blue\" style={{ fontSize: '12px' }}>\r\n          {text}\r\n        </Tag>\r\n        {record.is_urgent && (\r\n          <Tag color=\"red\" style={{ marginTop: 4 }}>\r\n            URGENT\r\n          </Tag>\r\n        )}\r\n      </div>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Status',\r\n    dataIndex: 'status',\r\n    key: 'status',\r\n    width: 160,\r\n    filters: Object.keys(statusConfig).map(key => ({\r\n      text: statusConfig[key as POStatus].label,\r\n      value: key,\r\n    })),\r\n    onFilter: (value: any, record: any) => record.status === value,\r\n    render: (status: POStatus, record: any) => {\r\n      const config = statusConfig[status] || statusConfig.draft;\r\n      const isOverdue = record.expected_delivery_date && \r\n        dayjs(record.expected_delivery_date).isBefore(dayjs()) &&\r\n        !['fully_received', 'cancelled', 'closed'].includes(status);\r\n      \r\n      return (\r\n        <div>\r\n          <Badge \r\n            status={config.color as any} \r\n            text={\r\n              <Tag color={config.color} icon={config.icon}>\r\n                {config.label}\r\n              </Tag>\r\n            }\r\n          />\r\n          {isOverdue && (\r\n            <Tag color=\"red\" icon={<WarningOutlined />} style={{ marginTop: 4 }}>\r\n              OVERDUE\r\n            </Tag>\r\n          )}\r\n        </div>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'Vendor',\r\n    dataIndex: 'VendorItem',\r\n    key: 'vendor',\r\n    width: 180,\r\n    render: (vendor: any, record: any) => {\r\n      const vendorData = vendor || { vendor_name: record.vendor_name, company_name: '' };\r\n      return (\r\n        <Tooltip title={vendorData.company_name || 'No company name'}>\r\n          <div>\r\n            <UserOutlined style={{ marginRight: 4, color: '#1890ff' }} />\r\n            <strong>{vendorData.vendor_name || '-'}</strong>\r\n            {vendorData.company_name && (\r\n              <div style={{ fontSize: '11px', color: '#888' }}>\r\n                {vendorData.company_name}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Tooltip>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'PO Date',\r\n    dataIndex: 'po_date',\r\n    key: 'po_date',\r\n    width: 120,\r\n    sorter: (a: any, b: any) => dayjs(a.po_date).unix() - dayjs(b.po_date).unix(),\r\n    render: (date: string) => (\r\n      <span>\r\n        <CalendarOutlined style={{ marginRight: 4 }} />\r\n        {dayjs(date).format('DD/MM/YYYY')}\r\n      </span>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Expected Delivery',\r\n    dataIndex: 'expected_delivery_date',\r\n    key: 'expected_delivery_date',\r\n    width: 140,\r\n    sorter: (a: any, b: any) => \r\n      dayjs(a.expected_delivery_date || 0).unix() - dayjs(b.expected_delivery_date || 0).unix(),\r\n    render: (date: string, record: any) => {\r\n      if (!date) return <span style={{ color: '#999' }}>-</span>;\r\n      \r\n      const isOverdue = dayjs(date).isBefore(dayjs()) &&\r\n        !['fully_received', 'cancelled', 'closed'].includes(record.status);\r\n      const daysLeft = dayjs(date).diff(dayjs(), 'days');\r\n      \r\n      return (\r\n        <Tooltip title={isOverdue ? 'Overdue!' : `${daysLeft} days left`}>\r\n          <span style={{ color: isOverdue ? '#ff4d4f' : daysLeft <= 3 ? '#faad14' : 'inherit' }}>\r\n            <CalendarOutlined style={{ marginRight: 4 }} />\r\n            {dayjs(date).format('DD/MM/YYYY')}\r\n          </span>\r\n        </Tooltip>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'Items',\r\n    dataIndex: 'items',\r\n    key: 'items_count',\r\n    width: 80,\r\n    align: 'center' as const,\r\n    render: (items: any[]) => (\r\n      <Tag color=\"geekblue\">{items?.length || 0} items</Tag>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Total Amount',\r\n    dataIndex: 'total_amount',\r\n    key: 'total_amount',\r\n    width: 130,\r\n    sorter: (a: any, b: any) => (a.total_amount || 0) - (b.total_amount || 0),\r\n    render: (amount: number) => (\r\n      <span style={{ fontWeight: 'bold', color: '#52c41a' }}>\r\n        <DollarOutlined style={{ marginRight: 4 }} />\r\n        {amount?.toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n      </span>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Paid Amount',\r\n    dataIndex: 'paid_amount',\r\n    key: 'paid_amount',\r\n    width: 130,\r\n    render: (paid: number, record: any) => {\r\n      const total = record.total_amount || 0;\r\n      const percentage = total > 0 ? ((paid || 0) / total) * 100 : 0;\r\n      \r\n      return (\r\n        <Tooltip title={`${percentage.toFixed(0)}% paid`}>\r\n          <div>\r\n            <span style={{ color: percentage === 100 ? '#52c41a' : '#faad14' }}>\r\n              {(paid || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n            </span>\r\n            {percentage > 0 && percentage < 100 && (\r\n              <div style={{ fontSize: '11px', color: '#888' }}>\r\n                ({percentage.toFixed(0)}%)\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Tooltip>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'Outstanding',\r\n    dataIndex: 'outstanding_amount',\r\n    key: 'outstanding_amount',\r\n    width: 130,\r\n    render: (outstanding: number) => (\r\n      <span style={{ color: outstanding > 0 ? '#ff4d4f' : '#52c41a' }}>\r\n        {(outstanding || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n      </span>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Receipt Status',\r\n    key: 'receipt_status',\r\n    width: 140,\r\n    render: (record: any) => {\r\n      const totalItems = record.items?.length || 0;\r\n      const receivedItems = record.items?.filter((item: any) => \r\n        item.received_quantity >= item.quantity\r\n      ).length || 0;\r\n      \r\n      if (receivedItems === 0) {\r\n        return <Tag color=\"default\">Not Received</Tag>;\r\n      } else if (receivedItems === totalItems) {\r\n        return <Tag color=\"green\" icon={<CheckCircleOutlined />}>Complete</Tag>;\r\n      } else {\r\n        return (\r\n          <Tag color=\"orange\" icon={<ClockCircleOutlined />}>\r\n            {receivedItems}/{totalItems}\r\n          </Tag>\r\n        );\r\n      }\r\n    },\r\n  },\r\n  {\r\n    title: 'Created By',\r\n    dataIndex: 'CreatedByUser',\r\n    key: 'created_by',\r\n    width: 130,\r\n    render: (user: any) => (\r\n      <Tooltip title={user?.email}>\r\n        <span style={{ fontSize: '12px' }}>\r\n          {user?.username || '-'}\r\n        </span>\r\n      </Tooltip>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Actions',\r\n    key: 'actions',\r\n    fixed: 'right' as const,\r\n    width: 120,\r\n    render: (record: any) => {\r\n      // Permission checks\r\n      const hasReadPerm = canRead(RESOURCES.PURCHASE_ORDER);\r\n      const hasUpdatePerm = canUpdate(RESOURCES.PURCHASE_ORDER);\r\n      const hasDeletePerm = canDelete(RESOURCES.PURCHASE_ORDER);\r\n      \r\n      // Status-based checks\r\n      const canEditByStatus = ['draft', 'rejected'].includes(record.status);\r\n      const isDraft = record.status === 'draft';\r\n      \r\n      // Combined permission + status checks\r\n      const canEdit = hasUpdatePerm && canEditByStatus;\r\n      const canDeleteRecord = hasDeletePerm && isDraft;\r\n      \r\n      // P/O Actions dropdown menu - Show actions based on permissions\r\n      const poActionsMenu = (\r\n        <Menu>\r\n          {/* View - requires read permission */}\r\n          {hasReadPerm && (\r\n            <Menu.Item \r\n              key=\"view\" \r\n              icon={<EyeOutlined />}\r\n              onClick={() => actions.onView(record)}\r\n            >\r\n              View Details\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Submit - requires update permission */}\r\n          {hasUpdatePerm && (\r\n            <Menu.Item \r\n              key=\"submit\" \r\n              icon={<UploadOutlined />}\r\n              onClick={() => actions.onSubmit(record)}\r\n              style={{ color: '#1890ff' }}\r\n              disabled={record.status !== 'draft'}\r\n            >\r\n              Submit for Approval\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Approve - requires update permission */}\r\n          {hasUpdatePerm && (\r\n            <Menu.Item \r\n              key=\"approve\" \r\n              icon={<CheckOutlined />}\r\n              onClick={() => actions.onApprove(record)}\r\n              style={{ color: '#52c41a' }}\r\n              disabled={record.status !== 'pending_approval'}\r\n            >\r\n              Approve PO\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Reject - requires update permission */}\r\n          {hasUpdatePerm && (\r\n            <Menu.Item \r\n              key=\"reject\" \r\n              icon={<CloseCircleOutlined />}\r\n              onClick={() => actions.onReject(record)}\r\n              danger\r\n              disabled={!['pending_approval', 'approved'].includes(record.status)}\r\n            >\r\n              Reject PO\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Send - requires update permission */}\r\n          {hasUpdatePerm && (\r\n            <Menu.Item \r\n              key=\"send\" \r\n              icon={<SendOutlined />}\r\n              onClick={() => actions.onSend(record)}\r\n              disabled={record.status !== 'approved'}\r\n            >\r\n              Send to Vendor\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Receive - requires update permission */}\r\n          {hasUpdatePerm && (\r\n            <Menu.Item \r\n              key=\"receive\" \r\n              icon={<InboxOutlined />}\r\n              onClick={() => actions.onReceive(record)}\r\n              style={{ color: '#1890ff' }}\r\n              disabled={!['sent', 'confirmed', 'partially_received'].includes(record.status)}\r\n            >\r\n              Receive Goods\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Print - requires read permission */}\r\n          {hasReadPerm && (\r\n            <Menu.Item \r\n              key=\"print\" \r\n              icon={<DownloadOutlined />}\r\n              onClick={() => actions.onPrint(record)}\r\n            >\r\n              Print / Download\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Pay - requires update permission, only show if there's outstanding amount */}\r\n          {hasUpdatePerm && record.outstanding_amount > 0 && (\r\n            <>\r\n              <Menu.Divider />\r\n              <Menu.Item \r\n                key=\"pay\" \r\n                icon={<CreditCardOutlined />}\r\n                onClick={() => actions.onPay(record)}\r\n                style={{ color: '#52c41a' }}\r\n                disabled={!['sent', 'confirmed', 'partially_received', 'fully_received', 'closed'].includes(record.status)}\r\n              >\r\n                Record Payment\r\n              </Menu.Item>\r\n            </>\r\n          )}\r\n          \r\n          {/* Cancel - requires update permission */}\r\n          {hasUpdatePerm && (\r\n            <>\r\n              <Menu.Divider />\r\n              <Menu.Item \r\n                key=\"cancel\" \r\n                icon={<StopOutlined />}\r\n                onClick={() => {\r\n                  // Show confirmation\r\n                  const confirmed = window.confirm('Cancel this Purchase Order?');\r\n                  if (confirmed) actions.onCancel(record);\r\n                }}\r\n                danger\r\n                disabled={['cancelled', 'closed', 'fully_received'].includes(record.status)}\r\n              >\r\n                Cancel PO\r\n              </Menu.Item>\r\n            </>\r\n          )}\r\n        </Menu>\r\n      );\r\n      \r\n      // Don't show actions column if user has no permissions at all\r\n      if (!hasReadPerm && !hasUpdatePerm && !hasDeletePerm) {\r\n        return null;\r\n      }\r\n      \r\n      return (\r\n        <Space size=\"small\">\r\n          {/* Default Actions - Based on permissions */}\r\n          \r\n          {/* Edit - requires update permission */}\r\n          {/* {hasUpdatePerm && (\r\n            <Tooltip title={canEdit ? \"Edit\" : hasUpdatePerm ? \"Edit (not available for this status)\" : \"No update permission\"}>\r\n              <Button\r\n                type=\"link\"\r\n                size=\"small\"\r\n                icon={<EditOutlined />}\r\n                onClick={() => actions.onEdit(record)}\r\n                disabled={!canEdit}\r\n              />\r\n            </Tooltip>\r\n          )}\r\n           */}\r\n          {/* Delete - requires delete permission */}\r\n          {/* {hasDeletePerm && (\r\n            <Popconfirm\r\n              title=\"Delete this Purchase Order?\"\r\n              description=\"This action cannot be undone.\"\r\n              onConfirm={() => actions.onDelete(record)}\r\n              okText=\"Yes\"\r\n              cancelText=\"No\"\r\n              disabled={!canDeleteRecord}\r\n            >\r\n              <Tooltip title={canDeleteRecord ? \"Delete\" : hasDeletePerm ? \"Delete (only Draft can be deleted)\" : \"No delete permission\"}>\r\n                <Button\r\n                  type=\"link\"\r\n                  size=\"small\"\r\n                  danger\r\n                  icon={<DeleteOutlined />}\r\n                  disabled={!canDeleteRecord}\r\n                />\r\n              </Tooltip>\r\n            </Popconfirm>\r\n          )} */}\r\n          \r\n          {/* P/O Actions Dropdown - only show if user has read or update permission */}\r\n          {(hasReadPerm || hasUpdatePerm) && (\r\n            <Dropdown overlay={poActionsMenu} trigger={['click']} placement=\"bottomRight\">\r\n              <Tooltip title=\"P/O Actions\">\r\n                <Button\r\n                  type=\"primary\"\r\n                  size=\"small\"\r\n                  icon={<MoreOutlined />}\r\n                >\r\n                 Actions\r\n                 </Button>\r\n              </Tooltip>\r\n            </Dropdown>\r\n          )}\r\n        </Space>\r\n      );\r\n    },\r\n  },\r\n];\r\n\r\n","import React, { useCallback, useMemo } from 'react';\r\nimport {\r\n  Table,\r\n  Button,\r\n  InputNumber,\r\n  Select,\r\n  DatePicker,\r\n  Input,\r\n  Popconfirm,\r\n  Space,\r\n  Tag,\r\n  Tooltip,\r\n  message,\r\n} from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  DeleteOutlined,\r\n  CalculatorOutlined,\r\n} from '@ant-design/icons';\r\nimport { POLineItem } from '../../types/purchaseOrder';\r\nimport { apiSlice } from '../../services/redux/api/apiSlice';\r\nimport dayjs from 'dayjs';\r\n\r\ninterface POLineItemsTableProps {\r\n  value?: POLineItem[];\r\n  onChange?: (items: POLineItem[]) => void;\r\n  disabled?: boolean;\r\n}\r\n\r\nconst POLineItemsTable: React.FC<POLineItemsTableProps> = ({\r\n  value = [],\r\n  onChange,\r\n  disabled = false,\r\n}) => {\r\n  // Memoized query params\r\n  const queryParams = useMemo(() => ({ pageNumber: 1, pageLimit: 100 }), []);\r\n  const { data: productsData, isLoading: productsLoading } = apiSlice.useGetProductQuery(queryParams);\r\n  \r\n  const products = useMemo(() => (productsData as any)?.result || [], [productsData]);\r\n\r\n  // Add new line item\r\n  const handleAddItem = useCallback(() => {\r\n    const newItem: Partial<POLineItem> = {\r\n      product_id: '',\r\n      product_name: '',\r\n      variant_name: '',\r\n      description: '',\r\n      quantity: 1,\r\n      unit_price: 0, // Will be filled at receipt time\r\n      tax_percentage: 0, // Will be filled at receipt time\r\n      discount: 0,\r\n      discount_type: 'percentage',\r\n      line_total: 0,\r\n      received_quantity: 0,\r\n      pending_quantity: 1,\r\n    };\r\n    \r\n    onChange?.([...value, newItem as POLineItem]);\r\n  }, [value, onChange]);\r\n\r\n  // Delete line item\r\n  const handleDeleteItem = useCallback((index: number) => {\r\n    const newItems = value.filter((_, i) => i !== index);\r\n    onChange?.(newItems);\r\n  }, [value, onChange]);\r\n\r\n  // Calculate line total\r\n  const calculateLineTotal = useCallback((item: Partial<POLineItem>) => {\r\n    const qty = Number(item.quantity) || 0;\r\n    const price = Number(item.unit_price) || 0;\r\n    const taxPct = Number(item.tax_percentage) || 0;\r\n    const discountVal = Number(item.discount) || 0;\r\n    const discountType = item.discount_type || 'percentage';\r\n\r\n    let subtotal = qty * price;\r\n    \r\n    // Apply discount\r\n    if (discountType === 'percentage') {\r\n      subtotal = subtotal - (subtotal * discountVal / 100);\r\n    } else {\r\n      subtotal = subtotal - discountVal;\r\n    }\r\n    \r\n    // Add tax\r\n    const taxAmount = subtotal * (taxPct / 100);\r\n    const total = subtotal + taxAmount;\r\n    \r\n    return {\r\n      line_total: Number(total.toFixed(2)),\r\n      pending_quantity: qty - (item.received_quantity || 0),\r\n    };\r\n  }, []);\r\n\r\n  // Update line item field\r\n  const handleFieldChange = useCallback((index: number, field: string, fieldValue: any) => {\r\n    const newItems = [...value];\r\n    const item = { ...newItems[index], [field]: fieldValue };\r\n    \r\n    // Recalculate totals if quantity, price, tax, or discount changes\r\n    if (['quantity', 'unit_price', 'tax_percentage', 'discount', 'discount_type'].includes(field)) {\r\n      const calculated = calculateLineTotal(item);\r\n      Object.assign(item, calculated);\r\n    }\r\n    \r\n    newItems[index] = item;\r\n    onChange?.(newItems);\r\n  }, [value, onChange, calculateLineTotal]);\r\n\r\n  // Handle product selection\r\n  const handleProductSelect = useCallback((index: number, productId: string) => {\r\n    const product = products.find((p: any) => p._id === productId);\r\n    if (!product) return;\r\n\r\n    const newItems = [...value];\r\n    const item = {\r\n      ...newItems[index],\r\n      product_id: productId,\r\n      product_name: product.name,\r\n      variant_name: product.VariantItem?.variant_name || '',\r\n      description: product.description || '',\r\n      // Price and tax will be filled at receipt time by vendor\r\n      tax_percentage: 0,\r\n      unit_price: 0,\r\n    };\r\n    \r\n    const calculated = calculateLineTotal(item);\r\n    newItems[index] = { ...item, ...calculated };\r\n    onChange?.(newItems);\r\n  }, [value, onChange, products, calculateLineTotal]);\r\n\r\n  // Calculate totals\r\n  const totals = useMemo(() => {\r\n    const subtotal = value.reduce((sum, item) => {\r\n      const qty = Number(item.quantity) || 0;\r\n      const price = Number(item.unit_price) || 0;\r\n      const discountVal = Number(item.discount) || 0;\r\n      const discountType = item.discount_type || 'percentage';\r\n      \r\n      let itemSubtotal = qty * price;\r\n      if (discountType === 'percentage') {\r\n        itemSubtotal = itemSubtotal - (itemSubtotal * discountVal / 100);\r\n      } else {\r\n        itemSubtotal = itemSubtotal - discountVal;\r\n      }\r\n      \r\n      return sum + itemSubtotal;\r\n    }, 0);\r\n\r\n    const taxAmount = value.reduce((sum, item) => {\r\n      const qty = Number(item.quantity) || 0;\r\n      const price = Number(item.unit_price) || 0;\r\n      const taxPct = Number(item.tax_percentage) || 0;\r\n      const discountVal = Number(item.discount) || 0;\r\n      const discountType = item.discount_type || 'percentage';\r\n      \r\n      let itemSubtotal = qty * price;\r\n      if (discountType === 'percentage') {\r\n        itemSubtotal = itemSubtotal - (itemSubtotal * discountVal / 100);\r\n      } else {\r\n        itemSubtotal = itemSubtotal - discountVal;\r\n      }\r\n      \r\n      return sum + (itemSubtotal * taxPct / 100);\r\n    }, 0);\r\n\r\n    const total = subtotal + taxAmount;\r\n    \r\n    return {\r\n      subtotal: Number(subtotal.toFixed(2)),\r\n      taxAmount: Number(taxAmount.toFixed(2)),\r\n      total: Number(total.toFixed(2)),\r\n    };\r\n  }, [value]);\r\n\r\n  // Table columns\r\n  const columns = [\r\n    {\r\n      title: '#',\r\n      key: 'index',\r\n      width: 40,\r\n      render: (_: any, __: any, index: number) => index + 1,\r\n    },\r\n    {\r\n      title: <span style={{ color: 'red' }}>* Product</span>,\r\n      key: 'product',\r\n      width: 200,\r\n      render: (_: any, record: POLineItem, index: number) => (\r\n        <Select\r\n          showSearch\r\n          allowClear\r\n          placeholder=\"Select product\"\r\n          style={{ width: '100%' }}\r\n          value={record.product_id || undefined}\r\n          onChange={(val) => handleProductSelect(index, val)}\r\n          disabled={disabled}\r\n          loading={productsLoading}\r\n          filterOption={(input, option) => {\r\n            const label = String(option?.children || '');\r\n            return label.toLowerCase().includes(input.toLowerCase());\r\n          }}\r\n          notFoundContent={productsLoading ? 'Loading products...' : 'No products found'}\r\n        >\r\n          {products.map((product: any) => (\r\n            <Select.Option key={product._id} value={product._id}>\r\n              {product.name} {product.VariantItem?.variant_name ? `- ${product.VariantItem.variant_name}` : ''}\r\n            </Select.Option>\r\n          ))}\r\n        </Select>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Description',\r\n      key: 'description',\r\n      width: 150,\r\n      render: (_: any, record: POLineItem, index: number) => (\r\n        <Input\r\n          placeholder=\"Description\"\r\n          value={record.description}\r\n          onChange={(e) => handleFieldChange(index, 'description', e.target.value)}\r\n          disabled={disabled}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: <span style={{ color: 'red' }}>* Quantity</span>,\r\n      key: 'quantity',\r\n      width: 100,\r\n      render: (_: any, record: POLineItem, index: number) => (\r\n        <InputNumber\r\n          min={1}\r\n          precision={0}\r\n          placeholder=\"Qty\"\r\n          style={{ width: '100%' }}\r\n          value={record.quantity}\r\n          onChange={(val) => handleFieldChange(index, 'quantity', val)}\r\n          disabled={disabled}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Unit Price',\r\n      key: 'unit_price',\r\n      width: 110,\r\n      render: (_: any, record: POLineItem, index: number) => (\r\n        <InputNumber\r\n          min={0}\r\n          precision={2}\r\n          placeholder=\"Enter at receipt\"\r\n          prefix=\"\"\r\n          style={{ width: '100%' }}\r\n          value={record.unit_price}\r\n          onChange={(val) => handleFieldChange(index, 'unit_price', val)}\r\n          disabled={true}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Tax %',\r\n      key: 'tax_percentage',\r\n      width: 80,\r\n      render: (_: any, record: POLineItem, index: number) => (\r\n        <InputNumber\r\n          min={0}\r\n          max={100}\r\n          precision={2}\r\n          placeholder=\"Enter at receipt\"\r\n          suffix=\"%\"\r\n          style={{ width: '100%' }}\r\n          value={record.tax_percentage}\r\n          onChange={(val) => handleFieldChange(index, 'tax_percentage', val)}\r\n          disabled={true}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Discount',\r\n      key: 'discount',\r\n      width: 130,\r\n      render: (_: any, record: POLineItem, index: number) => (\r\n        <Space.Compact style={{ width: '100%' }}>\r\n          <InputNumber\r\n            min={0}\r\n            precision={2}\r\n            placeholder=\"Enter at receipt\"\r\n            style={{ width: '70%' }}\r\n            value={record.discount}\r\n            onChange={(val) => handleFieldChange(index, 'discount', val)}\r\n            disabled={true}\r\n          />\r\n          <Select\r\n            style={{ width: '30%' }}\r\n            value={record.discount_type}\r\n            onChange={(val) => handleFieldChange(index, 'discount_type', val)}\r\n            disabled={true}\r\n          >\r\n            <Select.Option value=\"percentage\">%</Select.Option>\r\n            <Select.Option value=\"amount\"></Select.Option>\r\n          </Select>\r\n        </Space.Compact>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Line Total',\r\n      key: 'line_total',\r\n      width: 110,\r\n      render: (_: any, record: POLineItem) => (\r\n        <Tooltip title={record.unit_price > 0 ? `Qty: ${record.quantity}  ${record.unit_price}` : 'Price will be set at receipt'}>\r\n          <strong style={{ color: record.unit_price > 0 ? '#52c41a' : '#999' }}>\r\n            {record.unit_price > 0 \r\n              ? `${(record.line_total || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}`\r\n              : 'TBD'}\r\n          </strong>\r\n        </Tooltip>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Expected Date',\r\n      key: 'expected_delivery_date',\r\n      width: 120,\r\n      render: (_: any, record: POLineItem, index: number) => (\r\n        <DatePicker\r\n          format=\"YYYY-MM-DD\"\r\n          style={{ width: '100%' }}\r\n          value={record.expected_delivery_date ? dayjs(record.expected_delivery_date) : undefined}\r\n          onChange={(date) => handleFieldChange(index, 'expected_delivery_date', date?.format('YYYY-MM-DD'))}\r\n          disabled={disabled}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Actions',\r\n      key: 'actions',\r\n      width: 70,\r\n      render: (_: any, record: POLineItem, index: number) => (\r\n        <Popconfirm\r\n          title=\"Delete this line item?\"\r\n          onConfirm={() => handleDeleteItem(index)}\r\n          disabled={disabled || value.length === 1}\r\n        >\r\n          <Button\r\n            type=\"link\"\r\n            danger\r\n            size=\"small\"\r\n            icon={<DeleteOutlined />}\r\n            disabled={disabled || value.length === 1}\r\n          />\r\n        </Popconfirm>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div style={{ width: '100%' }}>\r\n      <div style={{ marginBottom: 12, display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n        <strong style={{ fontSize: '14px' }}>Line Items</strong>\r\n        <Button\r\n          type=\"dashed\"\r\n          icon={<PlusOutlined />}\r\n          onClick={handleAddItem}\r\n          disabled={disabled}\r\n        >\r\n          Add Item\r\n        </Button>\r\n      </div>\r\n      \r\n      <Table\r\n        columns={columns}\r\n        dataSource={value}\r\n        pagination={false}\r\n        size=\"small\"\r\n        scroll={{ x: 'max-content' }}\r\n        rowKey={(record, index) => `item-${index}`}\r\n        bordered\r\n        footer={() => (\r\n          <div style={{ textAlign: 'right' }}>\r\n            <Space direction=\"vertical\" size=\"small\" style={{ width: '100%' }}>\r\n              <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '20px' }}>\r\n                <span>Subtotal:</span>\r\n                <strong>{totals.subtotal.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\r\n              </div>\r\n              <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '20px' }}>\r\n                <span>Tax Amount:</span>\r\n                <strong>{totals.taxAmount.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\r\n              </div>\r\n              <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '20px', fontSize: '16px', color: '#52c41a' }}>\r\n                <span><CalculatorOutlined /> Total:</span>\r\n                <strong>{totals.total.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\r\n              </div>\r\n            </Space>\r\n          </div>\r\n        )}\r\n      />\r\n      \r\n      {value.length === 0 && (\r\n        <div style={{ textAlign: 'center', padding: '40px', color: '#999' }}>\r\n          No items added. Click \"Add Item\" to get started.\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default POLineItemsTable;\r\n\r\n","import React, { useState, useEffect, useCallback, useMemo } from 'react';\r\nimport {\r\n  Modal,\r\n  Form,\r\n  Input,\r\n  DatePicker,\r\n  Table,\r\n  InputNumber,\r\n  message,\r\n  Space,\r\n  Tag,\r\n  Button,\r\n  Alert,\r\n  Checkbox,\r\n  Divider,\r\n  Statistic,\r\n  Row,\r\n  Col,\r\n  Select,\r\n} from 'antd';\r\nimport {\r\n  InboxOutlined,\r\n  CheckCircleOutlined,\r\n  WarningOutlined,\r\n  CalendarOutlined,\r\n} from '@ant-design/icons';\r\nimport { useConvertPOToGRNMutation } from '../../services/redux/api/endpoints';\r\nimport dayjs from 'dayjs';\r\n\r\ninterface POReceiveModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  purchaseOrder: any;\r\n}\r\n\r\nconst POReceiveModal: React.FC<POReceiveModalProps> = ({\r\n  open,\r\n  onClose,\r\n  purchaseOrder,\r\n}) => {\r\n  const [form] = Form.useForm();\r\n  const [lineItems, setLineItems] = useState<any[]>([]);\r\n  const [createStockEntries, setCreateStockEntries] = useState(true);\r\n  const [shippingCost, setShippingCost] = useState<number>(0);\r\n  \r\n  const [convertToGRN, { isLoading }] = useConvertPOToGRNMutation();\r\n  \r\n  // Initialize line items when PO changes\r\n  useEffect(() => {\r\n    if (purchaseOrder?.items) {\r\n      const items = purchaseOrder.items.map((item: any) => ({\r\n        ...item,\r\n        po_line_item_id: item._id,\r\n        ordered_quantity: item.quantity,\r\n        received_quantity: item.pending_quantity || (item.quantity - (item.received_quantity || 0)),\r\n        rejected_quantity: 0,\r\n        accepted_quantity: item.pending_quantity || (item.quantity - (item.received_quantity || 0)),\r\n        batch_no: '',\r\n        mfg_date: undefined,\r\n        expiry_date: undefined,\r\n        notes: '',\r\n        // Price, tax, and discount - use existing if available, otherwise 0 (to be filled)\r\n        unit_price: item.unit_price || 0,\r\n        tax_percentage: item.tax_percentage || 0,\r\n        discount: item.discount || 0,\r\n        discount_type: item.discount_type || 'percentage',\r\n      }));\r\n      setLineItems(items);\r\n    }\r\n    // Initialize shipping cost from PO if available, otherwise reset to 0\r\n    if (purchaseOrder?.shipping_cost) {\r\n      setShippingCost(purchaseOrder.shipping_cost);\r\n    } else {\r\n      setShippingCost(0);\r\n    }\r\n  }, [purchaseOrder]);\r\n  \r\n  // Calculate accepted quantity when received/rejected changes\r\n  const handleQuantityChange = useCallback((index: number, field: string, value: number) => {\r\n    const newItems = [...lineItems];\r\n    newItems[index][field] = value;\r\n    \r\n    if (field === 'received_quantity' || field === 'rejected_quantity') {\r\n      newItems[index].accepted_quantity = \r\n        (newItems[index].received_quantity || 0) - (newItems[index].rejected_quantity || 0);\r\n    }\r\n    \r\n    setLineItems(newItems);\r\n  }, [lineItems]);\r\n  \r\n  // Handle field change\r\n  const handleFieldChange = useCallback((index: number, field: string, value: any) => {\r\n    const newItems = [...lineItems];\r\n    newItems[index][field] = value;\r\n    setLineItems(newItems);\r\n  }, [lineItems]);\r\n  \r\n  // Handle submit\r\n  const handleSubmit = async () => {\r\n    try {\r\n      const values = await form.validateFields();\r\n      \r\n      // Validate at least one item received\r\n      const hasReceivedItems = lineItems.some(item => item.accepted_quantity > 0);\r\n      if (!hasReceivedItems) {\r\n        message.error('Please receive at least one item');\r\n        return;\r\n      }\r\n      \r\n      // Validate expiry date is required for all received items\r\n      const itemsWithReceivedQuantity = lineItems.filter(item => item.received_quantity > 0);\r\n      const missingExpiryDates = itemsWithReceivedQuantity.filter(item => !item.expiry_date);\r\n      if (missingExpiryDates.length > 0) {\r\n        message.error('Expiry date is required for all received items');\r\n        return;\r\n      }\r\n      \r\n      // Validate price and tax are required for all received items\r\n      const missingPrice = itemsWithReceivedQuantity.filter(item => !item.unit_price || item.unit_price <= 0);\r\n      if (missingPrice.length > 0) {\r\n        message.error('Unit price is required for all received items');\r\n        return;\r\n      }\r\n      const missingTax = itemsWithReceivedQuantity.filter(item => item.tax_percentage === undefined || item.tax_percentage === null);\r\n      if (missingTax.length > 0) {\r\n        message.error('Tax percentage is required for all received items');\r\n        return;\r\n      }\r\n      \r\n      // Prepare items data\r\n      const items = lineItems\r\n        .filter(item => item.received_quantity > 0)\r\n        .map(item => ({\r\n          po_line_item_id: item.po_line_item_id,\r\n          received_quantity: item.received_quantity,\r\n          rejected_quantity: item.rejected_quantity || 0,\r\n          batch_no: item.batch_no,\r\n          mfg_date: item.mfg_date ? dayjs(item.mfg_date).format('YYYY-MM-DD') : undefined,\r\n          expiry_date: item.expiry_date ? dayjs(item.expiry_date).format('YYYY-MM-DD') : undefined,\r\n          notes: item.notes,\r\n          // Include price, tax, and discount from receipt\r\n          unit_price: item.unit_price,\r\n          tax_percentage: item.tax_percentage,\r\n          discount: item.discount || 0,\r\n          discount_type: item.discount_type || 'percentage',\r\n        }));\r\n      \r\n      const payload = {\r\n        id: purchaseOrder._id,\r\n        items,\r\n        vendor_invoice_no: values.vendor_invoice_no,\r\n        vendor_invoice_date: values.vendor_invoice_date ? \r\n          dayjs(values.vendor_invoice_date).format('YYYY-MM-DD') : undefined,\r\n        notes: values.notes,\r\n        shipping_cost: shippingCost || 0,\r\n        create_stock_entries: createStockEntries,\r\n      };\r\n      \r\n      await convertToGRN(payload).unwrap();\r\n      \r\n      message.success('Goods received successfully!');\r\n      form.resetFields();\r\n      onClose();\r\n    } catch (error: any) {\r\n      message.error(error?.data?.message || 'Failed to receive goods');\r\n    }\r\n  };\r\n  \r\n  // Calculate totals\r\n  const totals = {\r\n    ordered: lineItems.reduce((sum, item) => sum + (item.ordered_quantity || 0), 0),\r\n    received: lineItems.reduce((sum, item) => sum + (item.received_quantity || 0), 0),\r\n    rejected: lineItems.reduce((sum, item) => sum + (item.rejected_quantity || 0), 0),\r\n    accepted: lineItems.reduce((sum, item) => sum + (item.accepted_quantity || 0), 0),\r\n  };\r\n  \r\n  // Calculate financial totals for received items\r\n  const financialTotals = useMemo(() => {\r\n    const receivedItems = lineItems.filter(item => item.received_quantity > 0);\r\n    let subtotal = 0;\r\n    let discountAmount = 0;\r\n    let taxAmount = 0;\r\n    \r\n    receivedItems.forEach(item => {\r\n      const qty = item.accepted_quantity || 0;\r\n      const price = Number(item.unit_price) || 0;\r\n      const taxPct = Number(item.tax_percentage) || 0;\r\n      const discountVal = Number(item.discount) || 0;\r\n      const discountType = item.discount_type || 'percentage';\r\n      \r\n      if (price > 0) {\r\n        let itemSubtotal = qty * price;\r\n        \r\n        // Apply discount\r\n        let itemDiscount = 0;\r\n        if (discountType === 'percentage') {\r\n          itemDiscount = itemSubtotal * (discountVal / 100);\r\n        } else {\r\n          itemDiscount = discountVal;\r\n        }\r\n        itemSubtotal = itemSubtotal - itemDiscount;\r\n        \r\n        subtotal += itemSubtotal;\r\n        discountAmount += itemDiscount;\r\n        taxAmount += itemSubtotal * (taxPct / 100);\r\n      }\r\n    });\r\n    \r\n    const shipping = Number(shippingCost) || 0;\r\n    const total = subtotal + taxAmount + shipping;\r\n    \r\n    return {\r\n      subtotal: Number(subtotal.toFixed(2)),\r\n      discountAmount: Number(discountAmount.toFixed(2)),\r\n      taxAmount: Number(taxAmount.toFixed(2)),\r\n      shippingCost: Number(shipping.toFixed(2)),\r\n      total: Number(total.toFixed(2)),\r\n    };\r\n  }, [lineItems, shippingCost]);\r\n  \r\n  // Table columns\r\n  const columns = [\r\n    {\r\n      title: 'Product',\r\n      key: 'product',\r\n      width: 200,\r\n      render: (record: any) => (\r\n        <div>\r\n          <strong>{record.product_name}</strong>\r\n          {record.variant_name && (\r\n            <div style={{ fontSize: '11px', color: '#888' }}>\r\n              {record.variant_name}\r\n            </div>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Ordered Qty',\r\n      dataIndex: 'ordered_quantity',\r\n      key: 'ordered_quantity',\r\n      width: 100,\r\n      render: (qty: number) => <Tag color=\"blue\">{qty}</Tag>,\r\n    },\r\n    {\r\n      title: 'Already Received',\r\n      dataIndex: 'received_quantity',\r\n      key: 'already_received',\r\n      width: 120,\r\n      render: (qty: number, record: any) => {\r\n        const alreadyReceived = record.ordered_quantity - record.pending_quantity;\r\n        return alreadyReceived > 0 ? (\r\n          <Tag color=\"green\">{alreadyReceived}</Tag>\r\n        ) : (\r\n          <span style={{ color: '#999' }}>-</span>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      title: 'Pending',\r\n      key: 'pending',\r\n      width: 100,\r\n      render: (record: any) => (\r\n        <Tag color=\"orange\">{record.pending_quantity || 0}</Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: <span style={{ color: 'red' }}>* Receive Now</span>,\r\n      key: 'receive_now',\r\n      width: 120,\r\n      render: (record: any, _: any, index: number) => (\r\n        <InputNumber\r\n          min={0}\r\n          max={record.pending_quantity || record.ordered_quantity}\r\n          value={record.received_quantity}\r\n          onChange={(val) => handleQuantityChange(index, 'received_quantity', val || 0)}\r\n          style={{ width: '100%' }}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Rejected',\r\n      key: 'rejected',\r\n      width: 100,\r\n      render: (record: any, _: any, index: number) => (\r\n        <InputNumber\r\n          min={0}\r\n          max={record.received_quantity}\r\n          value={record.rejected_quantity}\r\n          onChange={(val) => handleQuantityChange(index, 'rejected_quantity', val || 0)}\r\n          style={{ width: '100%' }}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Accepted',\r\n      dataIndex: 'accepted_quantity',\r\n      key: 'accepted_quantity',\r\n      width: 100,\r\n      render: (qty: number) => (\r\n        <strong style={{ color: '#52c41a' }}>{qty}</strong>\r\n      ),\r\n    },\r\n    {\r\n      title: (\r\n        <span>\r\n          Unit Price <span style={{ color: 'red' }}>*</span>\r\n        </span>\r\n      ),\r\n      key: 'unit_price',\r\n      width: 120,\r\n      render: (record: any, _: any, index: number) => {\r\n        const isRequired = record.received_quantity > 0;\r\n        const hasError = isRequired && (!record.unit_price || record.unit_price <= 0);\r\n        return (\r\n          <InputNumber\r\n            min={0}\r\n            precision={2}\r\n            placeholder=\"0.00\"\r\n            prefix=\"\"\r\n            style={{ \r\n              width: '100%',\r\n              borderColor: hasError ? '#ff4d4f' : undefined\r\n            }}\r\n            value={record.unit_price}\r\n            onChange={(val) => handleFieldChange(index, 'unit_price', val || 0)}\r\n            disabled={record.received_quantity === 0}\r\n            className={hasError ? 'ant-input-number-error' : ''}\r\n          />\r\n        );\r\n      },\r\n    },\r\n    {\r\n      title: (\r\n        <span>\r\n          GST % <span style={{ color: 'red' }}>*</span>\r\n        </span>\r\n      ),\r\n      key: 'tax_percentage',\r\n      width: 100,\r\n      render: (record: any, _: any, index: number) => {\r\n        const isRequired = record.received_quantity > 0;\r\n        const hasError = isRequired && (record.tax_percentage === undefined || record.tax_percentage === null);\r\n        return (\r\n          <InputNumber\r\n            min={0}\r\n            max={100}\r\n            precision={2}\r\n            placeholder=\"18%\"\r\n            suffix=\"%\"\r\n            style={{ \r\n              width: '100%',\r\n              borderColor: hasError ? '#ff4d4f' : undefined\r\n            }}\r\n            value={record.tax_percentage}\r\n            onChange={(val) => handleFieldChange(index, 'tax_percentage', val || 0)}\r\n            disabled={record.received_quantity === 0}\r\n            className={hasError ? 'ant-input-number-error' : ''}\r\n          />\r\n        );\r\n      },\r\n    },\r\n    {\r\n      title: 'Discount',\r\n      key: 'discount',\r\n      width: 150,\r\n      render: (record: any, _: any, index: number) => (\r\n        <Space.Compact style={{ width: '100%' }}>\r\n          <InputNumber\r\n            min={0}\r\n            precision={2}\r\n            placeholder=\"0\"\r\n            style={{ width: '70%' }}\r\n            value={record.discount}\r\n            onChange={(val) => handleFieldChange(index, 'discount', val || 0)}\r\n            disabled={record.received_quantity === 0}\r\n          />\r\n          <Select\r\n            style={{ width: '30%' }}\r\n            value={record.discount_type}\r\n            onChange={(val) => handleFieldChange(index, 'discount_type', val)}\r\n            disabled={record.received_quantity === 0}\r\n          >\r\n            <Select.Option value=\"percentage\">%</Select.Option>\r\n            <Select.Option value=\"amount\"></Select.Option>\r\n          </Select>\r\n        </Space.Compact>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Batch No',\r\n      key: 'batch_no',\r\n      width: 130,\r\n      render: (record: any, _: any, index: number) => (\r\n        <Input\r\n          placeholder=\"Batch\"\r\n          value={record.batch_no}\r\n          onChange={(e) => handleFieldChange(index, 'batch_no', e.target.value)}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'MFG Date',\r\n      key: 'mfg_date',\r\n      width: 140,\r\n      render: (record: any, _: any, index: number) => (\r\n        <DatePicker\r\n          format=\"YYYY-MM-DD\"\r\n          value={record.mfg_date ? dayjs(record.mfg_date) : undefined}\r\n          onChange={(date) => handleFieldChange(index, 'mfg_date', date)}\r\n          style={{ width: '100%' }}\r\n          disabledDate={(current) => current && current > dayjs().endOf('day')}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: (\r\n        <span>\r\n          Expiry Date <span style={{ color: 'red' }}>*</span>\r\n        </span>\r\n      ),\r\n      key: 'expiry_date',\r\n      width: 140,\r\n      render: (record: any, _: any, index: number) => {\r\n        const isRequired = record.received_quantity > 0;\r\n        const hasError = isRequired && !record.expiry_date;\r\n        return (\r\n          <DatePicker\r\n            format=\"YYYY-MM-DD\"\r\n            value={record.expiry_date ? dayjs(record.expiry_date) : undefined}\r\n            onChange={(date) => handleFieldChange(index, 'expiry_date', date)}\r\n            style={{ \r\n              width: '100%',\r\n              borderColor: hasError ? '#ff4d4f' : undefined\r\n            }}\r\n            disabledDate={(current) => current && current < dayjs().endOf('day')}\r\n            placeholder={isRequired ? \"Required *\" : \"Select date\"}\r\n            className={hasError ? 'ant-picker-error' : ''}\r\n          />\r\n        );\r\n      },\r\n    },\r\n  ];\r\n  \r\n  return (\r\n    <Modal\r\n      title={\r\n        <Space>\r\n          <InboxOutlined style={{ color: '#1890ff' }} />\r\n          <span>Receive Goods - PO #{purchaseOrder?.po_number}</span>\r\n        </Space>\r\n      }\r\n      open={open}\r\n      onCancel={onClose}\r\n      width={1400}\r\n      footer={[\r\n        <Button key=\"cancel\" onClick={onClose}>\r\n          Cancel\r\n        </Button>,\r\n        <Button\r\n          key=\"submit\"\r\n          type=\"primary\"\r\n          icon={<CheckCircleOutlined />}\r\n          loading={isLoading}\r\n          onClick={handleSubmit}\r\n        >\r\n          Receive Goods & Create GRN\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <Alert\r\n        message=\"Goods Receipt Note (GRN)\"\r\n        description=\"Record the actual quantities received from the vendor. Enter the unit price, GST percentage, and discount (if any) for each item, plus the total shipping cost as provided by the vendor. This will update inventory and PO status.\"\r\n        type=\"info\"\r\n        showIcon\r\n        style={{ marginBottom: 16 }}\r\n      />\r\n      \r\n      <Form form={form} layout=\"vertical\">\r\n        <Row gutter={16}>\r\n          <Col span={8}>\r\n            <Form.Item\r\n              name=\"vendor_invoice_no\"\r\n              label={\r\n                <span>\r\n                  Vendor Invoice Number <span style={{ color: 'red' }}>*</span>\r\n                </span>\r\n              }\r\n              rules={[\r\n                { required: true, message: 'Please enter vendor invoice number' },\r\n                { whitespace: true, message: 'Vendor invoice number cannot be empty' },\r\n              ]}\r\n            >\r\n              <Input placeholder=\"Enter vendor's invoice number\" />\r\n            </Form.Item>\r\n          </Col>\r\n          <Col span={8}>\r\n            <Form.Item\r\n              name=\"vendor_invoice_date\"\r\n              label=\"Vendor Invoice Date\"\r\n            >\r\n              <DatePicker style={{ width: '100%' }} format=\"YYYY-MM-DD\" />\r\n            </Form.Item>\r\n          </Col>\r\n          <Col span={8}>\r\n            <Form.Item label=\"GRN Date\">\r\n              <DatePicker\r\n                value={dayjs()}\r\n                disabled\r\n                style={{ width: '100%' }}\r\n                format=\"YYYY-MM-DD\"\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n        </Row>\r\n        \r\n        <Divider>Receive Items</Divider>\r\n        \r\n        <Row gutter={16} style={{ marginBottom: 16 }}>\r\n          <Col span={6}>\r\n            <Statistic title=\"Total Ordered\" value={totals.ordered} />\r\n          </Col>\r\n          <Col span={6}>\r\n            <Statistic title=\"Receiving Now\" value={totals.received} valueStyle={{ color: '#1890ff' }} />\r\n          </Col>\r\n          <Col span={6}>\r\n            <Statistic title=\"Rejected\" value={totals.rejected} valueStyle={{ color: '#ff4d4f' }} />\r\n          </Col>\r\n          <Col span={6}>\r\n            <Statistic title=\"Accepted\" value={totals.accepted} valueStyle={{ color: '#52c41a' }} />\r\n          </Col>\r\n        </Row>\r\n        \r\n        <Table\r\n          columns={columns}\r\n          dataSource={lineItems}\r\n          rowKey=\"po_line_item_id\"\r\n          pagination={false}\r\n          scroll={{ x: 1650 }}\r\n          size=\"small\"\r\n          bordered\r\n        />\r\n        \r\n        <Divider />\r\n        \r\n        {/* Financial Totals */}\r\n        {financialTotals.total > 0 && (\r\n          <Row gutter={16} style={{ marginBottom: 16, padding: '16px', background: '#f5f5f5', borderRadius: '4px' }}>\r\n            <Col span={5}>\r\n              <Statistic \r\n                title=\"Subtotal (After Discount)\" \r\n                value={financialTotals.subtotal} \r\n                prefix=\"\"\r\n                valueStyle={{ fontSize: '16px' }}\r\n              />\r\n            </Col>\r\n            {financialTotals.discountAmount > 0 && (\r\n              <Col span={5}>\r\n                <Statistic \r\n                  title=\"Discount\" \r\n                  value={financialTotals.discountAmount} \r\n                  prefix=\"\"\r\n                  valueStyle={{ fontSize: '16px', color: '#ff4d4f' }}\r\n                />\r\n              </Col>\r\n            )}\r\n            <Col span={5}>\r\n              <Statistic \r\n                title=\"Tax Amount\" \r\n                value={financialTotals.taxAmount} \r\n                prefix=\"\"\r\n                valueStyle={{ fontSize: '16px' }}\r\n              />\r\n            </Col>\r\n            {financialTotals.shippingCost > 0 && (\r\n              <Col span={5}>\r\n                <Statistic \r\n                  title=\"Shipping Cost\" \r\n                  value={financialTotals.shippingCost} \r\n                  prefix=\"\"\r\n                  valueStyle={{ fontSize: '16px' }}\r\n                />\r\n              </Col>\r\n            )}\r\n            <Col span={financialTotals.shippingCost > 0 ? 4 : financialTotals.discountAmount > 0 ? 9 : 14}>\r\n              <Statistic \r\n                title=\"Total Amount\" \r\n                value={financialTotals.total} \r\n                prefix=\"\"\r\n                valueStyle={{ fontSize: '18px', color: '#52c41a', fontWeight: 'bold' }}\r\n              />\r\n            </Col>\r\n          </Row>\r\n        )}\r\n        \r\n        <Row gutter={16}>\r\n          <Col span={12}>\r\n            <Form.Item name=\"notes\" label=\"Notes\">\r\n              <Input.TextArea\r\n                rows={3}\r\n                placeholder=\"Any notes about the receipt...\"\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n          <Col span={12}>\r\n            <Form.Item label=\"Shipping Cost\">\r\n              <InputNumber\r\n                min={0}\r\n                precision={2}\r\n                placeholder=\"0.00\"\r\n                prefix=\"\"\r\n                style={{ width: '100%' }}\r\n                value={shippingCost}\r\n                onChange={(val) => setShippingCost(val || 0)}\r\n              />\r\n            </Form.Item>\r\n            <Checkbox\r\n              checked={createStockEntries}\r\n              onChange={(e) => setCreateStockEntries(e.target.checked)}\r\n              style={{ marginTop: 16 }}\r\n            >\r\n              <strong>Auto-create Stock Entries</strong>\r\n              <div style={{ fontSize: '11px', color: '#888' }}>\r\n                Automatically add received items to Stock Audit\r\n              </div>\r\n            </Checkbox>\r\n          </Col>\r\n        </Row>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default POReceiveModal;\r\n\r\n","import React, { useState } from 'react';\r\nimport { Modal, Form, Input, message, Space, Descriptions, Tag, Divider, Button } from 'antd';\r\nimport { CheckCircleOutlined, CloseCircleOutlined } from '@ant-design/icons';\r\nimport { useApprovePurchaseOrderMutation, useRejectPurchaseOrderMutation } from '../../services/redux/api/endpoints';\r\n\r\ninterface POApprovalModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  purchaseOrder: any;\r\n}\r\n\r\nconst POApprovalModal: React.FC<POApprovalModalProps> = ({\r\n  open,\r\n  onClose,\r\n  purchaseOrder,\r\n}) => {\r\n  const [form] = Form.useForm();\r\n  const [rejectModalOpen, setRejectModalOpen] = useState(false);\r\n  const [rejectionReason, setRejectionReason] = useState('');\r\n  \r\n  const [approvePO, { isLoading: approving }] = useApprovePurchaseOrderMutation();\r\n  const [rejectPO, { isLoading: rejecting }] = useRejectPurchaseOrderMutation();\r\n  \r\n  const handleApprove = async () => {\r\n    try {\r\n      const values = await form.validateFields();\r\n      await approvePO({ id: purchaseOrder._id, comments: values.comments }).unwrap();\r\n      message.success('Purchase order approved successfully');\r\n      form.resetFields();\r\n      onClose();\r\n    } catch (error: any) {\r\n      message.error(error?.data?.message || 'Failed to approve PO');\r\n    }\r\n  };\r\n  \r\n  const handleReject = async () => {\r\n    try {\r\n      if (!rejectionReason) {\r\n        message.error('Please provide a rejection reason');\r\n        return;\r\n      }\r\n      await rejectPO({ id: purchaseOrder._id, reason: rejectionReason }).unwrap();\r\n      message.success('Purchase order rejected');\r\n      form.resetFields();\r\n      setRejectionReason('');\r\n      setRejectModalOpen(false);\r\n      onClose();\r\n    } catch (error: any) {\r\n      message.error(error?.data?.message || 'Failed to reject PO');\r\n    }\r\n  };\r\n  \r\n  const showRejectModal = () => {\r\n    setRejectModalOpen(true);\r\n  };\r\n  \r\n  return (\r\n    <>\r\n      <Modal\r\n        title=\"Approve / Reject Purchase Order\"\r\n        open={open}\r\n        onCancel={onClose}\r\n        width={700}\r\n        footer={[\r\n          <Button\r\n            key=\"reject\"\r\n            danger\r\n            icon={<CloseCircleOutlined />}\r\n            loading={rejecting}\r\n            onClick={showRejectModal}\r\n          >\r\n            Reject\r\n          </Button>,\r\n          <Button\r\n            key=\"approve\"\r\n            type=\"primary\"\r\n            icon={<CheckCircleOutlined />}\r\n            loading={approving}\r\n            onClick={handleApprove}\r\n          >\r\n            Approve\r\n          </Button>,\r\n        ]}\r\n      >\r\n      <Descriptions bordered column={2} size=\"small\">\r\n        <Descriptions.Item label=\"PO Number\" span={2}>\r\n          <Tag color=\"blue\">{purchaseOrder?.po_number}</Tag>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Vendor\" span={2}>\r\n          {purchaseOrder?.vendor?.vendor_name}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Total Amount\" span={2}>\r\n          <strong style={{ color: '#52c41a' }}>\r\n            {purchaseOrder?.total_amount?.toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n          </strong>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Items\" span={2}>\r\n          {purchaseOrder?.items?.length} items\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Created By\" span={2}>\r\n          {purchaseOrder?.created_by_name}\r\n        </Descriptions.Item>\r\n      </Descriptions>\r\n      \r\n      <Divider />\r\n      \r\n      <Form form={form} layout=\"vertical\">\r\n        <Form.Item\r\n          name=\"comments\"\r\n          label=\"Comments (Optional)\"\r\n        >\r\n          <Input.TextArea rows={3} placeholder=\"Add any comments...\" />\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n    \r\n    {/* Rejection Modal */}\r\n    <Modal\r\n      title=\"Reject Purchase Order\"\r\n      open={rejectModalOpen}\r\n      onCancel={() => setRejectModalOpen(false)}\r\n      onOk={handleReject}\r\n      confirmLoading={rejecting}\r\n      okText=\"Reject\"\r\n      okButtonProps={{ danger: true }}\r\n    >\r\n      <Form.Item\r\n        label=\"Rejection Reason\"\r\n        required\r\n      >\r\n        <Input.TextArea\r\n          rows={4}\r\n          value={rejectionReason}\r\n          onChange={(e) => setRejectionReason(e.target.value)}\r\n          placeholder=\"Enter the reason for rejecting this purchase order...\"\r\n        />\r\n      </Form.Item>\r\n    </Modal>\r\n  </>\r\n  );\r\n};\r\n\r\nexport default POApprovalModal;\r\n\r\n","import React from 'react';\r\nimport { Modal, Form, Input, message, Space, Alert } from 'antd';\r\nimport { SendOutlined } from '@ant-design/icons';\r\nimport { useSendPurchaseOrderMutation } from '../../services/redux/api/endpoints';\r\n\r\ninterface POSendModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  purchaseOrder: any;\r\n}\r\n\r\nconst POSendModal: React.FC<POSendModalProps> = ({\r\n  open,\r\n  onClose,\r\n  purchaseOrder,\r\n}) => {\r\n  const [form] = Form.useForm();\r\n  \r\n  const [sendPO, { isLoading }] = useSendPurchaseOrderMutation();\r\n  \r\n  const handleSend = async () => {\r\n    try {\r\n      const values = await form.validateFields();\r\n      await sendPO({\r\n        id: purchaseOrder._id,\r\n        email: values.email,\r\n        message: values.message,\r\n      }).unwrap();\r\n      \r\n      message.success('Purchase order sent to vendor successfully');\r\n      form.resetFields();\r\n      onClose();\r\n    } catch (error: any) {\r\n      message.error(error?.data?.message || 'Failed to send PO');\r\n    }\r\n  };\r\n  \r\n  return (\r\n    <Modal\r\n      title={\r\n        <Space>\r\n          <SendOutlined style={{ color: '#1890ff' }} />\r\n          <span>Send Purchase Order to Vendor</span>\r\n        </Space>\r\n      }\r\n      open={open}\r\n      onCancel={onClose}\r\n      onOk={handleSend}\r\n      confirmLoading={isLoading}\r\n      okText=\"Send Email\"\r\n      width={600}\r\n    >\r\n      <Alert\r\n        message=\"Email Purchase Order\"\r\n        description={`This will send PO #${purchaseOrder?.po_number} as a PDF attachment to the vendor's email address.`}\r\n        type=\"info\"\r\n        showIcon\r\n        style={{ marginBottom: 16 }}\r\n      />\r\n      \r\n      <Form\r\n        form={form}\r\n        layout=\"vertical\"\r\n        initialValues={{\r\n          email: purchaseOrder?.vendor_email || purchaseOrder?.VendorItem?.email,\r\n        }}\r\n      >\r\n        <Form.Item\r\n          name=\"email\"\r\n          label=\"Vendor Email\"\r\n          rules={[\r\n            { required: true, message: 'Email is required' },\r\n            { type: 'email', message: 'Enter a valid email' },\r\n          ]}\r\n        >\r\n          <Input placeholder=\"vendor@example.com\" />\r\n        </Form.Item>\r\n        \r\n        <Form.Item\r\n          name=\"message\"\r\n          label=\"Message (Optional)\"\r\n        >\r\n          <Input.TextArea\r\n            rows={4}\r\n            placeholder=\"Dear Vendor, Please find the attached purchase order...\"\r\n          />\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default POSendModal;\r\n\r\n","import React, { useMemo } from 'react';\r\nimport {\r\n  Modal,\r\n  Descriptions,\r\n  Table,\r\n  Tag,\r\n  Divider,\r\n  Space,\r\n  Timeline,\r\n  Badge,\r\n  Typography,\r\n  Button,\r\n} from 'antd';\r\nimport {\r\n  FileTextOutlined,\r\n  CalendarOutlined,\r\n  DollarOutlined,\r\n  UserOutlined,\r\n  ShopOutlined,\r\n  CreditCardOutlined,\r\n  CheckCircleOutlined,\r\n  InboxOutlined,\r\n} from '@ant-design/icons';\r\nimport dayjs from 'dayjs';\r\nimport { apiSlice } from '../../services/redux/api/apiSlice';\r\nimport {\r\n  useGetPOPaymentsQuery,\r\n  useGetReceiptsForPOQuery,\r\n  useGetPOvsGRNComparisonQuery,\r\n} from '../../services/redux/api/endpoints/purchaseOrder.endpoints';\r\n\r\nconst { Text } = Typography;\r\n\r\ninterface POViewModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  purchaseOrder: any;\r\n  onPaymentSuccess?: () => void;\r\n}\r\n\r\nconst POViewModal: React.FC<POViewModalProps> = ({\r\n  open,\r\n  onClose,\r\n  purchaseOrder,\r\n  onPaymentSuccess,\r\n}) => {\r\n  // Fetch vendor by ID if VendorItem is not populated\r\n  // Must call hooks before any conditional returns\r\n  const shouldFetchVendor =\r\n    purchaseOrder &&\r\n    !purchaseOrder.VendorItem &&\r\n    purchaseOrder.vendor_id &&\r\n    open;\r\n  const { data: vendorData } = apiSlice.useGetVendorByIdQuery(\r\n    purchaseOrder?.vendor_id || '',\r\n    { skip: !shouldFetchVendor }\r\n  );\r\n\r\n  // Fetch warehouse by ID if WarehouseItem is not populated\r\n  const shouldFetchWarehouse =\r\n    purchaseOrder &&\r\n    !purchaseOrder.WarehouseItem &&\r\n    purchaseOrder.warehouse_id &&\r\n    open;\r\n  const { data: warehouseData } = apiSlice.useGetWarehouseByIdQuery(\r\n    purchaseOrder?.warehouse_id || '',\r\n    { skip: !shouldFetchWarehouse }\r\n  );\r\n\r\n  // Fetch payment history for this purchase order\r\n  const { data: paymentsData, refetch: refetchPayments } =\r\n    useGetPOPaymentsQuery(purchaseOrder?._id || '', {\r\n      skip: !purchaseOrder?._id || !open,\r\n    });\r\n\r\n  // Fetch GRN receipts for this purchase order\r\n  const { data: receiptsData } = useGetReceiptsForPOQuery(\r\n    purchaseOrder?._id || '',\r\n    { skip: !purchaseOrder?._id || !open }\r\n  );\r\n\r\n  // Fetch PO vs GRN comparison\r\n  const { data: comparisonData } = useGetPOvsGRNComparisonQuery(\r\n    purchaseOrder?._id || '',\r\n    { skip: !purchaseOrder?._id || !open }\r\n  );\r\n\r\n  // Get vendor information from multiple possible sources\r\n  const vendorInfo = useMemo(() => {\r\n    if (!purchaseOrder) return null;\r\n\r\n    // Priority 1: VendorItem (populated relation) - most reliable\r\n    if (purchaseOrder.VendorItem && purchaseOrder.VendorItem.vendor_name) {\r\n      return purchaseOrder.VendorItem;\r\n    }\r\n\r\n    // Priority 2: Fetch vendor by ID if VendorItem is missing\r\n    if (shouldFetchVendor && vendorData) {\r\n      const vendor = (vendorData as any)?.result || vendorData;\r\n      if (vendor && (vendor.vendor_name || vendor.name)) {\r\n        return {\r\n          vendor_name: vendor.vendor_name || vendor.name,\r\n          company_name: vendor.company_name,\r\n          email: vendor.email,\r\n          phone: vendor.phone || vendor.contact_number,\r\n          address: vendor.address,\r\n        };\r\n      }\r\n    }\r\n\r\n    // Priority 3: Direct fields on purchase order (if saved directly)\r\n    if (purchaseOrder.vendor_name) {\r\n      return {\r\n        vendor_name: purchaseOrder.vendor_name,\r\n        company_name: purchaseOrder.vendor_company_name,\r\n        email: purchaseOrder.vendor_email,\r\n        phone: purchaseOrder.vendor_phone,\r\n        address: purchaseOrder.vendor_address,\r\n      };\r\n    }\r\n\r\n    // If vendor_id exists but no data available, return null (will show fallback message)\r\n    return null;\r\n  }, [\r\n    purchaseOrder,\r\n    purchaseOrder?.VendorItem,\r\n    purchaseOrder?.vendor_name,\r\n    purchaseOrder?.vendor_id,\r\n    vendorData,\r\n    shouldFetchVendor,\r\n  ]);\r\n\r\n  // Get warehouse information from multiple possible sources\r\n  const warehouseInfo = useMemo(() => {\r\n    if (!purchaseOrder) return null;\r\n\r\n    // Priority 1: WarehouseItem (populated relation) - most reliable\r\n    if (\r\n      purchaseOrder.WarehouseItem &&\r\n      purchaseOrder.WarehouseItem.warehouse_name\r\n    ) {\r\n      return purchaseOrder.WarehouseItem;\r\n    }\r\n\r\n    // Priority 2: Fetch warehouse by ID if WarehouseItem is missing\r\n    if (shouldFetchWarehouse && warehouseData) {\r\n      const warehouse = (warehouseData as any)?.result || warehouseData;\r\n      if (warehouse && (warehouse.warehouse_name || warehouse.name)) {\r\n        return {\r\n          warehouse_name: warehouse.warehouse_name || warehouse.name,\r\n          warehouse_code: warehouse.warehouse_code || warehouse.code,\r\n          address: warehouse.address,\r\n          manager: warehouse.manager,\r\n        };\r\n      }\r\n    }\r\n\r\n    // Priority 3: Direct fields on purchase order (if saved directly)\r\n    if (purchaseOrder.warehouse_name) {\r\n      return {\r\n        warehouse_name: purchaseOrder.warehouse_name,\r\n        warehouse_code: purchaseOrder.warehouse_code,\r\n        address: purchaseOrder.warehouse_address,\r\n        manager: purchaseOrder.warehouse_manager,\r\n      };\r\n    }\r\n\r\n    // If warehouse_id exists but no data available, return null (will show fallback message)\r\n    return null;\r\n  }, [\r\n    purchaseOrder,\r\n    purchaseOrder?.WarehouseItem,\r\n    purchaseOrder?.warehouse_name,\r\n    purchaseOrder?.warehouse_id,\r\n    warehouseData,\r\n    shouldFetchWarehouse,\r\n  ]);\r\n\r\n  // Early return after hooks\r\n  if (!purchaseOrder) return null;\r\n\r\n  const statusConfig: Record<string, any> = {\r\n    draft: { color: 'default', label: 'Draft' },\r\n    pending_approval: { color: 'warning', label: 'Pending Approval' },\r\n    approved: { color: 'success', label: 'Approved' },\r\n    rejected: { color: 'error', label: 'Rejected' },\r\n    sent: { color: 'processing', label: 'Sent' },\r\n    confirmed: { color: 'cyan', label: 'Confirmed' },\r\n    partially_received: { color: 'purple', label: 'Partially Received' },\r\n    fully_received: { color: 'green', label: 'Fully Received' },\r\n    cancelled: { color: 'red', label: 'Cancelled' },\r\n    closed: { color: 'default', label: 'Closed' },\r\n  };\r\n\r\n  const currentStatus =\r\n    statusConfig[purchaseOrder.status] || statusConfig.draft;\r\n\r\n  // Helper function to format amounts safely\r\n  const formatAmount = (amount: any) => {\r\n    const numAmount = Number(amount) || 0;\r\n    return numAmount.toFixed(2);\r\n  };\r\n\r\n  const itemColumns = [\r\n    {\r\n      title: 'Product',\r\n      key: 'product',\r\n      render: (record: any) => (\r\n        <div>\r\n          <strong>{record.product_name}</strong>\r\n          {record.variant_name && (\r\n            <div style={{ fontSize: '11px', color: '#888' }}>\r\n              {record.variant_name}\r\n            </div>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Description',\r\n      dataIndex: 'description',\r\n      key: 'description',\r\n    },\r\n    {\r\n      title: 'Quantity',\r\n      dataIndex: 'quantity',\r\n      key: 'quantity',\r\n      render: (qty: any) => <Tag color=\"blue\">{Number(qty) || 0}</Tag>,\r\n    },\r\n    {\r\n      title: 'Unit Price',\r\n      dataIndex: 'unit_price',\r\n      key: 'unit_price',\r\n      render: (price: any) => `${formatAmount(price)}`,\r\n    },\r\n    {\r\n      title: 'Tax %',\r\n      dataIndex: 'tax_percentage',\r\n      key: 'tax_percentage',\r\n      render: (tax: any) => {\r\n        const numTax = Number(tax);\r\n        return numTax ? `${numTax}%` : '-';\r\n      },\r\n    },\r\n    {\r\n      title: 'Discount',\r\n      key: 'discount',\r\n      render: (record: any) => {\r\n        const discount = Number(record.discount) || 0;\r\n        if (discount > 0) {\r\n          return `${discount}${record.discount_type === 'percentage' ? '%' : ''}`;\r\n        }\r\n        return '-';\r\n      },\r\n    },\r\n    {\r\n      title: 'Line Total',\r\n      dataIndex: 'line_total',\r\n      key: 'line_total',\r\n      render: (total: any) => {\r\n        const numTotal = Number(total) || 0;\r\n        return (\r\n          <strong style={{ color: '#52c41a' }}>\r\n            {numTotal.toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n          </strong>\r\n        );\r\n      },\r\n    },\r\n    {\r\n      title: 'Received',\r\n      dataIndex: 'received_quantity',\r\n      key: 'received_quantity',\r\n      render: (received: any, record: any) => {\r\n        const numReceived = Number(received) || 0;\r\n        const numQuantity = Number(record.quantity) || 0;\r\n        const pending = numQuantity - numReceived;\r\n        return (\r\n          <div>\r\n            <Tag color=\"green\">{numReceived}</Tag>\r\n            {pending > 0 && <Tag color=\"orange\">Pending: {pending}</Tag>}\r\n          </div>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <Modal\r\n      title={\r\n        <Space>\r\n          <FileTextOutlined style={{ color: '#1890ff' }} />\r\n          <span>Purchase Order Details</span>\r\n        </Space>\r\n      }\r\n      open={open}\r\n      onCancel={onClose}\r\n      width={1200}\r\n      footer={[\r\n        <Button key=\"close\" type=\"primary\" onClick={onClose}>\r\n          Close\r\n        </Button>\r\n      ]}\r\n    >\r\n      <Descriptions bordered column={2} size=\"small\">\r\n        <Descriptions.Item label=\"PO Number\" span={1}>\r\n          <Tag color=\"blue\" icon={<FileTextOutlined />}>\r\n            {purchaseOrder.po_number}\r\n          </Tag>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Status\" span={1}>\r\n          <Badge\r\n            status={currentStatus.color}\r\n            text={<Tag color={currentStatus.color}>{currentStatus.label}</Tag>}\r\n          />\r\n        </Descriptions.Item>\r\n\r\n        <Descriptions.Item label=\"Vendor\" span={2}>\r\n          {vendorInfo ? (\r\n            <>\r\n              <UserOutlined style={{ marginRight: 8 }} />\r\n              <strong>{vendorInfo.vendor_name || 'N/A'}</strong>\r\n              {vendorInfo.company_name && (\r\n                <div style={{ fontSize: '12px', color: '#888', marginTop: 4 }}>\r\n                  {vendorInfo.company_name}\r\n                </div>\r\n              )}\r\n              {vendorInfo.email && (\r\n                <div style={{ fontSize: '12px', color: '#888', marginTop: 4 }}>\r\n                   {vendorInfo.email}\r\n                </div>\r\n              )}\r\n              {vendorInfo.phone && (\r\n                <div style={{ fontSize: '12px', color: '#888' }}>\r\n                   {vendorInfo.phone}\r\n                </div>\r\n              )}\r\n              {vendorInfo.address && (\r\n                <div style={{ fontSize: '12px', color: '#888', marginTop: 4 }}>\r\n                   {vendorInfo.address}\r\n                </div>\r\n              )}\r\n            </>\r\n          ) : (\r\n            <span style={{ color: '#999' }}>\r\n              <UserOutlined style={{ marginRight: 8 }} />\r\n              Vendor information not available\r\n            </span>\r\n          )}\r\n        </Descriptions.Item>\r\n\r\n        <Descriptions.Item label=\"PO Date\">\r\n          <CalendarOutlined style={{ marginRight: 8 }} />\r\n          {dayjs(purchaseOrder.po_date).format('DD/MM/YYYY')}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Expected Delivery\">\r\n          <CalendarOutlined style={{ marginRight: 8 }} />\r\n          {purchaseOrder.expected_delivery_date\r\n            ? dayjs(purchaseOrder.expected_delivery_date).format('DD/MM/YYYY')\r\n            : '-'}\r\n        </Descriptions.Item>\r\n\r\n        <Descriptions.Item label=\"Warehouse\">\r\n          {warehouseInfo ? (\r\n            <>\r\n              <ShopOutlined style={{ marginRight: 8 }} />\r\n              <strong>{warehouseInfo.warehouse_name || 'N/A'}</strong>\r\n              {warehouseInfo.warehouse_code && (\r\n                <div style={{ fontSize: '12px', color: '#888', marginTop: 4 }}>\r\n                  Code: {warehouseInfo.warehouse_code}\r\n                </div>\r\n              )}\r\n              {warehouseInfo.address && (\r\n                <div style={{ fontSize: '12px', color: '#888', marginTop: 4 }}>\r\n                   {warehouseInfo.address}\r\n                </div>\r\n              )}\r\n              {warehouseInfo.manager && (\r\n                <div style={{ fontSize: '12px', color: '#888', marginTop: 4 }}>\r\n                   Manager: {warehouseInfo.manager}\r\n                </div>\r\n              )}\r\n            </>\r\n          ) : (\r\n            <span style={{ color: '#999' }}>\r\n              <ShopOutlined style={{ marginRight: 8 }} />\r\n              Warehouse information not available\r\n            </span>\r\n          )}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Payment Terms\">\r\n          {purchaseOrder.payment_terms?.replace('_', ' ').toUpperCase()}\r\n        </Descriptions.Item>\r\n\r\n        <Descriptions.Item label=\"Created By\" span={2}>\r\n          {purchaseOrder.created_by_name}\r\n        </Descriptions.Item>\r\n      </Descriptions>\r\n\r\n      <Divider orientation=\"left\">Financial Summary</Divider>\r\n\r\n      <Descriptions bordered column={4} size=\"small\">\r\n        <Descriptions.Item label=\"Subtotal\">\r\n          <DollarOutlined style={{ marginRight: 8 }} />\r\n          {(Number(purchaseOrder.subtotal) || 0).toLocaleString('en-IN', {\r\n            minimumFractionDigits: 2,\r\n          })}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Tax Amount\">\r\n          \r\n          {(Number(purchaseOrder.tax_amount) || 0).toLocaleString('en-IN', {\r\n            minimumFractionDigits: 2,\r\n          })}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Total Amount\">\r\n          <strong style={{ color: '#52c41a', fontSize: '16px' }}>\r\n            \r\n            {(Number(purchaseOrder.total_amount) || 0).toLocaleString('en-IN', {\r\n              minimumFractionDigits: 2,\r\n            })}\r\n          </strong>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Paid Amount\">\r\n          <Text strong style={{ color: '#1890ff' }}>\r\n            \r\n            {(Number(purchaseOrder.paid_amount) || 0).toLocaleString('en-IN', {\r\n              minimumFractionDigits: 2,\r\n            })}\r\n          </Text>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Outstanding\" span={4}>\r\n          <strong style={{ color: '#ff4d4f', fontSize: '18px' }}>\r\n            \r\n            {(Number(purchaseOrder.outstanding_amount) || 0).toLocaleString(\r\n              'en-IN',\r\n              { minimumFractionDigits: 2 }\r\n            )}\r\n          </strong>\r\n        </Descriptions.Item>\r\n      </Descriptions>\r\n\r\n      <Divider orientation=\"left\">Line Items</Divider>\r\n\r\n      <Table\r\n        columns={itemColumns}\r\n        dataSource={purchaseOrder.items || []}\r\n        rowKey={(record, index) => `item-${index}`}\r\n        pagination={false}\r\n        size=\"small\"\r\n        bordered\r\n        scroll={{ x: 1000 }}\r\n      />\r\n\r\n      {/* GRN Receipts Section */}\r\n      {(() => {\r\n        const receipts = (receiptsData as any)?.result || receiptsData || [];\r\n        const receiptList = Array.isArray(receipts) ? receipts : [];\r\n\r\n        if (receiptList.length > 0) {\r\n          return (\r\n            <>\r\n              <Divider orientation=\"left\">\r\n                <Space>\r\n                  <InboxOutlined />\r\n                  <span>GRN Receipts ({receiptList.length})</span>\r\n                </Space>\r\n              </Divider>\r\n\r\n              <Table\r\n                columns={[\r\n                  {\r\n                    title: 'GRN Number',\r\n                    dataIndex: 'grn_number',\r\n                    key: 'grn_number',\r\n                    render: (text: string) => (\r\n                      <Tag color=\"blue\" icon={<FileTextOutlined />}>\r\n                        {text}\r\n                      </Tag>\r\n                    ),\r\n                  },\r\n                  {\r\n                    title: 'GRN Date',\r\n                    dataIndex: 'grn_date',\r\n                    key: 'grn_date',\r\n                    render: (date: string) => dayjs(date).format('DD/MM/YYYY'),\r\n                  },\r\n                  {\r\n                    title: 'Vendor Invoice',\r\n                    key: 'vendor_invoice',\r\n                    render: (record: any) => (\r\n                      <div>\r\n                        {record.vendor_invoice_no ? (\r\n                          <>\r\n                            <div>{record.vendor_invoice_no}</div>\r\n                            {record.vendor_invoice_date && (\r\n                              <div style={{ fontSize: '12px', color: '#888' }}>\r\n                                {dayjs(record.vendor_invoice_date).format(\r\n                                  'DD/MM/YYYY'\r\n                                )}\r\n                              </div>\r\n                            )}\r\n                          </>\r\n                        ) : (\r\n                          <Text type=\"secondary\">-</Text>\r\n                        )}\r\n                      </div>\r\n                    ),\r\n                  },\r\n                  {\r\n                    title: 'Total Amount',\r\n                    dataIndex: 'total_amount',\r\n                    key: 'total_amount',\r\n                    render: (amount: number) => (\r\n                      <Text strong>\r\n                        \r\n                        {(Number(amount) || 0).toLocaleString('en-IN', {\r\n                          minimumFractionDigits: 2,\r\n                        })}\r\n                      </Text>\r\n                    ),\r\n                  },\r\n                  {\r\n                    title: 'Received By',\r\n                    dataIndex: 'received_by_name',\r\n                    key: 'received_by_name',\r\n                    render: (name: string) => name || '-',\r\n                  },\r\n                ]}\r\n                dataSource={receiptList}\r\n                rowKey={record => record._id || record.id}\r\n                pagination={false}\r\n                size=\"small\"\r\n                bordered\r\n              />\r\n            </>\r\n          );\r\n        }\r\n        return null;\r\n      })()}\r\n\r\n      {/* PO vs GRN Comparison */}\r\n      {comparisonData && (\r\n        <>\r\n          <Divider orientation=\"left\">\r\n            <Space>\r\n              <CheckCircleOutlined />\r\n              <span>Ordered vs Received Comparison</span>\r\n            </Space>\r\n          </Divider>\r\n\r\n          <Table\r\n            columns={[\r\n              {\r\n                title: 'Product',\r\n                key: 'product',\r\n                render: (record: any) => (\r\n                  <div>\r\n                    <Text strong>{record.product_name || 'N/A'}</Text>\r\n                    {record.variant_name && (\r\n                      <div style={{ fontSize: '12px', color: '#888' }}>\r\n                        {record.variant_name}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ),\r\n              },\r\n              {\r\n                title: 'Ordered',\r\n                dataIndex: 'ordered_quantity',\r\n                key: 'ordered_quantity',\r\n                render: (qty: number) => <Tag color=\"blue\">{qty || 0}</Tag>,\r\n              },\r\n              {\r\n                title: 'Received',\r\n                dataIndex: 'received_quantity',\r\n                key: 'received_quantity',\r\n                render: (qty: number, record: any) => {\r\n                  const ordered = Number(record.ordered_quantity) || 0;\r\n                  const received = Number(qty) || 0;\r\n                  const pending = ordered - received;\r\n                  const percentage =\r\n                    ordered > 0 ? ((received / ordered) * 100).toFixed(1) : '0';\r\n\r\n                  return (\r\n                    <div>\r\n                      <Tag\r\n                        color={\r\n                          received === ordered\r\n                            ? 'green'\r\n                            : received > 0\r\n                              ? 'orange'\r\n                              : 'default'\r\n                        }\r\n                      >\r\n                        {received}\r\n                      </Tag>\r\n                      {pending > 0 && (\r\n                        <div\r\n                          style={{\r\n                            fontSize: '12px',\r\n                            color: '#888',\r\n                            marginTop: 4,\r\n                          }}\r\n                        >\r\n                          Pending: {pending} ({percentage}% fulfilled)\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  );\r\n                },\r\n              },\r\n              {\r\n                title: 'Status',\r\n                key: 'fulfillment_status',\r\n                render: (record: any) => {\r\n                  const ordered = Number(record.ordered_quantity) || 0;\r\n                  const received = Number(record.received_quantity) || 0;\r\n\r\n                  if (received === 0) {\r\n                    return <Tag color=\"default\">Not Received</Tag>;\r\n                  } else if (received === ordered) {\r\n                    return (\r\n                      <Tag color=\"green\" icon={<CheckCircleOutlined />}>\r\n                        Fully Received\r\n                      </Tag>\r\n                    );\r\n                  } else if (received < ordered) {\r\n                    return <Tag color=\"orange\">Partially Received</Tag>;\r\n                  } else {\r\n                    return <Tag color=\"red\">Over Received</Tag>;\r\n                  }\r\n                },\r\n              },\r\n            ]}\r\n            dataSource={\r\n              (comparisonData as any)?.result?.items ||\r\n              (comparisonData as any)?.items ||\r\n              []\r\n            }\r\n            rowKey={(record, index) => `comparison-${index}`}\r\n            pagination={false}\r\n            size=\"small\"\r\n            bordered\r\n          />\r\n        </>\r\n      )}\r\n\r\n      {purchaseOrder.notes && (\r\n        <>\r\n          <Divider orientation=\"left\">Notes</Divider>\r\n          <div\r\n            style={{\r\n              padding: '12px',\r\n              background: '#fafafa',\r\n              borderRadius: '4px',\r\n            }}\r\n          >\r\n            {purchaseOrder.notes}\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Payment History */}\r\n      <Divider orientation=\"left\">\r\n        <Space>\r\n          <CreditCardOutlined />\r\n          <span>Payment History</span>\r\n        </Space>\r\n      </Divider>\r\n\r\n      {(() => {\r\n        // Handle different response structures from backend\r\n        // Backend might return: { result: { payments: [...], summary: {...} } } or { result: [...] } or just [...]\r\n        let payments: any[] = [];\r\n        if (paymentsData) {\r\n          const data = paymentsData as any;\r\n          if (Array.isArray(data)) {\r\n            payments = data;\r\n          } else if (data.result) {\r\n            if (Array.isArray(data.result)) {\r\n              payments = data.result;\r\n            } else if (\r\n              data.result.payments &&\r\n              Array.isArray(data.result.payments)\r\n            ) {\r\n              payments = data.result.payments;\r\n            }\r\n          }\r\n        }\r\n        const paymentList = payments;\r\n\r\n        if (paymentList.length === 0) {\r\n          return (\r\n            <div\r\n              style={{ padding: '24px', textAlign: 'center', color: '#999' }}\r\n            >\r\n              <CreditCardOutlined\r\n                style={{ fontSize: '32px', marginBottom: '8px' }}\r\n              />\r\n              <div>No payments recorded yet</div>\r\n            </div>\r\n          );\r\n        }\r\n\r\n        const paymentColumns = [\r\n          {\r\n            title: 'Payment Date',\r\n            dataIndex: 'payment_date',\r\n            key: 'payment_date',\r\n            sorter: (a: any, b: any) =>\r\n              dayjs(a.payment_date).unix() - dayjs(b.payment_date).unix(),\r\n            render: (date: string, record: any) => (\r\n              <Space>\r\n                <CalendarOutlined />\r\n                {dayjs(date).format('DD/MM/YYYY')}\r\n                {record.payment_type === 'advance' && (\r\n                  <Tag color=\"orange\">Advance</Tag>\r\n                )}\r\n              </Space>\r\n            ),\r\n          },\r\n          {\r\n            title: 'Payment Amount',\r\n            dataIndex: 'payment_amount',\r\n            key: 'payment_amount',\r\n            render: (amount: number) => (\r\n              <Text strong style={{ color: '#52c41a', fontSize: '15px' }}>\r\n                \r\n                {(Number(amount) || 0).toLocaleString('en-IN', {\r\n                  minimumFractionDigits: 2,\r\n                })}\r\n              </Text>\r\n            ),\r\n          },\r\n          {\r\n            title: 'Payment Mode',\r\n            dataIndex: 'payment_mode',\r\n            key: 'payment_mode',\r\n            render: (mode: string) => {\r\n              const modeColors: Record<string, string> = {\r\n                cash: 'green',\r\n                upi: 'blue',\r\n                card: 'purple',\r\n                bank_transfer: 'cyan',\r\n                cheque: 'orange',\r\n                other: 'default',\r\n              };\r\n              return (\r\n                <Tag color={modeColors[mode] || 'default'}>\r\n                  {mode?.replace('_', ' ').toUpperCase() || 'N/A'}\r\n                </Tag>\r\n              );\r\n            },\r\n          },\r\n          {\r\n            title: 'Transaction Details',\r\n            key: 'transaction_details',\r\n            render: (record: any) => {\r\n              if (record.cheque_number) {\r\n                return (\r\n                  <div>\r\n                    <div>Cheque: {record.cheque_number}</div>\r\n                    {record.bank_name && (\r\n                      <div style={{ fontSize: '12px', color: '#888' }}>\r\n                        Bank: {record.bank_name}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              }\r\n              if (record.transaction_id) {\r\n                return (\r\n                  <div>\r\n                    <div>Txn ID: {record.transaction_id}</div>\r\n                    {record.bank_name && (\r\n                      <div style={{ fontSize: '12px', color: '#888' }}>\r\n                        Bank: {record.bank_name}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              }\r\n              if (record.reference_number) {\r\n                return <div>Ref: {record.reference_number}</div>;\r\n              }\r\n              return '-';\r\n            },\r\n          },\r\n          {\r\n            title: 'Notes',\r\n            dataIndex: 'notes',\r\n            key: 'notes',\r\n            render: (notes: string) => notes || '-',\r\n          },\r\n          {\r\n            title: 'Paid By',\r\n            dataIndex: 'paid_by_name',\r\n            key: 'paid_by_name',\r\n            render: (name: string) => name || '-',\r\n          },\r\n        ];\r\n\r\n        // Calculate payment summary\r\n        const totalPaid = paymentList.reduce(\r\n          (sum: number, payment: any) =>\r\n            sum + (Number(payment.payment_amount) || 0),\r\n          0\r\n        );\r\n\r\n        // Determine advance payments (payments made before goods received)\r\n        const advancePayments = paymentList.filter((payment: any) => {\r\n          // If payment date is before any GRN date, or if PO was sent/confirmed when payment was made\r\n          // For simplicity, we'll check if payment was made when PO status was sent/confirmed\r\n          // This is a heuristic - in production, you'd track this in the payment record\r\n          return (\r\n            payment.payment_type === 'advance' ||\r\n            (payment.payment_date &&\r\n              purchaseOrder?.actual_delivery_date &&\r\n              new Date(payment.payment_date) <\r\n                new Date(purchaseOrder.actual_delivery_date))\r\n          );\r\n        });\r\n\r\n        const advanceTotal = advancePayments.reduce(\r\n          (sum: number, payment: any) =>\r\n            sum + (Number(payment.payment_amount) || 0),\r\n          0\r\n        );\r\n\r\n        const normalTotal = totalPaid - advanceTotal;\r\n        const totalAmount = Number(purchaseOrder?.total_amount) || 0;\r\n        const outstandingAmount =\r\n          Number(purchaseOrder?.outstanding_amount) || 0;\r\n        const isFullyPaid = outstandingAmount <= 0;\r\n\r\n        return (\r\n          <>\r\n            {/* Payment Summary Card */}\r\n            <div\r\n              style={{\r\n                background: '#f6f8fa',\r\n                padding: 16,\r\n                borderRadius: 8,\r\n                marginBottom: 16,\r\n                border: '1px solid #e8e8e8',\r\n              }}\r\n            >\r\n              <Space\r\n                direction=\"vertical\"\r\n                style={{ width: '100%' }}\r\n                size=\"small\"\r\n              >\r\n                <div\r\n                  style={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    alignItems: 'center',\r\n                  }}\r\n                >\r\n                  <Text strong style={{ fontSize: '14px' }}>\r\n                    Payment Summary\r\n                  </Text>\r\n                  {isFullyPaid && (\r\n                    <Tag color=\"green\" icon={<CheckCircleOutlined />}>\r\n                      Fully Paid\r\n                    </Tag>\r\n                  )}\r\n                </div>\r\n                <Divider style={{ margin: '8px 0' }} />\r\n                <div\r\n                  style={{ display: 'flex', justifyContent: 'space-between' }}\r\n                >\r\n                  <Text>Total Amount:</Text>\r\n                  <Text strong>\r\n                    \r\n                    {totalAmount.toLocaleString('en-IN', {\r\n                      minimumFractionDigits: 2,\r\n                    })}\r\n                  </Text>\r\n                </div>\r\n                <div\r\n                  style={{ display: 'flex', justifyContent: 'space-between' }}\r\n                >\r\n                  <Text>Total Paid:</Text>\r\n                  <Text strong style={{ color: '#52c41a' }}>\r\n                    \r\n                    {totalPaid.toLocaleString('en-IN', {\r\n                      minimumFractionDigits: 2,\r\n                    })}\r\n                  </Text>\r\n                </div>\r\n                {advanceTotal > 0 && (\r\n                  <div\r\n                    style={{\r\n                      display: 'flex',\r\n                      justifyContent: 'space-between',\r\n                      fontSize: '12px',\r\n                      color: '#666',\r\n                    }}\r\n                  >\r\n                    <Text> Advance Payments:</Text>\r\n                    <Text>\r\n                      \r\n                      {advanceTotal.toLocaleString('en-IN', {\r\n                        minimumFractionDigits: 2,\r\n                      })}\r\n                    </Text>\r\n                  </div>\r\n                )}\r\n                {normalTotal > 0 && (\r\n                  <div\r\n                    style={{\r\n                      display: 'flex',\r\n                      justifyContent: 'space-between',\r\n                      fontSize: '12px',\r\n                      color: '#666',\r\n                    }}\r\n                  >\r\n                    <Text>  Normal Payments:</Text>\r\n                    <Text>\r\n                      \r\n                      {normalTotal.toLocaleString('en-IN', {\r\n                        minimumFractionDigits: 2,\r\n                      })}\r\n                    </Text>\r\n                  </div>\r\n                )}\r\n                <div\r\n                  style={{ display: 'flex', justifyContent: 'space-between' }}\r\n                >\r\n                  <Text strong>Outstanding:</Text>\r\n                  <Text\r\n                    strong\r\n                    style={{\r\n                      color: outstandingAmount > 0 ? '#ff4d4f' : '#52c41a',\r\n                    }}\r\n                  >\r\n                    \r\n                    {outstandingAmount.toLocaleString('en-IN', {\r\n                      minimumFractionDigits: 2,\r\n                    })}\r\n                  </Text>\r\n                </div>\r\n                <div\r\n                  style={{\r\n                    display: 'flex',\r\n                    justifyContent: 'space-between',\r\n                    fontSize: '12px',\r\n                    color: '#666',\r\n                  }}\r\n                >\r\n                  <Text>Total Payments:</Text>\r\n                  <Text>\r\n                    {paymentList.length} transaction\r\n                    {paymentList.length !== 1 ? 's' : ''}\r\n                  </Text>\r\n                </div>\r\n              </Space>\r\n            </div>\r\n\r\n            <Table\r\n              columns={paymentColumns}\r\n              dataSource={paymentList}\r\n              rowKey={record => record._id || record.id}\r\n              pagination={false}\r\n              size=\"small\"\r\n              bordered\r\n            />\r\n          </>\r\n        );\r\n      })()}\r\n\r\n      {purchaseOrder.notes && (\r\n        <>\r\n          <Divider orientation=\"left\">Notes</Divider>\r\n          <div\r\n            style={{\r\n              padding: '12px',\r\n              background: '#fafafa',\r\n              borderRadius: '4px',\r\n            }}\r\n          >\r\n            {purchaseOrder.notes}\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {purchaseOrder.terms_conditions && (\r\n        <>\r\n          <Divider orientation=\"left\">Terms & Conditions</Divider>\r\n          <div\r\n            style={{\r\n              padding: '12px',\r\n              background: '#fafafa',\r\n              borderRadius: '4px',\r\n            }}\r\n          >\r\n            {purchaseOrder.terms_conditions}\r\n          </div>\r\n        </>\r\n      )}\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default POViewModal;\r\n","import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Modal,\r\n  Form,\r\n  Input,\r\n  InputNumber,\r\n  DatePicker,\r\n  Select,\r\n  message,\r\n  Space,\r\n  Typography,\r\n  Divider,\r\n  Alert,\r\n  Button,\r\n  Row,\r\n  Col,\r\n} from 'antd';\r\nimport {\r\n  DollarOutlined,\r\n  CalendarOutlined,\r\n  CreditCardOutlined,\r\n} from '@ant-design/icons';\r\nimport { useCreatePOPaymentMutation } from '../../services/redux/api/endpoints/purchaseOrder.endpoints';\r\nimport { getCurrentUser } from '../../helpers/auth';\r\nimport SessionStorageEncryption from '../../helpers/encryption';\r\nimport dayjs from 'dayjs';\r\n\r\nconst { TextArea } = Input;\r\nconst { Option } = Select;\r\nconst { Text } = Typography;\r\n\r\ninterface POPaymentModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  purchaseOrder: any;\r\n  onSuccess?: () => void;\r\n}\r\n\r\nconst POPaymentModal: React.FC<POPaymentModalProps> = ({\r\n  open,\r\n  onClose,\r\n  purchaseOrder,\r\n  onSuccess,\r\n}) => {\r\n  const [form] = Form.useForm();\r\n  const [createPayment, { isLoading }] = useCreatePOPaymentMutation();\r\n  const [paymentMode, setPaymentMode] = useState<string>('cash');\r\n  const currentUser = getCurrentUser();\r\n  \r\n  // Safely convert amounts to numbers\r\n  const totalAmount = Number(purchaseOrder?.total_amount) || 0;\r\n  const paidAmount = Number(purchaseOrder?.paid_amount) || 0;\r\n  const calculatedOutstanding = Math.max(0, totalAmount - paidAmount);\r\n  \r\n  // Use outstanding_amount from PO if available and valid, otherwise calculate it\r\n  const outstandingAmountFromPO = purchaseOrder?.outstanding_amount !== undefined && purchaseOrder?.outstanding_amount !== null\r\n    ? Number(purchaseOrder.outstanding_amount)\r\n    : null;\r\n  \r\n  // Ensure outstandingAmount is always a valid number (use PO value if valid, otherwise calculated)\r\n  const numOutstandingAmount = outstandingAmountFromPO !== null && !isNaN(outstandingAmountFromPO)\r\n    ? Math.max(0, outstandingAmountFromPO)\r\n    : calculatedOutstanding;\r\n  \r\n  // Get multi-tenant fields from purchase order or user context\r\n  const scopeData = SessionStorageEncryption.getItem('scope');\r\n  const organisationId = purchaseOrder?.organisation_id || currentUser?.organisation_id || scopeData?.organisationId;\r\n  const branchId = purchaseOrder?.branch_id || currentUser?.branch_id || scopeData?.branchId;\r\n  const tenantId = purchaseOrder?.tenant_id || scopeData?.tenantId;\r\n  \r\n  useEffect(() => {\r\n    if (open && purchaseOrder) {\r\n      // Don't auto-fill amount - let user enter partial payment amount\r\n      form.setFieldsValue({\r\n        payment_date: dayjs(),\r\n        payment_amount: undefined, // Don't pre-fill - allow user to enter partial amount\r\n        payment_mode: 'bank_transfer',\r\n        transaction_id: undefined,\r\n        cheque_number: undefined,\r\n        bank_name: undefined,\r\n        reference_number: undefined,\r\n      });\r\n      setPaymentMode('bank_transfer');\r\n    }\r\n  }, [open, purchaseOrder, form]);\r\n  \r\n  // Helper function to set partial payment amount\r\n  const setPartialAmount = (percentage: number) => {\r\n    const amount = (numOutstandingAmount * percentage) / 100;\r\n    form.setFieldsValue({ payment_amount: Number(amount.toFixed(2)) });\r\n  };\r\n  \r\n  const handleSubmit = async () => {\r\n    try {\r\n      const values = await form.validateFields();\r\n      \r\n      // Validate payment amount\r\n      if (values.payment_amount <= 0) {\r\n        message.error('Payment amount must be greater than 0');\r\n        return;\r\n      }\r\n      \r\n      if (values.payment_amount > numOutstandingAmount) {\r\n        message.error(`Payment amount cannot exceed outstanding amount of ${numOutstandingAmount.toFixed(2)}`);\r\n        return;\r\n      }\r\n      \r\n      // Validate PO status - payments allowed only for sent, confirmed, partially_received, fully_received, or closed\r\n      const allowedStatuses = ['sent', 'confirmed', 'partially_received', 'fully_received', 'closed'];\r\n      const currentStatus = purchaseOrder?.status;\r\n      \r\n      if (!allowedStatuses.includes(currentStatus)) {\r\n        message.error(`Payments cannot be recorded for PO in \"${currentStatus}\" status. PO must be sent to vendor first.`);\r\n        return;\r\n      }\r\n      \r\n      // Validate multi-tenant fields\r\n      if (!organisationId || !tenantId) {\r\n        message.error('Organisation and Tenant information is required');\r\n        return;\r\n      }\r\n      \r\n      // Determine payment type (advance or normal)\r\n      const isAdvancePayment = ['sent', 'confirmed'].includes(currentStatus) && \r\n                                (!purchaseOrder?.is_partially_received && !purchaseOrder?.is_fully_received);\r\n      \r\n      // Validate purchase order ID\r\n      if (!purchaseOrder?._id) {\r\n        message.error('Purchase Order ID is missing');\r\n        return;\r\n      }\r\n      \r\n      const poId = purchaseOrder._id;\r\n      \r\n      // Build payload according to backend model\r\n      // Note: purchase_order_id will be extracted from payload and used in URL path\r\n      const payload: any = {\r\n        purchase_order_id: poId, // This will be extracted and used in URL: /purchase_orders/{poId}/payments\r\n        payment_date: values.payment_date.format('YYYY-MM-DD'),\r\n        payment_amount: values.payment_amount,\r\n        payment_mode: values.payment_mode,\r\n        organisation_id: organisationId,\r\n        tenant_id: tenantId,\r\n        notes: values.notes || undefined,\r\n        paid_by_id: currentUser?._id || undefined,\r\n        paid_by_name: currentUser?.username || currentUser?.name || undefined,\r\n      };\r\n      \r\n      // Add branch_id if available\r\n      if (branchId) {\r\n        payload.branch_id = branchId;\r\n      }\r\n      \r\n      // Map payment reference fields based on payment mode\r\n      if (values.payment_mode === 'cheque') {\r\n        if (values.cheque_number) payload.cheque_number = values.cheque_number;\r\n        if (values.bank_name) payload.bank_name = values.bank_name;\r\n      } else if (['upi', 'card', 'bank_transfer'].includes(values.payment_mode)) {\r\n        if (values.transaction_id) payload.transaction_id = values.transaction_id;\r\n        if (values.bank_name && values.payment_mode === 'bank_transfer') {\r\n          payload.bank_name = values.bank_name;\r\n        }\r\n      }\r\n      \r\n      // Add reference number if provided\r\n      if (values.reference_number) {\r\n        payload.reference_number = values.reference_number;\r\n      }\r\n      \r\n      await createPayment(payload).unwrap();\r\n      \r\n      // Show appropriate success message based on payment amount and type\r\n      const remainingAmount = numOutstandingAmount - values.payment_amount;\r\n      const paymentType = isAdvancePayment ? 'Advance ' : '';\r\n      \r\n      if (remainingAmount > 0) {\r\n        message.success(\r\n          `${paymentType}Payment of ${values.payment_amount.toFixed(2)} recorded successfully! Remaining amount: ${remainingAmount.toFixed(2)}`,\r\n          5\r\n        );\r\n      } else {\r\n        message.success(`${paymentType}Payment recorded successfully! Purchase order is now fully paid.`, 5);\r\n      }\r\n      \r\n      form.resetFields();\r\n      onSuccess?.();\r\n      onClose();\r\n    } catch (error: any) {\r\n      console.error('Payment creation error:', error);\r\n      const errorMessage = error?.data?.message || error?.data?.error || error?.message || 'Failed to record payment';\r\n      message.error(errorMessage);\r\n    }\r\n  };\r\n  \r\n  const handleCancel = () => {\r\n    form.resetFields();\r\n    onClose();\r\n  };\r\n  \r\n  return (\r\n    <Modal\r\n      title={\r\n        <Space>\r\n          <DollarOutlined style={{ color: '#52c41a' }} />\r\n          <span>Record Payment</span>\r\n        </Space>\r\n      }\r\n      open={open}\r\n      onCancel={handleCancel}\r\n      width={800}\r\n      footer={[\r\n        <Space key=\"footer\" style={{ width: '100%', justifyContent: 'flex-end' }}>\r\n          <Button onClick={handleCancel}>Cancel</Button>\r\n          <Button\r\n            type=\"primary\"\r\n            onClick={handleSubmit}\r\n            loading={isLoading}\r\n            style={{ backgroundColor: '#52c41a', borderColor: '#52c41a' }}\r\n          >\r\n            Record Payment\r\n          </Button>\r\n        </Space>\r\n      ]}\r\n    >\r\n      <Alert\r\n        message=\"Payment Information\"\r\n        description={\r\n          <div>\r\n            <div><strong>PO Number:</strong> {purchaseOrder?.po_number || 'N/A'}</div>\r\n            {numOutstandingAmount > 0 && (\r\n              <div style={{ marginTop: 8, fontSize: '12px', color: '#666' }}>\r\n                 You can record partial payments. Multiple payments can be made until the full amount is paid.\r\n              </div>\r\n            )}\r\n          </div>\r\n        }\r\n        type=\"info\"\r\n        showIcon\r\n        style={{ marginBottom: 16 }}\r\n      />\r\n      \r\n      {/* Payment Summary */}\r\n      <div style={{ \r\n        background: '#f6f8fa', \r\n        padding: 16, \r\n        borderRadius: 8, \r\n        marginBottom: 16 \r\n      }}>\r\n        <Space direction=\"vertical\" style={{ width: '100%' }} size=\"small\">\r\n          <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n            <Text strong>Total Amount:</Text>\r\n            <Text strong>{(Number(totalAmount) || 0).toLocaleString('en-IN', { \r\n              minimumFractionDigits: 2, \r\n              maximumFractionDigits: 2 \r\n            })}</Text>\r\n          </div>\r\n          <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n            <Text>Paid Amount:</Text>\r\n            <Text style={{ color: '#52c41a' }}>\r\n              {(Number(paidAmount) || 0).toLocaleString('en-IN', { \r\n                minimumFractionDigits: 2, \r\n                maximumFractionDigits: 2 \r\n              })}\r\n            </Text>\r\n          </div>\r\n          {paidAmount > 0 && (\r\n            <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '12px', color: '#666' }}>\r\n              <Text>Payment Progress:</Text>\r\n              <Text>\r\n                {((Number(paidAmount) / Number(totalAmount)) * 100).toFixed(1)}%\r\n              </Text>\r\n            </div>\r\n          )}\r\n          <Divider style={{ margin: '8px 0' }} />\r\n          <div style={{ display: 'flex', justifyContent: 'space-between' }}>\r\n            <Text strong>Outstanding Amount:</Text>\r\n            <Text strong style={{ color: '#ff4d4f', fontSize: '16px' }}>\r\n              {numOutstandingAmount.toLocaleString('en-IN', { \r\n                minimumFractionDigits: 2, \r\n                maximumFractionDigits: 2 \r\n              })}\r\n            </Text>\r\n          </div>\r\n        </Space>\r\n      </div>\r\n      \r\n      <Form\r\n        form={form}\r\n        layout=\"vertical\"\r\n        onFinish={handleSubmit}\r\n      >\r\n        <Row gutter={16}>\r\n          <Col xs={24} sm={12}>\r\n            <Form.Item\r\n              name=\"payment_date\"\r\n              label={\r\n                <Space>\r\n                  <CalendarOutlined />\r\n                  <span>Payment Date</span>\r\n                </Space>\r\n              }\r\n              rules={[{ required: true, message: 'Please select payment date' }]}\r\n            >\r\n              <DatePicker\r\n                style={{ width: '100%' }}\r\n                format=\"YYYY-MM-DD\"\r\n                disabledDate={(current) => current && current > dayjs().endOf('day')}\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n          \r\n          <Col xs={24} sm={12}>\r\n            <Form.Item\r\n              name=\"payment_amount\"\r\n              label={\r\n                <Space>\r\n                  <DollarOutlined />\r\n                  <span>Payment Amount</span>\r\n                  <span style={{ color: 'red' }}>*</span>\r\n                </Space>\r\n              }\r\n              extra={\r\n                numOutstandingAmount > 0 ? (\r\n                  <div style={{ marginTop: 8 }}>\r\n                    <Text type=\"secondary\" style={{ fontSize: '12px', display: 'block', marginBottom: 8 }}>\r\n                      Quick amount selection (partial payments allowed):\r\n                    </Text>\r\n                    <Space size=\"small\" wrap>\r\n                      <Button \r\n                        size=\"small\" \r\n                        type=\"link\" \r\n                        onClick={() => setPartialAmount(25)}\r\n                        style={{ padding: '0 8px', fontSize: '12px' }}\r\n                      >\r\n                        25%\r\n                      </Button>\r\n                      <Button \r\n                        size=\"small\" \r\n                        type=\"link\" \r\n                        onClick={() => setPartialAmount(50)}\r\n                        style={{ padding: '0 8px', fontSize: '12px' }}\r\n                      >\r\n                        50%\r\n                      </Button>\r\n                      <Button \r\n                        size=\"small\" \r\n                        type=\"link\" \r\n                        onClick={() => setPartialAmount(75)}\r\n                        style={{ padding: '0 8px', fontSize: '12px' }}\r\n                      >\r\n                        75%\r\n                      </Button>\r\n                      <Button \r\n                        size=\"small\" \r\n                        type=\"link\" \r\n                        onClick={() => setPartialAmount(100)}\r\n                        style={{ padding: '0 8px', fontSize: '12px', color: '#52c41a' }}\r\n                      >\r\n                        Full ({numOutstandingAmount.toFixed(2)})\r\n                      </Button>\r\n                    </Space>\r\n                  </div>\r\n                ) : (\r\n                  <Text type=\"secondary\" style={{ fontSize: '12px' }}>\r\n                    Enter payment amount (max: {numOutstandingAmount.toFixed(2)})\r\n                  </Text>\r\n                )\r\n              }\r\n              rules={[\r\n                { required: true, message: 'Please enter payment amount' },\r\n                { type: 'number', min: 0.01, message: 'Amount must be greater than 0' },\r\n                {\r\n                  validator: (_, value) => {\r\n                    if (value && value > numOutstandingAmount) {\r\n                      return Promise.reject(new Error(`Amount cannot exceed outstanding amount of ${numOutstandingAmount.toFixed(2)}`));\r\n                    }\r\n                    return Promise.resolve();\r\n                  },\r\n                },\r\n              ]}\r\n            >\r\n              <InputNumber\r\n                style={{ width: '100%' }}\r\n                prefix=\"\"\r\n                placeholder={`Enter amount (max: ${numOutstandingAmount.toFixed(2)})`}\r\n                min={0.01}\r\n                max={numOutstandingAmount}\r\n                step={0.01}\r\n                precision={2}\r\n                formatter={(value) => `${value}`.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')}\r\n                parser={(value) => {\r\n                  const parsed = value?.replace(/\\$\\s?|(,*)/g, '') || '0';\r\n                  return Number(parsed) || 0;\r\n                }}\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n        </Row>\r\n        \r\n        <Row gutter={16}>\r\n          <Col xs={24} sm={12}>\r\n            <Form.Item\r\n              name=\"payment_mode\"\r\n              label={\r\n                <Space>\r\n                  <CreditCardOutlined />\r\n                  <span>Payment Mode</span>\r\n                  <span style={{ color: 'red' }}>*</span>\r\n                </Space>\r\n              }\r\n              rules={[{ required: true, message: 'Please select payment mode' }]}\r\n            >\r\n              <Select \r\n                placeholder=\"Select payment mode\"\r\n                onChange={(value) => setPaymentMode(value)}\r\n              >\r\n                <Option value=\"cash\">Cash</Option>\r\n                <Option value=\"upi\">UPI</Option>\r\n                <Option value=\"card\">Card</Option>\r\n                <Option value=\"bank_transfer\">Bank Transfer</Option>\r\n                <Option value=\"cheque\">Cheque</Option>\r\n                <Option value=\"other\">Other</Option>\r\n              </Select>\r\n            </Form.Item>\r\n          </Col>\r\n          \r\n          {/* Reference Number - Show in same row as Payment Mode when not 'other' */}\r\n          {paymentMode !== 'other' && (\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"reference_number\"\r\n                label=\"Reference Number (Optional)\"\r\n                extra=\"Additional reference number if needed\"\r\n              >\r\n                <Input placeholder=\"Optional: Enter reference number\" />\r\n              </Form.Item>\r\n            </Col>\r\n          )}\r\n        </Row>\r\n        \r\n        {/* Conditional fields based on payment mode */}\r\n        {paymentMode === 'cheque' && (\r\n          <Row gutter={16}>\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"cheque_number\"\r\n                label=\"Cheque Number\"\r\n              >\r\n                <Input placeholder=\"Enter cheque number\" />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"bank_name\"\r\n                label=\"Bank Name\"\r\n              >\r\n                <Input placeholder=\"Enter bank name\" />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n        )}\r\n        \r\n        {['upi', 'card'].includes(paymentMode) && (\r\n          <Row gutter={16}>\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"transaction_id\"\r\n                label=\"Transaction ID\"\r\n              >\r\n                <Input placeholder=\"Enter transaction ID\" />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n        )}\r\n        \r\n        {paymentMode === 'bank_transfer' && (\r\n          <Row gutter={16}>\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"transaction_id\"\r\n                label=\"Transaction ID\"\r\n              >\r\n                <Input placeholder=\"Enter transaction ID or reference number\" />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"bank_name\"\r\n                label=\"Bank Name\"\r\n              >\r\n                <Input placeholder=\"Enter bank name\" />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n        )}\r\n        \r\n        {paymentMode === 'other' && (\r\n          <Row gutter={16}>\r\n            <Col xs={24} sm={12}>\r\n              <Form.Item\r\n                name=\"reference_number\"\r\n                label=\"Reference Number\"\r\n              >\r\n                <Input placeholder=\"Enter reference number\" />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n        )}\r\n        \r\n        <Row gutter={16}>\r\n          <Col xs={24}>\r\n            <Form.Item\r\n              name=\"notes\"\r\n              label=\"Notes\"\r\n            >\r\n              <TextArea\r\n                rows={3}\r\n                placeholder=\"Optional: Add notes about this payment\"\r\n              />\r\n            </Form.Item>\r\n          </Col>\r\n        </Row>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default POPaymentModal;\r\n\r\n","import React, { useEffect } from 'react';\r\nimport {\r\n  Modal,\r\n  Descriptions,\r\n  Table,\r\n  Tag,\r\n  Space,\r\n  Divider,\r\n  Statistic,\r\n  Row,\r\n  Col,\r\n  Alert,\r\n} from 'antd';\r\nimport {\r\n  FileTextOutlined,\r\n  InboxOutlined,\r\n  CalendarOutlined,\r\n  DollarOutlined,\r\n  CheckCircleOutlined,\r\n} from '@ant-design/icons';\r\nimport { useGetPurchaseOrderReceiptByIdQuery } from '../../services/redux/api/endpoints';\r\nimport dayjs from 'dayjs';\r\n\r\ninterface GRNViewModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  grnId?: string;\r\n  grnData?: any;\r\n}\r\n\r\nconst GRNViewModal: React.FC<GRNViewModalProps> = ({\r\n  open,\r\n  onClose,\r\n  grnId,\r\n  grnData,\r\n}) => {\r\n  const { data: grnDetailData, isLoading } = useGetPurchaseOrderReceiptByIdQuery(grnId || '', {\r\n    skip: !open || !grnId || !!grnData,\r\n  });\r\n\r\n  const grn = grnData || (grnDetailData as any)?.result || {};\r\n\r\n  // Item columns\r\n  const itemColumns = [\r\n    {\r\n      title: 'Product',\r\n      key: 'product',\r\n      width: 200,\r\n      render: (record: any) => (\r\n        <div>\r\n          <strong>{record.product_name || record.ProductItem?.name || '-'}</strong>\r\n          {record.variant_name && (\r\n            <div style={{ fontSize: '11px', color: '#888' }}>\r\n              {record.variant_name}\r\n            </div>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Ordered Qty',\r\n      key: 'ordered_quantity',\r\n      width: 100,\r\n      render: (record: any) => (\r\n        <Tag color=\"blue\">{record.ordered_quantity || 0}</Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Received Qty',\r\n      key: 'received_quantity',\r\n      width: 100,\r\n      render: (record: any) => (\r\n        <Tag color=\"green\">{record.received_quantity || 0}</Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Rejected Qty',\r\n      key: 'rejected_quantity',\r\n      width: 100,\r\n      render: (record: any) => (\r\n        record.rejected_quantity > 0 ? (\r\n          <Tag color=\"red\">{record.rejected_quantity}</Tag>\r\n        ) : (\r\n          <span style={{ color: '#999' }}>-</span>\r\n        )\r\n      ),\r\n    },\r\n    {\r\n      title: 'Accepted Qty',\r\n      key: 'accepted_quantity',\r\n      width: 100,\r\n      render: (record: any) => (\r\n        <strong style={{ color: '#52c41a' }}>\r\n          {record.accepted_quantity || 0}\r\n        </strong>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Unit Price',\r\n      key: 'unit_price',\r\n      width: 120,\r\n      render: (record: any) => (\r\n        <span>{(Number(record.unit_price) || 0).toFixed(2)}</span>\r\n      ),\r\n    },\r\n    {\r\n      title: 'GST %',\r\n      key: 'tax_percentage',\r\n      width: 80,\r\n      render: (record: any) => (\r\n        <span>{record.tax_percentage || 0}%</span>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Batch No',\r\n      key: 'batch_no',\r\n      width: 120,\r\n      render: (record: any) => record.batch_no || '-',\r\n    },\r\n    {\r\n      title: 'Expiry Date',\r\n      key: 'expiry_date',\r\n      width: 120,\r\n      render: (record: any) => (\r\n        record.expiry_date ? dayjs(record.expiry_date).format('DD/MM/YYYY') : '-'\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <Modal\r\n      title={\r\n        <Space>\r\n          <FileTextOutlined style={{ color: '#1890ff' }} />\r\n          <span>GRN Details - {grn.grn_number}</span>\r\n        </Space>\r\n      }\r\n      open={open}\r\n      onCancel={onClose}\r\n      width={1400}\r\n      footer={null}\r\n    >\r\n      <Alert\r\n        message=\"Goods Receipt Note (GRN)\"\r\n        description=\"Complete details of the goods receipt note including all received items and financial information.\"\r\n        type=\"info\"\r\n        showIcon\r\n        style={{ marginBottom: 16 }}\r\n      />\r\n\r\n      <Descriptions bordered column={2} size=\"small\" style={{ marginBottom: 24 }}>\r\n        <Descriptions.Item label=\"GRN Number\">\r\n          <Tag color=\"purple\" style={{ fontSize: '13px' }}>\r\n            {grn.grn_number}\r\n          </Tag>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"GRN Date\">\r\n          <Space>\r\n            <CalendarOutlined />\r\n            {grn.grn_date ? dayjs(grn.grn_date).format('DD/MM/YYYY') : '-'}\r\n          </Space>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"PO Number\">\r\n          <Tag color=\"blue\">\r\n            {grn.po_number || grn.PurchaseOrderItem?.po_number || '-'}\r\n          </Tag>\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Vendor\">\r\n          {grn.vendor?.vendor_name || grn.vendor_name || '-'}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Vendor Invoice Number\">\r\n          {grn.vendor_invoice_no ? (\r\n            <Tag color=\"green\">{grn.vendor_invoice_no}</Tag>\r\n          ) : (\r\n            '-'\r\n          )}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Vendor Invoice Date\">\r\n          {grn.vendor_invoice_date ? dayjs(grn.vendor_invoice_date).format('DD/MM/YYYY') : '-'}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Received By\">\r\n          {grn.received_by_name || '-'}\r\n        </Descriptions.Item>\r\n        <Descriptions.Item label=\"Warehouse\">\r\n          {grn.warehouse?.warehouse_name || grn.warehouse_name || '-'}\r\n        </Descriptions.Item>\r\n      </Descriptions>\r\n\r\n      <Divider>Received Items</Divider>\r\n\r\n      <Table\r\n        columns={itemColumns}\r\n        dataSource={grn.items || []}\r\n        rowKey={(record, index) => `item-${index}`}\r\n        loading={isLoading}\r\n        pagination={false}\r\n        size=\"small\"\r\n        bordered\r\n        scroll={{ x: 1200 }}\r\n      />\r\n\r\n      <Divider>Financial Summary</Divider>\r\n\r\n      <Row gutter={16} style={{ marginBottom: 16 }}>\r\n        <Col span={6}>\r\n          <Statistic\r\n            title=\"Subtotal\"\r\n            value={Number(grn.subtotal) || 0}\r\n            prefix=\"\"\r\n            precision={2}\r\n          />\r\n        </Col>\r\n        <Col span={6}>\r\n          <Statistic\r\n            title=\"Tax Amount\"\r\n            value={Number(grn.tax_amount) || 0}\r\n            prefix=\"\"\r\n            precision={2}\r\n            valueStyle={{ color: '#1890ff' }}\r\n          />\r\n        </Col>\r\n        <Col span={6}>\r\n          <Statistic\r\n            title=\"Shipping Cost\"\r\n            value={Number(grn.shipping_cost) || 0}\r\n            prefix=\"\"\r\n            precision={2}\r\n          />\r\n        </Col>\r\n        <Col span={6}>\r\n          <Statistic\r\n            title=\"Total Amount\"\r\n            value={Number(grn.total_amount) || 0}\r\n            prefix=\"\"\r\n            precision={2}\r\n            valueStyle={{ color: '#52c41a', fontSize: '20px', fontWeight: 'bold' }}\r\n          />\r\n        </Col>\r\n      </Row>\r\n\r\n      {grn.notes && (\r\n        <>\r\n          <Divider>Notes</Divider>\r\n          <Alert\r\n            message={grn.notes}\r\n            type=\"info\"\r\n            showIcon={false}\r\n            style={{ marginBottom: 16 }}\r\n          />\r\n        </>\r\n      )}\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default GRNViewModal;\r\n\r\n","import React, { useState, useMemo, useCallback } from 'react';\r\nimport {\r\n  Button,\r\n  Space,\r\n  Tag,\r\n  Input,\r\n  Row,\r\n  Tooltip,\r\n} from 'antd';\r\nimport {\r\n  EyeOutlined,\r\n  SearchOutlined,\r\n  CalendarOutlined,\r\n} from '@ant-design/icons';\r\nimport dayjs from 'dayjs';\r\nimport GlobalTable from '../../components/antd/GlobalTable';\r\nimport { useGetPurchaseOrderReceiptsQuery } from '../../services/redux/api/endpoints';\r\nimport GRNViewModal from './GRNViewModal';\r\n\r\nconst GRNListTab: React.FC = () => {\r\n  const [searchText, setSearchText] = useState('');\r\n  const [pagination, setPagination] = useState({\r\n    current: 1,\r\n    pageSize: 10,\r\n  });\r\n  const [selectedGRN, setSelectedGRN] = useState<any>(null);\r\n  const [viewModalOpen, setViewModalOpen] = useState(false);\r\n\r\n  // Fetch GRNs\r\n  const { data: grnsData, isLoading } = useGetPurchaseOrderReceiptsQuery({\r\n    pageNumber: pagination.current,\r\n    pageLimit: pagination.pageSize,\r\n    searchString: searchText.length > 2 || searchText.length === 0 ? searchText : undefined,\r\n  });\r\n\r\n  const grnsList = useMemo(() => (grnsData as any)?.result || [], [grnsData]);\r\n  const paginationData = useMemo(() => (grnsData as any)?.pagination || {}, [grnsData]);\r\n\r\n  const handleSearch = useCallback((value: string) => {\r\n    setSearchText(value);\r\n    setPagination({ ...pagination, current: 1 });\r\n  }, [pagination]);\r\n\r\n  const handlePaginationChange = (pageNumber: number, pageLimit: number) => {\r\n    setPagination({ current: pageNumber, pageSize: pageLimit });\r\n  };\r\n\r\n  const handleView = (record: any) => {\r\n    setSelectedGRN(record);\r\n    setViewModalOpen(true);\r\n  };\r\n\r\n\r\n  // Table columns\r\n  const columns = [\r\n    {\r\n      title: 'GRN Number',\r\n      key: 'grn_number',\r\n      width: 150,\r\n      render: (record: any) => (\r\n        <Tag color=\"purple\" style={{ fontSize: '13px', padding: '4px 12px' }}>\r\n          {record.grn_number}\r\n        </Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: 'GRN Date',\r\n      key: 'grn_date',\r\n      width: 120,\r\n      render: (record: any) => (\r\n        <Space>\r\n          <CalendarOutlined />\r\n          {dayjs(record.grn_date).format('DD/MM/YYYY')}\r\n        </Space>\r\n      ),\r\n    },\r\n    {\r\n      title: 'PO Number',\r\n      key: 'po_number',\r\n      width: 150,\r\n      render: (record: any) => (\r\n        <Tag color=\"blue\">\r\n          {record.po_number || record.PurchaseOrderItem?.po_number || '-'}\r\n        </Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Vendor',\r\n      key: 'vendor',\r\n      width: 200,\r\n      render: (record: any) => (\r\n        <div>\r\n          <strong>{record.vendor?.vendor_name || record.vendor_name || '-'}</strong>\r\n          {record.VendorItem?.company_name && (\r\n            <div style={{ fontSize: '11px', color: '#888' }}>\r\n              {record.VendorItem.company_name}\r\n            </div>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Vendor Invoice',\r\n      key: 'vendor_invoice',\r\n      width: 180,\r\n      render: (record: any) => (\r\n        <div>\r\n          {record.vendor_invoice_no ? (\r\n            <>\r\n              <Tag color=\"green\">{record.vendor_invoice_no}</Tag>\r\n              {record.vendor_invoice_date && (\r\n                <div style={{ fontSize: '11px', color: '#888', marginTop: '4px' }}>\r\n                  {dayjs(record.vendor_invoice_date).format('DD/MM/YYYY')}\r\n                </div>\r\n              )}\r\n            </>\r\n          ) : (\r\n            <span style={{ color: '#999' }}>-</span>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Items',\r\n      key: 'items_count',\r\n      width: 100,\r\n      render: (record: any) => (\r\n        <Tag>\r\n          {record.items?.length || 0} items\r\n        </Tag>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Received By',\r\n      key: 'received_by',\r\n      width: 150,\r\n      render: (record: any) => record.received_by_name || '-',\r\n    },\r\n    {\r\n      title: 'Subtotal',\r\n      key: 'subtotal',\r\n      width: 120,\r\n      render: (record: any) => (\r\n        <span style={{ fontWeight: 500 }}>\r\n          {(Number(record.subtotal) || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Tax Amount',\r\n      key: 'tax_amount',\r\n      width: 120,\r\n      render: (record: any) => (\r\n        <span style={{ color: '#1890ff' }}>\r\n          {(Number(record.tax_amount) || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Total Amount',\r\n      key: 'total_amount',\r\n      width: 130,\r\n      render: (record: any) => (\r\n        <strong style={{ color: '#52c41a', fontSize: '14px' }}>\r\n          {(Number(record.total_amount) || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n        </strong>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Actions',\r\n      key: 'actions',\r\n      width: 100,\r\n      fixed: 'right' as const,\r\n      render: (_: any, record: any) => (\r\n        <Space>\r\n          <Tooltip title=\"View GRN Details\">\r\n            <Button\r\n              type=\"link\"\r\n              icon={<EyeOutlined />}\r\n              onClick={() => handleView(record)}\r\n            >\r\n              View\r\n            </Button>\r\n          </Tooltip>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <>\r\n      <Row justify=\"space-between\" align=\"middle\" style={{ marginBottom: 16 }}>\r\n        <div>\r\n          <h2 style={{ margin: 0, fontSize: '20px', fontWeight: 600 }}>\r\n            Goods Receipt Notes (GRN)\r\n          </h2>\r\n          <p style={{ margin: '4px 0 0 0', color: '#888', fontSize: '14px' }}>\r\n            View and manage all goods receipt notes\r\n          </p>\r\n        </div>\r\n        <div style={{ display: 'flex', gap: '16px', alignItems: 'center' }}>\r\n          <Input\r\n            placeholder=\"Search by GRN number, PO number, or vendor...\"\r\n            prefix={<SearchOutlined />}\r\n            value={searchText}\r\n            onChange={(e) => handleSearch(e.target.value)}\r\n            style={{ width: 300 }}\r\n            allowClear\r\n          />\r\n        </div>\r\n      </Row>\r\n\r\n      <GlobalTable\r\n        columns={columns}\r\n        data={grnsList}\r\n        rowKey=\"_id\"\r\n        loading={isLoading}\r\n        totalCount={paginationData.totalCount || 0}\r\n        pageLimit={paginationData.pageLimit || 10}\r\n        onPaginationChange={handlePaginationChange}\r\n      />\r\n\r\n      <GRNViewModal\r\n        open={viewModalOpen}\r\n        onClose={() => {\r\n          setViewModalOpen(false);\r\n          setSelectedGRN(null);\r\n        }}\r\n        grnId={selectedGRN?._id}\r\n        grnData={selectedGRN}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default GRNListTab;\r\n\r\n","import React, { useState, useCallback, useMemo } from 'react';\r\nimport { message, Modal, Form, Input, Select, DatePicker, InputNumber, Tabs } from 'antd';\r\nimport { FileTextOutlined, ShoppingOutlined } from '@ant-design/icons';\r\nimport { GenericCrudPage } from '../../components/common/GenericCrudPage';\r\nimport { purchaseOrderColumns } from './columns';\r\nimport { apiSlice } from '../../services/redux/api/apiSlice';\r\nimport {\r\n  useSubmitPurchaseOrderMutation,\r\n  useRejectPurchaseOrderMutation,\r\n  useCancelPurchaseOrderMutation,\r\n} from '../../services/redux/api/endpoints';\r\nimport POLineItemsTable from './POLineItemsTable';\r\nimport POReceiveModal from './POReceiveModal';\r\nimport POApprovalModal from './POApprovalModal';\r\nimport POSendModal from './POSendModal';\r\nimport POViewModal from './POViewModal';\r\nimport POPaymentModal from './POPaymentModal';\r\nimport GRNListTab from './GRNListTab';\r\nimport dayjs from 'dayjs';\r\nimport { getCurrentUser } from '../../helpers/auth';\r\nimport { canCreate, canUpdate, canDelete, RESOURCES } from '../../helpers/permissionHelper';\r\n\r\nconst { TextArea } = Input;\r\nconst { Option } = Select;\r\n\r\nconst PurchaseOrderCrud: React.FC = () => {\r\n  const currentUser = getCurrentUser();\r\n  const [activeTab, setActiveTab] = useState('purchase-orders');\r\n  \r\n  // Modals state\r\n  const [receiveModalOpen, setReceiveModalOpen] = useState(false);\r\n  const [approvalModalOpen, setApprovalModalOpen] = useState(false);\r\n  const [sendModalOpen, setSendModalOpen] = useState(false);\r\n  const [viewModalOpen, setViewModalOpen] = useState(false);\r\n  const [paymentModalOpen, setPaymentModalOpen] = useState(false);\r\n  const [selectedPO, setSelectedPO] = useState<any>(null);\r\n  \r\n  // API queries - memoized params\r\n  const queryParams = useMemo(() => ({ pageNumber: 1, pageLimit: 100 }), []);\r\n  const { data: vendorsData, isLoading: vendorsLoading } = apiSlice.useGetVendorQuery(queryParams);\r\n  const { data: warehousesData, isLoading: warehousesLoading } = apiSlice.useGetWarehouseQuery(queryParams);\r\n  \r\n  const vendors = useMemo(() => (vendorsData as any)?.result || [], [vendorsData]);\r\n  const warehouses = useMemo(() => (warehousesData as any)?.result || [], [warehousesData]);\r\n  \r\n  // Mutations\r\n  const [submitPO] = useSubmitPurchaseOrderMutation();\r\n  const [rejectPO] = useRejectPurchaseOrderMutation();\r\n  const [cancelPO] = useCancelPurchaseOrderMutation();\r\n  \r\n  // Optimized: Calculate item subtotal once (DRY principle)\r\n  const getItemSubtotal = useCallback((item: any) => {\r\n    const qty = Number(item.quantity) || 0;\r\n    const price = Number(item.unit_price) || 0;\r\n    const discountVal = Number(item.discount) || 0;\r\n    const discountType = item.discount_type || 'percentage';\r\n    \r\n    let itemSubtotal = qty * price;\r\n    if (discountType === 'percentage') {\r\n      itemSubtotal -= itemSubtotal * discountVal / 100;\r\n    } else {\r\n      itemSubtotal -= discountVal;\r\n    }\r\n    \r\n    return itemSubtotal;\r\n  }, []);\r\n  \r\n  // Optimized: Single loop calculation\r\n  const calculateTotals = useCallback((items: any[] = []) => {\r\n    let subtotal = 0;\r\n    let tax_amount = 0;\r\n    let discount_amount = 0;\r\n\r\n    items.forEach(item => {\r\n      const qty = Number(item.quantity) || 0;\r\n      const price = Number(item.unit_price) || 0;\r\n      // Only calculate if price is set (price will be 0 during creation, filled at receipt)\r\n      if (price > 0) {\r\n        const itemTotal = qty * price;\r\n        const itemSubtotal = getItemSubtotal(item);\r\n        const taxPct = Number(item.tax_percentage) || 0;\r\n        \r\n        subtotal += itemSubtotal;\r\n        tax_amount += itemSubtotal * (taxPct / 100);\r\n        discount_amount += itemTotal - itemSubtotal;\r\n      }\r\n    });\r\n\r\n    const total_amount = subtotal + tax_amount;\r\n    \r\n    return {\r\n      subtotal: Number(subtotal.toFixed(2)),\r\n      tax_amount: Number(tax_amount.toFixed(2)),\r\n      discount_amount: Number(discount_amount.toFixed(2)),\r\n      total_amount: Number(total_amount.toFixed(2)),\r\n      outstanding_amount: Number(total_amount.toFixed(2)),\r\n    };\r\n  }, [getItemSubtotal]);\r\n  \r\n  // Form items - memoized\r\n  const formItems = useMemo(() => [\r\n    {\r\n      name: 'po_number',\r\n      label: 'PO Number',\r\n      rules: [{ required: false, message: 'PO number is required' }],\r\n      component: <Input placeholder=\"Auto-generated or enter manually\" />,\r\n    },\r\n    {\r\n      name: 'po_date',\r\n      label: 'PO Date',\r\n      initialValue: dayjs(),\r\n      rules: [{ required: true, message: 'PO date is required' }],\r\n      component: <DatePicker style={{ width: '100%' }} format=\"YYYY-MM-DD\" />,\r\n    },\r\n    {\r\n      name: 'vendor_id',\r\n      label: 'Vendor',\r\n      rules: [{ required: true, message: 'Vendor is required' }],\r\n      component: (\r\n        <Select\r\n          showSearch\r\n          placeholder=\"Select vendor\"\r\n          loading={vendorsLoading}\r\n          filterOption={(input, option) => \r\n            String(option?.children || '').toLowerCase().includes(input.toLowerCase())\r\n          }\r\n        >\r\n          {vendors.map((vendor: any) => (\r\n            <Option key={vendor._id} value={vendor._id}>\r\n              {vendor.vendor_name}\r\n            </Option>\r\n          ))}\r\n        </Select>\r\n      ),\r\n    },\r\n    {\r\n      name: 'expected_delivery_date',\r\n      label: 'Expected Delivery Date',\r\n      component: <DatePicker style={{ width: '100%' }} format=\"YYYY-MM-DD\" />,\r\n    },\r\n    {\r\n      name: 'warehouse_id',\r\n      label: 'Delivery Warehouse',\r\n      rules: [{ required: true, message: 'Warehouse is required' }],\r\n      component: (\r\n        <Select\r\n          showSearch\r\n          placeholder=\"Select warehouse\"\r\n          loading={warehousesLoading}\r\n          filterOption={(input, option) =>\r\n            String(option?.children || '').toLowerCase().includes(input.toLowerCase())\r\n          }\r\n        >\r\n          {warehouses.map((warehouse: any) => (\r\n            <Option key={warehouse._id} value={warehouse._id}>\r\n              {warehouse.warehouse_name}\r\n            </Option>\r\n          ))}\r\n        </Select>\r\n      ),\r\n    },\r\n    {\r\n      name: 'payment_terms',\r\n      label: 'Payment Terms',\r\n      initialValue: 'net_30',\r\n      component: (\r\n        <Select>\r\n          <Option value=\"immediate\">Immediate</Option>\r\n          <Option value=\"net_7\">Net 7 Days</Option>\r\n          <Option value=\"net_15\">Net 15 Days</Option>\r\n          <Option value=\"net_30\">Net 30 Days</Option>\r\n          <Option value=\"net_60\">Net 60 Days</Option>\r\n          <Option value=\"net_90\">Net 90 Days</Option>\r\n        </Select>\r\n      ),\r\n    },\r\n    {\r\n      name: 'shipping_address',\r\n      label: 'Shipping Address',\r\n      component: <TextArea rows={2} placeholder=\"Delivery address\" />,\r\n    },\r\n    {\r\n      name: 'shipping_method',\r\n      label: 'Shipping Method',\r\n      component: <Input placeholder=\"e.g., Road Transport, Air Cargo\" />,\r\n    },\r\n    {\r\n      name: 'notes',\r\n      label: 'Notes',\r\n      component: <TextArea rows={3} placeholder=\"Additional notes or instructions\" />,\r\n    },\r\n    {\r\n      name: 'terms_conditions',\r\n      label: 'Terms & Conditions',\r\n      component: <TextArea rows={3} placeholder=\"Terms and conditions for this PO\" />,\r\n    },\r\n    {\r\n      name: 'items',\r\n      label: 'Line Items',\r\n      rules: [\r\n        { required: true, message: 'At least one item is required' },\r\n        {\r\n          validator: async (_: any, items: any[]) => {\r\n            if (!items || items.length === 0) {\r\n              throw new Error('At least one item is required');\r\n            }\r\n            const hasInvalidItems = items.some(\r\n              item => !item.product_id || !item.quantity\r\n            );\r\n            if (hasInvalidItems) {\r\n              throw new Error('All items must have product and quantity');\r\n            }\r\n          },\r\n        },\r\n      ],\r\n      component: <POLineItemsTable />,\r\n      colSpan: 3,\r\n    },\r\n  ], [vendors, warehouses, vendorsLoading, warehousesLoading]);\r\n  \r\n  // Column actions - memoized\r\n  const columnActions = useMemo(() => ({\r\n    onView: (record: any) => {\r\n      setSelectedPO(record);\r\n      setViewModalOpen(true);\r\n    },\r\n    onEdit: () => {}, // Handled by GenericCrudPage\r\n    onDelete: async (record: any) => message.info('Delete handled by GenericCrudPage'),\r\n    onSubmit: async (record: any) => {\r\n      Modal.confirm({\r\n        title: 'Submit Purchase Order for Approval?',\r\n        content: 'Once submitted, the PO will be sent for approval and cannot be edited.',\r\n        onOk: async () => {\r\n          try {\r\n            await submitPO({ id: record._id }).unwrap();\r\n            message.success('Purchase order submitted for approval');\r\n          } catch (error: any) {\r\n            message.error(error?.data?.message || 'Failed to submit PO');\r\n          }\r\n        },\r\n      });\r\n    },\r\n    onApprove: (record: any) => {\r\n      setSelectedPO(record);\r\n      setApprovalModalOpen(true);\r\n    },\r\n    onReject: async (record: any) => {\r\n      Modal.confirm({\r\n        title: 'Reject Purchase Order?',\r\n        content: (\r\n          <div>\r\n            <p>Please provide a reason for rejection:</p>\r\n            <Input.TextArea\r\n              rows={3}\r\n              id=\"rejection-reason\"\r\n              placeholder=\"Enter reason...\"\r\n            />\r\n          </div>\r\n        ),\r\n        onOk: async () => {\r\n          const reason = (document.getElementById('rejection-reason') as HTMLTextAreaElement)?.value;\r\n          if (!reason) {\r\n            message.error('Rejection reason is required');\r\n            return Promise.reject();\r\n          }\r\n          try {\r\n            await rejectPO({ id: record._id, reason }).unwrap();\r\n            message.success('Purchase order rejected');\r\n          } catch (error: any) {\r\n            message.error(error?.data?.message || 'Failed to reject PO');\r\n          }\r\n        },\r\n      });\r\n    },\r\n    onSend: (record: any) => {\r\n      setSelectedPO(record);\r\n      setSendModalOpen(true);\r\n    },\r\n    onReceive: (record: any) => {\r\n      setSelectedPO(record);\r\n      setReceiveModalOpen(true);\r\n    },\r\n    onPay: (record: any) => {\r\n      setSelectedPO(record);\r\n      setPaymentModalOpen(true);\r\n    },\r\n    onCancel: async (record: any) => {\r\n      Modal.confirm({\r\n        title: 'Cancel Purchase Order?',\r\n        content: 'Are you sure you want to cancel this PO?',\r\n        onOk: async () => {\r\n          try {\r\n            await cancelPO({ id: record._id }).unwrap();\r\n            message.success('Purchase order cancelled');\r\n          } catch (error: any) {\r\n            message.error(error?.data?.message || 'Failed to cancel PO');\r\n          }\r\n        },\r\n      });\r\n    },\r\n    onPrint: () => message.info('Print functionality coming soon'),\r\n  }), [submitPO, rejectPO, cancelPO]);\r\n  \r\n  // Handle before save - calculate totals\r\n  const handleBeforeSave = useCallback((values: any) => {\r\n    const totals = calculateTotals(values.items || []);\r\n    \r\n    return {\r\n      ...values,\r\n      ...totals,\r\n      po_date: values.po_date ? dayjs(values.po_date).format('YYYY-MM-DD') : dayjs().format('YYYY-MM-DD'),\r\n      expected_delivery_date: values.expected_delivery_date ? \r\n        dayjs(values.expected_delivery_date).format('YYYY-MM-DD') : undefined,\r\n      status: values._id ? values.status : 'draft',\r\n      created_by_id: currentUser?._id,\r\n      created_by_name: currentUser?.username,\r\n      paid_amount: values.paid_amount || 0,\r\n    };\r\n  }, [calculateTotals, currentUser]);\r\n  \r\n  // Config for GenericCrudPage with permissions\r\n  const config = useMemo(() => ({\r\n    title: 'Purchase Orders',\r\n    entityName: 'PurchaseOrder',\r\n    columns: purchaseOrderColumns(columnActions),\r\n    formItems,\r\n    formColumns: 3,\r\n    drawerWidth: 1400,\r\n    beforeSave: handleBeforeSave,\r\n    canCreate: () => canCreate(RESOURCES.PURCHASE_ORDER),\r\n    canEdit: (record: any) => {\r\n      const hasPermission = canUpdate(RESOURCES.PURCHASE_ORDER);\r\n      const canEditByStatus = ['draft', 'rejected'].includes(record?.status);\r\n      return hasPermission && canEditByStatus;\r\n    },\r\n    canDelete: (record: any) => {\r\n      const hasPermission = canDelete(RESOURCES.PURCHASE_ORDER);\r\n      const isDraft = record?.status === 'draft';\r\n      return hasPermission && isDraft;\r\n    },\r\n  }), [columnActions, formItems, handleBeforeSave]);\r\n  \r\n  return (\r\n    <>\r\n      <Tabs\r\n        activeKey={activeTab}\r\n        onChange={setActiveTab}\r\n        type=\"card\"\r\n        size=\"large\"\r\n        items={[\r\n          {\r\n            key: 'purchase-orders',\r\n            label: (\r\n              <span>\r\n                <ShoppingOutlined /> Purchase Orders\r\n              </span>\r\n            ),\r\n            children: <GenericCrudPage config={config} />,\r\n          },\r\n          {\r\n            key: 'grn',\r\n            label: (\r\n              <span>\r\n                <FileTextOutlined /> GRN\r\n              </span>\r\n            ),\r\n            children: <GRNListTab />,\r\n          },\r\n        ]}\r\n      />\r\n      \r\n      <POReceiveModal\r\n        open={receiveModalOpen}\r\n        onClose={() => {\r\n          setReceiveModalOpen(false);\r\n          setSelectedPO(null);\r\n        }}\r\n        purchaseOrder={selectedPO}\r\n      />\r\n      \r\n      <POApprovalModal\r\n        open={approvalModalOpen}\r\n        onClose={() => {\r\n          setApprovalModalOpen(false);\r\n          setSelectedPO(null);\r\n        }}\r\n        purchaseOrder={selectedPO}\r\n      />\r\n      \r\n      <POSendModal\r\n        open={sendModalOpen}\r\n        onClose={() => {\r\n          setSendModalOpen(false);\r\n          setSelectedPO(null);\r\n        }}\r\n        purchaseOrder={selectedPO}\r\n      />\r\n      \r\n      <POViewModal\r\n        open={viewModalOpen}\r\n        onClose={() => {\r\n          setViewModalOpen(false);\r\n          setSelectedPO(null);\r\n        }}\r\n        purchaseOrder={selectedPO}\r\n      />\r\n      \r\n      <POPaymentModal\r\n        open={paymentModalOpen}\r\n        onClose={() => {\r\n          setPaymentModalOpen(false);\r\n          setSelectedPO(null);\r\n        }}\r\n        purchaseOrder={selectedPO}\r\n        onSuccess={() => {\r\n          // Refetch purchase orders to update payment amounts\r\n          // GenericCrudPage will automatically refetch due to cache invalidation\r\n          setPaymentModalOpen(false);\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default PurchaseOrderCrud;\r\n\r\n","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport CheckOutlinedSvg from \"@ant-design/icons-svg/es/asn/CheckOutlined\";\nimport AntdIcon from \"../components/AntdIcon\";\nconst CheckOutlined = (props, ref) => /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n  ref: ref,\n  icon: CheckOutlinedSvg\n}));\n\n/**![check](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTkxMiAxOTBoLTY5LjljLTkuOCAwLTE5LjEgNC41LTI1LjEgMTIuMkw0MDQuNyA3MjQuNSAyMDcgNDc0YTMyIDMyIDAgMDAtMjUuMS0xMi4ySDExMmMtNi43IDAtMTAuNCA3LjctNi4zIDEyLjlsMjczLjkgMzQ3YzEyLjggMTYuMiAzNy40IDE2LjIgNTAuMyAwbDQ4OC40LTYxOC45YzQuMS01LjEuNC0xMi44LTYuMy0xMi44eiIgLz48L3N2Zz4=) */\nconst RefIcon = /*#__PURE__*/React.forwardRef(CheckOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'CheckOutlined';\n}\nexport default RefIcon;","// This icon file is generated automatically.\nvar UploadOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z\" } }] }, \"name\": \"upload\", \"theme\": \"outlined\" };\nexport default UploadOutlined;\n","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport UploadOutlinedSvg from \"@ant-design/icons-svg/es/asn/UploadOutlined\";\nimport AntdIcon from \"../components/AntdIcon\";\nconst UploadOutlined = (props, ref) => /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n  ref: ref,\n  icon: UploadOutlinedSvg\n}));\n\n/**![upload](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTQwMCAzMTcuN2g3My45VjY1NmMwIDQuNCAzLjYgOCA4IDhoNjBjNC40IDAgOC0zLjYgOC04VjMxNy43SDYyNGM2LjcgMCAxMC40LTcuNyA2LjMtMTIuOUw1MTguMyAxNjNhOCA4IDAgMDAtMTIuNiAwbC0xMTIgMTQxLjdjLTQuMSA1LjMtLjQgMTMgNi4zIDEzek04NzggNjI2aC02MGMtNC40IDAtOCAzLjYtOCA4djE1NEgyMTRWNjM0YzAtNC40LTMuNi04LTgtOGgtNjBjLTQuNCAwLTggMy42LTggOHYxOThjMCAxNy43IDE0LjMgMzIgMzIgMzJoNjg0YzE3LjcgMCAzMi0xNC4zIDMyLTMyVjYzNGMwLTQuNC0zLjYtOC04LTh6IiAvPjwvc3ZnPg==) */\nconst RefIcon = /*#__PURE__*/React.forwardRef(UploadOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'UploadOutlined';\n}\nexport default RefIcon;"],"names":["statusConfig","draft","color","icon","_jsx","EditOutlined","label","pending_approval","ClockCircleOutlined","approved","CheckCircleOutlined","rejected","CloseCircleOutlined","sent","SendOutlined","confirmed","partially_received","InboxOutlined","fully_received","cancelled","StopOutlined","closed","_ref","value","onChange","disabled","queryParams","useMemo","pageNumber","pageLimit","data","productsData","isLoading","productsLoading","apiSlice","useGetProductQuery","products","result","handleAddItem","useCallback","product_id","product_name","variant_name","description","quantity","unit_price","tax_percentage","discount","discount_type","line_total","received_quantity","pending_quantity","handleDeleteItem","index","newItems","filter","_","i","calculateLineTotal","item","qty","Number","price","taxPct","discountVal","subtotal","toFixed","handleFieldChange","field","fieldValue","_objectSpread","includes","calculated","Object","assign","handleProductSelect","productId","_product$VariantItem","product","find","p","_id","name","VariantItem","totals","reduce","sum","itemSubtotal","taxAmount","total","columns","title","key","width","render","__","style","children","record","Select","showSearch","allowClear","placeholder","undefined","val","loading","filterOption","input","option","String","toLowerCase","notFoundContent","map","_product$VariantItem2","_jsxs","Option","concat","Input","e","target","InputNumber","min","precision","prefix","max","suffix","Space","Compact","Tooltip","toLocaleString","minimumFractionDigits","DatePicker","format","expected_delivery_date","dayjs","date","Popconfirm","onConfirm","length","Button","type","danger","size","DeleteOutlined","marginBottom","display","justifyContent","alignItems","fontSize","PlusOutlined","onClick","Table","dataSource","pagination","scroll","x","rowKey","bordered","footer","textAlign","direction","gap","CalculatorOutlined","padding","open","onClose","purchaseOrder","form","Form","useForm","lineItems","setLineItems","useState","createStockEntries","setCreateStockEntries","shippingCost","setShippingCost","convertToGRN","useConvertPOToGRNMutation","useEffect","items","po_line_item_id","ordered_quantity","rejected_quantity","accepted_quantity","batch_no","mfg_date","expiry_date","notes","shipping_cost","handleQuantityChange","ordered","received","accepted","financialTotals","receivedItems","discountAmount","forEach","discountType","itemDiscount","shipping","dataIndex","Tag","alreadyReceived","hasError","borderColor","className","disabledDate","current","endOf","isRequired","Modal","po_number","onCancel","async","values","validateFields","some","message","error","itemsWithReceivedQuantity","payload","id","vendor_invoice_no","vendor_invoice_date","create_stock_entries","unwrap","success","resetFields","_error$data","Alert","showIcon","layout","Row","gutter","Col","span","Item","rules","required","whitespace","Divider","Statistic","valueStyle","background","borderRadius","fontWeight","TextArea","rows","Checkbox","checked","marginTop","_purchaseOrder$vendor","_purchaseOrder$total_","_purchaseOrder$items","rejectModalOpen","setRejectModalOpen","rejectionReason","setRejectionReason","approvePO","approving","useApprovePurchaseOrderMutation","rejectPO","rejecting","useRejectPurchaseOrderMutation","_Fragment","showRejectModal","comments","Descriptions","column","vendor","vendor_name","total_amount","created_by_name","onOk","reason","_error$data2","confirmLoading","okText","okButtonProps","_purchaseOrder$Vendor","sendPO","useSendPurchaseOrderMutation","email","initialValues","vendor_email","VendorItem","Text","Typography","_purchaseOrder$paymen","_result","onPaymentSuccess","shouldFetchVendor","vendor_id","vendorData","useGetVendorByIdQuery","skip","shouldFetchWarehouse","WarehouseItem","warehouse_id","warehouseData","useGetWarehouseByIdQuery","paymentsData","refetch","refetchPayments","useGetPOPaymentsQuery","receiptsData","useGetReceiptsForPOQuery","comparisonData","useGetPOvsGRNComparisonQuery","vendorInfo","company_name","phone","contact_number","address","vendor_company_name","vendor_phone","vendor_address","warehouseInfo","warehouse_name","warehouse","warehouse_code","code","manager","warehouse_address","warehouse_manager","currentStatus","status","itemColumns","tax","numTax","numTotal","numReceived","pending","FileTextOutlined","Badge","text","UserOutlined","marginRight","CalendarOutlined","po_date","ShopOutlined","payment_terms","replace","toUpperCase","orientation","DollarOutlined","tax_amount","strong","paid_amount","outstanding_amount","receipts","receiptList","Array","isArray","amount","percentage","CreditCardOutlined","payments","paymentList","paymentColumns","sorter","a","b","payment_date","unix","payment_type","mode","cash","upi","card","bank_transfer","cheque","other","cheque_number","bank_name","transaction_id","reference_number","totalPaid","payment","payment_amount","advanceTotal","actual_delivery_date","Date","normalTotal","totalAmount","outstandingAmount","isFullyPaid","border","margin","terms_conditions","onSuccess","createPayment","useCreatePOPaymentMutation","paymentMode","setPaymentMode","currentUser","getCurrentUser","paidAmount","calculatedOutstanding","Math","outstandingAmountFromPO","numOutstandingAmount","isNaN","scopeData","SessionStorageEncryption","getItem","organisationId","organisation_id","branchId","branch_id","tenantId","tenant_id","setFieldsValue","payment_mode","setPartialAmount","handleSubmit","allowedStatuses","isAdvancePayment","is_partially_received","is_fully_received","purchase_order_id","paid_by_id","paid_by_name","username","remainingAmount","paymentType","console","errorMessage","handleCancel","backgroundColor","maximumFractionDigits","onFinish","xs","sm","extra","wrap","validator","Promise","reject","Error","resolve","step","formatter","parser","parsed","_grn$PurchaseOrderIte","_grn$vendor","_grn$warehouse","grnId","grnData","grnDetailData","useGetPurchaseOrderReceiptByIdQuery","grn","_record$ProductItem","ProductItem","grn_number","grn_date","PurchaseOrderItem","received_by_name","GRNListTab","searchText","setSearchText","setPagination","pageSize","selectedGRN","setSelectedGRN","viewModalOpen","setViewModalOpen","grnsData","useGetPurchaseOrderReceiptsQuery","searchString","grnsList","paginationData","handleSearch","_record$PurchaseOrder","_record$vendor","_record$VendorItem","_record$items","fixed","EyeOutlined","handleView","justify","align","SearchOutlined","GlobalTable","totalCount","onPaginationChange","handlePaginationChange","GRNViewModal","PurchaseOrderCrud","activeTab","setActiveTab","receiveModalOpen","setReceiveModalOpen","approvalModalOpen","setApprovalModalOpen","sendModalOpen","setSendModalOpen","paymentModalOpen","setPaymentModalOpen","selectedPO","setSelectedPO","vendorsData","vendorsLoading","useGetVendorQuery","warehousesData","warehousesLoading","useGetWarehouseQuery","vendors","warehouses","submitPO","useSubmitPurchaseOrderMutation","cancelPO","useCancelPurchaseOrderMutation","getItemSubtotal","calculateTotals","discount_amount","arguments","itemTotal","formItems","component","initialValue","POLineItemsTable","colSpan","columnActions","onView","onEdit","onDelete","info","onSubmit","confirm","content","onApprove","onReject","_document$getElementB","document","getElementById","onSend","onReceive","onPay","_error$data3","onPrint","handleBeforeSave","created_by_id","config","entityName","actions","is_urgent","filters","keys","onFilter","isOverdue","isBefore","WarningOutlined","daysLeft","diff","paid","outstanding","_record$items2","totalItems","user","hasReadPerm","canRead","RESOURCES","PURCHASE_ORDER","hasUpdatePerm","canUpdate","hasDeletePerm","canDelete","poActionsMenu","Menu","UploadOutlined","CheckOutlined","DownloadOutlined","window","Dropdown","overlay","trigger","placement","MoreOutlined","formColumns","drawerWidth","beforeSave","canCreate","canEdit","hasPermission","canEditByStatus","isDraft","Tabs","activeKey","ShoppingOutlined","GenericCrudPage","POReceiveModal","POApprovalModal","POSendModal","POViewModal","POPaymentModal","_extends","bind","source","prototype","hasOwnProperty","call","apply","this","props","ref","React","AntdIcon","CheckOutlinedSvg","UploadOutlinedSvg"],"sourceRoot":""}