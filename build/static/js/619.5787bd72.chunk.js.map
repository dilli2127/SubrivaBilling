{"version":3,"file":"static/js/619.5787bd72.chunk.js","mappings":"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","sources":["pages/Permissions/PermissionManagement.tsx","../node_modules/@ant-design/icons-svg/es/asn/SaveOutlined.js","../node_modules/@ant-design/icons/es/icons/SaveOutlined.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Table,\r\n  Card,\r\n  Button,\r\n  Select,\r\n  message,\r\n  Spin,\r\n  Checkbox,\r\n  Space,\r\n  Typography,\r\n  Tooltip,\r\n  Tag,\r\n} from 'antd';\r\nimport {\r\n  SaveOutlined,\r\n  ReloadOutlined,\r\n  CheckCircleOutlined,\r\n  CloseCircleOutlined,\r\n} from '@ant-design/icons';\r\nimport requestBackServer from '../../services/api';\r\nimport { RESOURCES } from '../../helpers/permissionHelper';\r\nimport './PermissionManagement.css';\r\n\r\nconst { Title, Text } = Typography;\r\nconst { Option } = Select;\r\n\r\ninterface Role {\r\n  _id: string;\r\n  name: string;\r\n  roles_type: string;\r\n  description?: string;\r\n}\r\n\r\ninterface Permission {\r\n  resource: string;\r\n  can_create: boolean;\r\n  can_read: boolean;\r\n  can_update: boolean;\r\n  can_delete: boolean;\r\n  allowed_menu_keys?: string[];\r\n}\r\n\r\ninterface PermissionsMap {\r\n  [resource: string]: Permission;\r\n}\r\n\r\nconst PermissionManagement: React.FC = () => {\r\n  const [roles, setRoles] = useState<Role[]>([]);\r\n  const [selectedRoleId, setSelectedRoleId] = useState<string>('');\r\n  const [permissions, setPermissions] = useState<PermissionsMap>({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  // Fetch all roles on component mount\r\n  useEffect(() => {\r\n    fetchRoles();\r\n  }, []);\r\n\r\n  // Fetch permissions when role is selected\r\n  useEffect(() => {\r\n    if (selectedRoleId) {\r\n      fetchRolePermissions(selectedRoleId);\r\n    }\r\n  }, [selectedRoleId]);\r\n\r\n  const fetchRoles = async () => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await requestBackServer({\r\n        method: 'GET',\r\n        endpoint: '/roles',\r\n      });\r\n\r\n      if (response.statusCode === 200) {\r\n        const rolesData = response.result || [];\r\n        setRoles(rolesData);\r\n      } else {\r\n        message.error(`Failed to fetch roles: ${response.message || 'Unknown error'}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching roles:', error);\r\n      message.error('Error fetching roles');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchRolePermissions = async (roleId: string) => {\r\n    setLoading(true);\r\n    try {\r\n      const response = await requestBackServer({\r\n        method: 'GET',\r\n        endpoint: `/permissions/role/${roleId}`,\r\n      });\r\n\r\n      if (response.statusCode === 200) {\r\n        // Handle the API response format - permissions are in 'resources' array\r\n        const resourcesArray = response.result?.resources || [];\r\n        \r\n        if (resourcesArray.length === 0) {\r\n          message.warning('No permissions found for this role. Please seed permissions first.');\r\n          setPermissions({});\r\n          return;\r\n        }\r\n        \r\n        // Convert array format to object format for the component\r\n        const permsData: PermissionsMap = {};\r\n        resourcesArray.forEach((item: any) => {\r\n          permsData[item.resource] = {\r\n            resource: item.resource,\r\n            can_create: item.can_create,\r\n            can_read: item.can_read,\r\n            can_update: item.can_update,\r\n            can_delete: item.can_delete,\r\n            allowed_menu_keys: item.allowed_menu_keys || []\r\n          };\r\n        });\r\n        \r\n        setPermissions(permsData);\r\n      } else {\r\n        message.error(`Failed to fetch permissions: ${response.message || 'Unknown error'}`);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching permissions:', error);\r\n      message.error('Error fetching permissions');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePermissionChange = (\r\n    resource: string,\r\n    action: 'can_create' | 'can_read' | 'can_update' | 'can_delete',\r\n    value: boolean\r\n  ) => {\r\n    setPermissions((prev) => ({\r\n      ...prev,\r\n      [resource]: {\r\n        ...prev[resource],\r\n        [action]: value,\r\n      },\r\n    }));\r\n  };\r\n\r\n  const handleSelectAll = (\r\n    action: 'can_create' | 'can_read' | 'can_update' | 'can_delete',\r\n    value: boolean\r\n  ) => {\r\n    const updatedPermissions = { ...permissions };\r\n    Object.keys(updatedPermissions).forEach((resource) => {\r\n      updatedPermissions[resource] = {\r\n        ...updatedPermissions[resource],\r\n        [action]: value,\r\n      };\r\n    });\r\n    setPermissions(updatedPermissions);\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    if (!selectedRoleId) {\r\n      message.warning('Please select a role first');\r\n      return;\r\n    }\r\n\r\n    setSaving(true);\r\n    try {\r\n      const permissionsArray = Object.entries(permissions).map(\r\n        ([resource, perms]) => ({\r\n          resource,\r\n          can_create: perms.can_create || false,\r\n          can_read: perms.can_read || false,\r\n          can_update: perms.can_update || false,\r\n          can_delete: perms.can_delete || false\r\n        })\r\n      );\r\n\r\n      const response = await requestBackServer({\r\n        method: 'POST',\r\n        endpoint: '/permissions/bulk',\r\n        data: {\r\n          role_id: selectedRoleId,\r\n          permissions: permissionsArray,\r\n        },\r\n      });\r\n\r\n      if (response.statusCode === 200) {\r\n        message.success('Permissions updated successfully');\r\n        // Refresh permissions\r\n        fetchRolePermissions(selectedRoleId);\r\n      } else {\r\n        message.error(response.message || 'Failed to update permissions');\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Error saving permissions:', error);\r\n      message.error(\r\n        error?.response?.data?.exception || 'Error saving permissions'\r\n      );\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Resource',\r\n      dataIndex: 'resource',\r\n      key: 'resource',\r\n      width: 250,\r\n      fixed: 'left' as const,\r\n      render: (resource: string) => (\r\n        <Space>\r\n          <Text strong>{formatResourceName(resource)}</Text>\r\n          <Tag color=\"blue\">{resource}</Tag>\r\n        </Space>\r\n      ),\r\n    },\r\n    {\r\n      title: (\r\n        <Space direction=\"vertical\" size={0} align=\"center\">\r\n          <Text>Create</Text>\r\n          <Checkbox\r\n            onChange={(e) => handleSelectAll('can_create', e.target.checked)}\r\n            disabled={!selectedRoleId}\r\n          >\r\n            <Text type=\"secondary\" style={{ fontSize: 11 }}>\r\n              All\r\n            </Text>\r\n          </Checkbox>\r\n        </Space>\r\n      ),\r\n      dataIndex: 'can_create',\r\n      key: 'can_create',\r\n      align: 'center' as const,\r\n      width: 100,\r\n      render: (value: boolean, record: any) => (\r\n        <Checkbox\r\n          checked={value}\r\n          onChange={(e) =>\r\n            handlePermissionChange(\r\n              record.resource,\r\n              'can_create',\r\n              e.target.checked\r\n            )\r\n          }\r\n          disabled={!selectedRoleId}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: (\r\n        <Space direction=\"vertical\" size={0} align=\"center\">\r\n          <Text>Read</Text>\r\n          <Checkbox\r\n            onChange={(e) => handleSelectAll('can_read', e.target.checked)}\r\n            disabled={!selectedRoleId}\r\n          >\r\n            <Text type=\"secondary\" style={{ fontSize: 11 }}>\r\n              All\r\n            </Text>\r\n          </Checkbox>\r\n        </Space>\r\n      ),\r\n      dataIndex: 'can_read',\r\n      key: 'can_read',\r\n      align: 'center' as const,\r\n      width: 100,\r\n      render: (value: boolean, record: any) => (\r\n        <Checkbox\r\n          checked={value}\r\n          onChange={(e) =>\r\n            handlePermissionChange(\r\n              record.resource,\r\n              'can_read',\r\n              e.target.checked\r\n            )\r\n          }\r\n          disabled={!selectedRoleId}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: (\r\n        <Space direction=\"vertical\" size={0} align=\"center\">\r\n          <Text>Update</Text>\r\n          <Checkbox\r\n            onChange={(e) => handleSelectAll('can_update', e.target.checked)}\r\n            disabled={!selectedRoleId}\r\n          >\r\n            <Text type=\"secondary\" style={{ fontSize: 11 }}>\r\n              All\r\n            </Text>\r\n          </Checkbox>\r\n        </Space>\r\n      ),\r\n      dataIndex: 'can_update',\r\n      key: 'can_update',\r\n      align: 'center' as const,\r\n      width: 100,\r\n      render: (value: boolean, record: any) => (\r\n        <Checkbox\r\n          checked={value}\r\n          onChange={(e) =>\r\n            handlePermissionChange(\r\n              record.resource,\r\n              'can_update',\r\n              e.target.checked\r\n            )\r\n          }\r\n          disabled={!selectedRoleId}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: (\r\n        <Space direction=\"vertical\" size={0} align=\"center\">\r\n          <Text>Delete</Text>\r\n          <Checkbox\r\n            onChange={(e) => handleSelectAll('can_delete', e.target.checked)}\r\n            disabled={!selectedRoleId}\r\n          >\r\n            <Text type=\"secondary\" style={{ fontSize: 11 }}>\r\n              All\r\n            </Text>\r\n          </Checkbox>\r\n        </Space>\r\n      ),\r\n      dataIndex: 'can_delete',\r\n      key: 'can_delete',\r\n      align: 'center' as const,\r\n      width: 100,\r\n      render: (value: boolean, record: any) => (\r\n        <Checkbox\r\n          checked={value}\r\n          onChange={(e) =>\r\n            handlePermissionChange(\r\n              record.resource,\r\n              'can_delete',\r\n              e.target.checked\r\n            )\r\n          }\r\n          disabled={!selectedRoleId}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Summary',\r\n      key: 'summary',\r\n      align: 'center' as const,\r\n      width: 120,\r\n      render: (_: any, record: any) => {\r\n        const perms = permissions[record.resource];\r\n        const count = [\r\n          perms?.can_create,\r\n          perms?.can_read,\r\n          perms?.can_update,\r\n          perms?.can_delete,\r\n        ].filter(Boolean).length;\r\n\r\n        return (\r\n          <Space>\r\n            {count === 4 ? (\r\n              <Tag color=\"success\" icon={<CheckCircleOutlined />}>\r\n                Full Access\r\n              </Tag>\r\n            ) : count === 0 ? (\r\n              <Tag color=\"error\" icon={<CloseCircleOutlined />}>\r\n                No Access\r\n              </Tag>\r\n            ) : (\r\n              <Tag color=\"processing\">{count}/4</Tag>\r\n            )}\r\n          </Space>\r\n        );\r\n      },\r\n    },\r\n  ];\r\n\r\n  const formatResourceName = (resource: string): string => {\r\n    return resource\r\n      .split('_')\r\n      .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\r\n      .join(' ');\r\n  };\r\n\r\n  const dataSource = Object.entries(permissions).map(([resource, perms]) => ({\r\n    key: resource,\r\n    resource: resource,\r\n    can_create: perms.can_create,\r\n    can_read: perms.can_read,\r\n    can_update: perms.can_update,\r\n    can_delete: perms.can_delete,\r\n  }));\r\n\r\n  const selectedRole = roles.find((r) => r._id === selectedRoleId);\r\n\r\n  return (\r\n    <div className=\"permission-management\">\r\n      <Card\r\n        title={\r\n          <Space>\r\n            <Title level={4} style={{ margin: 0 }}>\r\n              Permission Management\r\n            </Title>\r\n          </Space>\r\n        }\r\n        extra={\r\n          <Space>\r\n            <Tooltip title=\"Refresh\">\r\n              <Button\r\n                icon={<ReloadOutlined />}\r\n                onClick={() => {\r\n                  fetchRoles();\r\n                  if (selectedRoleId) {\r\n                    fetchRolePermissions(selectedRoleId);\r\n                  }\r\n                }}\r\n              >\r\n                Refresh\r\n              </Button>\r\n            </Tooltip>\r\n            <Button\r\n              type=\"primary\"\r\n              icon={<SaveOutlined />}\r\n              onClick={handleSave}\r\n              loading={saving}\r\n              disabled={!selectedRoleId}\r\n            >\r\n              Save Changes\r\n            </Button>\r\n          </Space>\r\n        }\r\n      >\r\n        <Space direction=\"vertical\" size=\"large\" style={{ width: '100%' }}>\r\n          {/* Role Selection */}\r\n          <div>\r\n            <Text strong style={{ marginRight: 8 }}>\r\n              Select Role:\r\n            </Text>\r\n            <Select\r\n              style={{ width: 300 }}\r\n              placeholder=\"Choose a role to manage permissions\"\r\n              value={selectedRoleId || undefined}\r\n              onChange={setSelectedRoleId}\r\n              loading={loading}\r\n            >\r\n              {roles.map((role) => (\r\n                <Option key={role._id} value={role._id}>\r\n                  <Space>\r\n                    <Text>{role.name}</Text>\r\n                    <Tag color=\"blue\">{role.roles_type}</Tag>\r\n                  </Space>\r\n                </Option>\r\n              ))}\r\n            </Select>\r\n            {selectedRole && (\r\n              <Text type=\"secondary\" style={{ marginLeft: 12 }}>\r\n                {selectedRole.description}\r\n              </Text>\r\n            )}\r\n          </div>\r\n\r\n          {/* Permissions Table */}\r\n          <Spin spinning={loading}>\r\n            <Table\r\n              columns={columns}\r\n              dataSource={dataSource}\r\n              pagination={false}\r\n              scroll={{ x: 800, y: 500 }}\r\n              bordered\r\n              size=\"small\"\r\n              locale={{\r\n                emptyText: selectedRoleId\r\n                  ? 'No permissions found for this role'\r\n                  : 'Please select a role to view permissions',\r\n              }}\r\n            />\r\n          </Spin>\r\n\r\n          {/* Summary Stats */}\r\n          {selectedRoleId && dataSource.length > 0 && (\r\n            <Card size=\"small\" style={{ background: '#f5f5f5' }}>\r\n              <Space size=\"large\">\r\n                <Text>\r\n                  <Text strong>Total Resources:</Text> {dataSource.length}\r\n                </Text>\r\n                <Text>\r\n                  <Text strong>Full Access:</Text>{' '}\r\n                  {\r\n                    dataSource.filter(\r\n                      (d) =>\r\n                        d.can_create &&\r\n                        d.can_read &&\r\n                        d.can_update &&\r\n                        d.can_delete\r\n                    ).length\r\n                  }\r\n                </Text>\r\n                <Text>\r\n                  <Text strong>No Access:</Text>{' '}\r\n                  {\r\n                    dataSource.filter(\r\n                      (d) =>\r\n                        !d.can_create &&\r\n                        !d.can_read &&\r\n                        !d.can_update &&\r\n                        !d.can_delete\r\n                    ).length\r\n                  }\r\n                </Text>\r\n                <Text>\r\n                  <Text strong>Partial Access:</Text>{' '}\r\n                  {\r\n                    dataSource.filter(\r\n                      (d) =>\r\n                        [\r\n                          d.can_create,\r\n                          d.can_read,\r\n                          d.can_update,\r\n                          d.can_delete,\r\n                        ].filter(Boolean).length > 0 &&\r\n                        !(\r\n                          d.can_create &&\r\n                          d.can_read &&\r\n                          d.can_update &&\r\n                          d.can_delete\r\n                        )\r\n                    ).length\r\n                  }\r\n                </Text>\r\n              </Space>\r\n            </Card>\r\n          )}\r\n        </Space>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PermissionManagement;\r\n\r\n","// This icon file is generated automatically.\nvar SaveOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z\" } }] }, \"name\": \"save\", \"theme\": \"outlined\" };\nexport default SaveOutlined;\n","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport SaveOutlinedSvg from \"@ant-design/icons-svg/es/asn/SaveOutlined\";\nimport AntdIcon from \"../components/AntdIcon\";\nconst SaveOutlined = (props, ref) => /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n  ref: ref,\n  icon: SaveOutlinedSvg\n}));\n\n/**![save](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTg5My4zIDI5My4zTDczMC43IDEzMC43Yy03LjUtNy41LTE2LjctMTMtMjYuNy0xNlYxMTJIMTQ0Yy0xNy43IDAtMzIgMTQuMy0zMiAzMnY3MzZjMCAxNy43IDE0LjMgMzIgMzIgMzJoNzM2YzE3LjcgMCAzMi0xNC4zIDMyLTMyVjMzOC41YzAtMTctNi43LTMzLjItMTguNy00NS4yek0zODQgMTg0aDI1NnYxMDRIMzg0VjE4NHptNDU2IDY1NkgxODRWMTg0aDEzNnYxMzZjMCAxNy43IDE0LjMgMzIgMzIgMzJoMzIwYzE3LjcgMCAzMi0xNC4zIDMyLTMyVjIwNS44bDEzNiAxMzZWODQwek01MTIgNDQyYy03OS41IDAtMTQ0IDY0LjUtMTQ0IDE0NHM2NC41IDE0NCAxNDQgMTQ0IDE0NC02NC41IDE0NC0xNDQtNjQuNS0xNDQtMTQ0LTE0NHptMCAyMjRjLTQ0LjIgMC04MC0zNS44LTgwLTgwczM1LjgtODAgODAtODAgODAgMzUuOCA4MCA4MC0zNS44IDgwLTgwIDgweiIgLz48L3N2Zz4=) */\nconst RefIcon = /*#__PURE__*/React.forwardRef(SaveOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'SaveOutlined';\n}\nexport default RefIcon;"],"names":["Title","Text","Typography","Option","Select","PermissionManagement","roles","setRoles","useState","selectedRoleId","setSelectedRoleId","permissions","setPermissions","loading","setLoading","saving","setSaving","useEffect","fetchRoles","fetchRolePermissions","async","response","requestBackServer","method","endpoint","statusCode","rolesData","result","message","error","concat","console","roleId","_response$result","resourcesArray","resources","length","warning","permsData","forEach","item","resource","can_create","can_read","can_update","can_delete","allowed_menu_keys","handlePermissionChange","action","value","prev","_objectSpread","handleSelectAll","updatedPermissions","Object","keys","columns","title","dataIndex","key","width","fixed","render","_jsxs","Space","children","_jsx","strong","formatResourceName","Tag","color","direction","size","align","Checkbox","onChange","e","target","checked","disabled","type","style","fontSize","record","_","perms","count","filter","Boolean","icon","CheckCircleOutlined","CloseCircleOutlined","split","map","word","charAt","toUpperCase","slice","join","dataSource","entries","_ref2","selectedRole","find","r","_id","className","Card","level","margin","extra","Tooltip","Button","ReloadOutlined","onClick","SaveOutlined","permissionsArray","_ref","data","role_id","success","_error$response","_error$response$data","exception","marginRight","placeholder","undefined","role","name","roles_type","marginLeft","description","Spin","spinning","Table","pagination","scroll","x","y","bordered","locale","emptyText","background","d","_extends","assign","bind","i","arguments","source","prototype","hasOwnProperty","call","apply","this","props","ref","React","AntdIcon","SaveOutlinedSvg"],"sourceRoot":""}