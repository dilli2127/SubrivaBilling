{"version":3,"file":"static/js/90.37eb6282.chunk.js","mappings":"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","sources":["helpers/pdfHelper.ts"],"sourcesContent":["import { message } from 'antd';\r\nimport jsPDF from 'jspdf';\r\nimport html2canvas from 'html2canvas';\r\n\r\n/**\r\n * Print HTML content directly without converting to PDF first\r\n * Opens browser print dialog directly (Ctrl+P action)\r\n */\r\nexport const printAsPDF = async (\r\n  htmlContent: string,\r\n  fileName: string,\r\n  documentType: 'bill' | 'invoice' = 'bill'\r\n) => {\r\n  try {\r\n    message.loading(`Preparing ${documentType === 'bill' ? 'Bill' : 'Invoice'} for printing...`, 0);\r\n\r\n    // Create a hidden iframe for printing\r\n    const printFrame = document.createElement('iframe');\r\n    printFrame.style.position = 'absolute';\r\n    printFrame.style.width = '0';\r\n    printFrame.style.height = '0';\r\n    printFrame.style.border = 'none';\r\n    printFrame.style.visibility = 'hidden';\r\n    \r\n    document.body.appendChild(printFrame);\r\n\r\n    // Write HTML content with print styles to iframe\r\n    const iframeDoc = printFrame.contentDocument || printFrame.contentWindow?.document;\r\n    if (iframeDoc) {\r\n      iframeDoc.open();\r\n      iframeDoc.write(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n          <head>\r\n            <meta charset=\"UTF-8\">\r\n            <title>${fileName}</title>\r\n            <style>\r\n              * {\r\n                margin: 0;\r\n                padding: 0;\r\n                box-sizing: border-box;\r\n              }\r\n              body {\r\n                margin: 0;\r\n                padding: 0;\r\n                font-family: Arial, sans-serif;\r\n              }\r\n              @media print {\r\n                @page {\r\n                  size: A4;\r\n                  margin: 0;\r\n                }\r\n                body {\r\n                  margin: 0;\r\n                  padding: 0;\r\n                }\r\n              }\r\n            </style>\r\n          </head>\r\n          <body>\r\n            ${htmlContent}\r\n          </body>\r\n        </html>\r\n      `);\r\n      iframeDoc.close();\r\n\r\n      message.destroy();\r\n\r\n      // Wait for content to load, then trigger print\r\n      setTimeout(() => {\r\n        try {\r\n          printFrame.contentWindow?.focus();\r\n          printFrame.contentWindow?.print();\r\n          message.success(`${documentType === 'bill' ? 'Bill' : 'Invoice'} ready to print`);\r\n        } catch (error) {\r\n          console.error('Error triggering print:', error);\r\n          message.error('Failed to open print dialog');\r\n        }\r\n\r\n        // Clean up iframe after printing\r\n        setTimeout(() => {\r\n          if (document.body.contains(printFrame)) {\r\n            document.body.removeChild(printFrame);\r\n          }\r\n        }, 1000);\r\n      }, 500);\r\n    }\r\n  } catch (error) {\r\n    console.error('Error preparing print:', error);\r\n    message.destroy();\r\n    message.error('Failed to prepare print. Please try again.');\r\n  }\r\n};\r\n\r\n/**\r\n * Generate and download actual PDF file from HTML content\r\n * Uses html2canvas and jsPDF to create a real PDF file in A4 format\r\n */\r\nexport const downloadAsPDF = async (\r\n  htmlContent: string,\r\n  fileName: string,\r\n  documentType: 'bill' | 'invoice' = 'bill'\r\n) => {\r\n  try {\r\n    message.loading(`Generating ${documentType === 'bill' ? 'Bill' : 'Invoice'} PDF...`, 0);\r\n\r\n    // Create a temporary container\r\n    const container = document.createElement('div');\r\n    container.style.position = 'absolute';\r\n    container.style.left = '-9999px';\r\n    container.style.top = '0';\r\n    container.style.width = '190mm'; // Slightly less than A4 to ensure it fits\r\n    container.style.padding = '0';\r\n    container.style.backgroundColor = 'white';\r\n    container.innerHTML = htmlContent;\r\n    \r\n    document.body.appendChild(container);\r\n\r\n    // Wait for images and content to load\r\n    await new Promise(resolve => setTimeout(resolve, 500));\r\n\r\n    // Generate canvas from HTML\r\n    const canvas = await html2canvas(container, {\r\n      useCORS: true,\r\n      allowTaint: true,\r\n      backgroundColor: '#ffffff',\r\n      logging: false,\r\n      width: container.scrollWidth,\r\n      height: container.scrollHeight,\r\n    } as any);\r\n\r\n    // Remove temporary container\r\n    document.body.removeChild(container);\r\n\r\n    // Calculate PDF dimensions\r\n    const imgWidth = 210; // A4 width in mm\r\n    const pageHeight = 297; // A4 height in mm\r\n    const imgHeight = (canvas.height * imgWidth) / canvas.width;\r\n    \r\n    // Create PDF\r\n    const pdf = new jsPDF({\r\n      orientation: 'portrait',\r\n      unit: 'mm',\r\n      format: 'a4',\r\n    });\r\n\r\n    const imgData = canvas.toDataURL('image/png');\r\n    \r\n    // If content is less than 1.5 pages, fit it to a single page\r\n    // Only use multi-page if content is genuinely long (more than 1.5x page height)\r\n    if (imgHeight <= pageHeight * 1.5) {\r\n      // Single page - fit to A4 size\r\n      // If content is taller than one page, scale it down to fit\r\n      if (imgHeight > pageHeight) {\r\n        // Scale down to fit on one page\r\n        const scale = pageHeight / imgHeight;\r\n        const scaledWidth = imgWidth * scale;\r\n        const scaledHeight = pageHeight;\r\n        const xOffset = (imgWidth - scaledWidth) / 2; // Center horizontally\r\n        pdf.addImage(imgData, 'PNG', xOffset, 0, scaledWidth, scaledHeight);\r\n      } else {\r\n        // Fits normally\r\n        pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);\r\n      }\r\n    } else {\r\n      // Multi-page - content is genuinely very long (more than 1.5 pages)\r\n      let heightLeft = imgHeight;\r\n      let page = 0;\r\n      \r\n      while (heightLeft > 0) {\r\n        if (page > 0) {\r\n          pdf.addPage();\r\n        }\r\n        \r\n        // Calculate position for this page\r\n        const pagePosition = -(page * pageHeight);\r\n        pdf.addImage(imgData, 'PNG', 0, pagePosition, imgWidth, imgHeight);\r\n        \r\n        heightLeft -= pageHeight;\r\n        page++;\r\n      }\r\n    }\r\n\r\n    // Download PDF\r\n    pdf.save(`${fileName}.pdf`);\r\n\r\n    message.destroy();\r\n    message.success(`${documentType === 'bill' ? 'Bill' : 'Invoice'} PDF downloaded successfully!`);\r\n  } catch (error) {\r\n    console.error('Error generating PDF:', error);\r\n    message.destroy();\r\n    message.error('Failed to generate PDF. Please try again.');\r\n  }\r\n};\r\n"],"names":["printAsPDF","async","htmlContent","fileName","documentType","arguments","length","undefined","_printFrame$contentWi","message","loading","concat","printFrame","document","createElement","style","position","width","height","border","visibility","body","appendChild","iframeDoc","contentDocument","contentWindow","open","write","close","destroy","setTimeout","_printFrame$contentWi2","_printFrame$contentWi3","focus","print","success","error","console","contains","removeChild","downloadAsPDF","container","left","top","padding","backgroundColor","innerHTML","Promise","resolve","canvas","html2canvas","useCORS","allowTaint","logging","scrollWidth","scrollHeight","imgWidth","pageHeight","imgHeight","pdf","jsPDF","orientation","unit","format","imgData","toDataURL","scaledWidth","scaledHeight","xOffset","addImage","heightLeft","page","addPage","pagePosition","save"],"sourceRoot":""}