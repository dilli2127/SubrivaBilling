{"version":3,"file":"static/js/559.967f0964.chunk.js","mappings":"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","sources":["pages/DynamicEntity/hooks/useDynamicEntity.tsx","pages/DynamicEntity/DynamicEntityCrud.tsx"],"sourcesContent":["import { useCallback, useMemo, useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { apiSlice } from '../../../services/redux/api/apiSlice';\r\nimport { \r\n  EntityDefinition, \r\n  DynamicApiRoutes, \r\n  UseDynamicEntityReturn \r\n} from '../types';\r\n\r\n/**\r\n * Custom hook for managing dynamic entity operations\r\n * Handles entity definition fetching, API route generation, and entity validation\r\n */\r\nexport const useDynamicEntity = (): UseDynamicEntityReturn => {\r\n  const { entityName } = useParams<{ entityName: string }>();\r\n  const navigate = useNavigate();\r\n  const [entityDef, setEntityDef] = useState<EntityDefinition | null>(null);\r\n\r\n  // Use RTK Query to fetch entity definitions\r\n  const { data: entityDefData, isLoading: loading, error: queryError, refetch: fetchEntityDefinition } = apiSlice.useGetEntityDefinitionQuery(\r\n    { entity_name: entityName },\r\n    { skip: !entityName }\r\n  );\r\n\r\n  // Extract items from response\r\n  const items = useMemo(() => {\r\n    if (!entityDefData) return null;\r\n    const data = (entityDefData as any)?.result || entityDefData;\r\n    return data;\r\n  }, [entityDefData]);\r\n\r\n  const error = queryError ? (queryError as any) : null;\r\n\r\n  // Update entity definition when data changes\r\n  useEffect(() => {\r\n    const itemsResult = Array.isArray(items) ? items : (items?.result || []);\r\n    if (itemsResult && Array.isArray(itemsResult) && itemsResult.length > 0 && entityName) {\r\n      // Find the specific entity definition that matches the entityName\r\n      const definition = itemsResult.find((item: EntityDefinition) => item.entity_name === entityName);\r\n      if (definition) {\r\n        setEntityDef(definition);\r\n      } else {\r\n        // If no matching entity found, clear the definition\r\n        setEntityDef(null);\r\n      }\r\n    }\r\n  }, [items, entityName]);\r\n\r\n  // RTK Query automatically fetches when entityName changes\r\n  // No manual fetch needed\r\n\r\n  // Entity definition route (for backward compatibility, using RTK Query identifier)\r\n  const entityDefRoute = useMemo(() => ({\r\n    identifier: 'GetEntityDefinition',\r\n    method: 'POST',\r\n    endpoint: '/entity_definition',\r\n  }), []);\r\n\r\n  // Generate optimized API routes for dynamic entity\r\n  const dynamicApiRoutes = useMemo<DynamicApiRoutes | null>(() => {\r\n    if (!entityName) return null;\r\n    \r\n    const baseEndpoint = `/${entityName}`;\r\n    \r\n    return {\r\n      get: {\r\n        method: 'POST',\r\n        endpoint: baseEndpoint,\r\n        identifier: `GetAll_${entityName}`,\r\n      },\r\n      create: {\r\n        method: 'PUT',\r\n        endpoint: baseEndpoint,\r\n        identifier: `Add_${entityName}`,\r\n      },\r\n      update: {\r\n        method: 'POST',\r\n        endpoint: baseEndpoint,\r\n        identifier: `Update_${entityName}`,\r\n      },\r\n      delete: {\r\n        method: 'DELETE',\r\n        endpoint: baseEndpoint,\r\n        identifier: `Delete_${entityName}`,\r\n      },\r\n    };\r\n  }, [entityName]);\r\n\r\n\r\n  // Basic columns - dynamic columns will be generated by GenericCrudPage\r\n  const defaultColumns = useMemo(() => [\r\n    {\r\n      title: 'ID',\r\n      dataIndex: '_id',\r\n      key: '_id',\r\n      render: (text: string) => (\r\n        <span style={{ \r\n          fontFamily: 'monospace', \r\n          fontSize: '13px',\r\n          fontWeight: 500,\r\n          color: '#1890ff'\r\n        }}>\r\n          {text.substring(0, 8)}...\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Created',\r\n      dataIndex: 'createdAt',\r\n      key: 'createdAt',\r\n      render: (date: string) => (\r\n        <span style={{ fontSize: '13px', color: '#666' }}>\r\n          {new Date(date).toLocaleDateString()}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Updated',\r\n      dataIndex: 'updatedAt',\r\n      key: 'updatedAt',\r\n      render: (date: string) => (\r\n        <span style={{ fontSize: '13px', color: '#666' }}>\r\n          {new Date(date).toLocaleDateString()}\r\n        </span>\r\n      ),\r\n    },\r\n  ], []);\r\n\r\n  // Validation helpers\r\n  const isEntityValid = useMemo(() => {\r\n    return Boolean(entityDef && entityDef.is_active);\r\n  }, [entityDef]);\r\n\r\n  const hasError = useMemo(() => {\r\n    return error || (!loading && !isEntityValid);\r\n  }, [error, loading, isEntityValid]);\r\n\r\n  // Navigation helpers\r\n  const goBack = useCallback(() => {\r\n    navigate('/entities');\r\n  }, [navigate]);\r\n\r\n  const goToEntityDefinitions = useCallback(() => {\r\n    navigate('/entity-definitions');\r\n  }, [navigate]);\r\n\r\n  return {\r\n    // State\r\n    entityName,\r\n    entityDef,\r\n    loading,\r\n    error,\r\n    hasError,\r\n    isEntityValid,\r\n    \r\n    // Computed\r\n    dynamicApiRoutes,\r\n    defaultColumns,\r\n    \r\n    // Actions\r\n    fetchEntityDefinition,\r\n    goBack,\r\n    goToEntityDefinitions,\r\n    \r\n    // Helpers\r\n    entityDefRoute,\r\n  };\r\n};\r\n","import React, { useMemo, useCallback } from 'react';\r\nimport { Spin, Result, Button } from 'antd';\r\nimport { GenericCrudPage } from '../../components/common/GenericCrudPage';\r\nimport { useDynamicEntity } from './hooks/useDynamicEntity';\r\nimport { DynamicEntityConfig, FormValuesChangeHandler } from './types';\r\n\r\n/**\r\n * Optimized Dynamic CRUD page with column customization\r\n */\r\nconst DynamicEntityCrud: React.FC = () => {\r\n  const {\r\n    entityName,\r\n    entityDef,\r\n    loading,\r\n    hasError,\r\n    isEntityValid,\r\n    dynamicApiRoutes,\r\n    defaultColumns,\r\n    goBack,\r\n    goToEntityDefinitions,\r\n  } = useDynamicEntity();\r\n\r\n  const config = useMemo((): DynamicEntityConfig | null => {\r\n    if (!entityDef || !entityName) return null;\r\n\r\n    return {\r\n      title: entityDef.plural_name,\r\n      entityName: entityName,\r\n      columns: defaultColumns,\r\n      formItems: [],\r\n      formColumns: 2,\r\n      drawerWidth: 700,\r\n      skipMetadataWrapping: true,\r\n      metadataFieldName: 'custom_data',\r\n      enableDynamicFields: true,\r\n      enableSuperAdminFilters: true,\r\n    };\r\n  }, [entityDef, entityName, defaultColumns]);\r\n\r\n  const handleValuesChange = useCallback<FormValuesChangeHandler>((_changed, all) => {\r\n    if (entityDef && !all.entity_name) {\r\n      all.entity_name = entityDef.entity_name;\r\n    }\r\n  }, [entityDef]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '50vh' }}>\r\n        <Spin size=\"large\" tip={`Loading ${entityName} definition...`} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (hasError || !isEntityValid || !config) {\r\n    return (\r\n      <Result\r\n        status=\"404\"\r\n        title=\"Entity Not Found\"\r\n        subTitle={`The entity \"${entityName}\" does not exist or is not active.`}\r\n        extra={\r\n          <div>\r\n            <Button type=\"primary\" onClick={goBack} style={{ marginRight: 8 }}>\r\n              Back to Entities\r\n            </Button>\r\n            <Button onClick={goToEntityDefinitions}>\r\n              Manage Entity Definitions\r\n            </Button>\r\n          </div>\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <GenericCrudPage\r\n      config={config}\r\n      enableDynamicFields={true}\r\n      showDynamicColumnsInTable={true} // Show dynamic columns in table for pure dynamic entities\r\n      entityName={entityDef?.entity_name}\r\n      enableSuperAdminFilters={true}\r\n      onValuesChange={handleValuesChange}\r\n    />\r\n  );\r\n};\r\n\r\nexport default DynamicEntityCrud;\r\n\r\n"],"names":["DynamicEntityCrud","entityName","entityDef","loading","hasError","isEntityValid","dynamicApiRoutes","defaultColumns","goBack","goToEntityDefinitions","useDynamicEntity","useParams","navigate","useNavigate","setEntityDef","useState","data","entityDefData","isLoading","error","queryError","refetch","fetchEntityDefinition","apiSlice","useGetEntityDefinitionQuery","entity_name","skip","items","useMemo","result","useEffect","itemsResult","Array","isArray","length","definition","find","item","entityDefRoute","identifier","method","endpoint","baseEndpoint","concat","get","create","update","delete","title","dataIndex","key","render","text","_jsxs","style","fontFamily","fontSize","fontWeight","color","children","substring","date","_jsx","Date","toLocaleDateString","Boolean","is_active","useCallback","config","plural_name","columns","formItems","formColumns","drawerWidth","skipMetadataWrapping","metadataFieldName","enableDynamicFields","enableSuperAdminFilters","handleValuesChange","_changed","all","display","justifyContent","alignItems","height","Spin","size","tip","GenericCrudPage","showDynamicColumnsInTable","onValuesChange","Result","status","subTitle","extra","Button","type","onClick","marginRight"],"sourceRoot":""}