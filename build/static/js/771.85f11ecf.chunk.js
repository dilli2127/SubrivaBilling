"use strict";(self.webpackChunkSUBRIVA_BILLING=self.webpackChunkSUBRIVA_BILLING||[]).push([[771],{28771:(e,t,n)=>{n.r(t),n.d(t,{default:()=>pe});var i=n(89379),l=n(65043),o=n(83833),s=n(62305),a=n(76399),d=n(96651),r=n(6051),c=n(95206),m=n(60647),u=n(36621),x=n(62751),h=n(36091),p=n(6881),g=n(53722),v=n(11951),y=n(76401),j=n(61118),f=n(75388),b=n(94834),A=n(9316),_=n(72411),S=n(73847),I=n(60446),C=n.n(I),w=n(22671),T=n(83537),N=n(97031),D=n(13658),k=n(39249),P=n(16569),B=n(8354),E=n(42261),M=n(46237),L=n(4394),G=n(87977);const z="EmailSendModal_emailSendModal__BfdYk",F="EmailSendModal_emailSendHeader__C2GeM",V="EmailSendModal_emailSendContent__18hO-",X="EmailSendModal_emailForm__Dz-ws",Y="EmailSendModal_formSection__XePkG",O="EmailSendModal_formActions__0+vVX",q="EmailSendModal_emailPreview__z0YAf",R="EmailSendModal_previewContent__i+Cpp",W="EmailSendModal_previewHeader__Y+2Wh",U="EmailSendModal_previewBody__wL6Yl",Q="EmailSendModal_htmlPreview__Lr4X+",H="EmailSendModal_previewActions__l-Y3Y",J="EmailSendModal_billInfo__1yHvY",K="EmailSendModal_successState__gVP0P",Z="EmailSendModal_successIcon__levgm";var $=n(70579);const{Title:ee,Text:te}=o.A,{TextArea:ne}=u.A,ie=e=>{var t;let{visible:n,onClose:i,billData:o,customerEmail:a,customerName:d}=e;const[m]=s.A.useForm(),[h,p]=(0,l.useState)(!1),[g,v]=(0,l.useState)(!1),[y,b]=(0,l.useState)(null),[A,_]=(0,l.useState)(!1),[S,I]=(0,l.useState)(!1),{getEntityApi:C}=(0,T.p)();(0,l.useEffect)((()=>{n&&a&&m.setFieldsValue({to:a,subject:"Invoice #".concat((null===o||void 0===o?void 0:o.invoice_no)||""," - ").concat(d||"")})}),[n,a,d,o,m]);const w=e=>{var t,n;return"\nDear ".concat((null===(t=e.customerDetails)||void 0===t?void 0:t.full_name)||"Valued Customer",",\n\nThank you for your business! Please find your invoice details below:\n\nInvoice Number: ").concat(e.invoice_no,"\nDate: ").concat(new Date(e.date).toLocaleDateString(),"\nTotal Amount: \u20b9").concat(e.total_amount||0,"\n\nItems:\n").concat((null===(n=e.Items)||void 0===n?void 0:n.map((e=>{var t;return"- ".concat(null===(t=e.productItems)||void 0===t?void 0:t.name," (").concat(e.qty," x \u20b9").concat(e.price,") = \u20b9").concat(e.amount)})).join("\n"))||"No items","\n\nPayment Status: ").concat(e.is_paid?"Paid":"Pending","\n\nThank you for choosing us!\n\nBest regards,\nSubriva Billing Team\n    ").trim()},N=e=>{var t,n,i;return'\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset="UTF-8">\n        <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .header { background: #f8f9fa; padding: 20px; text-align: center; }\n            .content { padding: 20px; }\n            .invoice-table { width: 100%; border-collapse: collapse; margin: 20px 0; }\n            .invoice-table th, .invoice-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }\n            .invoice-table th { background-color: #f8f9fa; }\n            .total { font-weight: bold; font-size: 18px; }\n            .footer { background: #f8f9fa; padding: 20px; text-align: center; margin-top: 20px; }\n        </style>\n    </head>\n    <body>\n        <div class="header">\n            <h1>Subriva Billing</h1>\n            <h2>Invoice #'.concat(e.invoice_no,'</h2>\n        </div>\n        \n        <div class="content">\n            <p>Dear <strong>').concat((null===(t=e.customerDetails)||void 0===t?void 0:t.full_name)||"Valued Customer",'</strong>,</p>\n            \n            <p>Thank you for your business! Please find your invoice details below:</p>\n            \n            <table class="invoice-table">\n                <tr>\n                    <th>Invoice Number</th>\n                    <td>').concat(e.invoice_no,"</td>\n                </tr>\n                <tr>\n                    <th>Date</th>\n                    <td>").concat(new Date(e.date).toLocaleDateString(),"</td>\n                </tr>\n                <tr>\n                    <th>Customer</th>\n                    <td>").concat((null===(n=e.customerDetails)||void 0===n?void 0:n.full_name)||"N/A",'</td>\n                </tr>\n            </table>\n            \n            <h3>Items:</h3>\n            <table class="invoice-table">\n                <thead>\n                    <tr>\n                        <th>Product</th>\n                        <th>Quantity</th>\n                        <th>Price</th>\n                        <th>Amount</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    ').concat((null===(i=e.Items)||void 0===i?void 0:i.map((e=>{var t;return"\n                        <tr>\n                            <td>".concat((null===(t=e.productItems)||void 0===t?void 0:t.name)||"N/A","</td>\n                            <td>").concat(e.qty||0,"</td>\n                            <td>\u20b9").concat(e.price||0,"</td>\n                            <td>\u20b9").concat(e.amount||0,"</td>\n                        </tr>\n                    ")})).join(""))||'<tr><td colspan="4">No items</td></tr>','\n                </tbody>\n                <tfoot>\n                    <tr class="total">\n                        <td colspan="3">Total Amount</td>\n                        <td>\u20b9').concat(e.total_amount||0,"</td>\n                    </tr>\n                </tfoot>\n            </table>\n            \n            <p><strong>Payment Status:</strong> ").concat(e.is_paid?"Paid":"Pending",'</p>\n        </div>\n        \n        <div class="footer">\n            <p>Thank you for choosing us!</p>\n            <p><strong>Best regards,<br>Subriva Billing Team</strong></p>\n        </div>\n    </body>\n    </html>\n    ')},D=async e=>{if(o){_(!0);try{const t=sessionStorage.getItem("token"),n=sessionStorage.getItem("csrf-token"),l=await fetch("".concat("http://localhost:8249/","/email/send-invoice"),{method:"POST",headers:{"Content-Type":"application/json",token:t||"","x-csrf-token":n||""},body:JSON.stringify({customerEmail:e.to,invoiceData:o,subject:e.subject,customMessage:e.message||""})}),s=await l.json();s.success?(I(!0),P.Ay.success("Invoice sent successfully to ".concat(e.to)),setTimeout((()=>{i()}),2e3)):P.Ay.error(s.error||"Failed to send email")}catch(t){console.error("Error sending email:",t),P.Ay.error("Failed to send email. Please try again.")}finally{_(!1)}}else P.Ay.error("No bill data available")},k=()=>{m.validateFields().then(D)},ie=()=>{m.resetFields(),v(!1),b(null),I(!1),i()};return(0,$.jsx)(x.A,{title:(0,$.jsxs)("div",{className:F,children:[(0,$.jsx)(f.A,{}),(0,$.jsx)("span",{children:"Send Invoice via Email"})]}),open:n,onCancel:ie,width:900,className:z,footer:null,destroyOnClose:!0,children:(0,$.jsx)("div",{className:V,children:S?(0,$.jsxs)("div",{className:K,children:[(0,$.jsx)(M.A,{className:Z}),(0,$.jsx)(ee,{level:3,children:"Email Sent Successfully!"}),(0,$.jsxs)(te,{type:"secondary",children:["The invoice has been sent to ",m.getFieldValue("to")]})]}):(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(s.A,{form:m,layout:"vertical",onFinish:k,className:X,children:[(0,$.jsxs)("div",{className:Y,children:[(0,$.jsx)(ee,{level:4,children:"Email Details"}),(0,$.jsx)(s.A.Item,{label:"To",name:"to",rules:[{required:!0,message:"Please enter recipient email"},{type:"email",message:"Please enter valid email address"}],children:(0,$.jsx)(u.A,{prefix:(0,$.jsx)(f.A,{}),placeholder:"customer@example.com",size:"large"})}),(0,$.jsx)(s.A.Item,{label:"Subject",name:"subject",rules:[{required:!0,message:"Please enter email subject"}],children:(0,$.jsx)(u.A,{placeholder:"Invoice subject",size:"large"})}),(0,$.jsx)(s.A.Item,{label:"Custom Message (Optional)",name:"message",children:(0,$.jsx)(ne,{rows:3,placeholder:"Add a personal message to the customer..."})})]}),(0,$.jsx)(B.A,{}),(0,$.jsx)("div",{className:O,children:(0,$.jsxs)(r.A,{children:[(0,$.jsx)(c.Ay,{icon:(0,$.jsx)(j.A,{}),onClick:async()=>{if(o){p(!0);try{var e;const t={subject:"Invoice #".concat(o.invoice_no," - ").concat((null===(e=o.customerDetails)||void 0===e?void 0:e.full_name)||"Customer"),text:w(o),html:N(o)};b(t),v(!0),m.setFieldsValue({subject:t.subject})}catch(t){P.Ay.error("Failed to generate email preview")}finally{p(!1)}}},loading:h,disabled:!o,children:"Preview Email"}),(0,$.jsx)(c.Ay,{type:"primary",icon:(0,$.jsx)(L.A,{}),htmlType:"submit",loading:A,disabled:!o,children:"Send Email"}),(0,$.jsx)(c.Ay,{onClick:ie,children:"Cancel"})]})})]}),g&&y&&(0,$.jsxs)("div",{className:q,children:[(0,$.jsx)(B.A,{children:"Email Preview"}),(0,$.jsxs)("div",{className:R,children:[(0,$.jsx)("div",{className:W,children:(0,$.jsxs)(ee,{level:5,children:["Subject: ",y.subject]})}),(0,$.jsx)("div",{className:U,children:(0,$.jsx)("div",{className:Q,dangerouslySetInnerHTML:{__html:(le=y.html,G.A.sanitize(le,{ALLOWED_TAGS:["b","i","em","strong","u","s","a","p","br","ul","ol","li","h1","h2","h3","h4","h5","h6","blockquote","code","pre","span","div","hr","table","thead","tbody","tr","th","td"],ALLOWED_ATTR:["href","title","target","class","id"],ALLOW_DATA_ATTR:!1}))}})}),(0,$.jsxs)("div",{className:H,children:[(0,$.jsx)(c.Ay,{type:"primary",icon:(0,$.jsx)(L.A,{}),onClick:k,loading:A,children:"Send This Email"}),(0,$.jsx)(c.Ay,{onClick:()=>v(!1),children:"Back to Edit"})]})]})]}),o&&(0,$.jsx)("div",{className:J,children:(0,$.jsx)(E.A,{message:"Invoice Information",description:(0,$.jsxs)("div",{children:[(0,$.jsx)(te,{strong:!0,children:"Invoice #:"})," ",o.invoice_no,(0,$.jsx)("br",{}),(0,$.jsx)(te,{strong:!0,children:"Customer:"})," ",(null===(t=o.customerDetails)||void 0===t?void 0:t.full_name)||"N/A",(0,$.jsx)("br",{}),(0,$.jsx)(te,{strong:!0,children:"Amount:"})," \u20b9",o.total_amount||0]}),type:"info",showIcon:!0})})]})})});var le},{Title:le,Text:oe}=o.A,se=e=>{var t,n,i;let{visible:o,onClose:s,billData:a}=e;const d=(0,l.useRef)(null),[r,m]=(0,l.useState)(!1),u=e=>(Number(e)||0).toFixed(2),h="Focuz Medicals",p="123 MG Road, Bangalore, Karnataka - 560001",g="29ABCDE1234F1Z5",v=[{title:"Item",dataIndex:"productItems",key:"name",render:(e,t)=>{var n;const i=t.productItems;if(!i)return"";const l=null===(n=i.VariantItem)||void 0===n?void 0:n.variant_name;return l?"".concat(i.name," - ").concat(l):i.name}},{title:"Qty",dataIndex:"qty",key:"qty",width:100,render:e=>e||0},{title:"Loose Qty",dataIndex:"loose_qty",key:"loose_qty",width:100,render:e=>e||0},{title:"Price",dataIndex:"price",key:"price",width:120,render:e=>"\u20b9 ".concat(u(e))},{title:"Amount",dataIndex:"amount",key:"amount",width:120,render:e=>"\u20b9 ".concat(u(e))}];return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(x.A,{title:(0,$.jsx)(le,{level:4,style:{margin:0,color:"#1890ff"},children:"Sale Details"}),open:o,onCancel:s,width:800,footer:[(0,$.jsx)(c.Ay,{type:"primary",icon:(0,$.jsx)(f.A,{}),onClick:()=>m(!0),children:"Send via Email"},"email"),(0,$.jsx)(c.Ay,{icon:(0,$.jsx)(b.A,{}),onClick:()=>{var e;const t="\n      <html>\n        <head>\n          <title>Sale - ".concat(a.invoice_no,'</title>\n          <style>\n            body { font-family: Arial, sans-serif; padding: 20px; color: #222; }\n            .shop-info { text-align: center; margin-bottom: 20px; }\n            .shop-info h2 { margin-bottom: 0; color: #1890ff; }\n            .info-flex { display: flex; justify-content: space-between; margin-bottom: 10px; }\n            table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }\n            th { background-color: #f5f5f5; }\n            .total { text-align: right; font-weight: bold; margin-top: 10px; }\n            .thank-you { text-align: center; margin-top: 40px; font-size: 16px; color: #1890ff; font-weight: bold; }\n            @media print {\n              .no-print { display: none; }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="shop-info">\n            <h2>').concat(h,"</h2>\n            <p>").concat(p,"</p>\n            <p><strong>GST No:</strong> ").concat(g,'</p>\n          </div>\n\n          <div class="info-flex">\n            <div>\n              <p><strong>Invoice No:</strong> ').concat(a.invoice_no,"</p>\n              <p><strong>Date:</strong> ").concat(new Date(a.date).toLocaleDateString(),'</p>\n            </div>\n            <div style="text-align: right;">\n              <p><strong>Customer:</strong> ').concat((null===(e=a.customerDetails)||void 0===e?void 0:e.full_name)||"","</p>\n              <p><strong>Payment Mode:</strong> ").concat(a.payment_mode||"","</p>\n            </div>\n          </div>\n\n          <table>\n            <thead>\n              <tr>\n                <th>Item</th>\n                <th>Qty</th>\n                <th>Loose Qty</th>\n                <th>Price</th>\n                <th>Amount</th>\n              </tr>\n            </thead>\n            <tbody>\n              ").concat(a.Items.map((e=>{var t;const n=e.productItems,i=n?"".concat(n.name).concat(null!==(t=n.VariantItem)&&void 0!==t&&t.variant_name?" - ".concat(n.VariantItem.variant_name):""):"";return"\n                  <tr>\n                    <td>".concat(i,"</td>\n                    <td>").concat(e.qty||0,"</td>\n                    <td>").concat(e.loose_qty||0,"</td>\n                    <td>\u20b9 ").concat(u(e.price),"</td>\n                    <td>\u20b9 ").concat(u(e.amount),"</td>\n                  </tr>\n                ")})).join(""),'\n            </tbody>\n          </table>\n\n          <div class="total">\n            <p>Value of Goods: \u20b9 ').concat(u(a.value_of_goods),"</p>\n            ").concat(a.discount>0?"\n              <p>Discount: ".concat("percentage"===a.discount_type?a.discount+"%":"\u20b9 "+u(a.discount),"</p>\n            "):"","\n            <p>Total GST: \u20b9 ").concat(u(a.total_gst),"</p>\n            <p>CGST: \u20b9 ").concat(u(a.cgst||a.total_gst/2),"</p>\n            <p>SGST: \u20b9 ").concat(u(a.sgst||a.total_gst/2),"</p>\n            <p><strong>").concat("retail"===a.sale_type?"Bill Value":"Invoice Value",": \u20b9 ").concat(u(a.total_amount),"</strong></p>\n            ").concat(a.is_partially_paid?"\n              <p>Paid Amount: \u20b9 ".concat(u(a.paid_amount),"</p>\n              <p>Remaining Amount: \u20b9 ").concat(u(Number(a.total_amount)-Number(a.paid_amount)),"</p>\n            "):"","\n            <p><strong>Payment Status:</strong> ").concat(a.is_paid?"Fully Paid":a.is_partially_paid?"Partially Paid":"Unpaid","</p>\n          </div>\n\n          <div class=\"thank-you\">\n            Thank you for shopping with us!\n          </div>\n\n          <script>\n            window.onload = function() {\n              window.print();\n              window.onafterprint = function() {\n                window.parent.postMessage('printComplete', '*');\n              };\n            };\n          <\/script>\n        </body>\n      </html>\n    "),n=d.current;n.contentWindow.document.open(),n.contentWindow.document.write(t),n.contentWindow.document.close(),window.addEventListener("message",(e=>{"printComplete"===e.data&&s()}))},children:"Print Sale"},"print"),(0,$.jsx)(c.Ay,{onClick:s,children:"Close"},"close")],children:[(0,$.jsxs)("div",{style:{textAlign:"center",marginBottom:16},children:[(0,$.jsx)(le,{level:4,style:{marginBottom:0,color:"#1890ff"},children:h}),(0,$.jsx)(oe,{children:p}),(0,$.jsx)("br",{}),(0,$.jsxs)(oe,{children:[(0,$.jsx)("strong",{children:"GST No:"})," ",(0,$.jsx)(oe,{code:!0,children:g})]})]}),(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[(0,$.jsxs)("div",{children:[(0,$.jsx)(oe,{strong:!0,children:"Invoice No:"})," ",a.invoice_no,(0,$.jsx)("br",{}),(0,$.jsx)(oe,{strong:!0,children:"Date:"})," ",new Date(a.date).toLocaleDateString()]}),(0,$.jsxs)("div",{style:{textAlign:"right"},children:[(0,$.jsx)(oe,{strong:!0,children:"Customer:"})," ",null===(t=a.customerDetails)||void 0===t?void 0:t.full_name,(0,$.jsx)("br",{}),(0,$.jsx)(oe,{strong:!0,children:"Payment Mode:"})," ",a.payment_mode]})]}),(0,$.jsx)(k.A,{dataSource:a.Items,columns:v,pagination:!1,bordered:!0,summary:()=>(0,$.jsxs)(k.A.Summary.Row,{children:[(0,$.jsx)(k.A.Summary.Cell,{index:0,colSpan:4,children:(0,$.jsx)(oe,{strong:!0,children:"Total Amount:"})}),(0,$.jsx)(k.A.Summary.Cell,{index:1,children:(0,$.jsxs)(oe,{strong:!0,children:["\u20b9 ",u(a.sub_total)]})})]})}),(0,$.jsxs)("div",{style:{marginTop:20,textAlign:"right"},children:[(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginBottom:"8px"},children:[(0,$.jsx)(oe,{strong:!0,children:"Value of Goods:"}),(0,$.jsxs)(oe,{children:["\u20b9 ",u(a.value_of_goods)]})]}),a.discount>0&&(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginBottom:"8px"},children:[(0,$.jsx)(oe,{strong:!0,children:"Discount:"}),(0,$.jsx)(oe,{children:"percentage"===a.discount_type?"".concat(a.discount,"%"):"\u20b9 ".concat(u(a.discount))})]}),(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginBottom:"8px"},children:[(0,$.jsx)(oe,{strong:!0,children:"Total GST:"}),(0,$.jsxs)(oe,{children:["\u20b9 ",u(a.total_gst)]})]}),(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginBottom:"8px"},children:[(0,$.jsx)(oe,{strong:!0,children:"CGST:"}),(0,$.jsxs)(oe,{children:["\u20b9 ",u(a.cgst||a.total_gst/2)]})]}),(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginBottom:"8px"},children:[(0,$.jsx)(oe,{strong:!0,children:"SGST:"}),(0,$.jsxs)(oe,{children:["\u20b9 ",u(a.sgst||a.total_gst/2)]})]}),(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",marginBottom:"8px"},children:[(0,$.jsxs)(oe,{strong:!0,children:["retail"===a.sale_type?"Bill Value":"Invoice Value",":"]}),(0,$.jsxs)(oe,{children:["\u20b9 ",u(a.total_amount)]})]}),(0,$.jsx)(oe,{strong:!0,children:"Payment Status: "}),a.is_paid?(0,$.jsx)(oe,{type:"success",children:"Fully Paid"}):a.is_partially_paid?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(oe,{type:"warning",children:"Partially Paid"}),(0,$.jsx)("br",{}),(0,$.jsxs)(oe,{children:["Paid Amount: \u20b9 ",u(a.paid_amount)]}),(0,$.jsx)("br",{}),(0,$.jsxs)(oe,{children:["Remaining Amount: \u20b9"," ",u(Number(a.total_amount)-Number(a.paid_amount))]})]}):(0,$.jsx)(oe,{type:"danger",children:"Unpaid"})]}),(0,$.jsx)("div",{style:{textAlign:"center",marginTop:40},children:(0,$.jsx)(oe,{style:{color:"#1890ff",fontWeight:500},children:"Thank you for shopping with us!"})})]}),(0,$.jsx)("iframe",{ref:d,style:{display:"none"},title:"print-frame"}),(0,$.jsx)(ie,{visible:r,onClose:()=>m(!1),billData:a,customerEmail:null===a||void 0===a||null===(n=a.customerDetails)||void 0===n?void 0:n.email,customerName:null===a||void 0===a||null===(i=a.customerDetails)||void 0===i?void 0:i.full_name})]})};var ae=n(4413),de=n(94211),re=n(83003),ce=n(22115);const me={borderBottom:"1px solid #000",padding:"2px",textAlign:"left",fontSize:"11px"},ue={padding:"2px",fontSize:"11px"},xe={classic:{label:"Classic",component:e=>{var t,n,i,l;let{billData:o}=e;const s=(0,ce.J)();return(0,$.jsxs)("div",{style:{fontFamily:"Courier New, monospace",background:"#fff",border:"1px solid #ddd",maxWidth:"380px",margin:"20px auto",padding:"16px",fontSize:"12px",color:"#000"},children:[(0,$.jsxs)("div",{style:{textAlign:"center",marginBottom:"8px"},children:[(0,$.jsx)("h3",{style:{margin:"4px 0",fontWeight:"bold",fontSize:"16px"},children:(null===s||void 0===s||null===(t=s.organisationItems)||void 0===t?void 0:t.org_name)||""}),(0,$.jsx)("div",{style:{fontSize:"11px",marginBottom:"4px"},children:(null===s||void 0===s||null===(n=s.branchItems)||void 0===n?void 0:n.address1)||""}),(0,$.jsxs)("div",{style:{fontSize:"11px"},children:["GSTIN: ",(null===s||void 0===s||null===(i=s.organisationItems)||void 0===i?void 0:i.gst_number)||"33XXXXXXXXXXX"]})]}),(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[(0,$.jsxs)("div",{children:[(0,$.jsxs)("div",{children:["BILL NO: ",(null===o||void 0===o?void 0:o.invoice_no)||"INV-XXXX"]}),(0,$.jsxs)("div",{children:["DATE:"," ",null!==o&&void 0!==o&&o.date?new Date(o.date).toLocaleDateString():"-"]})]}),(0,$.jsx)("div",{style:{textAlign:"right"},children:(0,$.jsxs)("div",{children:["NAME:"," ",((null===o||void 0===o?void 0:o.customerName)||"").substring(0,20).toUpperCase()]})})]}),(0,$.jsx)("div",{style:{borderTop:"1px dashed #000",margin:"4px 0"}}),(0,$.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"8px"},children:[(0,$.jsx)("thead",{children:(0,$.jsxs)("tr",{children:[(0,$.jsx)("th",{style:me,children:"S.No"}),(0,$.jsx)("th",{style:me,children:"Item"}),(0,$.jsx)("th",{style:me,children:"Qty"}),(0,$.jsx)("th",{style:me,children:"Rate"}),(0,$.jsx)("th",{style:me,children:"MRP"}),(0,$.jsx)("th",{style:me,children:"Amt"})]})}),(0,$.jsx)("tbody",{children:null===o||void 0===o||null===(l=o.items)||void 0===l?void 0:l.map(((e,t)=>(0,$.jsxs)("tr",{children:[(0,$.jsx)("td",{style:ue,children:t+1}),(0,$.jsx)("td",{style:ue,children:e.name.length>15?e.name.substring(0,15)+"...":e.name}),(0,$.jsx)("td",{style:ue,children:e.qty}),(0,$.jsxs)("td",{style:ue,children:["\u20b9",e.price]}),(0,$.jsxs)("td",{style:ue,children:["\u20b9",e.mrp||e.price]}),(0,$.jsxs)("td",{style:ue,children:["\u20b9",e.amount]})]},t)))})]}),(0,$.jsx)("div",{style:{borderTop:"1px dashed #000",margin:"4px 0"}}),(0,$.jsxs)("div",{style:{textAlign:"right",fontWeight:"bold"},children:[(0,$.jsxs)("div",{children:["Subtotal: \u20b9 ",null===o||void 0===o?void 0:o.total]}),(0,$.jsxs)("div",{children:["CGST: \u20b9 ",((null===o||void 0===o?void 0:o.cgst)||((null===o||void 0===o?void 0:o.total_gst)||0)/2).toFixed(2)]}),(0,$.jsxs)("div",{children:["SGST: \u20b9 ",((null===o||void 0===o?void 0:o.sgst)||((null===o||void 0===o?void 0:o.total_gst)||0)/2).toFixed(2)]}),(0,$.jsxs)("div",{style:{fontSize:"14px"},children:["NET AMOUNT: \u20b9 ",null===o||void 0===o?void 0:o.total]})]}),(0,$.jsx)("div",{style:{borderTop:"1px dashed #000",margin:"8px 0"}}),(0,$.jsxs)("div",{style:{textAlign:"center",fontSize:"11px"},children:["*** GET WELL SOON. THANK YOU ***",(0,$.jsx)("br",{}),"Goods Once Sold Cannot Be Taken Back"]})]})},previewImg:"https://via.placeholder.com/220x120?text=Classic"},modern:{label:"Modern",component:e=>{var t,n,i,l,o;let{billData:s}=e;const a=(0,ce.J)();return(0,$.jsxs)("div",{style:{padding:30,background:"#fff",border:"1px solid #ccc",borderRadius:12,maxWidth:850,margin:"20px auto",color:"#333",fontFamily:"Georgia, serif",boxShadow:"0 0 10px rgba(0,0,0,0.08)"},children:[(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",borderBottom:"2px solid #333",paddingBottom:10,marginBottom:20},children:[(0,$.jsxs)("div",{children:[(0,$.jsx)("h1",{style:{margin:0,fontSize:24},children:(null===a||void 0===a||null===(t=a.organisationItems)||void 0===t?void 0:t.org_name)||"Your Company Name"}),(0,$.jsx)("p",{style:{margin:"5px 0",fontSize:14},children:(null===a||void 0===a||null===(n=a.branchItems)||void 0===n?void 0:n.branch_name)||"Branch Name"}),(0,$.jsx)("p",{style:{margin:0,fontSize:12},children:(null===a||void 0===a||null===(i=a.branchItems)||void 0===i?void 0:i.address1)||"Branch Address"})]}),(0,$.jsxs)("div",{style:{textAlign:"right",fontSize:12},children:[(0,$.jsxs)("p",{style:{margin:0},children:[(0,$.jsx)("strong",{children:"GSTIN:"})," ",(null===a||void 0===a||null===(l=a.organisationItems)||void 0===l?void 0:l.gst_number)||"-"]}),(0,$.jsx)("p",{style:{margin:"5px 0",fontWeight:600},children:"wholesale"===(null===s||void 0===s?void 0:s.sale_type)?"INVOICE":"CASH BILL"}),(0,$.jsxs)("p",{style:{margin:0},children:[(0,$.jsx)("strong",{children:"Invoice #:"})," ",(null===s||void 0===s?void 0:s.invoice_no)||"-"]})]})]}),(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:20},children:[(0,$.jsxs)("div",{style:{fontSize:13},children:[(0,$.jsxs)("p",{style:{margin:"2px 0"},children:[(0,$.jsx)("strong",{children:"Bill To:"})," ",(null===s||void 0===s?void 0:s.customerName)||"Customer Name"]}),(0,$.jsx)("p",{style:{margin:"2px 0",color:"#555"},children:(null===s||void 0===s?void 0:s.customerAddress)||"Customer Address"})]}),(0,$.jsx)("div",{style:{textAlign:"right",fontSize:13},children:(0,$.jsxs)("p",{style:{margin:"2px 0"},children:[(0,$.jsx)("strong",{children:"Date:"})," ",null!==s&&void 0!==s&&s.date?new Date(s.date).toLocaleDateString():"-"]})})]}),(0,$.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:20},children:[(0,$.jsx)("thead",{children:(0,$.jsxs)("tr",{style:{background:"rgba(255,255,255,0.08)"},children:[(0,$.jsx)("th",{style:{padding:10,textAlign:"left"},children:"Item"}),(0,$.jsx)("th",{style:{padding:10,textAlign:"right"},children:"Qty"}),(0,$.jsx)("th",{style:{padding:10,textAlign:"right"},children:"Price"}),(0,$.jsx)("th",{style:{padding:10,textAlign:"right"},children:"MRP"}),(0,$.jsx)("th",{style:{padding:10,textAlign:"right"},children:"Amount"})]})}),(0,$.jsx)("tbody",{children:null===s||void 0===s||null===(o=s.items)||void 0===o?void 0:o.map(((e,t)=>(0,$.jsxs)("tr",{style:{borderBottom:"1px solid rgba(255,255,255,0.10)"},children:[(0,$.jsx)("td",{style:{padding:10},children:e.name}),(0,$.jsx)("td",{style:{padding:10,textAlign:"right"},children:e.qty}),(0,$.jsx)("td",{style:{padding:10,textAlign:"right"},children:e.price}),(0,$.jsx)("td",{style:{padding:10,textAlign:"right"},children:e.mrp||e.price}),(0,$.jsx)("td",{style:{padding:10,textAlign:"right"},children:e.amount})]},t)))})]}),(0,$.jsxs)("div",{style:{textAlign:"right",fontSize:14},children:[(null===s||void 0===s?void 0:s.discount)>0&&(0,$.jsxs)("p",{children:["Discount:"," ","percentage"===s.discount_type?"".concat(s.discount,"%"):"\u20b9 ".concat(s.discount)]}),(0,$.jsxs)("p",{children:["CGST: \u20b9 ",((null===s||void 0===s?void 0:s.cgst)||((null===s||void 0===s?void 0:s.total_gst)||0)/2).toFixed(2)]}),(0,$.jsxs)("p",{children:["SGST: \u20b9 ",((null===s||void 0===s?void 0:s.sgst)||((null===s||void 0===s?void 0:s.total_gst)||0)/2).toFixed(2)]}),(0,$.jsxs)("h2",{style:{margin:0},children:["Grand Total: \u20b9 ",null===s||void 0===s?void 0:s.total]})]}),(0,$.jsx)("div",{style:{textAlign:"center",marginTop:30,fontSize:12,color:"#999"},children:"*** Thank you for shopping with us! ***"})]})},previewImg:"https://via.placeholder.com/220x120?text=Modern"}},{Title:he}=o.A,pe=()=>{var e,t,n,o;const{getEntityApi:I}=(0,T.p)(),k=I("SalesRecord"),{items:P,loading:B}=(0,N.Sm)(k.getIdentifier("GetAll")),[E,M]=(0,l.useState)(null),[L,G]=(0,l.useState)(!1),[z,F]=(0,l.useState)(!1),[V]=s.A.useForm(),[X,Y]=(0,l.useState)(""),[O,q]=(0,l.useState)({current:1,pageSize:10}),[R,W]=(0,l.useState)(!1),[U,Q]=(0,l.useState)(null),[H,J]=(0,l.useState)(!1),[K,Z]=(0,l.useState)(null);(0,re.wA)();(0,de.z)({action:"delete",title:"Sale",identifier:k.getIdentifier("Delete"),entityApi:k});const ee=[{title:"Invoice",dataIndex:"invoice_no",key:"invoice_no",render:e=>(0,$.jsx)(a.A,{icon:(0,$.jsx)(h.A,{}),color:"blue",children:e})},{title:"Date",dataIndex:"date",key:"date",render:e=>(0,$.jsx)(d.A,{title:C()(e).format("MMMM D, YYYY"),children:(0,$.jsx)(a.A,{icon:(0,$.jsx)(p.A,{}),color:"purple",children:C()(e).format("DD MMM YY")})})},{title:"Customer",dataIndex:"customerDetails",key:"customerDetails",render:e=>(0,$.jsxs)(r.A,{children:[(0,$.jsx)(g.A,{}),(0,$.jsxs)("span",{children:[(0,$.jsx)("strong",{children:null===e||void 0===e?void 0:e.full_name}),(0,$.jsx)("br",{}),(0,$.jsx)("small",{style:{color:"#999"},children:null===e||void 0===e?void 0:e.mobile})]})]})},{title:"Payment Mode",dataIndex:"payment_mode",key:"payment_mode",render:e=>{const t="cash"===e?"green":"upi"===e?"geekblue":"orange";return(0,$.jsx)(a.A,{icon:(0,$.jsx)(v.A,{}),color:t,children:e.toUpperCase()})}},{title:"Total",dataIndex:"total_amount",key:"total_amount",render:e=>(0,$.jsxs)(a.A,{icon:(0,$.jsx)(y.A,{}),color:"gold",children:["\u20b9 ",Number(e).toFixed(2)]})},{title:"Actions",key:"actions",render:(e,t)=>(0,$.jsxs)(r.A,{size:"middle",children:[(0,$.jsx)(d.A,{title:"View Bill",children:(0,$.jsx)(c.Ay,{type:"link",icon:(0,$.jsx)(j.A,{}),onClick:()=>(e=>{M(e),V.setFieldsValue((0,i.A)((0,i.A)({},e),{},{date:C()(e.date)})),G(!0)})(t)})}),(0,$.jsx)(d.A,{title:"Send via Email",children:(0,$.jsx)(c.Ay,{type:"link",icon:(0,$.jsx)(f.A,{}),onClick:()=>(e=>{Z(e),J(!0)})(t)})}),(0,$.jsx)(d.A,{title:"Print",children:(0,$.jsx)(c.Ay,{type:"link",icon:(0,$.jsx)(b.A,{}),onClick:()=>(e=>{var t,n,i;const l={customerName:(null===(t=e.customerDetails)||void 0===t?void 0:t.full_name)||"",customerAddress:(null===(n=e.customerDetails)||void 0===n?void 0:n.address)||"",date:e.date,invoice_no:e.invoice_no,items:(e.Items||[]).map((e=>{var t,n,i;return{name:[(null===(t=e.productItems)||void 0===t?void 0:t.name)||e.product_name||"",(null===(n=e.productItems)||void 0===n||null===(i=n.VariantItem)||void 0===i?void 0:i.variant_name)||""].filter(Boolean).join(" "),qty:e.qty,price:e.price,mrp:e.mrp,amount:e.amount}})),total:e.total_amount||0,total_gst:e.total_gst||0,discount:e.discount||0,discount_type:e.discount_type||"",gst_number:e.gst_number||(null===(i=e.organisationItems)||void 0===i?void 0:i.gst_number)||""};Q(l),W(!0)})(t)})}),(0,$.jsx)(m.A,{title:"Are you sure to delete this bill?",onConfirm:()=>(async e=>{try{await k("Delete",{},e)}catch(t){}})(t._id),okText:"Yes",cancelText:"No",children:(0,$.jsx)(d.A,{title:"Delete",children:(0,$.jsx)(c.Ay,{type:"link",icon:(0,$.jsx)(A.A,{}),danger:!0})})})]})}];return(0,l.useEffect)((()=>{k("GetAll",{pageNumber:O.current,pageLimit:O.pageSize,searchString:X})}),[k]),(0,$.jsxs)("div",{style:{padding:24},children:[(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[(0,$.jsx)(he,{level:3,style:{color:"#1890ff",margin:0},children:"Sales List"}),(0,$.jsxs)(r.A,{children:[(0,$.jsx)(u.A,{placeholder:"Search by invoice no, customer name or mobile",prefix:(0,$.jsx)(_.A,{}),allowClear:!0,style:{width:300},onChange:e=>{return t=e.target.value,Y(t),q((0,i.A)((0,i.A)({},O),{},{current:1})),void k("GetAll",{pageNumber:1,pageLimit:O.pageSize,searchString:t});var t}}),(0,$.jsx)(c.Ay,{type:"primary",icon:(0,$.jsx)(S.A,{}),onClick:()=>{M(null),G(!0)},children:"Create New Sale"})]})]}),(0,$.jsx)(ae.A,{data:null===P||void 0===P?void 0:P.result,columns:ee,loading:B,bordered:!0,rowKey:"_id",totalCount:(null===P||void 0===P||null===(e=P.pagination)||void 0===e?void 0:e.totalCount)||0,pageLimit:(null===P||void 0===P||null===(t=P.pagination)||void 0===t?void 0:t.pageLimit)||10,onPaginationChange:(e,t)=>{q({current:e,pageSize:t}),k("GetAll",{pageNumber:e,pageLimit:t,searchString:X})}}),(0,$.jsx)(w.A,{title:E?"Edit Sale":"Create New Sale",onClose:()=>G(!1),open:L,width:1200,children:(0,$.jsx)(D.default,{billdata:E,onSuccess:()=>{G(!1),k("GetAll")}})}),E&&(0,$.jsx)(se,{visible:z,onClose:()=>F(!1),billData:E}),(0,$.jsx)(x.A,{open:R,onCancel:()=>W(!1),footer:[(0,$.jsx)(c.Ay,{type:"primary",onClick:()=>window.print(),children:"Print"},"print"),(0,$.jsx)(c.Ay,{onClick:()=>W(!1),children:"Close"},"close")],width:800,title:U?"Print Invoice #".concat(U.invoice_no):"Print Invoice",centered:!0,children:U&&(()=>{const e=localStorage.getItem("billingTemplate"),t=xe["modern"===e||"classic"===e?e:"classic"].component;return(0,$.jsx)(t,{billData:U})})()}),(0,$.jsx)(ie,{visible:H,onClose:()=>{J(!1),Z(null)},billData:K,customerEmail:null===K||void 0===K||null===(n=K.customerDetails)||void 0===n?void 0:n.email,customerName:null===K||void 0===K||null===(o=K.customerDetails)||void 0===o?void 0:o.full_name})]})}}}]);
//# sourceMappingURL=771.85f11ecf.chunk.js.map