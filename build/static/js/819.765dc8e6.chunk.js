"use strict";(self.webpackChunkFOCUZ_BILLING=self.webpackChunkFOCUZ_BILLING||[]).push([[819],{48819:(e,t,l)=>{l.r(t),l.d(t,{default:()=>U});var i=l(89379),a=l(65043),n=l(62305),o=l(4825),r=l(97031),d=l(82863),s=l(74198),c=l(76399),u=l(96651),p=l(6051),m=l(95206),h=l(60446),x=l.n(h),g=l(27089),y=l(9764),A=l(53722),v=l(85192),b=l(24228),j=l(73092),f=l(76401),_=l(6881),k=l(45229),S=l(9933),C=l(46237),w=l(39470),I=l(80132),R=l(41911),F=l(65885),q=l(70579);const P=e=>{let{onAllocate:t,onRevert:l,onStockout:i,onStorageAllocate:a}=e;return[{title:"Invoice ID",dataIndex:"invoice_id",key:"invoice_id",render:e=>(0,q.jsx)(c.A,{icon:(0,q.jsx)(g.A,{}),color:"blue",children:e})},{title:"Product",dataIndex:"ProductItem",key:"product",render:e=>(0,q.jsx)(u.A,{title:null===e||void 0===e?void 0:e.name,children:(0,q.jsxs)("span",{children:[(0,q.jsx)(y.A,{style:{marginRight:4}}),null===e||void 0===e?void 0:e.name]})})},{title:"Vendor",dataIndex:"VendorItem",key:"vendor",render:e=>(0,q.jsx)(u.A,{title:null===e||void 0===e?void 0:e.vendor_name,children:(0,q.jsxs)("span",{children:[(0,q.jsx)(A.A,{style:{marginRight:4}}),(null===e||void 0===e?void 0:e.vendor_name)||"-"]})})},{title:"Warehouse",dataIndex:"WarehouseItem",key:"warehouse",render:e=>(0,q.jsx)(u.A,{title:null===e||void 0===e?void 0:e.warehouse_name,children:(0,q.jsxs)("span",{children:[(0,q.jsx)(v.A,{style:{marginRight:4}}),(null===e||void 0===e?void 0:e.warehouse_name)||"-"]})})},{title:"Batch Number",dataIndex:"batch_no",key:"batch_no",render:e=>(0,q.jsx)(c.A,{icon:(0,q.jsx)(b.A,{}),color:"purple",children:e||"-"})},{title:"Buy Price",dataIndex:"buy_price",key:"buy_price",render:e=>(0,q.jsxs)("span",{children:[(0,q.jsx)(j.A,{style:{marginRight:4}}),"\u20b9",e]})},{title:"Selling Price",dataIndex:"sell_price",key:"sell_price",render:e=>(0,q.jsxs)("span",{children:[(0,q.jsx)(f.A,{style:{marginRight:4}}),"\u20b9",e||"-"]})},{title:"Buy Date",dataIndex:"buyed_date",key:"buyed_date",render:e=>(0,q.jsxs)("span",{children:[(0,q.jsx)(_.A,{style:{marginRight:4}}),x()(e).format("DD/MM/YYYY")]})},{title:"MFG Date",dataIndex:"mfg_date",key:"mfg_date",render:e=>(0,q.jsxs)("span",{children:[(0,q.jsx)(k.A,{style:{marginRight:4}}),e?x()(e).format("DD/MM/YYYY"):"-"]})},{title:"Expiry Date",dataIndex:"expiry_date",key:"expiry_date",render:e=>{const t=x()(e),l=x()(),i=t.isBefore(l),a=t.diff(l,"days")<=30&&t.diff(l,"days")>0;let n="green";return i?n="red":a&&(n="orange"),(0,q.jsxs)(c.A,{color:n,children:[(0,q.jsx)(_.A,{style:{marginRight:4}}),e?x()(e).format("DD/MM/YYYY"):"-"]})}},{title:"Payment Status",dataIndex:"payment_status",key:"payment_status",render:e=>(0,q.jsx)(c.A,{color:"paid"===e?"green":"partial"===e?"orange":"red",children:e})},{title:"Total Cost",dataIndex:"total_cost",key:"total_cost",render:e=>(0,q.jsxs)("span",{style:{fontWeight:"bold"},children:["\u20b9",e]})},{title:"Quantity",dataIndex:"quantity",key:"quantity",render:e=>(0,q.jsxs)(c.A,{color:"green",children:[(0,q.jsx)(S.A,{})," ",e]})},{title:"Available Qty",dataIndex:"available_quantity",key:"available_quantity",render:e=>(0,q.jsx)(c.A,{color:e>0?"green":"red",children:e})},{title:"Available Qty to Rack",dataIndex:"rack_available_to_allocate",key:"rack_available_to_allocate",render:e=>(0,q.jsx)(c.A,{color:e>0?"green":"red",children:e})},{title:"Status",dataIndex:"status",key:"status",render:(e,t)=>{const l=t.available_quantity||0,i=t.expiry_date?x()(t.expiry_date):null,a=x()();let n="Active",o="green",r=(0,q.jsx)(C.A,{});return 0===l?(n="Out of Stock",o="red",r=(0,q.jsx)(w.A,{})):i&&i.isBefore(a)?(n="Expired",o="red",r=(0,q.jsx)(w.A,{})):i&&i.diff(a,"days")<=30&&(n="Near Expiry",o="orange",r=(0,q.jsx)(w.A,{})),(0,q.jsx)(c.A,{color:o,icon:r,children:n})}},{title:"Stock Handle",key:"stock_handle",width:280,render:(e,n)=>{const o=0===(n.available_quantity||0);return(0,q.jsxs)(p.A,{size:"small",children:[(0,q.jsx)(u.A,{title:"Allocate Stock",children:(0,q.jsx)(m.Ay,{type:"primary",size:"small",icon:(0,q.jsx)(S.A,{}),onClick:()=>t(n),disabled:o,style:{fontSize:"10px",height:"24px",padding:"0 6px"},children:"Allocate"})}),(0,q.jsx)(u.A,{title:"Storage Allocate",children:(0,q.jsx)(m.Ay,{type:"primary",size:"small",icon:(0,q.jsx)(I.A,{}),onClick:()=>a(n),disabled:o,style:{fontSize:"10px",height:"24px",padding:"0 6px",backgroundColor:"#52c41a",borderColor:"#52c41a"},children:"Storage"})}),(0,q.jsx)(u.A,{title:"Revert Changes",children:(0,q.jsx)(m.Ay,{type:"default",size:"small",icon:(0,q.jsx)(R.A,{}),onClick:()=>l(n),style:{fontSize:"10px",height:"24px",padding:"0 6px"},children:"Revert"})}),(0,q.jsx)(u.A,{title:"Mark as Stockout",children:(0,q.jsx)(m.Ay,{type:"default",size:"small",icon:(0,q.jsx)(F.A,{}),onClick:()=>i(n),style:{fontSize:"10px",height:"24px",padding:"0 6px"},children:"Stockout"})})]})}}]};var V=l(26553),L=l(36621),E=l(7866),D=l(93504);const{Option:O}=V.A,Y=(e,t,l,i,a,n)=>{var o,r,d;return[{label:"Invoice / Reference ID",name:"invoice_id",rules:[{required:!0,message:"Enter invoice or reference ID!"}],component:(0,q.jsx)(L.A,{placeholder:"e.g., INV-1001"})},{label:"Product",name:"product",rules:[{required:!0,message:"Please select a product!"}],component:(0,q.jsx)(V.A,{placeholder:"Select product",showSearch:!0,allowClear:!0,loading:i,optionFilterProp:"children",filterOption:(e,t)=>"string"===typeof(null===t||void 0===t?void 0:t.children)&&t.children.toLowerCase().includes(e.toLowerCase()),children:null===e||void 0===e||null===(o=e.result)||void 0===o?void 0:o.map((e=>{var t;return(0,q.jsx)(V.A.Option,{value:null===e||void 0===e?void 0:e._id,children:"".concat(e.name," ").concat(null===e||void 0===e||null===(t=e.VariantItem)||void 0===t?void 0:t.variant_name)},null===e||void 0===e?void 0:e._id)}))})},{label:"Quantity",name:"quantity",rules:[{required:!0,message:"Enter quantity!"}],component:(0,q.jsx)(E.A,{min:1,placeholder:"e.g., 10",style:{width:"100%"}})},{label:"Available Quantity",name:"available_quantity",rules:[{required:!0,message:"Enter available quantity!"}],component:(0,q.jsx)(E.A,{min:1,placeholder:"e.g., 10",style:{width:"100%"}})},{label:"Buying Price (per unit)",name:"buy_price",rules:[{required:!0,message:"Enter buying price!"}],component:(0,q.jsx)(E.A,{min:0,step:.01,placeholder:"\u20b90.00",style:{width:"100%"}})},{label:"MRP (per unit)",name:"mrp",rules:[{required:!0,message:"Enter buying price!"}],component:(0,q.jsx)(E.A,{min:0,step:.01,placeholder:"\u20b90.00",style:{width:"100%"}})},{label:"Selling Price",name:"sell_price",rules:[],component:(0,q.jsx)(E.A,{min:0,step:.01,placeholder:"\u20b90.00",style:{width:"100%"}})},{label:"Batch Number",name:"batch_no",rules:[],component:(0,q.jsx)(L.A,{placeholder:"Optional batch number"})},{label:"Manufacturing Date",name:"mfg_date",rules:[],component:(0,q.jsx)(D.A,{format:"YYYY-MM-DD",style:{width:"100%"}})},{label:"Expiry Date",name:"expiry_date",rules:[{required:!0,message:"Enter expiry date!"},e=>{let{getFieldValue:t}=e;return{validator(e,l){const i=t("mfg_date");return i&&l&&l.isBefore(i)?Promise.reject(new Error("Expiry must be after MFG date")):Promise.resolve()}}}],component:(0,q.jsx)(D.A,{format:"YYYY-MM-DD",style:{width:"100%"}})},{label:"Vendor",name:"vendor",rules:[],component:(0,q.jsx)(V.A,{placeholder:"Select Vendor",showSearch:!0,allowClear:!0,loading:a,optionFilterProp:"children",filterOption:(e,t)=>"string"===typeof(null===t||void 0===t?void 0:t.children)&&t.children.toLowerCase().includes(e.toLowerCase()),children:null===t||void 0===t||null===(r=t.result)||void 0===r?void 0:r.map((e=>(0,q.jsx)(V.A.Option,{value:null===e||void 0===e?void 0:e._id,children:"".concat(e.vendor_name," ").concat(null===e||void 0===e?void 0:e.company_name)},null===e||void 0===e?void 0:e._id)))})},{label:"Buyed Date",name:"buyed_date",initialValue:x()(),rules:[{required:!0,message:"Select the buyed date"}],component:(0,q.jsx)(D.A,{format:"YYYY-MM-DD",style:{width:"100%"}})},{label:"Payment Status",name:"payment_status",rules:[{required:!0,message:"Select payment status!"}],component:(0,q.jsxs)(V.A,{placeholder:"Select payment status",children:[(0,q.jsx)(O,{value:"paid",children:"Paid"}),(0,q.jsx)(O,{value:"pending",children:"Pending"}),(0,q.jsx)(O,{value:"partial",children:"Partial"})]})},{label:"Warehouse / Location",name:"warehouse_location",rules:[],component:(0,q.jsx)(V.A,{placeholder:"Select warehouse",showSearch:!0,allowClear:!0,loading:n,optionFilterProp:"children",filterOption:(e,t)=>"string"===typeof(null===t||void 0===t?void 0:t.children)&&t.children.toLowerCase().includes(e.toLowerCase()),children:null===l||void 0===l||null===(d=l.result)||void 0===d?void 0:d.map((e=>(0,q.jsx)(V.A.Option,{value:null===e||void 0===e?void 0:e._id,children:"".concat(e.warehouse_name," ").concat(null===e||void 0===e?void 0:e.warehouse_code)},null===e||void 0===e?void 0:e._id)))})},{label:"Note",name:"note",rules:[],component:(0,q.jsx)(L.A.TextArea,{rows:2,placeholder:"Optional remarks"})},{label:"Total Cost",name:"total_cost",rules:[],component:(0,q.jsx)(E.A,{placeholder:"Auto-calculated",disabled:!0,style:{width:"100%"}})}]};var B=l(22671);const{Option:M}=V.A,z=e=>{let{open:t,onClose:l,onSubmit:i,record:o,branchList:r,branchLoading:d,createLoading:s=!1}=e;const[c]=n.A.useForm(),u=((e,t)=>{var l;return[{name:"branch_id",label:"Branch",rules:[{required:!0,message:"Please select a branch"}],component:(0,q.jsx)(V.A,{placeholder:"Select branch",loading:t,showSearch:!0,optionFilterProp:"children",children:null===e||void 0===e||null===(l=e.result)||void 0===l?void 0:l.map((e=>(0,q.jsx)(M,{value:e._id,children:e.branch_name},e._id)))})},{name:"added_quantity",label:"Quantity",rules:[{required:!0,message:"Please enter quantity"}],component:(0,q.jsx)(E.A,{min:1,style:{width:"100%"}})},{label:"Note",name:"note",rules:[],component:(0,q.jsx)(L.A.TextArea,{rows:3,placeholder:"Optional notes"})}]})(r,d);return(0,a.useEffect)((()=>{t&&c.resetFields()}),[t,c,o]),(0,q.jsx)(B.A,{title:"Allocate Stock",open:t,onClose:l,width:400,children:(0,q.jsxs)(n.A,{form:c,layout:"vertical",onFinish:i,initialValues:{},children:[u.map((e=>(0,q.jsx)(n.A.Item,{name:e.name,label:e.label,rules:e.rules,children:e.component},e.name))),(0,q.jsx)(n.A.Item,{children:(0,q.jsx)(m.Ay,{type:"primary",htmlType:"submit",block:!0,disabled:s,loading:s,children:"Allocate"})})]})})},{Option:G}=V.A,T=e=>{let{open:t,onClose:l,onSubmit:i,record:o,branchList:r,branchLoading:d,loading:s}=e;const[c]=n.A.useForm(),u=((e,t,l)=>{var i;return[{name:"branch_id",label:"Branch",rules:[{required:!0,message:"Please select a branch"}],component:(0,q.jsx)(V.A,{placeholder:"Select branch",loading:t,showSearch:!0,optionFilterProp:"children",children:null===e||void 0===e||null===(i=e.result)||void 0===i?void 0:i.map((e=>(0,q.jsx)(G,{value:e._id,children:e.branch_name},e._id)))})},{name:"available_stock",label:"Available Stock",rules:[{required:!1,message:"Please enter available stock"}],component:(0,q.jsx)(E.A,{min:1,style:{width:"100%"},disabled:!0,value:(null===l||void 0===l?void 0:l.available_quantity)||0})},{name:"quantity",label:"Quantity",rules:[{required:!0,message:"Please enter quantity"}],component:(0,q.jsx)(E.A,{min:1,style:{width:"100%"}})}]})(r,d,o);return(0,a.useEffect)((()=>{t&&c.resetFields()}),[t,c,o]),(0,q.jsx)(B.A,{title:"Revert Stock",open:t,onClose:l,width:400,children:(0,q.jsxs)(n.A,{form:c,layout:"vertical",onFinish:i,initialValues:{},children:[u.map((e=>(0,q.jsx)(n.A.Item,{name:e.name,label:e.label,rules:e.rules,children:e.component},e.name))),(0,q.jsx)(n.A.Item,{children:(0,q.jsx)(m.Ay,{type:"primary",htmlType:"submit",block:!0,loading:s,disabled:s,children:"Revert"})})]})})},{Option:N}=V.A,Q=e=>{let{open:t,onClose:l,onSubmit:i,record:o,loading:r=!1}=e;const[d]=n.A.useForm(),s=(e=>{var t,l,i;return[{name:"stock_audit_id",label:"Stock In Batch",rules:[{required:!0,message:"Please select the stock batch"}],initialValue:null===e||void 0===e?void 0:e._id,component:(0,q.jsx)(V.A,{disabled:!0,children:(0,q.jsxs)(N,{value:null===e||void 0===e?void 0:e._id,children:[null===e||void 0===e||null===(t=e.ProductItem)||void 0===t?void 0:t.name," - ",null===e||void 0===e||null===(l=e.ProductItem)||void 0===l||null===(i=l.VariantItem)||void 0===i?void 0:i.variant_name," - ",null===e||void 0===e?void 0:e.batch_no]})})},{name:"quantity",label:"Quantity",rules:[{required:!0,message:"Enter quantity to remove"}],component:(0,q.jsx)(E.A,{min:1,placeholder:"e.g., 5",style:{width:"100%"}})},{name:"out_reason",label:"Reason",rules:[{required:!0,message:"Please enter the reason"}],component:(0,q.jsxs)(V.A,{placeholder:"Reason for stock out",children:[(0,q.jsx)(V.A.Option,{value:"expired",children:"Expired"}),(0,q.jsx)(V.A.Option,{value:"damaged",children:"Damaged"}),(0,q.jsx)(V.A.Option,{value:"internal_use",children:"Internal Use"}),(0,q.jsx)(V.A.Option,{value:"bulk_sale",children:"Bulk Sale"}),(0,q.jsx)(V.A.Option,{value:"return_to_vendor",children:"Return to Vendor"})]})},{name:"out_date",label:"Out Date",rules:[{required:!0,message:"Please select the date"}],component:(0,q.jsx)(D.A,{placeholder:"Select Date",style:{width:"100%"}})},{name:"note",label:"Note",rules:[],component:(0,q.jsx)(L.A.TextArea,{rows:3,placeholder:"Optional note"})}]})(o);return(0,a.useEffect)((()=>{t&&d.resetFields()}),[t,d]),(0,q.jsx)(B.A,{title:"Stock Out",open:t,onClose:l,width:400,children:(0,q.jsxs)(n.A,{form:d,layout:"vertical",onFinish:i,children:[s.map((e=>(0,q.jsx)(n.A.Item,{name:e.name,label:e.label,rules:e.rules,initialValue:e.initialValue,children:e.component},e.name))),(0,q.jsx)(n.A.Item,{children:(0,q.jsx)(m.Ay,{type:"primary",htmlType:"submit",block:!0,loading:r,disabled:r,children:"Stockout"})})]})})};var K=l(16874),W=l(94211);const U=()=>{const[e]=n.A.useForm(),[t,l]=(0,a.useState)(!1),[c,u]=(0,a.useState)(null),[p,m]=(0,a.useState)(!1),[h,x]=(0,a.useState)(null),[g,y]=(0,a.useState)(!1),[A,v]=(0,a.useState)(null),[b,j]=(0,a.useState)(!1),[f,_]=(0,a.useState)(null),{getEntityApi:k,StockRevertFromBranch:S}=(0,o.p)(),C=k("Product"),w=k("Vendor"),I=k("Warehouse"),R=k("Braches"),F=k("BranchStock"),V=k("StockAudit"),L=k("StockOut"),E=k("Rack"),D=k("StockStorage"),{items:O,loading:B}=(0,r.Sm)(C.getIdentifier("GetAll")),{items:M,loading:G}=(0,r.Sm)(w.getIdentifier("GetAll")),{items:N,loading:U}=(0,r.Sm)(I.getIdentifier("GetAll")),{items:Z,loading:H}=(0,r.Sm)(R.getIdentifier("GetAll")),{items:X,loading:$}=(0,r.Sm)(E.getIdentifier("GetAll")),{loading:J}=(0,r.Sm)(F.getIdentifier("Create")),{loading:ee}=(0,r.Sm)(L.getIdentifier("Create")),{loading:te}=(0,r.Sm)(S.getIdentifier("RevertStock"));(0,a.useEffect)((()=>{const t=e.getFieldValue("quantity"),l=e.getFieldValue("buy_price");t&&l&&e.setFieldsValue({total_cost:t*l})}),[e,e.getFieldValue("quantity"),e.getFieldValue("buy_price")]),(0,a.useEffect)((()=>{C("GetAll"),w("GetAll"),I("GetAll"),R("GetAll"),E("GetAll")}),[C,w,I,R,E]),(0,W.z)({action:"create",title:"Stock allocation",identifier:F.getIdentifier("Create"),entityApi:V}),(0,W.z)({action:"update",title:"Stock updated",identifier:S.getIdentifier("RevertStock"),entityApi:V}),(0,W.z)({action:"create",title:"Stock Out",identifier:L.getIdentifier("Create"),entityApi:V}),(0,W.z)({action:"create",title:"Storage Allocate",identifier:D.getIdentifier("Create"),entityApi:V});const le={title:"Stock Audit",columns:P({onAllocate:e=>{u(e),l(!0)},onRevert:e=>{x(e),m(!0)},onStockout:e=>{v(e),y(!0)},onStorageAllocate:e=>{_(e),j(!0)}}),formItems:Y(O,M,N,B,G,U),apiRoutes:(0,s._V)("StockAudit"),formColumns:3,drawerWidth:1200};return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(d.r,{config:le}),(0,q.jsx)(z,{open:t,onClose:()=>l(!1),onSubmit:async e=>{var t;await F("Create",(0,i.A)((0,i.A)({},e),{},{stock_audit_id:c._id,product:null===(t=c.ProductItem)||void 0===t?void 0:t._id,batch_no:c.batch_no,mfg_date:c.mfg_date,mrp:c.mrp,expiry_date:c.expiry_date,invoice_id:c.invoice_id,sell_price:c.sell_price,available_loose_quantity:c.available_loose_quantity,available_quantity:c.available_quantity})),l(!1),u(null)},record:c,branchList:Z,branchLoading:H,createLoading:J}),(0,q.jsx)(T,{open:p,onClose:()=>m(!1),onSubmit:async e=>{await S("RevertStock",(0,i.A)((0,i.A)({},e),{},{stock_audit_id:h._id})),m(!1),x(null)},record:h,branchList:Z,branchLoading:H,loading:te}),(0,q.jsx)(Q,{open:g,onClose:()=>y(!1),onSubmit:async e=>{await L("Create",(0,i.A)((0,i.A)({},e),{},{stock_audit_id:A._id})),y(!1),v(null)},record:A,loading:ee}),(0,q.jsx)(K.A,{open:b,onClose:()=>j(!1),onSubmit:async e=>{await D("Create",(0,i.A)((0,i.A)({},e),{},{stock_audit_id:null===f||void 0===f?void 0:f._id})),j(!1),_(null)},record:f,rackList:X,rackLoading:$,createLoading:J})]})}},74198:(e,t,l)=>{l.d(t,{_V:()=>a});l(65043);var i=l(91449);l(27038);const a=e=>{const t=i.LE[e]||(0,i.lX)(e);return{get:t.getAll(),create:t.create(),update:t.update(),delete:t.delete()}}},82863:(e,t,l)=>{l.d(t,{r:()=>F});var i=l(89379),a=l(65043),n=l(96651),o=l(47419),r=l(11645),d=l(36621),s=l(26553),c=l(93504),u=l(95206),p=l(33359),m=l(9316),h=l(83003),x=l(62305),g=l(97031),y=l(91449),A=l(60446),v=l.n(A);var b=l(22671),j=l(53986),f=l(83833),_=l(88655),k=l(73847),S=l(70579);const C=["key","name","fieldKey"],w=e=>{const{FormValue:t,onSubmit:l,onCancel:n,formItems:d,onChildCancel:s,formColumns:c,splitLabelAndField:p,nested:m,nestedInputs:h,wrapperCol:g,labelCol:y,initialValues:A,loading:v,form:b,onValuesChange:w}=e,I=c||1;return(0,a.useEffect)((()=>{A&&(null===b||void 0===b||b.setFieldsValue(A))}),[A,b]),(0,S.jsxs)("div",{style:{position:"relative",height:"100%"},children:[(0,S.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"600px 600px",opacity:.1,zIndex:0}}),(0,S.jsxs)(x.A,{form:b,onFinish:e=>{l?l(e):t&&t(e),null===b||void 0===b||b.resetFields()},layout:"vertical",onValuesChange:w,children:[(0,S.jsxs)(o.A,{gutter:[16,16],children:[null===d||void 0===d?void 0:d.map(((e,t)=>{var l;return(0,S.jsx)(r.A,{span:24/I,children:p?(0,S.jsxs)("div",{children:[(0,S.jsxs)(f.A.Text,{strong:!0,children:[e.label," ",(null===(l=e.rules)||void 0===l?void 0:l.some((e=>e.required)))&&(0,S.jsx)(f.A.Text,{type:"danger",children:"*"})]}),(0,S.jsx)(x.A.Item,{name:e.name,rules:e.rules,style:{marginTop:"8px"},children:e.component})]}):(0,S.jsx)(x.A.Item,{label:(0,S.jsx)(f.A.Text,{strong:!0,children:e.label}),name:e.name,rules:e.rules,labelCol:{span:y},wrapperCol:{span:g},children:e.component})},t)})),m&&(0,S.jsx)(x.A.List,{name:"nestedItems",children:(e,t)=>{let{add:l,remove:a}=t;return(0,S.jsxs)(S.Fragment,{children:[e.map((e=>{let{key:t,name:l,fieldKey:n}=e,d=(0,j.A)(e,C);return(0,S.jsxs)(o.A,{gutter:[16,16],align:"middle",children:[h.map(((e,t)=>(0,S.jsx)(r.A,{children:(0,S.jsx)(x.A.Item,(0,i.A)((0,i.A)({},d),{},{name:[l,e.name],fieldKey:[n,e.name],rules:[{required:!0,message:"Missing ".concat(e.label)}],label:e.label,children:e.component}))},t))),(0,S.jsx)(r.A,{children:(0,S.jsx)(_.A,{onClick:()=>a(l)})})]},t)})),(0,S.jsx)(o.A,{justify:"center",children:(0,S.jsx)(r.A,{children:(0,S.jsx)(u.Ay,{type:"primary",onClick:()=>l(),icon:(0,S.jsx)(k.A,{}),children:"Add More Field"})})})]})}})]}),(0,S.jsxs)(o.A,{justify:"end",gutter:[16,16],style:{padding:"16px"},children:[(0,S.jsx)(r.A,{children:(0,S.jsx)(u.Ay,{onClick:()=>{n?n():s&&s(!1),null===b||void 0===b||b.resetFields()},children:"Cancel"})}),(0,S.jsx)(r.A,{children:(0,S.jsx)(u.Ay,{type:"primary",htmlType:"submit",loading:v,children:"Submit"})})]})]})]})};var I=l(4413);function R(e,t,l){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{title:"Actions",key:"actions",render:(a,o)=>(0,S.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,S.jsx)(n.A,{title:"Edit ".concat(e),children:(0,S.jsx)(p.A,{style:{cursor:"pointer",color:"#1890ff"},onClick:()=>t(o)})}),(0,S.jsx)(n.A,{title:"Delete ".concat(e),children:(0,S.jsx)(m.A,{style:{cursor:i?"not-allowed":"pointer",color:i?"#d9d9d9":"#ff4d4f",opacity:i?.5:1},onClick:()=>!i&&l(o)})})]})}}const F=e=>{let{config:t,filters:l=[],onFilterChange:n,customButtons:p=[],onValuesChange:m}=e;const{loading:A,createLoading:j,updateLoading:f,deleteLoading:_,items:k,pagination:C,drawerVisible:F,initialValues:q,form:P,handleEdit:V,handleDelete:L,handleDrawerOpen:E,resetForm:D,handleSubmit:O,handlePaginationChange:Y,columns:B,formItems:M,formColumns:z=2,drawerWidth:G,filterValues:T,setFilterValues:N}=(e=>{const t=(0,h.wA)(),[l]=x.A.useForm(),[n,o]=(0,a.useState)(!1),[r,d]=(0,a.useState)({}),[s,c]=(0,a.useState)({}),[u,p]=(0,a.useState)({current:1,pageSize:10}),{loading:m,items:A}=(0,g.Sm)(e.apiRoutes.get.identifier),{loading:b,items:j,error:f}=(0,g.Sm)(e.apiRoutes.create.identifier),{loading:_,items:k,error:S}=(0,g.Sm)(e.apiRoutes.update.identifier),{loading:C,items:w,error:I}=(0,g.Sm)(e.apiRoutes.delete.identifier),R=(0,a.useCallback)(((e,l,i,a)=>{t((0,g.s7)({method:e,endpoint:l,data:i},a))}),[t]),F=(0,a.useCallback)((()=>{const t=(0,i.A)((0,i.A)({},s),{},{pageNumber:u.current,pageLimit:u.pageSize});R(e.apiRoutes.get.method,e.apiRoutes.get.endpoint,t,e.apiRoutes.get.identifier)}),[R,e.apiRoutes.get,s,u]),q=(0,a.useCallback)((t=>{R(e.apiRoutes.create.method,e.apiRoutes.create.endpoint,t,e.apiRoutes.create.identifier)}),[R,e.apiRoutes.create]),P=(0,a.useCallback)(((t,l)=>{R(e.apiRoutes.update.method,"".concat(e.apiRoutes.update.endpoint,"/").concat(t),l,e.apiRoutes.update.identifier)}),[R,e.apiRoutes.update]),V=(0,a.useCallback)((t=>{R(e.apiRoutes.delete.method,"".concat(e.apiRoutes.delete.endpoint,"/").concat(t),{_id:t},e.apiRoutes.delete.identifier)}),[R,e.apiRoutes.delete]),L=(0,a.useCallback)(((e,t)=>{p({current:e,pageSize:t})}),[]);function E(e){return/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(\.\d+)?(Z|[+-]\d{2}:\d{2})?)?$/.test(e)}const D=(0,a.useCallback)((e=>{const t={};for(const l in e){const i=e[l];"string"===typeof i&&E(i)&&v()(i,void 0,!0).isValid()?t[l]=v()(i):t[l]=i}d(t),o(!0)}),[]),O=(0,a.useCallback)((e=>{V(e._id)}),[V]),Y=(0,a.useCallback)((()=>{o(!0)}),[]),B=(0,a.useCallback)((()=>{o(!1),d({}),l.resetFields()}),[l]),M=(0,a.useCallback)((e=>{r._id?P(r._id,e):q(e)}),[r._id,q,P]);return(0,a.useEffect)((()=>{if(200===(null===j||void 0===j?void 0:j.statusCode))(0,y.P0)("success","".concat(e.title," created successfully")),F(),B(),t((0,g.Ki)(e.apiRoutes.create.identifier));else if(f){const t=f.message||"Failed to create ".concat(e.title);(0,y.P0)("error",t)}}),[j,f,e.title,F,B,t,e.apiRoutes.create.identifier]),(0,a.useEffect)((()=>{if(200===(null===k||void 0===k?void 0:k.statusCode))(0,y.P0)("success","".concat(e.title," updated successfully")),F(),B(),t((0,g.Ki)(e.apiRoutes.update.identifier));else if(S){const t=S.message||"Failed to update ".concat(e.title);(0,y.P0)("error",t)}}),[k,S,e.title,F,B,t,e.apiRoutes.update.identifier]),(0,a.useEffect)((()=>{if(200===(null===w||void 0===w?void 0:w.statusCode))(0,y.P0)("success","".concat(e.title," deleted successfully")),F(),t((0,g.Ki)(e.apiRoutes.delete.identifier));else if(I){const t=I.message||"Failed to delete ".concat(e.title);(0,y.P0)("error",t)}}),[w,I,e.title,F,t,e.apiRoutes.delete.identifier]),(0,a.useEffect)((()=>{F()}),[F]),(0,i.A)({loading:m,createLoading:b,updateLoading:_,deleteLoading:C,items:null===A||void 0===A?void 0:A.result,pagination:null===A||void 0===A?void 0:A.pagination,drawerVisible:n,initialValues:r,form:l,filterValues:s,setFilterValues:c,handleEdit:D,handleDelete:O,handleDrawerOpen:Y,resetForm:B,handleSubmit:M,handlePaginationChange:L},e)})(t),Q=(0,a.useCallback)(((e,t)=>{const l=(0,i.A)((0,i.A)({},T),{},{[e]:t});N(l),n&&n(l)}),[T,N,n]),K=(0,a.useMemo)((()=>[...B,R(t.title,V,L,_)]),[B,t.title,V,L,_]);return(0,S.jsxs)("div",{children:[(0,S.jsxs)(o.A,{justify:"space-between",align:"bottom",gutter:[16,16],style:{marginBottom:16},children:[(0,S.jsx)(r.A,{flex:"auto",children:(0,S.jsx)("h1",{style:{margin:0},children:t.title})}),(0,S.jsx)(r.A,{children:(0,S.jsxs)(o.A,{gutter:[12,12],align:"bottom",justify:"end",wrap:!0,children:[l.map((e=>{var t;return(0,S.jsxs)(r.A,{children:["input"===e.type&&(0,S.jsx)(d.A,{placeholder:e.placeholder||e.label,value:T[e.key]||"",onChange:t=>Q(e.key,t.target.value),style:{width:e.width||200},disabled:j||f||_}),"select"===e.type&&(0,S.jsx)(s.A,{placeholder:e.placeholder||e.label,value:T[e.key],onChange:t=>{Q(e.key,t),e.onChange&&e.onChange(t)},allowClear:!0,style:{width:e.width||200},disabled:e.disabled||j||f||_,children:null===(t=e.options)||void 0===t?void 0:t.map((e=>(0,S.jsx)(s.A.Option,{value:e.value,children:e.label},e.value)))}),"date"===e.type&&(0,S.jsx)(c.A,{placeholder:e.placeholder||e.label,value:T[e.key],onChange:t=>Q(e.key,t),style:{width:e.width||200},disabled:j||f||_})]},e.key)})),(0,S.jsx)(r.A,{children:(0,S.jsx)(d.A,{placeholder:"Search ".concat(t.title),value:T.searchString||"",onChange:e=>Q("searchString",e.target.value),style:{width:200},disabled:j||f||_})}),p.map((e=>(0,S.jsx)(r.A,{children:(0,S.jsx)(u.Ay,{type:e.type||"default",onClick:e.onClick,icon:e.icon,disabled:j||f||_,children:e.label})},e.key))),(0,S.jsx)(r.A,{children:(0,S.jsxs)(u.Ay,{type:"primary",onClick:E,loading:j,disabled:j,children:["Add ",t.title]})})]})})]}),(0,S.jsx)(I.A,{columns:K,data:k,loading:A||_,rowKeyField:"_id",totalCount:(null===C||void 0===C?void 0:C.totalCount)||0,pageLimit:(null===C||void 0===C?void 0:C.pageLimit)||10,onPaginationChange:Y}),(0,S.jsx)(b.A,{title:"".concat(q._id?"Edit":"Add"," ").concat(t.title),open:F,onClose:j||f?()=>{}:D,width:G,children:(0,S.jsx)(w,{form:P,formItems:M,formColumns:z,initialValues:q,onSubmit:O,onCancel:D,onValuesChange:m,loading:j||f})})]})}}}]);
//# sourceMappingURL=819.765dc8e6.chunk.js.map