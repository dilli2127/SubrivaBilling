/*! For license information please see 284.2a646d0a.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkSUBRIVA_BILLING=self.webpackChunkSUBRIVA_BILLING||[]).push([[284],{33359:(e,t,i)=>{i.d(t,{A:()=>r});var l=i(65043),n=i(71360),a=i(66381);function s(){return s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var l in i)Object.prototype.hasOwnProperty.call(i,l)&&(e[l]=i[l])}return e},s.apply(this,arguments)}const o=(e,t)=>l.createElement(a.A,s({},e,{ref:t,icon:n.A}));const r=l.forwardRef(o)},68284:(e,t,i)=>{i.r(t),i.d(t,{default:()=>f});var l=i(65043),n=i(82863),a=i(74198),s=i(36621),o=i(32513),r=i(39314),d=i(70579);const c=function(e){const t=e.find((e=>"tenant_manage"===e.key));return t&&t.children?[t.key,...t.children.map((e=>e.key))]:[]}(r.W),u=function e(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.reduce(((t,l)=>(l.children?(t.push({label:l.label,value:l.key,isParent:!0}),t=t.concat(e(l.children,l.label+" / "))):t.push({label:i+l.label,value:l.key}),t)),[])}(r.W).filter((e=>!e.isParent&&!c.includes(e.value)&&"organisation"!==e.value)),p=[{title:"Role Name",dataIndex:"name",key:"name",render:e=>(0,d.jsx)("strong",{children:e})},{title:"Description",dataIndex:"description",key:"description",ellipsis:!0}];var m=i(4825),h=i(95005);const g=()=>{var e;const{getEntityApi:t}=(0,m.p)(),i=t("Organisations"),{items:r}=(0,h.S)(i.getIdentifier("GetAll"));(0,l.useEffect)((()=>{i("GetAll")}),[i]);const c=[{key:"organisation_id",label:"Organisation",type:"select",options:(null===r||void 0===r||null===(e=r.result)||void 0===e?void 0:e.map((e=>({label:e.org_name,value:e._id}))))||[],placeholder:"Select Organisation"}];return(0,d.jsx)(n.r,{config:{title:"Roles",columns:p,formItems:[{label:"Role Name",name:"name",rules:[{required:!0,message:"Please enter role name!"}],component:(0,d.jsx)(s.A,{placeholder:"Enter role name"})},{label:"Description",name:"description",rules:[],component:(0,d.jsx)(s.A.TextArea,{rows:4,placeholder:"Enter role description (optional)"})},{label:"Permissions",name:"allowedMenuKeys",rules:[{required:!0,message:"Please select at least one permission!"}],component:(0,d.jsx)(o.A.Group,{options:u})}],apiRoutes:(0,a._V)("Roles"),formColumns:2},filters:c})},f=(0,l.memo)(g)},74198:(e,t,i)=>{i.d(t,{_V:()=>n});i(65043);var l=i(91449);i(27038);const n=e=>{const t=l.LE[e]||(0,l.lX)(e);return{get:t.getAll(),create:t.create(),update:t.update(),delete:t.delete()}}},82863:(e,t,i)=>{i.d(t,{r:()=>I});var l=i(89379),n=i(65043),a=i(96651),s=i(47419),o=i(11645),r=i(36621),d=i(26553),c=i(93504),u=i(95206),p=i(33359),m=i(9316),h=i(83003),g=i(62305),f=i(97031),y=i(91449),A=i(60446),x=i.n(A);var b=i(22671),j=i(53986),v=i(83833),C=i(88655),k=i(73847),R=i(70579);const w=["key","name","fieldKey"],S=e=>{const{FormValue:t,onSubmit:i,onCancel:a,formItems:r,onChildCancel:d,formColumns:c,splitLabelAndField:p,nested:m,nestedInputs:h,wrapperCol:f,labelCol:y,initialValues:A,loading:x,form:b,onValuesChange:S}=e,V=c||1;return(0,n.useEffect)((()=>{A&&(null===b||void 0===b||b.setFieldsValue(A))}),[A,b]),(0,R.jsxs)("div",{style:{position:"relative",height:"100%"},children:[(0,R.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"600px 600px",opacity:.1,zIndex:0}}),(0,R.jsxs)(g.A,{form:b,onFinish:e=>{i?i(e):t&&t(e),null===b||void 0===b||b.resetFields()},layout:"vertical",onValuesChange:S,children:[(0,R.jsxs)(s.A,{gutter:[16,16],children:[null===r||void 0===r?void 0:r.map(((e,t)=>{var i;return(0,R.jsx)(o.A,{span:24/V,children:p?(0,R.jsxs)("div",{children:[(0,R.jsxs)(v.A.Text,{strong:!0,children:[e.label," ",(null===(i=e.rules)||void 0===i?void 0:i.some((e=>e.required)))&&(0,R.jsx)(v.A.Text,{type:"danger",children:"*"})]}),(0,R.jsx)(g.A.Item,{name:e.name,rules:e.rules,style:{marginTop:"8px"},children:e.component})]}):(0,R.jsx)(g.A.Item,{label:(0,R.jsx)(v.A.Text,{strong:!0,children:e.label}),name:e.name,rules:e.rules,labelCol:{span:y},wrapperCol:{span:f},children:e.component})},t)})),m&&(0,R.jsx)(g.A.List,{name:"nestedItems",children:(e,t)=>{let{add:i,remove:n}=t;return(0,R.jsxs)(R.Fragment,{children:[e.map((e=>{let{key:t,name:i,fieldKey:a}=e,r=(0,j.A)(e,w);return(0,R.jsxs)(s.A,{gutter:[16,16],align:"middle",children:[h.map(((e,t)=>(0,R.jsx)(o.A,{children:(0,R.jsx)(g.A.Item,(0,l.A)((0,l.A)({},r),{},{name:[i,e.name],fieldKey:[a,e.name],rules:[{required:!0,message:"Missing ".concat(e.label)}],label:e.label,children:e.component}))},t))),(0,R.jsx)(o.A,{children:(0,R.jsx)(C.A,{onClick:()=>n(i)})})]},t)})),(0,R.jsx)(s.A,{justify:"center",children:(0,R.jsx)(o.A,{children:(0,R.jsx)(u.Ay,{type:"primary",onClick:()=>i(),icon:(0,R.jsx)(k.A,{}),children:"Add More Field"})})})]})}})]}),(0,R.jsxs)(s.A,{justify:"end",gutter:[16,16],style:{padding:"16px"},children:[(0,R.jsx)(o.A,{children:(0,R.jsx)(u.Ay,{onClick:()=>{a?a():d&&d(!1),null===b||void 0===b||b.resetFields()},children:"Cancel"})}),(0,R.jsx)(o.A,{children:(0,R.jsx)(u.Ay,{type:"primary",htmlType:"submit",loading:x,children:"Submit"})})]})]})]})};var V=i(4413);function F(e,t,i){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return{title:"Actions",key:"actions",render:(n,s)=>(0,R.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,R.jsx)(a.A,{title:"Edit ".concat(e),children:(0,R.jsx)(p.A,{style:{cursor:"pointer",color:"#1890ff"},onClick:()=>t(s)})}),(0,R.jsx)(a.A,{title:"Delete ".concat(e),children:(0,R.jsx)(m.A,{style:{cursor:l?"not-allowed":"pointer",color:l?"#d9d9d9":"#ff4d4f",opacity:l?.5:1},onClick:()=>!l&&i(s)})})]})}}const I=e=>{let{config:t,filters:i=[],onFilterChange:a,customButtons:p=[],onValuesChange:m}=e;const{loading:A,createLoading:j,updateLoading:v,deleteLoading:C,items:k,pagination:w,drawerVisible:I,initialValues:L,form:P,handleEdit:E,handleDelete:_,handleDrawerOpen:O,resetForm:K,handleSubmit:D,handlePaginationChange:T,columns:B,formItems:z,formColumns:G=2,drawerWidth:N,filterValues:q,setFilterValues:M}=(e=>{const t=(0,h.wA)(),[i]=g.A.useForm(),[a,s]=(0,n.useState)(!1),[o,r]=(0,n.useState)({}),[d,c]=(0,n.useState)({}),[u,p]=(0,n.useState)({current:1,pageSize:10}),{loading:m,items:A}=(0,f.Sm)(e.apiRoutes.get.identifier),{loading:b,items:j,error:v}=(0,f.Sm)(e.apiRoutes.create.identifier),{loading:C,items:k,error:R}=(0,f.Sm)(e.apiRoutes.update.identifier),{loading:w,items:S,error:V}=(0,f.Sm)(e.apiRoutes.delete.identifier),F=(0,n.useCallback)(((e,i,l,n)=>{t((0,f.s7)({method:e,endpoint:i,data:l},n))}),[t]),I=(0,n.useCallback)((()=>{const t=(0,l.A)((0,l.A)({},d),{},{pageNumber:u.current,pageLimit:u.pageSize});F(e.apiRoutes.get.method,e.apiRoutes.get.endpoint,t,e.apiRoutes.get.identifier)}),[F,e.apiRoutes.get,d,u]),L=(0,n.useCallback)((t=>{F(e.apiRoutes.create.method,e.apiRoutes.create.endpoint,t,e.apiRoutes.create.identifier)}),[F,e.apiRoutes.create]),P=(0,n.useCallback)(((t,i)=>{F(e.apiRoutes.update.method,"".concat(e.apiRoutes.update.endpoint,"/").concat(t),i,e.apiRoutes.update.identifier)}),[F,e.apiRoutes.update]),E=(0,n.useCallback)((t=>{F(e.apiRoutes.delete.method,"".concat(e.apiRoutes.delete.endpoint,"/").concat(t),{_id:t},e.apiRoutes.delete.identifier)}),[F,e.apiRoutes.delete]),_=(0,n.useCallback)(((e,t)=>{p({current:e,pageSize:t})}),[]);function O(e){return/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(\.\d+)?(Z|[+-]\d{2}:\d{2})?)?$/.test(e)}const K=(0,n.useCallback)((e=>{const t={};for(const i in e){const l=e[i];"string"===typeof l&&O(l)&&x()(l,void 0,!0).isValid()?t[i]=x()(l):t[i]=l}r(t),s(!0)}),[]),D=(0,n.useCallback)((e=>{E(e._id)}),[E]),T=(0,n.useCallback)((()=>{s(!0)}),[]),B=(0,n.useCallback)((()=>{s(!1),r({}),i.resetFields()}),[i]),z=(0,n.useCallback)((e=>{o._id?P(o._id,e):L(e)}),[o._id,L,P]);return(0,n.useEffect)((()=>{if(200===(null===j||void 0===j?void 0:j.statusCode))(0,y.P0)("success","".concat(e.title," created successfully")),I(),B(),t((0,f.Ki)(e.apiRoutes.create.identifier));else if(v){const t=v.message||"Failed to create ".concat(e.title);(0,y.P0)("error",t)}}),[j,v,e.title,I,B,t,e.apiRoutes.create.identifier]),(0,n.useEffect)((()=>{if(200===(null===k||void 0===k?void 0:k.statusCode))(0,y.P0)("success","".concat(e.title," updated successfully")),I(),B(),t((0,f.Ki)(e.apiRoutes.update.identifier));else if(R){const t=R.message||"Failed to update ".concat(e.title);(0,y.P0)("error",t)}}),[k,R,e.title,I,B,t,e.apiRoutes.update.identifier]),(0,n.useEffect)((()=>{if(200===(null===S||void 0===S?void 0:S.statusCode))(0,y.P0)("success","".concat(e.title," deleted successfully")),I(),t((0,f.Ki)(e.apiRoutes.delete.identifier));else if(V){const t=V.message||"Failed to delete ".concat(e.title);(0,y.P0)("error",t)}}),[S,V,e.title,I,t,e.apiRoutes.delete.identifier]),(0,n.useEffect)((()=>{I()}),[I]),(0,l.A)({loading:m,createLoading:b,updateLoading:C,deleteLoading:w,items:null===A||void 0===A?void 0:A.result,pagination:null===A||void 0===A?void 0:A.pagination,drawerVisible:a,initialValues:o,form:i,filterValues:d,setFilterValues:c,handleEdit:K,handleDelete:D,handleDrawerOpen:T,resetForm:B,handleSubmit:z,handlePaginationChange:_},e)})(t),W=(0,n.useCallback)(((e,t)=>{const i=(0,l.A)((0,l.A)({},q),{},{[e]:t});M(i),a&&a(i)}),[q,M,a]),U=(0,n.useMemo)((()=>[...B,F(t.title,E,_,C)]),[B,t.title,E,_,C]);return(0,R.jsxs)("div",{children:[(0,R.jsxs)(s.A,{justify:"space-between",align:"bottom",gutter:[16,16],style:{marginBottom:16},children:[(0,R.jsx)(o.A,{flex:"auto",children:(0,R.jsx)("h1",{style:{margin:0},children:t.title})}),(0,R.jsx)(o.A,{children:(0,R.jsxs)(s.A,{gutter:[12,12],align:"bottom",justify:"end",wrap:!0,children:[i.map((e=>{var t;return(0,R.jsxs)(o.A,{children:["input"===e.type&&(0,R.jsx)(r.A,{placeholder:e.placeholder||e.label,value:q[e.key]||"",onChange:t=>W(e.key,t.target.value),style:{width:e.width||200},disabled:j||v||C}),"select"===e.type&&(0,R.jsx)(d.A,{placeholder:e.placeholder||e.label,value:q[e.key],onChange:t=>{W(e.key,t),e.onChange&&e.onChange(t)},allowClear:!0,style:{width:e.width||200},disabled:e.disabled||j||v||C,children:null===(t=e.options)||void 0===t?void 0:t.map((e=>(0,R.jsx)(d.A.Option,{value:e.value,children:e.label},e.value)))}),"date"===e.type&&(0,R.jsx)(c.A,{placeholder:e.placeholder||e.label,value:q[e.key],onChange:t=>W(e.key,t),style:{width:e.width||200},disabled:j||v||C})]},e.key)})),(0,R.jsx)(o.A,{children:(0,R.jsx)(r.A,{placeholder:"Search ".concat(t.title),value:q.searchString||"",onChange:e=>W("searchString",e.target.value),style:{width:200},disabled:j||v||C})}),p.map((e=>(0,R.jsx)(o.A,{children:(0,R.jsx)(u.Ay,{type:e.type||"default",onClick:e.onClick,icon:e.icon,disabled:j||v||C,children:e.label})},e.key))),(0,R.jsx)(o.A,{children:(0,R.jsxs)(u.Ay,{type:"primary",onClick:O,loading:j,disabled:j,children:["Add ",t.title]})})]})})]}),(0,R.jsx)(V.A,{columns:U,data:k,loading:A||C,rowKeyField:"_id",totalCount:(null===w||void 0===w?void 0:w.totalCount)||0,pageLimit:(null===w||void 0===w?void 0:w.pageLimit)||10,onPaginationChange:T}),(0,R.jsx)(b.A,{title:"".concat(L._id?"Edit":"Add"," ").concat(t.title),open:I,onClose:j||v?()=>{}:K,width:N,children:(0,R.jsx)(S,{form:P,formItems:z,formColumns:G,initialValues:L,onSubmit:D,onCancel:K,onValuesChange:m,loading:j||v})})]})}}}]);
//# sourceMappingURL=284.2a646d0a.chunk.js.map