{"version":3,"file":"static/js/221.24d8f8ad.chunk.js","mappings":"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","sources":["pages/UserAccount/columns.tsx","pages/UserAccount/formItems.tsx","pages/UserAccount/crud.tsx"],"sourcesContent":["import { Tag } from 'antd';\r\n\r\nexport const usersAccountColumns = [\r\n  {\r\n    title: 'Name',\r\n    dataIndex: 'name',\r\n    key: 'name',\r\n    render: (text: string) => <strong>{text}</strong>,\r\n  },\r\n  {\r\n    title: 'Username',\r\n    dataIndex: 'user_name',\r\n    key: 'user_name',\r\n    render: (text: string) => <span style={{ color: '#1890ff' }}>{text}</span>,\r\n  },\r\n  {\r\n    title: 'Email',\r\n    dataIndex: 'email',\r\n    key: 'email',\r\n  },\r\n  {\r\n    title: 'Mobile',\r\n    dataIndex: 'mobile',\r\n    key: 'mobile',\r\n  },\r\n  {\r\n    title: 'Role',\r\n    dataIndex: 'roleItems',\r\n    key: 'role_id',\r\n    render: (roleItems: { name: string }) => (\r\n      <Tag color=\"geekblue\">{roleItems?.name}</Tag>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Status',\r\n    dataIndex: 'status',\r\n    key: 'status',\r\n    render: (status: boolean) => (\r\n      <Tag color={status ? 'green' : 'volcano'}>\r\n        {status ? 'Active' : 'Inactive'}\r\n      </Tag>\r\n    ),\r\n  },\r\n];\r\n","import React from 'react';\r\nimport { Input, Select, Switch } from 'antd';\r\n\r\nexport const usersAccountFormItems = ({\r\n  roles = [],\r\n  organisation = [],\r\n  branches = [],\r\n  selectedOrganisationId = null,\r\n  userItemRole = '',\r\n}: {\r\n  roles?: { label: string; value: string }[];\r\n  organisation?: { label: string; value: string }[];\r\n  branches?: {\r\n    label: string;\r\n    value: string;\r\n    organisation_id?: string | number;\r\n  }[];\r\n  selectedOrganisationId?: string | number | null;\r\n  selectedRoleName?: string;\r\n  userItemRole?: string;\r\n} = {}) => [\r\n  {\r\n    label: 'Full Name',\r\n    name: 'name',\r\n    rules: [{ required: true, message: 'Please enter full name' }],\r\n    component: <Input placeholder=\"Enter full name\" />,\r\n  },\r\n  {\r\n    label: 'Email',\r\n    name: 'email',\r\n    rules: [\r\n      { required: true, message: 'Please enter email' },\r\n      { type: 'email', message: 'Enter a valid email' },\r\n    ],\r\n    component: <Input placeholder=\"Enter email\" />,\r\n  },\r\n  {\r\n    label: 'Username',\r\n    name: 'user_name',\r\n    rules: [{ required: true, message: 'Please enter username' }],\r\n    component: <Input placeholder=\"Enter username\" />,\r\n  },\r\n  {\r\n    label: 'Mobile Number',\r\n    name: 'mobile',\r\n    rules: [\r\n      { required: true, message: 'Please enter mobile number' },\r\n      { pattern: /^[0-9]{10}$/, message: 'Enter valid 10-digit mobile number' },\r\n    ],\r\n    component: <Input placeholder=\"Enter mobile number\" maxLength={10} />,\r\n  },\r\n  {\r\n    label: 'Password',\r\n    name: 'password',\r\n    rules: [{ required: true, message: 'Please enter password' }],\r\n    component: <Input.Password placeholder=\"Enter password\" />,\r\n  },\r\n  {\r\n    label: 'Role',\r\n    name: 'role_id',\r\n    rules: [{ required: true, message: 'Please select a role' }],\r\n    component: (\r\n      <Select placeholder=\"Select role\" allowClear showSearch>\r\n        {roles.map(role => (\r\n          <Select.Option key={role.value} value={role.value}>\r\n            {role.label}\r\n          </Select.Option>\r\n        ))}\r\n      </Select>\r\n    ),\r\n  },\r\n  ...(userItemRole !== 'OrganisationAdmin' && userItemRole !== 'BranchAdmin'\r\n    ? [\r\n        {\r\n          label: 'Organisation',\r\n          name: 'organisation_id',\r\n          rules: [{ required: true, message: 'Please select a organisation' }],\r\n          component: (\r\n            <Select placeholder=\"Select organisation\" allowClear showSearch>\r\n              {organisation.map(org => (\r\n                <Select.Option key={org.value} value={org.value}>\r\n                  {org.label}\r\n                </Select.Option>\r\n              ))}\r\n            </Select>\r\n          ),\r\n        },\r\n      ]\r\n    : []),\r\n  ...(userItemRole !== 'BranchAdmin'\r\n    ? [\r\n        {\r\n          label: 'Branch',\r\n          name: 'branch_id',\r\n          rules: [{ required: false, message: 'Please select a branch' }],\r\n          component: (\r\n            <Select\r\n              placeholder=\"Select branch\"\r\n              allowClear\r\n              showSearch\r\n              disabled={\r\n                userItemRole === 'BranchAdmin' ? !selectedOrganisationId : false\r\n              }\r\n            >\r\n              {(userItemRole !== 'BranchAdmin'\r\n                ? branches\r\n                : branches.filter(\r\n                    branch =>\r\n                      (typeof selectedOrganisationId === 'string' ||\r\n                        typeof selectedOrganisationId === 'number') &&\r\n                      branch.organisation_id === selectedOrganisationId\r\n                  )\r\n              ).map(branch => (\r\n                <Select.Option key={branch.value} value={branch.value}>\r\n                  {branch.label}\r\n                </Select.Option>\r\n              ))}\r\n            </Select>\r\n          ),\r\n        },\r\n      ]\r\n    : []),\r\n  {\r\n    label: 'Active Status',\r\n    name: 'status',\r\n    valuePropName: 'checked',\r\n    component: <Switch checkedChildren=\"Active\" unCheckedChildren=\"Inactive\" />,\r\n  },\r\n];\r\n","import React, { memo, useEffect, useMemo, useState } from 'react';\r\nimport { GenericCrudPage } from '../../components/common/GenericCrudPage';\r\nimport { getEntityApiRoutes } from '../../helpers/CrudFactory';\r\nimport { usersAccountColumns } from './columns';\r\nimport { usersAccountFormItems } from './formItems';\r\nimport { useApiActions } from '../../services/api/useApiActions';\r\nimport { useDynamicSelector } from '../../services/redux/selector';\r\nimport { Form } from 'antd';\r\nimport { getCurrentUser } from '../../helpers/auth';\r\n\r\nconst UserAccountCrud: React.FC = () => {\r\n  const { getEntityApi } = useApiActions();\r\n  const apis = ['Roles', 'Organisations', 'Braches'].map(getEntityApi);\r\n  const [RolesApi, OrganisationsApi, BrachesApi] = apis;\r\n  const { items: rolesItems } = useDynamicSelector(\r\n    RolesApi.getIdentifier('GetAll')\r\n  );\r\n  const { items: orgaisationItems } = useDynamicSelector(\r\n    OrganisationsApi.getIdentifier('GetAll')\r\n  );\r\n  const { items: branchesItems } = useDynamicSelector(\r\n    BrachesApi.getIdentifier('GetAll')\r\n  );\r\n  const userItem = useMemo(() => {\r\n    return getCurrentUser();\r\n  }, []);\r\n\r\n  const userItemRole =\r\n    userItem?.roleItems?.name ||\r\n    userItem?.usertype ||\r\n    userItem?.user_role ||\r\n    '';\r\n  useEffect(() => {\r\n    [RolesApi, OrganisationsApi].forEach(api => api('GetAll'));\r\n    if (userItemRole !== 'tenant' || userItemRole !== 'superadmin') {\r\n      BrachesApi('GetAll');\r\n    }\r\n  }, [RolesApi, OrganisationsApi]);\r\n\r\n  // Prepare roles for the select\r\n  const roles =\r\n    rolesItems?.result?.map((role: any) => ({\r\n      label: role.name,\r\n      value: role._id,\r\n    })) || [];\r\n  const organisation =\r\n    orgaisationItems?.result?.map((organisation: any) => ({\r\n      label: organisation.org_name || organisation.name,\r\n      value: organisation._id,\r\n    })) || [];\r\n  const branches =\r\n    branchesItems?.result?.map((branch: any) => ({\r\n      label: branch.branch_name || branch.name,\r\n      value: branch._id,\r\n      organisation_id: branch.organisation_id || branch.org_id, // ensure this property exists for filtering\r\n    })) || [];\r\n\r\n  // Dependent select logic\r\n  const [form] = Form.useForm();\r\n  const [selectedOrganisationId, setSelectedOrganisationId] = useState<\r\n    string | number | null\r\n  >(null);\r\n\r\n  const handleOrganisationChange = (value: string | number | undefined) => {\r\n    BrachesApi('GetAll', { organisation_id: value }); // Fetch branches for the selected organisation\r\n    const safeValue = value === undefined || value === '' ? null : value;\r\n    setSelectedOrganisationId(safeValue);\r\n    form.setFieldsValue({ branch_id: undefined }); // reset branch when org changes\r\n  };\r\n\r\n  // Listen to organisation_id changes in the form\r\n  const handleValuesChange = (changed: any, all: any) => {\r\n    if (changed.organisation_id !== undefined)\r\n      handleOrganisationChange(changed.organisation_id);\r\n  };\r\n\r\n  return (\r\n    <GenericCrudPage\r\n      config={{\r\n        title: 'Users',\r\n        columns: usersAccountColumns,\r\n        formItems: usersAccountFormItems({\r\n          roles,\r\n          organisation,\r\n          branches,\r\n          selectedOrganisationId,\r\n          userItemRole,\r\n        }),\r\n        apiRoutes: getEntityApiRoutes('BillingUsers'),\r\n        formColumns: 2,\r\n      }}\r\n      onValuesChange={handleValuesChange}\r\n      enableDynamicFields={true}\r\n      entityName=\"users\"\r\n    />\r\n  );\r\n};\r\n\r\nexport default memo(UserAccountCrud);\r\n"],"names":["usersAccountColumns","title","dataIndex","key","render","text","_jsx","children","style","color","roleItems","Tag","name","status","usersAccountFormItems","roles","organisation","branches","selectedOrganisationId","userItemRole","arguments","length","undefined","label","rules","required","message","component","Input","placeholder","type","pattern","maxLength","Password","Select","allowClear","showSearch","map","role","Option","value","org","disabled","filter","branch","organisation_id","valuePropName","Switch","checkedChildren","unCheckedChildren","UserAccountCrud","_userItem$roleItems","_rolesItems$result","_orgaisationItems$res","_branchesItems$result","getEntityApi","useApiActions","apis","RolesApi","OrganisationsApi","BrachesApi","items","rolesItems","useDynamicSelector","getIdentifier","orgaisationItems","branchesItems","userItem","useMemo","getCurrentUser","usertype","user_role","useEffect","forEach","api","result","_id","org_name","branch_name","org_id","form","Form","useForm","setSelectedOrganisationId","useState","GenericCrudPage","config","columns","formItems","apiRoutes","getEntityApiRoutes","formColumns","onValuesChange","handleValuesChange","changed","all","setFieldsValue","branch_id","enableDynamicFields","entityName","memo"],"sourceRoot":""}