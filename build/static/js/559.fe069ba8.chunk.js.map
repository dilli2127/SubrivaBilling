{"version":3,"file":"static/js/559.fe069ba8.chunk.js","mappings":"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","sources":["pages/DynamicEntity/hooks/useDynamicEntity.tsx","pages/DynamicEntity/DynamicEntityCrud.tsx"],"sourcesContent":["import { useCallback, useMemo, useState, useEffect } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { Dispatch } from 'redux';\r\nimport { dynamic_request, useDynamicSelector } from '../../../services/redux';\r\nimport { createApiRouteGetter } from '../../../helpers/Common_functions';\r\nimport { \r\n  EntityDefinition, \r\n  DynamicApiRoutes, \r\n  UseDynamicEntityReturn \r\n} from '../types';\r\n\r\n/**\r\n * Custom hook for managing dynamic entity operations\r\n * Handles entity definition fetching, API route generation, and entity validation\r\n */\r\nexport const useDynamicEntity = (): UseDynamicEntityReturn => {\r\n  const { entityName } = useParams<{ entityName: string }>();\r\n  const navigate = useNavigate();\r\n  const dispatch: Dispatch<any> = useDispatch();\r\n  const [entityDef, setEntityDef] = useState<EntityDefinition | null>(null);\r\n\r\n  // Memoized API route getter to prevent recreation\r\n  const getApiRoute = useMemo(() => createApiRouteGetter('EntityDefinition'), []);\r\n  const entityDefRoute = useMemo(() => getApiRoute('GetAll'), [getApiRoute]);\r\n\r\n  // Fetch entity definition data\r\n  const { loading, items, error } = useDynamicSelector(entityDefRoute.identifier);\r\n\r\n  // Fetch entity definition when entityName changes\r\n  const fetchEntityDefinition = useCallback(() => {\r\n    if (entityName) {\r\n      dispatch(\r\n        dynamic_request(\r\n          {\r\n            method: entityDefRoute.method,\r\n            endpoint: entityDefRoute.endpoint,\r\n            data: { entity_name: entityName },\r\n          },\r\n          entityDefRoute.identifier\r\n        )\r\n      );\r\n    }\r\n  }, [entityName, dispatch, entityDefRoute]);\r\n\r\n  // Update entity definition when data changes\r\n  useEffect(() => {\r\n    if (items?.result && Array.isArray(items.result) && items.result.length > 0 && entityName) {\r\n      // Find the specific entity definition that matches the entityName\r\n      const definition = items.result.find((item: EntityDefinition) => item.entity_name === entityName);\r\n      if (definition) {\r\n        setEntityDef(definition);\r\n      } else {\r\n        // If no matching entity found, clear the definition\r\n        setEntityDef(null);\r\n      }\r\n    }\r\n  }, [items, entityName]);\r\n\r\n  // Fetch on mount and when entityName changes\r\n  useEffect(() => {\r\n    fetchEntityDefinition();\r\n  }, [fetchEntityDefinition]);\r\n\r\n  // Generate optimized API routes for dynamic entity\r\n  const dynamicApiRoutes = useMemo<DynamicApiRoutes | null>(() => {\r\n    if (!entityName) return null;\r\n    \r\n    const baseEndpoint = `/${entityName}`;\r\n    \r\n    return {\r\n      get: {\r\n        method: 'POST',\r\n        endpoint: baseEndpoint,\r\n        identifier: `GetAll_${entityName}`,\r\n      },\r\n      create: {\r\n        method: 'PUT',\r\n        endpoint: baseEndpoint,\r\n        identifier: `Add_${entityName}`,\r\n      },\r\n      update: {\r\n        method: 'POST',\r\n        endpoint: baseEndpoint,\r\n        identifier: `Update_${entityName}`,\r\n      },\r\n      delete: {\r\n        method: 'DELETE',\r\n        endpoint: baseEndpoint,\r\n        identifier: `Delete_${entityName}`,\r\n      },\r\n    };\r\n  }, [entityName]);\r\n\r\n\r\n  // Basic columns - dynamic columns will be generated by GenericCrudPage\r\n  const defaultColumns = useMemo(() => [\r\n    {\r\n      title: 'ID',\r\n      dataIndex: '_id',\r\n      key: '_id',\r\n      render: (text: string) => (\r\n        <span style={{ \r\n          fontFamily: 'monospace', \r\n          fontSize: '13px',\r\n          fontWeight: 500,\r\n          color: '#1890ff'\r\n        }}>\r\n          {text.substring(0, 8)}...\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Created',\r\n      dataIndex: 'createdAt',\r\n      key: 'createdAt',\r\n      render: (date: string) => (\r\n        <span style={{ fontSize: '13px', color: '#666' }}>\r\n          {new Date(date).toLocaleDateString()}\r\n        </span>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Updated',\r\n      dataIndex: 'updatedAt',\r\n      key: 'updatedAt',\r\n      render: (date: string) => (\r\n        <span style={{ fontSize: '13px', color: '#666' }}>\r\n          {new Date(date).toLocaleDateString()}\r\n        </span>\r\n      ),\r\n    },\r\n  ], []);\r\n\r\n  // Validation helpers\r\n  const isEntityValid = useMemo(() => {\r\n    return Boolean(entityDef && entityDef.is_active);\r\n  }, [entityDef]);\r\n\r\n  const hasError = useMemo(() => {\r\n    return error || (!loading && !isEntityValid);\r\n  }, [error, loading, isEntityValid]);\r\n\r\n  // Navigation helpers\r\n  const goBack = useCallback(() => {\r\n    navigate('/entities');\r\n  }, [navigate]);\r\n\r\n  const goToEntityDefinitions = useCallback(() => {\r\n    navigate('/entity-definitions');\r\n  }, [navigate]);\r\n\r\n  return {\r\n    // State\r\n    entityName,\r\n    entityDef,\r\n    loading,\r\n    error,\r\n    hasError,\r\n    isEntityValid,\r\n    \r\n    // Computed\r\n    dynamicApiRoutes,\r\n    defaultColumns,\r\n    \r\n    // Actions\r\n    fetchEntityDefinition,\r\n    goBack,\r\n    goToEntityDefinitions,\r\n    \r\n    // Helpers\r\n    entityDefRoute,\r\n  };\r\n};\r\n","import React, { useMemo, useCallback } from 'react';\r\nimport { Spin, Result, Button } from 'antd';\r\nimport { GenericCrudPage } from '../../components/common/GenericCrudPage';\r\nimport { useDynamicEntity } from './hooks/useDynamicEntity';\r\nimport { DynamicEntityConfig, FormValuesChangeHandler } from './types';\r\n\r\n/**\r\n * Optimized Dynamic CRUD page with column customization\r\n */\r\nconst DynamicEntityCrud: React.FC = () => {\r\n  const {\r\n    entityName,\r\n    entityDef,\r\n    loading,\r\n    hasError,\r\n    isEntityValid,\r\n    dynamicApiRoutes,\r\n    defaultColumns,\r\n    goBack,\r\n    goToEntityDefinitions,\r\n  } = useDynamicEntity();\r\n\r\n  const config = useMemo((): DynamicEntityConfig | null => {\r\n    if (!entityDef || !dynamicApiRoutes) return null;\r\n\r\n    return {\r\n      title: entityDef.plural_name,\r\n      columns: defaultColumns,\r\n      formItems: [],\r\n      apiRoutes: dynamicApiRoutes,\r\n      formColumns: 2,\r\n      drawerWidth: 700,\r\n      skipMetadataWrapping: true,\r\n      metadataFieldName: 'custom_data',\r\n      enableDynamicFields: true,\r\n      enableSuperAdminFilters: true,\r\n    };\r\n  }, [entityDef, dynamicApiRoutes, defaultColumns]);\r\n\r\n  const handleValuesChange = useCallback<FormValuesChangeHandler>((_changed, all) => {\r\n    if (entityDef && !all.entity_name) {\r\n      all.entity_name = entityDef.entity_name;\r\n    }\r\n  }, [entityDef]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '50vh' }}>\r\n        <Spin size=\"large\" tip={`Loading ${entityName} definition...`} />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (hasError || !isEntityValid || !config) {\r\n    return (\r\n      <Result\r\n        status=\"404\"\r\n        title=\"Entity Not Found\"\r\n        subTitle={`The entity \"${entityName}\" does not exist or is not active.`}\r\n        extra={\r\n          <div>\r\n            <Button type=\"primary\" onClick={goBack} style={{ marginRight: 8 }}>\r\n              Back to Entities\r\n            </Button>\r\n            <Button onClick={goToEntityDefinitions}>\r\n              Manage Entity Definitions\r\n            </Button>\r\n          </div>\r\n        }\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <GenericCrudPage\r\n      config={config}\r\n      enableDynamicFields={true}\r\n      showDynamicColumnsInTable={true} // Show dynamic columns in table for pure dynamic entities\r\n      entityName={entityDef?.entity_name}\r\n      enableSuperAdminFilters={true}\r\n      onValuesChange={handleValuesChange}\r\n    />\r\n  );\r\n};\r\n\r\nexport default DynamicEntityCrud;\r\n\r\n"],"names":["DynamicEntityCrud","entityName","entityDef","loading","hasError","isEntityValid","dynamicApiRoutes","defaultColumns","goBack","goToEntityDefinitions","useDynamicEntity","useParams","navigate","useNavigate","dispatch","useDispatch","setEntityDef","useState","getApiRoute","useMemo","createApiRouteGetter","entityDefRoute","items","error","useDynamicSelector","identifier","fetchEntityDefinition","useCallback","dynamic_request","method","endpoint","data","entity_name","useEffect","result","Array","isArray","length","definition","find","item","baseEndpoint","concat","get","create","update","delete","title","dataIndex","key","render","text","_jsxs","style","fontFamily","fontSize","fontWeight","color","children","substring","date","_jsx","Date","toLocaleDateString","Boolean","is_active","config","plural_name","columns","formItems","apiRoutes","formColumns","drawerWidth","skipMetadataWrapping","metadataFieldName","enableDynamicFields","enableSuperAdminFilters","handleValuesChange","_changed","all","display","justifyContent","alignItems","height","Spin","size","tip","GenericCrudPage","showDynamicColumnsInTable","onValuesChange","Result","status","subTitle","extra","Button","type","onClick","marginRight"],"sourceRoot":""}