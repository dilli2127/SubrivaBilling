{"version":3,"file":"static/js/4122.57a59c89.chunk.js","mappings":"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","sources":["../node_modules/@ant-design/icons-svg/es/asn/FileSyncOutlined.js","../node_modules/@ant-design/icons/es/icons/FileSyncOutlined.js","pages/Quotations/columns.tsx","helpers/quotationCalculations.ts","pages/Quotations/QuotationLineItemsTable.tsx","pages/Quotations/QuotationViewModal.tsx","pages/Quotations/QuotationConvertModal.tsx","pages/Quotations/QuotationSendModal.tsx","pages/Quotations/QuotationCrud.tsx","../node_modules/@ant-design/icons-svg/es/asn/PrinterOutlined.js","../node_modules/@ant-design/icons/es/icons/PrinterOutlined.js"],"sourcesContent":["// This icon file is generated automatically.\nvar FileSyncOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M296 256c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm192 200v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8zm-48 396H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm104.1-115.6c1.8-34.5 16.2-66.8 40.8-91.4 26.2-26.2 62-41 99.1-41 37.4 0 72.6 14.6 99.1 41 3.2 3.2 6.3 6.6 9.2 10.1L769.2 673a8 8 0 003 14.1l93.3 22.5c5 1.2 9.8-2.6 9.9-7.7l.6-95.4a8 8 0 00-12.9-6.4l-20.3 15.8C805.4 569.6 748.1 540 684 540c-109.9 0-199.6 86.9-204 195.7-.2 4.5 3.5 8.3 8 8.3h48.1c4.3 0 7.8-3.3 8-7.6zM880 744h-48.1c-4.3 0-7.8 3.3-8 7.6-1.8 34.5-16.2 66.8-40.8 91.4-26.2 26.2-62 41-99.1 41-37.4 0-72.6-14.6-99.1-41-3.2-3.2-6.3-6.6-9.2-10.1l23.1-17.9a8 8 0 00-3-14.1l-93.3-22.5c-5-1.2-9.8 2.6-9.9 7.7l-.6 95.4a8 8 0 0012.9 6.4l20.3-15.8C562.6 918.4 619.9 948 684 948c109.9 0 199.6-86.9 204-195.7.2-4.5-3.5-8.3-8-8.3z\" } }] }, \"name\": \"file-sync\", \"theme\": \"outlined\" };\nexport default FileSyncOutlined;\n","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport FileSyncOutlinedSvg from \"@ant-design/icons-svg/es/asn/FileSyncOutlined\";\nimport AntdIcon from \"../components/AntdIcon\";\nconst FileSyncOutlined = (props, ref) => /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n  ref: ref,\n  icon: FileSyncOutlinedSvg\n}));\n\n/**![file-sync](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTI5NiAyNTZjLTQuNCAwLTggMy42LTggOHY0OGMwIDQuNCAzLjYgOCA4IDhoMzg0YzQuNCAwIDgtMy42IDgtOHYtNDhjMC00LjQtMy42LTgtOC04SDI5NnptMTkyIDIwMHYtNDhjMC00LjQtMy42LTgtOC04SDI5NmMtNC40IDAtOCAzLjYtOCA4djQ4YzAgNC40IDMuNiA4IDggOGgxODRjNC40IDAgOC0zLjYgOC04em0tNDggMzk2SDIwOFYxNDhoNTYwdjM0NGMwIDQuNCAzLjYgOCA4IDhoNTZjNC40IDAgOC0zLjYgOC04VjEwOGMwLTE3LjctMTQuMy0zMi0zMi0zMkgxNjhjLTE3LjcgMC0zMiAxNC4zLTMyIDMydjc4NGMwIDE3LjcgMTQuMyAzMiAzMiAzMmgyNzJjNC40IDAgOC0zLjYgOC04di01NmMwLTQuNC0zLjYtOC04LTh6bTEwNC4xLTExNS42YzEuOC0zNC41IDE2LjItNjYuOCA0MC44LTkxLjQgMjYuMi0yNi4yIDYyLTQxIDk5LjEtNDEgMzcuNCAwIDcyLjYgMTQuNiA5OS4xIDQxIDMuMiAzLjIgNi4zIDYuNiA5LjIgMTAuMUw3NjkuMiA2NzNhOCA4IDAgMDAzIDE0LjFsOTMuMyAyMi41YzUgMS4yIDkuOC0yLjYgOS45LTcuN2wuNi05NS40YTggOCAwIDAwLTEyLjktNi40bC0yMC4zIDE1LjhDODA1LjQgNTY5LjYgNzQ4LjEgNTQwIDY4NCA1NDBjLTEwOS45IDAtMTk5LjYgODYuOS0yMDQgMTk1LjctLjIgNC41IDMuNSA4LjMgOCA4LjNoNDguMWM0LjMgMCA3LjgtMy4zIDgtNy42ek04ODAgNzQ0aC00OC4xYy00LjMgMC03LjggMy4zLTggNy42LTEuOCAzNC41LTE2LjIgNjYuOC00MC44IDkxLjQtMjYuMiAyNi4yLTYyIDQxLTk5LjEgNDEtMzcuNCAwLTcyLjYtMTQuNi05OS4xLTQxLTMuMi0zLjItNi4zLTYuNi05LjItMTAuMWwyMy4xLTE3LjlhOCA4IDAgMDAtMy0xNC4xbC05My4zLTIyLjVjLTUtMS4yLTkuOCAyLjYtOS45IDcuN2wtLjYgOTUuNGE4IDggMCAwMDEyLjkgNi40bDIwLjMtMTUuOEM1NjIuNiA5MTguNCA2MTkuOSA5NDggNjg0IDk0OGMxMDkuOSAwIDE5OS42LTg2LjkgMjA0LTE5NS43LjItNC41LTMuNS04LjMtOC04LjN6IiAvPjwvc3ZnPg==) */\nconst RefIcon = /*#__PURE__*/React.forwardRef(FileSyncOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'FileSyncOutlined';\n}\nexport default RefIcon;","import React from 'react';\r\nimport { Tag, Tooltip, Button, Space, Badge, Dropdown, Menu } from 'antd';\r\nimport dayjs from 'dayjs';\r\nimport {\r\n  FileTextOutlined,\r\n  UserOutlined,\r\n  CalendarOutlined,\r\n  DollarOutlined,\r\n  CheckCircleOutlined,\r\n  CloseCircleOutlined,\r\n  SendOutlined,\r\n  EyeOutlined,\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  DownloadOutlined,\r\n  WarningOutlined,\r\n  MoreOutlined,\r\n  FileSyncOutlined,\r\n  MailOutlined,\r\n} from '@ant-design/icons';\r\nimport { QuotationStatus, Quotation } from '../../types/quotation';\r\nimport { canRead, canUpdate, canDelete, RESOURCES } from '../../helpers/permissionHelper';\r\n\r\n// Status Configuration\r\nconst statusConfig: Record<QuotationStatus, { color: string; icon: React.ReactNode; label: string }> = {\r\n  draft: { color: 'default', icon: <EditOutlined />, label: 'Draft' },\r\n  sent: { color: 'processing', icon: <SendOutlined />, label: 'Sent' },\r\n  accepted: { color: 'success', icon: <CheckCircleOutlined />, label: 'Accepted' },\r\n  rejected: { color: 'error', icon: <CloseCircleOutlined />, label: 'Rejected' },\r\n  expired: { color: 'warning', icon: <WarningOutlined />, label: 'Expired' },\r\n  converted: { color: 'green', icon: <FileSyncOutlined />, label: 'Converted' },\r\n};\r\n\r\ninterface ColumnActions {\r\n  onView: (record: Quotation) => void;\r\n  onEdit: (record: Quotation) => void;\r\n  onDelete: (record: Quotation) => void;\r\n  onSend: (record: Quotation) => void;\r\n  onConvert: (record: Quotation) => void;\r\n  onAccept: (record: Quotation) => void;\r\n  onReject: (record: Quotation) => void;\r\n  onPrint: (record: Quotation) => void;\r\n}\r\n\r\nexport const quotationColumns = (actions: ColumnActions) => [\r\n  {\r\n    title: 'Quotation #',\r\n    dataIndex: 'quotation_number',\r\n    key: 'quotation_number',\r\n    fixed: 'left' as const,\r\n    width: 140,\r\n    render: (text: string, record: Quotation) => (\r\n      <div>\r\n        <Tag icon={<FileTextOutlined />} color=\"blue\" style={{ fontSize: '12px' }}>\r\n          {text}\r\n        </Tag>\r\n        {record.status === 'converted' && (\r\n          <Tag color=\"green\" style={{ marginTop: 4 }}>\r\n            CONVERTED\r\n          </Tag>\r\n        )}\r\n      </div>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Status',\r\n    dataIndex: 'status',\r\n    key: 'status',\r\n    width: 140,\r\n    filters: Object.keys(statusConfig).map(key => ({\r\n      text: statusConfig[key as QuotationStatus].label,\r\n      value: key,\r\n    })),\r\n    onFilter: (value: string | number | boolean, record: Quotation) => record.status === value,\r\n    render: (status: QuotationStatus, record: Quotation) => {\r\n      const config = statusConfig[status] || statusConfig.draft;\r\n      const isExpired = record.valid_until && \r\n        dayjs(record.valid_until).isBefore(dayjs()) &&\r\n        !['converted', 'rejected'].includes(status);\r\n      \r\n      return (\r\n        <div>\r\n          <Badge \r\n            status={config.color as any} \r\n            text={\r\n              <Tag color={config.color} icon={config.icon}>\r\n                {config.label}\r\n              </Tag>\r\n            }\r\n          />\r\n          {isExpired && status !== 'expired' && (\r\n            <Tag color=\"red\" icon={<WarningOutlined />} style={{ marginTop: 4 }}>\r\n              EXPIRED\r\n            </Tag>\r\n          )}\r\n        </div>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'Customer',\r\n    dataIndex: 'customer',\r\n    key: 'customer',\r\n    width: 180,\r\n    render: (customer: any, record: Quotation) => {\r\n      // Check multiple possible customer field names\r\n      const recordAny = record as any; // API may return additional fields\r\n      const customerData = customer || record.CustomerItem || { \r\n        customer_name: record.customer_name, \r\n        full_name: recordAny.full_name,\r\n        name: recordAny.name,\r\n        company_name: '' \r\n      };\r\n      \r\n      const customerName = customerData.customer_name || customerData.full_name || customerData.name || '-';\r\n      \r\n      return (\r\n        <Tooltip title={customerData.company_name || customerData.email || 'No additional info'}>\r\n          <div>\r\n            <UserOutlined style={{ marginRight: 4, color: '#1890ff' }} />\r\n            <strong>{customerName}</strong>\r\n            {customerData.company_name && (\r\n              <div style={{ fontSize: '11px', color: '#888' }}>\r\n                {customerData.company_name}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Tooltip>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'Quotation Date',\r\n    dataIndex: 'quotation_date',\r\n    key: 'quotation_date',\r\n    width: 120,\r\n    sorter: (a: Quotation, b: Quotation) => dayjs(a.quotation_date).unix() - dayjs(b.quotation_date).unix(),\r\n    render: (date: string) => {\r\n      if (!date) return <span style={{ color: '#999' }}>-</span>;\r\n      return (\r\n        <span>\r\n          <CalendarOutlined style={{ marginRight: 4 }} />\r\n          {dayjs(date).format('DD/MM/YYYY')}\r\n        </span>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'Valid Until',\r\n    dataIndex: 'valid_until',\r\n    key: 'valid_until',\r\n    width: 140,\r\n    sorter: (a: Quotation, b: Quotation) => \r\n      dayjs(a.valid_until || 0).unix() - dayjs(b.valid_until || 0).unix(),\r\n    render: (date: string, record: Quotation) => {\r\n      if (!date) return <span style={{ color: '#999' }}>-</span>;\r\n      \r\n      const isExpired = dayjs(date).isBefore(dayjs()) &&\r\n        !['converted', 'rejected'].includes(record.status);\r\n      const daysLeft = dayjs(date).diff(dayjs(), 'days');\r\n      \r\n      return (\r\n        <Tooltip title={isExpired ? 'Expired!' : `${daysLeft} days left`}>\r\n          <span style={{ color: isExpired ? '#ff4d4f' : daysLeft <= 3 ? '#faad14' : 'inherit' }}>\r\n            <CalendarOutlined style={{ marginRight: 4 }} />\r\n            {dayjs(date).format('DD/MM/YYYY')}\r\n          </span>\r\n        </Tooltip>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'Items',\r\n    dataIndex: 'items',\r\n    key: 'items_count',\r\n    width: 80,\r\n    align: 'center' as const,\r\n    render: (items: any[]) => (\r\n      <Tag color=\"geekblue\">{items?.length || 0} items</Tag>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Total Amount',\r\n    dataIndex: 'total_amount',\r\n    key: 'total_amount',\r\n    width: 130,\r\n    sorter: (a: Quotation, b: Quotation) => (a.total_amount || 0) - (b.total_amount || 0),\r\n    render: (amount: number) => (\r\n      <span style={{ fontWeight: 'bold', color: '#52c41a' }}>\r\n        <DollarOutlined style={{ marginRight: 4 }} />\r\n        {amount?.toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n      </span>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Converted To',\r\n    dataIndex: 'converted_to_invoice_no',\r\n    key: 'converted_to',\r\n    width: 150,\r\n    render: (salesRecordId: string, record: Quotation) => {\r\n      if (!salesRecordId) return <span style={{ color: '#999' }}>-</span>;\r\n      \r\n      const tooltipTitle = record.converted_date \r\n        ? `Converted on ${dayjs(record.converted_date).format('DD/MM/YYYY')}`\r\n        : 'Converted to Invoice';\r\n      \r\n      return (\r\n        <Tooltip title={tooltipTitle}>\r\n          <Tag color=\"green\" icon={<FileSyncOutlined />}>\r\n            {salesRecordId}\r\n          </Tag>\r\n        </Tooltip>\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: 'Created By',\r\n    dataIndex: 'CreatedByUser',\r\n    key: 'created_by',\r\n    width: 130,\r\n    render: (user: any) => (\r\n      <Tooltip title={user?.email}>\r\n        <span style={{ fontSize: '12px' }}>\r\n          {user?.username || '-'}\r\n        </span>\r\n      </Tooltip>\r\n    ),\r\n  },\r\n  {\r\n    title: 'Actions',\r\n    key: 'actions',\r\n    fixed: 'right' as const,\r\n    width: 120,\r\n    render: (_: unknown, record: Quotation) => {\r\n      // Permission checks\r\n      const hasReadPerm = canRead(RESOURCES.QUOTATION);\r\n      const hasUpdatePerm = canUpdate(RESOURCES.QUOTATION);\r\n      const hasDeletePerm = canDelete(RESOURCES.QUOTATION);\r\n      \r\n      // Status-based checks\r\n      const canEditByStatus = ['draft', 'rejected'].includes(record.status);\r\n      const isDraft = record.status === 'draft';\r\n      const canConvert = ['draft', 'sent', 'accepted'].includes(record.status);\r\n      const canSend = record.status === 'draft';\r\n      \r\n      // Combined permission + status checks\r\n      const canEdit = hasUpdatePerm && canEditByStatus;\r\n      const canDeleteRecord = hasDeletePerm && isDraft;\r\n      \r\n      // Quotation Actions dropdown menu\r\n      const quotationActionsMenu = (\r\n        <Menu>\r\n          {/* View - requires read permission */}\r\n          {hasReadPerm && (\r\n            <Menu.Item \r\n              key=\"view\" \r\n              icon={<EyeOutlined />}\r\n              onClick={() => actions.onView(record)}\r\n            >\r\n              View Details\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Send - requires update permission */}\r\n          {hasUpdatePerm && canSend && (\r\n            <Menu.Item \r\n              key=\"send\" \r\n              icon={<MailOutlined />}\r\n              onClick={() => actions.onSend(record)}\r\n            >\r\n              Send to Customer\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Convert to Invoice - requires update permission */}\r\n          {hasUpdatePerm && canConvert && (\r\n            <Menu.Item \r\n              key=\"convert\" \r\n              icon={<FileSyncOutlined />}\r\n              onClick={() => actions.onConvert(record)}\r\n            >\r\n              Convert to Invoice\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Accept - requires update permission */}\r\n          {hasUpdatePerm && record.status === 'sent' && (\r\n            <Menu.Item \r\n              key=\"accept\" \r\n              icon={<CheckCircleOutlined />}\r\n              onClick={() => actions.onAccept(record)}\r\n            >\r\n              Mark as Accepted\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Reject - requires update permission */}\r\n          {hasUpdatePerm && record.status === 'sent' && (\r\n            <Menu.Item \r\n              key=\"reject\" \r\n              icon={<CloseCircleOutlined />}\r\n              onClick={() => actions.onReject(record)}\r\n            >\r\n              Mark as Rejected\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Print - requires read permission */}\r\n          {hasReadPerm && (\r\n            <Menu.Item \r\n              key=\"print\" \r\n              icon={<DownloadOutlined />}\r\n              onClick={() => actions.onPrint(record)}\r\n            >\r\n              Print/PDF\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Edit - requires update permission */}\r\n          {canEdit && (\r\n            <Menu.Item \r\n              key=\"edit\" \r\n              icon={<EditOutlined />}\r\n              onClick={() => actions.onEdit(record)}\r\n            >\r\n              Edit\r\n            </Menu.Item>\r\n          )}\r\n          \r\n          {/* Delete - requires delete permission */}\r\n          {canDeleteRecord && (\r\n            <>\r\n              <Menu.Divider />\r\n              <Menu.Item \r\n                key=\"delete\" \r\n                icon={<DeleteOutlined />}\r\n                danger\r\n                onClick={() => actions.onDelete(record)}\r\n              >\r\n                Delete\r\n              </Menu.Item>\r\n            </>\r\n          )}\r\n        </Menu>\r\n      );\r\n      \r\n      return (\r\n        <Space>\r\n          {/* Quick Actions - Show most common actions as buttons */}\r\n          {hasReadPerm && (\r\n            <Tooltip title=\"View Details\">\r\n              <Button\r\n                type=\"text\"\r\n                size=\"small\"\r\n                icon={<EyeOutlined />}\r\n                onClick={() => actions.onView(record)}\r\n              />\r\n            </Tooltip>\r\n          )}\r\n          \r\n          {hasUpdatePerm && canConvert && (\r\n            <Tooltip title=\"Convert to Invoice\">\r\n              <Button\r\n                type=\"text\"\r\n                size=\"small\"\r\n                icon={<FileSyncOutlined />}\r\n                onClick={() => actions.onConvert(record)}\r\n                style={{ color: '#52c41a' }}\r\n              />\r\n            </Tooltip>\r\n          )}\r\n          \r\n          {/* More Actions Dropdown */}\r\n          <Dropdown overlay={quotationActionsMenu} trigger={['click']}>\r\n            <Button\r\n              type=\"text\"\r\n              size=\"small\"\r\n              icon={<MoreOutlined />}\r\n            />\r\n          </Dropdown>\r\n        </Space>\r\n      );\r\n    },\r\n  },\r\n];\r\n\r\n","import { QuotationLineItem } from '../types/quotation';\r\n\r\ntype Numeric = number | string | null | undefined;\r\n\r\nexport interface LineItemTotals {\r\n  line_total: number;\r\n  item_subtotal: number;\r\n  item_discount_amount: number;\r\n  item_tax_amount: number;\r\n  item_value_of_goods: number;\r\n}\r\n\r\nexport interface AggregateTotals {\r\n  subtotal: number;\r\n  discount_amount: number;\r\n  tax_amount: number;\r\n  value_of_goods: number;\r\n  total_amount: number;\r\n}\r\n\r\nconst toNumber = (value: Numeric, fallback = 0): number => {\r\n  const parsed = Number(value);\r\n  return Number.isFinite(parsed) ? parsed : fallback;\r\n};\r\n\r\nconst roundToTwo = (value: number): number =>\r\n  Number((Math.round((value + Number.EPSILON) * 100) / 100).toFixed(2));\r\n\r\n/**\r\n * Calculates all monetary fields for a single line item respecting GST inclusion state\r\n */\r\nexport const calculateLineItemTotals = (\r\n  item: Partial<QuotationLineItem>,\r\n  gstIncluded: boolean = true\r\n): LineItemTotals => {\r\n  const quantity = toNumber(item.quantity);\r\n  const unitPrice = toNumber(item.unit_price);\r\n  const taxPercentage = toNumber(item.tax_percentage);\r\n  const discountValue = toNumber(item.discount);\r\n  const discountType = item.discount_type === 'amount' ? 'amount' : 'percentage';\r\n\r\n  const baseAmount = quantity * unitPrice;\r\n\r\n  let discountAmount =\r\n    discountType === 'percentage'\r\n      ? (baseAmount * discountValue) / 100\r\n      : discountValue;\r\n\r\n  discountAmount = Math.min(Math.max(discountAmount, 0), baseAmount);\r\n\r\n  const subtotal = Math.max(baseAmount - discountAmount, 0);\r\n\r\n  let taxAmount = 0;\r\n  let lineTotal = subtotal;\r\n  let valueOfGoods = subtotal;\r\n\r\n  if (taxPercentage > 0) {\r\n    if (gstIncluded) {\r\n      taxAmount = subtotal * (taxPercentage / (100 + taxPercentage));\r\n      valueOfGoods = subtotal - taxAmount;\r\n      lineTotal = subtotal;\r\n    } else {\r\n      taxAmount = subtotal * (taxPercentage / 100);\r\n      lineTotal = subtotal + taxAmount;\r\n      valueOfGoods = subtotal;\r\n    }\r\n  } else {\r\n    valueOfGoods = subtotal;\r\n  }\r\n\r\n  return {\r\n    line_total: roundToTwo(lineTotal),\r\n    item_subtotal: roundToTwo(subtotal),\r\n    item_discount_amount: roundToTwo(discountAmount),\r\n    item_tax_amount: roundToTwo(taxAmount),\r\n    item_value_of_goods: roundToTwo(valueOfGoods),\r\n  };\r\n};\r\n\r\n/**\r\n * Normalizes line items (numbers + derived amounts)\r\n */\r\nexport const normalizeLineItems = (\r\n  items: Partial<QuotationLineItem>[] = [],\r\n  gstIncluded: boolean = true\r\n) =>\r\n  items.map(item => {\r\n    const normalizedItem: Partial<QuotationLineItem> = {\r\n      ...item,\r\n      quantity: toNumber(item.quantity),\r\n      unit_price: toNumber(item.unit_price),\r\n      tax_percentage: toNumber(item.tax_percentage),\r\n      discount: toNumber(item.discount),\r\n      discount_type: item.discount_type === 'amount' ? 'amount' : 'percentage',\r\n    };\r\n\r\n    const totals = calculateLineItemTotals(normalizedItem, gstIncluded);\r\n\r\n    return {\r\n      ...normalizedItem,\r\n      // Explicitly preserve stock_audit_id\r\n      stock_audit_id: item.stock_audit_id || normalizedItem.stock_audit_id || undefined,\r\n      // Add calculated totals\r\n      ...totals,\r\n    };\r\n  });\r\n\r\n/**\r\n * Aggregates totals for the entire quotation\r\n */\r\nexport const calculateAggregateTotals = (\r\n  items: Partial<QuotationLineItem>[] = [],\r\n  gstIncluded: boolean = true\r\n): AggregateTotals => {\r\n  const totals = items.reduce(\r\n    (acc, item) => {\r\n      const itemTotals = calculateLineItemTotals(item, gstIncluded);\r\n      // Subtotal = sum of line totals (what customer pays per line) for better UX\r\n      acc.subtotal += itemTotals.line_total;\r\n      acc.tax_amount += itemTotals.item_tax_amount;\r\n      acc.discount_amount += itemTotals.item_discount_amount;\r\n      acc.value_of_goods += itemTotals.item_value_of_goods;\r\n      acc.total_amount += itemTotals.line_total;\r\n      return acc;\r\n    },\r\n    {\r\n      subtotal: 0,\r\n      tax_amount: 0,\r\n      discount_amount: 0,\r\n      value_of_goods: 0,\r\n      total_amount: 0,\r\n    } as AggregateTotals\r\n  );\r\n\r\n  return {\r\n    subtotal: roundToTwo(totals.subtotal),\r\n    tax_amount: roundToTwo(totals.tax_amount),\r\n    discount_amount: roundToTwo(totals.discount_amount),\r\n    value_of_goods: roundToTwo(totals.value_of_goods),\r\n    total_amount: roundToTwo(totals.total_amount),\r\n  };\r\n};\r\n\r\n\r\n","import React, { useCallback, useMemo, useEffect, useRef, useState } from 'react';\r\nimport {\r\n  Table,\r\n  Button,\r\n  InputNumber,\r\n  Select,\r\n  Input,\r\n  Popconfirm,\r\n  Space,\r\n  Tooltip,\r\n} from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  DeleteOutlined,\r\n  CalculatorOutlined,\r\n} from '@ant-design/icons';\r\nimport { QuotationLineItem } from '../../types/quotation';\r\nimport { apiSlice } from '../../services/redux/api/apiSlice';\r\nimport { calculateLineItemTotals } from '../../helpers/quotationCalculations';\r\n\r\ninterface QuotationLineItemsTableProps {\r\n  value?: QuotationLineItem[];\r\n  onChange?: (items: QuotationLineItem[]) => void;\r\n  disabled?: boolean;\r\n  isGstIncluded?: boolean;  // Whether GST is included in prices\r\n}\r\n\r\nconst QuotationLineItemsTable: React.FC<QuotationLineItemsTableProps> = ({\r\n  value = [],\r\n  onChange,\r\n  disabled = false,\r\n  isGstIncluded = true,  // Default to GST included\r\n}) => {\r\n  // Product dropdown with server-side debounced search and infinite scroll\r\n  const [productSearchString, setProductSearchString] = useState('');\r\n  const [productDebouncedSearch, setProductDebouncedSearch] = useState('');\r\n  const [productPage, setProductPage] = useState(1);\r\n  const [allProducts, setAllProducts] = useState<any[]>([]);\r\n  const [hasMoreProducts, setHasMoreProducts] = useState(true);\r\n  const productSearchTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n  const isLoadingMoreProductsRef = useRef(false);\r\n\r\n  // Debounce product search\r\n  useEffect(() => {\r\n    // Skip if search hasn't changed\r\n    if (productSearchString === productDebouncedSearch) {\r\n      return;\r\n    }\r\n\r\n    if (productSearchTimerRef.current) {\r\n      clearTimeout(productSearchTimerRef.current);\r\n    }\r\n    \r\n    productSearchTimerRef.current = setTimeout(() => {\r\n      setProductDebouncedSearch(productSearchString);\r\n      setProductPage(1);\r\n      setAllProducts([]);\r\n      setHasMoreProducts(true);\r\n      isLoadingMoreProductsRef.current = false;\r\n    }, 300);\r\n    return () => {\r\n      if (productSearchTimerRef.current) {\r\n        clearTimeout(productSearchTimerRef.current);\r\n      }\r\n    };\r\n  }, [productSearchString, productDebouncedSearch]);\r\n\r\n  // Fetch products with server-side search\r\n  const productQueryParams = useMemo(() => ({\r\n    pageNumber: productPage,\r\n    pageLimit: 20,\r\n    searchString: productDebouncedSearch || '',\r\n  }), [productPage, productDebouncedSearch]);\r\n\r\n  const { data: productsData, isLoading: productsLoading, isFetching: productsFetching } = apiSlice.useGetProductQuery(\r\n    productQueryParams,\r\n    {\r\n      refetchOnMountOrArgChange: false,\r\n      refetchOnFocus: false,\r\n      refetchOnReconnect: false,\r\n    }\r\n  );\r\n\r\n  // Accumulate products\r\n  useEffect(() => {\r\n    if (productsData) {\r\n      const newProducts = (productsData as any)?.result || [];\r\n      const totalCount = (productsData as any).pagination?.totalCount || (productsData as any).pagination?.total || 0;\r\n      \r\n      setAllProducts(prev => {\r\n        if (productPage === 1) {\r\n          // For page 1, replace all\r\n          setHasMoreProducts(newProducts.length < totalCount && newProducts.length > 0);\r\n          return newProducts;\r\n        } else {\r\n          // Append products for subsequent pages\r\n          const existingIds = new Set(prev.map((p: any) => p._id));\r\n          const uniqueNewProducts = newProducts.filter((p: any) => !existingIds.has(p._id));\r\n          if (uniqueNewProducts.length === 0) {\r\n            return prev;\r\n          }\r\n          const updated = [...prev, ...uniqueNewProducts];\r\n          setHasMoreProducts(updated.length < totalCount && uniqueNewProducts.length > 0);\r\n          return updated;\r\n        }\r\n      });\r\n      isLoadingMoreProductsRef.current = false;\r\n    }\r\n  }, [productsData, productPage]);\r\n\r\n  // Product scroll handler for infinite loading\r\n  const handleProductPopupScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\r\n    const target = e.target as HTMLDivElement;\r\n    const scrollTop = target.scrollTop;\r\n    const scrollHeight = target.scrollHeight;\r\n    const clientHeight = target.clientHeight;\r\n    const scrollPercentage = (scrollTop + clientHeight) / scrollHeight;\r\n    \r\n    if (scrollPercentage > 0.7 && hasMoreProducts && !productsLoading && !isLoadingMoreProductsRef.current) {\r\n      isLoadingMoreProductsRef.current = true;\r\n      setProductPage(prev => prev + 1);\r\n    }\r\n  }, [hasMoreProducts, productsLoading]);\r\n\r\n  const onProductDropdownVisibleChange = useCallback((open: boolean) => {\r\n    // Don't trigger any actions - let the query hook handle data loading\r\n  }, []);\r\n\r\n  // Keep products list for backward compatibility with handleProductSelect\r\n  const products = allProducts;\r\n\r\n  // Component for stock audit dropdown per row\r\n  const StockAuditDropdownForRow: React.FC<{\r\n    record: QuotationLineItem;\r\n    index: number;\r\n    disabled: boolean;\r\n    onStockAuditSelect: (index: number, stockAuditId: string | undefined, stockAudit?: any) => void;\r\n  }> = React.memo(({ record, index, disabled, onStockAuditSelect }) => {\r\n    const [searchString, setSearchString] = useState('');\r\n    const [debouncedSearch, setDebouncedSearch] = useState('');\r\n    const [page, setPage] = useState(1);\r\n    const [allItems, setAllItems] = useState<any[]>([]);\r\n    const [hasMore, setHasMore] = useState(true);\r\n    const searchTimerRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n    const isLoadingMoreRef = useRef(false);\r\n    const prevProductIdRef = useRef<string | undefined>(undefined);\r\n    const prevQueryParamsRef = useRef<string>('');\r\n    const dataLoadedRef = useRef(false);\r\n    const productId = record.product_id;\r\n\r\n    // Debounce search\r\n    useEffect(() => {\r\n      // Skip if search hasn't changed\r\n      if (searchString === debouncedSearch) {\r\n        return;\r\n      }\r\n\r\n      if (searchTimerRef.current) {\r\n        clearTimeout(searchTimerRef.current);\r\n      }\r\n      \r\n      searchTimerRef.current = setTimeout(() => {\r\n        setDebouncedSearch(searchString);\r\n        setPage(1);\r\n        setAllItems([]);\r\n        setHasMore(true);\r\n        isLoadingMoreRef.current = false;\r\n        dataLoadedRef.current = false;\r\n      }, 300);\r\n      return () => {\r\n        if (searchTimerRef.current) {\r\n          clearTimeout(searchTimerRef.current);\r\n        }\r\n      };\r\n    }, [searchString, debouncedSearch]);\r\n\r\n    // Reset when product_id changes\r\n    useEffect(() => {\r\n      if (prevProductIdRef.current !== productId) {\r\n        prevProductIdRef.current = productId;\r\n        setPage(1);\r\n        setAllItems([]);\r\n        setHasMore(true);\r\n        setSearchString('');\r\n        setDebouncedSearch('');\r\n        isLoadingMoreRef.current = false;\r\n        dataLoadedRef.current = false;\r\n      }\r\n    }, [productId]);\r\n\r\n    // Create stable query params object - memoized to prevent unnecessary refetches\r\n    const queryParams = useMemo(() => ({\r\n      pageNumber: page,\r\n      pageLimit: 20,\r\n      searchString: debouncedSearch || '',\r\n      product_id: productId || undefined,\r\n    }), [page, debouncedSearch, productId]);\r\n\r\n    // Create query key string to detect actual query changes (not record changes)\r\n    const queryKey = useMemo(() => \r\n      JSON.stringify({ page, searchString: debouncedSearch, product_id: productId }), \r\n      [page, debouncedSearch, productId]\r\n    );\r\n\r\n    // Track if query params actually changed (not just record props)\r\n    const shouldRefetch = useMemo(() => {\r\n      const paramsChanged = prevQueryParamsRef.current !== queryKey;\r\n      if (paramsChanged) {\r\n        prevQueryParamsRef.current = queryKey;\r\n      }\r\n      return paramsChanged;\r\n    }, [queryKey]);\r\n\r\n    // Fetch stock audit with product_id filter\r\n    // Set refetchOnMountOrArgChange to false to prevent refetch on component re-render\r\n    // RTK Query will still refetch when query params change naturally\r\n    const { data, isLoading, isFetching } = apiSlice.useGetStockAuditQuery(\r\n      queryParams,\r\n      {\r\n        skip: !productId, // Skip if no product selected\r\n        refetchOnMountOrArgChange: false, // Don't refetch on component re-render\r\n        refetchOnFocus: false,\r\n        refetchOnReconnect: false,\r\n      }\r\n    );\r\n\r\n    // Accumulate items - only update when data actually changes\r\n    useEffect(() => {\r\n      if (data && productId) {\r\n        const newItems = (data as any)?.result || [];\r\n        const totalCount = (data as any).pagination?.totalCount || (data as any).pagination?.total || 0;\r\n        \r\n        // Prevent unnecessary updates if data hasn't actually changed\r\n        setAllItems(prev => {\r\n          if (page === 1) {\r\n            // For page 1, check if items are actually different\r\n            if (prev.length === newItems.length && \r\n                prev.length > 0 && \r\n                prev[0]?._id === newItems[0]?._id) {\r\n              return prev; // No change, return previous\r\n            }\r\n            setHasMore(newItems.length < totalCount && newItems.length > 0);\r\n            dataLoadedRef.current = true;\r\n            return newItems;\r\n          } else {\r\n            // Append items for subsequent pages\r\n            const existingIds = new Set(prev.map((item: any) => item._id));\r\n            const uniqueNewItems = newItems.filter((item: any) => !existingIds.has(item._id));\r\n            if (uniqueNewItems.length === 0) {\r\n              return prev; // No new items\r\n            }\r\n            const updated = [...prev, ...uniqueNewItems];\r\n            setHasMore(updated.length < totalCount && uniqueNewItems.length > 0);\r\n            return updated;\r\n          }\r\n        });\r\n        isLoadingMoreRef.current = false;\r\n      }\r\n    }, [data, page, productId]);\r\n\r\n    const handlePopupScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\r\n      const target = e.target as HTMLDivElement;\r\n      const scrollTop = target.scrollTop;\r\n      const scrollHeight = target.scrollHeight;\r\n      const clientHeight = target.clientHeight;\r\n      const scrollPercentage = (scrollTop + clientHeight) / scrollHeight;\r\n      \r\n      if (scrollPercentage > 0.7 && hasMore && !isLoading && !isLoadingMoreRef.current && productId) {\r\n        isLoadingMoreRef.current = true;\r\n        setPage(prev => prev + 1);\r\n      }\r\n    }, [hasMore, isLoading, productId]);\r\n\r\n    const onDropdownVisibleChange = useCallback((open: boolean) => {\r\n      // Don't trigger any actions - let the query hook handle data loading\r\n      // The items should persist when dropdown closes\r\n    }, []);\r\n\r\n    return (\r\n      <Select\r\n        showSearch\r\n        allowClear\r\n        placeholder={productId ? \"Select stock batch\" : \"Select product first\"}\r\n        style={{ width: '100%' }}\r\n        value={record.stock_audit_id || undefined}\r\n        onChange={(val) => {\r\n          // Find the stock audit object from allItems to pass to handler\r\n          // Make sure we preserve allItems - don't let onChange clear it\r\n          if (val === undefined || val === null) {\r\n            onStockAuditSelect(index, undefined, undefined);\r\n            return;\r\n          }\r\n          const selectedStockAudit = allItems.find((sa: any) => sa._id === val);\r\n          if (selectedStockAudit) {\r\n            onStockAuditSelect(index, val, selectedStockAudit);\r\n          } else {\r\n            // If item not found in allItems, just set the ID\r\n            onStockAuditSelect(index, val, undefined);\r\n          }\r\n        }}\r\n        disabled={disabled || !productId}\r\n        loading={isLoading && allItems.length === 0}\r\n        onSearch={setSearchString}\r\n        onPopupScroll={handlePopupScroll}\r\n        onDropdownVisibleChange={onDropdownVisibleChange}\r\n        filterOption={false}\r\n        notFoundContent={\r\n          !productId ? 'Please select a product first' :\r\n          isLoading && !dataLoadedRef.current ? 'Loading stock batches...' : \r\n          allItems.length === 0 && !isLoading ? 'No stock batches found for this product' : \r\n          null\r\n        }\r\n        dropdownRender={(menu) => (\r\n          <>\r\n            {menu}\r\n            {hasMore && allItems.length > 0 && (\r\n              <div style={{ textAlign: 'center', padding: '8px', color: '#999' }}>\r\n                {isLoading ? 'Loading...' : 'Scroll for more'}\r\n              </div>\r\n            )}\r\n          </>\r\n        )}\r\n      >\r\n        {allItems.map((stockAudit: any) => (\r\n          <Select.Option key={stockAudit._id} value={stockAudit._id}>\r\n            {stockAudit.ProductItem?.name || 'N/A'} \r\n            {stockAudit.ProductItem?.VariantItem?.variant_name ? ` - ${stockAudit.ProductItem.VariantItem.variant_name}` : ''}\r\n            {stockAudit.batch_no ? ` (Batch: ${stockAudit.batch_no})` : ''}\r\n          </Select.Option>\r\n        ))}\r\n      </Select>\r\n    );\r\n  }, (prevProps, nextProps) => {\r\n    // Custom comparison: only re-render if product_id, index, or disabled changes\r\n    // Ignore changes to record.stock_audit_id or other record properties\r\n    return (\r\n      prevProps.record.product_id === nextProps.record.product_id &&\r\n      prevProps.index === nextProps.index &&\r\n      prevProps.disabled === nextProps.disabled &&\r\n      prevProps.onStockAuditSelect === nextProps.onStockAuditSelect\r\n    );\r\n  });\r\n\r\n  // Add new line item\r\n  const handleAddItem = useCallback(() => {\r\n    const newItem: Partial<QuotationLineItem> = {\r\n      product_id: '',\r\n      product_name: '',\r\n      variant_name: '',\r\n      description: '',\r\n      quantity: 1,\r\n      unit_price: 0,\r\n      tax_percentage: 18,\r\n      discount: 0,\r\n      discount_type: 'percentage',\r\n      line_total: 0,\r\n    };\r\n    \r\n    onChange?.([...value, newItem as QuotationLineItem]);\r\n  }, [value, onChange]);\r\n\r\n  // Delete line item\r\n  const handleDeleteItem = useCallback((index: number) => {\r\n    const newItems = value.filter((_, i) => i !== index);\r\n    onChange?.(newItems);\r\n  }, [value, onChange]);\r\n\r\n  // Calculate derived values for a line item\r\n  const getLineItemTotals = useCallback(\r\n    (item: Partial<QuotationLineItem>) => calculateLineItemTotals(item, isGstIncluded),\r\n    [isGstIncluded]\r\n  );\r\n\r\n  // Update line item field\r\n  const handleFieldChange = useCallback((index: number, field: string, fieldValue: any) => {\r\n    const newItems = [...value];\r\n    const item = { ...newItems[index], [field]: fieldValue };\r\n    \r\n    // Recalculate totals if quantity, price, tax, or discount changes\r\n    if (['quantity', 'unit_price', 'tax_percentage', 'discount', 'discount_type'].includes(field)) {\r\n      const calculated = getLineItemTotals(item);\r\n      item.line_total = calculated.line_total;\r\n    }\r\n    \r\n    newItems[index] = item;\r\n    onChange?.(newItems);\r\n  }, [value, onChange, getLineItemTotals]);\r\n\r\n  // Handle product selection\r\n  const handleProductSelect = useCallback((index: number, productId: string) => {\r\n    const product = products.find((p: any) => p._id === productId);\r\n    if (!product) return;\r\n\r\n    const newItems = [...value];\r\n    \r\n    // Get tax percentage from product category, with fallbacks\r\n    const taxPercentage = \r\n      product.CategoryItem?.tax_percentage || \r\n      product.category?.tax_percentage ||\r\n      product.tax_percentage ||\r\n      18; // Default to 18% if no tax found\r\n    \r\n    const item = {\r\n      ...newItems[index],\r\n      product_id: productId,\r\n      product_name: product.name,\r\n      variant_name: product.VariantItem?.variant_name || '',\r\n      description: product.description || '',\r\n      tax_percentage: Number(taxPercentage) || 18, // Ensure it's a number\r\n      unit_price: product.sell_price || 0, // Use sell_price for quotations\r\n    };\r\n    \r\n    const calculated = getLineItemTotals(item);\r\n    newItems[index] = { ...item, line_total: calculated.line_total };\r\n    onChange?.(newItems);\r\n  }, [value, onChange, products, getLineItemTotals]);\r\n\r\n  // Handle stock audit selection\r\n  const handleStockAuditSelect = useCallback((index: number, stockAuditId: string | undefined, stockAudit?: any) => {\r\n    const newItems = [...value];\r\n    const item = { ...newItems[index] };\r\n    \r\n    // If cleared (undefined), just remove stock audit ID\r\n    if (!stockAuditId) {\r\n      item.stock_audit_id = undefined;\r\n      newItems[index] = item;\r\n      onChange?.(newItems);\r\n      return;\r\n    }\r\n\r\n    // If stock audit object is not provided, return early\r\n    // The component should pass the stock audit object\r\n    if (!stockAudit) {\r\n      // Just update the stock audit ID if object is not available\r\n      item.stock_audit_id = stockAuditId;\r\n      newItems[index] = item;\r\n      onChange?.(newItems);\r\n      return;\r\n    }\r\n\r\n    // Update stock audit ID\r\n    item.stock_audit_id = stockAuditId;\r\n    \r\n    // Populate price from stock audit sell_price\r\n    if (stockAudit.sell_price !== undefined && stockAudit.sell_price !== null) {\r\n      item.unit_price = Number(stockAudit.sell_price) || 0;\r\n    }\r\n    \r\n    // Update product info if not already set\r\n    if (stockAudit.ProductItem && !item.product_id) {\r\n      item.product_id = stockAudit.ProductItem._id || '';\r\n      item.product_name = stockAudit.ProductItem.name || '';\r\n      item.variant_name = stockAudit.ProductItem.VariantItem?.variant_name || '';\r\n      \r\n      // Get tax percentage from product category\r\n      const taxPercentage = \r\n        stockAudit.ProductItem.CategoryItem?.tax_percentage ||\r\n        stockAudit.category?.tax_percentage ||\r\n        18;\r\n      item.tax_percentage = Number(taxPercentage) || 18;\r\n    }\r\n    \r\n    // Recalculate totals\r\n    const calculated = getLineItemTotals(item);\r\n    item.line_total = calculated.line_total;\r\n    \r\n    newItems[index] = item;\r\n    onChange?.(newItems);\r\n  }, [value, onChange, getLineItemTotals]);\r\n\r\n  // Recalculate line totals when GST mode changes\r\n  const prevGstRef = useRef(isGstIncluded);\r\n  \r\n  useEffect(() => {\r\n    if (prevGstRef.current === isGstIncluded) {\r\n      return;\r\n    }\r\n\r\n    if (!value || value.length === 0) {\r\n      prevGstRef.current = isGstIncluded;\r\n      return;\r\n    }\r\n\r\n    const recalculatedItems = value.map(item => {\r\n      const calculations = calculateLineItemTotals(item, isGstIncluded);\r\n      return { ...item, line_total: calculations.line_total };\r\n    }) as QuotationLineItem[];\r\n\r\n    onChange?.(recalculatedItems);\r\n    prevGstRef.current = isGstIncluded;\r\n  }, [isGstIncluded, value, onChange]);\r\n\r\n  // Calculate totals\r\n  const totals = useMemo(() => {\r\n    const aggregate = value.reduce(\r\n      (acc, item) => {\r\n        const itemTotals = calculateLineItemTotals(item, isGstIncluded);\r\n        // Subtotal = sum of line totals (what customer pays per line) for better UX\r\n        acc.subtotal += itemTotals.line_total;\r\n        acc.discountAmount += itemTotals.item_discount_amount;\r\n        acc.valueOfGoods += itemTotals.item_value_of_goods;\r\n        acc.taxAmount += itemTotals.item_tax_amount;\r\n        acc.total += itemTotals.line_total;\r\n        return acc;\r\n      },\r\n      {\r\n        subtotal: 0,\r\n        discountAmount: 0,\r\n        valueOfGoods: 0,\r\n        taxAmount: 0,\r\n        total: 0,\r\n      }\r\n    );\r\n    \r\n    return {\r\n      subtotal: Number(aggregate.subtotal.toFixed(2)),\r\n      discountAmount: Number(aggregate.discountAmount.toFixed(2)),\r\n      valueOfGoods: Number(aggregate.valueOfGoods.toFixed(2)),\r\n      taxAmount: Number(aggregate.taxAmount.toFixed(2)),\r\n      total: Number(aggregate.total.toFixed(2)),\r\n    };\r\n  }, [value, isGstIncluded]);\r\n\r\n  // Table columns\r\n  const columns = [\r\n    {\r\n      title: '#',\r\n      key: 'index',\r\n      width: 40,\r\n      render: (_: any, __: any, index: number) => index + 1,\r\n    },\r\n    {\r\n      title: <span style={{ color: 'red' }}>* Product</span>,\r\n      key: 'product',\r\n      width: 200,\r\n      render: (_: any, record: QuotationLineItem, index: number) => (\r\n        <Select\r\n          showSearch\r\n          allowClear\r\n          placeholder=\"Select product\"\r\n          style={{ width: '100%' }}\r\n          value={record.product_id || undefined}\r\n          onChange={(val) => handleProductSelect(index, val)}\r\n          disabled={disabled}\r\n          loading={productsLoading && allProducts.length === 0}\r\n          onSearch={setProductSearchString}\r\n          onPopupScroll={handleProductPopupScroll}\r\n          onDropdownVisibleChange={onProductDropdownVisibleChange}\r\n          filterOption={false}\r\n          notFoundContent={\r\n            productsLoading && allProducts.length === 0 ? 'Loading products...' : \r\n            allProducts.length === 0 ? 'No products found' : \r\n            null\r\n          }\r\n          dropdownRender={(menu) => (\r\n            <>\r\n              {menu}\r\n              {hasMoreProducts && allProducts.length > 0 && (\r\n                <div style={{ textAlign: 'center', padding: '8px', color: '#999' }}>\r\n                  {productsLoading ? 'Loading...' : 'Scroll for more'}\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        >\r\n          {allProducts.map((product: any) => (\r\n            <Select.Option key={product._id} value={product._id}>\r\n              {product.name} {product.VariantItem?.variant_name ? `- ${product.VariantItem.variant_name}` : ''}\r\n            </Select.Option>\r\n          ))}\r\n        </Select>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Stock Audit',\r\n      key: 'stock_audit',\r\n      width: 200,\r\n      render: (_: any, record: QuotationLineItem, index: number) => (\r\n        <StockAuditDropdownForRow\r\n          record={record}\r\n          index={index}\r\n          disabled={disabled}\r\n          onStockAuditSelect={handleStockAuditSelect}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Description',\r\n      key: 'description',\r\n      width: 150,\r\n      render: (_: any, record: QuotationLineItem, index: number) => (\r\n        <Input\r\n          placeholder=\"Description\"\r\n          value={record.description}\r\n          onChange={(e) => handleFieldChange(index, 'description', e.target.value)}\r\n          disabled={disabled}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: <span style={{ color: 'red' }}>* Quantity</span>,\r\n      key: 'quantity',\r\n      width: 100,\r\n      render: (_: any, record: QuotationLineItem, index: number) => (\r\n        <InputNumber\r\n          min={1}\r\n          precision={0}\r\n          placeholder=\"Qty\"\r\n          style={{ width: '100%' }}\r\n          value={record.quantity}\r\n          onChange={(val) => handleFieldChange(index, 'quantity', val)}\r\n          disabled={disabled}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: <span style={{ color: 'red' }}>* Unit Price</span>,\r\n      key: 'unit_price',\r\n      width: 110,\r\n      render: (_: any, record: QuotationLineItem, index: number) => (\r\n        <InputNumber\r\n          min={0}\r\n          precision={2}\r\n          placeholder=\"0.00\"\r\n          prefix=\"\"\r\n          style={{ width: '100%' }}\r\n          value={record.unit_price}\r\n          onChange={(val) => handleFieldChange(index, 'unit_price', val)}\r\n          disabled={disabled}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Tax %',\r\n      key: 'tax_percentage',\r\n      width: 80,\r\n      render: (_: any, record: QuotationLineItem, index: number) => (\r\n        <InputNumber\r\n          min={0}\r\n          max={100}\r\n          precision={2}\r\n          placeholder=\"18%\"\r\n          suffix=\"%\"\r\n          style={{ width: '100%' }}\r\n          value={record.tax_percentage}\r\n          onChange={(val) => handleFieldChange(index, 'tax_percentage', val)}\r\n          disabled={disabled}\r\n        />\r\n      ),\r\n    },\r\n    {\r\n      title: 'Discount',\r\n      key: 'discount',\r\n      width: 130,\r\n      render: (_: any, record: QuotationLineItem, index: number) => (\r\n        <Space.Compact style={{ width: '100%' }}>\r\n          <InputNumber\r\n            min={0}\r\n            precision={2}\r\n            placeholder=\"0\"\r\n            style={{ width: '70%' }}\r\n            value={record.discount}\r\n            onChange={(val) => handleFieldChange(index, 'discount', val)}\r\n            disabled={disabled}\r\n          />\r\n          <Select\r\n            style={{ width: '30%' }}\r\n            value={record.discount_type}\r\n            onChange={(val) => handleFieldChange(index, 'discount_type', val)}\r\n            disabled={disabled}\r\n          >\r\n            <Select.Option value=\"percentage\">%</Select.Option>\r\n            <Select.Option value=\"amount\"></Select.Option>\r\n          </Select>\r\n        </Space.Compact>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Line Total',\r\n      key: 'line_total',\r\n      width: 110,\r\n      render: (_: any, record: QuotationLineItem) => (\r\n        <Tooltip title={`Qty: ${record.quantity}  ${record.unit_price}`}>\r\n          <strong style={{ color: '#52c41a' }}>\r\n            {(record.line_total || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n          </strong>\r\n        </Tooltip>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Actions',\r\n      key: 'actions',\r\n      width: 70,\r\n      render: (_: any, record: QuotationLineItem, index: number) => (\r\n        <Popconfirm\r\n          title=\"Delete this line item?\"\r\n          onConfirm={() => handleDeleteItem(index)}\r\n          disabled={disabled || value.length === 1}\r\n        >\r\n          <Button\r\n            type=\"link\"\r\n            danger\r\n            size=\"small\"\r\n            icon={<DeleteOutlined />}\r\n            disabled={disabled || value.length === 1}\r\n          />\r\n        </Popconfirm>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div style={{ width: '100%' }}>\r\n      <div style={{ marginBottom: 12, display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n        <strong style={{ fontSize: '14px' }}>Line Items</strong>\r\n        <Button\r\n          type=\"dashed\"\r\n          icon={<PlusOutlined />}\r\n          onClick={handleAddItem}\r\n          disabled={disabled}\r\n        >\r\n          Add Item\r\n        </Button>\r\n      </div>\r\n      \r\n      <Table\r\n        columns={columns}\r\n        dataSource={value}\r\n        pagination={false}\r\n        size=\"small\"\r\n        scroll={{ x: 'max-content' }}\r\n        rowKey={(record, index) => `item-${index}`}\r\n        bordered\r\n        footer={() => (\r\n          <div style={{ textAlign: 'right' }}>\r\n            <Space direction=\"vertical\" size=\"small\" style={{ width: '100%' }}>\r\n              {totals.discountAmount > 0 && (\r\n                <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '20px' }}>\r\n                  <span>Discount:</span>\r\n                  <strong style={{ color: '#ff4d4f' }}>\r\n                    -{totals.discountAmount.toLocaleString('en-IN', { minimumFractionDigits: 2 })}\r\n                  </strong>\r\n                </div>\r\n              )}\r\n              {/* Only show Subtotal if it differs from Total (e.g., when there are adjustments) */}\r\n              {Math.abs(totals.subtotal - totals.total) > 0.01 && (\r\n                <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '20px' }}>\r\n                  <span>Subtotal:</span>\r\n                  <strong>{totals.subtotal.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\r\n                </div>\r\n              )}\r\n              <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '20px' }}>\r\n                <span>Value of Goods:</span>\r\n                <strong>{totals.valueOfGoods.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\r\n              </div>\r\n              {totals.taxAmount > 0 && (\r\n                <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '20px' }}>\r\n                  <span>Tax Amount:</span>\r\n                  <strong>{totals.taxAmount.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\r\n                </div>\r\n              )}\r\n              <div style={{ display: 'flex', justifyContent: 'flex-end', gap: '20px', fontSize: '16px', color: '#52c41a' }}>\r\n                <span><CalculatorOutlined /> Total:</span>\r\n                <strong>{totals.total.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\r\n              </div>\r\n            </Space>\r\n          </div>\r\n        )}\r\n      />\r\n      \r\n      {value.length === 0 && (\r\n        <div style={{ textAlign: 'center', padding: '40px', color: '#999' }}>\r\n          No items added. Click \"Add Item\" to get started.\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default QuotationLineItemsTable;\r\n\r\n","import React, { useMemo } from 'react';\nimport {\n  Modal,\n  Descriptions,\n  Table,\n  Tag,\n  Divider,\n  Space,\n  Typography,\n} from 'antd';\nimport {\n  FileTextOutlined,\n  CalendarOutlined,\n  DollarOutlined,\n  UserOutlined,\n  CheckCircleOutlined,\n  CloseCircleOutlined,\n  SendOutlined,\n  WarningOutlined,\n  FileSyncOutlined,\n} from '@ant-design/icons';\nimport dayjs from 'dayjs';\nimport { apiSlice } from '../../services/redux/api/apiSlice';\nimport { QuotationStatus, Quotation, QuotationLineItem } from '../../types/quotation';\n\nconst { Text } = Typography;\n\ninterface QuotationViewModalProps {\n  open: boolean;\n  onClose: () => void;\n  quotation: Quotation | null;\n}\n\nconst QuotationViewModal: React.FC<QuotationViewModalProps> = ({\n  open,\n  onClose,\n  quotation,\n}) => {\n  // Fetch customer by ID if customer is not populated\n  const quotationAny = quotation as any; // API may return additional fields\n  const shouldFetchCustomer =\n    quotation &&\n    !quotationAny.customer &&\n    !quotation.CustomerItem &&\n    quotation.customer_id &&\n    open;\n  const { data: customerData } = apiSlice.useGetCustomerByIdQuery(\n    quotation?.customer_id || '',\n    { skip: !shouldFetchCustomer }\n  );\n\n  // Get customer information\n  const customerInfo = useMemo(() => {\n    if (!quotation) return null;\n\n    // Priority 1: Check for populated customer object (lowercase 'customer')\n    if (quotationAny.customer && (quotationAny.customer.customer_name || quotationAny.customer.full_name || quotationAny.customer.name)) {\n      return {\n        customer_name: quotationAny.customer.customer_name || quotationAny.customer.full_name || quotationAny.customer.name,\n        company_name: quotationAny.customer.company_name,\n        email: quotationAny.customer.email,\n        phone: quotationAny.customer.phone || quotationAny.customer.mobile,\n        address: quotationAny.customer.address,\n        gst_number: quotationAny.customer.gst_number,\n      };\n    }\n\n    // Priority 2: Check for CustomerItem (capital C, with 'Item' suffix)\n    if (quotation.CustomerItem) {\n      const customerItem = quotation.CustomerItem as any;\n      if (customerItem.customer_name || customerItem.full_name || customerItem.name) {\n        return {\n          customer_name: customerItem.customer_name || customerItem.full_name || customerItem.name,\n          company_name: customerItem.company_name,\n          email: customerItem.email,\n          phone: customerItem.phone || customerItem.mobile,\n          address: customerItem.address,\n          gst_number: customerItem.gst_number,\n        };\n      }\n    }\n\n    // Priority 3: Fetch customer by ID if not populated\n    if (shouldFetchCustomer && customerData) {\n      const customer = (customerData as any)?.result || customerData;\n      if (customer && (customer.customer_name || customer.full_name || customer.name)) {\n        return {\n          customer_name: customer.customer_name || customer.full_name || customer.name,\n          company_name: customer.company_name,\n          email: customer.email,\n          phone: customer.phone || customer.mobile || customer.contact_number,\n          address: customer.address,\n          gst_number: customer.gst_number,\n        };\n      }\n    }\n\n    // Priority 4: Check for direct fields on quotation\n    if (quotation.customer_name || quotationAny.full_name || quotationAny.name) {\n      return {\n        customer_name: quotation.customer_name || quotationAny.full_name || quotationAny.name,\n        company_name: quotationAny.customer_company_name || quotationAny.company_name,\n        email: quotation.customer_email || quotationAny.email,\n        phone: quotation.customer_phone || quotationAny.mobile || quotationAny.phone,\n        address: quotationAny.customer_address || quotationAny.address,\n      };\n    }\n\n    return null;\n  }, [quotation, customerData, shouldFetchCustomer]);\n\n  // Status configuration\n  const statusConfig: Record<QuotationStatus, { color: string; icon: React.ReactNode; label: string }> = {\n    draft: { color: 'default', icon: <FileTextOutlined />, label: 'Draft' },\n    sent: { color: 'processing', icon: <SendOutlined />, label: 'Sent' },\n    accepted: { color: 'success', icon: <CheckCircleOutlined />, label: 'Accepted' },\n    rejected: { color: 'error', icon: <CloseCircleOutlined />, label: 'Rejected' },\n    expired: { color: 'warning', icon: <WarningOutlined />, label: 'Expired' },\n    converted: { color: 'green', icon: <FileSyncOutlined />, label: 'Converted' },\n  };\n\n  const status = (quotation?.status || 'draft') as QuotationStatus;\n  const statusInfo = statusConfig[status] || statusConfig.draft;\n\n  // Line items columns\n  const lineItemsColumns = [\n    {\n      title: '#',\n      key: 'index',\n      width: 50,\n      render: (_: unknown, __: unknown, index: number) => index + 1,\n    },\n    {\n      title: 'Product',\n      dataIndex: 'product_name',\n      key: 'product_name',\n      render: (text: string, record: QuotationLineItem) => (\n        <div>\n          <strong>{text || '-'}</strong>\n          {record.variant_name && (\n            <div style={{ fontSize: '12px', color: '#888' }}>\n              {record.variant_name}\n            </div>\n          )}\n        </div>\n      ),\n    },\n    {\n      title: 'Description',\n      dataIndex: 'description',\n      key: 'description',\n      render: (text: string) => text || '-',\n    },\n    {\n      title: 'Quantity',\n      dataIndex: 'quantity',\n      key: 'quantity',\n      align: 'right' as const,\n      render: (qty: number) => qty || 0,\n    },\n    {\n      title: 'Unit Price',\n      dataIndex: 'unit_price',\n      key: 'unit_price',\n      align: 'right' as const,\n      render: (price: number) => `${(price || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}`,\n    },\n    {\n      title: 'Tax %',\n      dataIndex: 'tax_percentage',\n      key: 'tax_percentage',\n      align: 'right' as const,\n      render: (tax: number) => `${tax || 0}%`,\n    },\n    {\n      title: 'Discount',\n      dataIndex: 'discount',\n      key: 'discount',\n      align: 'right' as const,\n      render: (discount: number, record: any) => {\n        if (!discount) return '-';\n        const type = record.discount_type === 'amount' ? '' : '%';\n        return `${type}${discount}`;\n      },\n    },\n    {\n      title: 'Line Total',\n      dataIndex: 'line_total',\n      key: 'line_total',\n      align: 'right' as const,\n      render: (total: number) => (\n        <strong style={{ color: '#52c41a' }}>\n          {(total || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n        </strong>\n      ),\n    },\n  ];\n\n  if (!quotation) {\n    return null;\n  }\n\n  const isExpired = quotation.valid_until && \n    dayjs(quotation.valid_until).isBefore(dayjs()) &&\n    !['converted', 'rejected'].includes(status);\n\n  return (\n    <Modal\n      title={\n        <Space>\n          <FileTextOutlined />\n          <span>Quotation Details</span>\n          <Tag color={statusInfo.color} icon={statusInfo.icon}>\n            {statusInfo.label}\n          </Tag>\n        </Space>\n      }\n      open={open}\n      onCancel={onClose}\n      footer={null}\n      width={1000}\n      style={{ top: 20 }}\n    >\n      <div style={{ maxHeight: '80vh', overflowY: 'auto' }}>\n        {/* Quotation Header */}\n        <Descriptions bordered column={2} size=\"small\">\n          <Descriptions.Item label=\"Quotation Number\" span={1}>\n            <Tag color=\"blue\" icon={<FileTextOutlined />}>\n              {quotation.quotation_number}\n            </Tag>\n          </Descriptions.Item>\n          <Descriptions.Item label=\"Quotation Date\" span={1}>\n            <Space>\n              <CalendarOutlined />\n              {quotation.quotation_date \n                ? dayjs(quotation.quotation_date).format('DD/MM/YYYY')\n                : '-'}\n            </Space>\n          </Descriptions.Item>\n          <Descriptions.Item label=\"Valid Until\" span={1}>\n            <Space>\n              <CalendarOutlined />\n              {quotation.valid_until ? (\n                <span style={{ color: isExpired ? '#ff4d4f' : 'inherit' }}>\n                  {dayjs(quotation.valid_until).format('DD/MM/YYYY')}\n                  {isExpired && (\n                    <Tag color=\"red\" style={{ marginLeft: 8 }}>\n                      EXPIRED\n                    </Tag>\n                  )}\n                </span>\n              ) : (\n                '-'\n              )}\n            </Space>\n          </Descriptions.Item>\n          <Descriptions.Item label=\"Status\" span={1}>\n            <Tag color={statusInfo.color} icon={statusInfo.icon}>\n              {statusInfo.label}\n            </Tag>\n          </Descriptions.Item>\n        </Descriptions>\n\n        <Divider />\n\n        {/* Customer Information */}\n        <Descriptions title=\"Customer Information\" bordered column={2} size=\"small\">\n          <Descriptions.Item label=\"Customer Name\" span={1}>\n            <Space>\n              <UserOutlined />\n              <strong>{customerInfo?.customer_name || quotation.customer_name || '-'}</strong>\n            </Space>\n          </Descriptions.Item>\n          <Descriptions.Item label=\"Email\" span={1}>\n            {customerInfo?.email || quotation.customer_email || '-'}\n          </Descriptions.Item>\n          <Descriptions.Item label=\"Phone\" span={1}>\n            {customerInfo?.phone || quotation.customer_phone || '-'}\n          </Descriptions.Item>\n          {customerInfo?.gst_number && (\n            <Descriptions.Item label=\"GST Number\" span={1}>\n              {customerInfo.gst_number}\n            </Descriptions.Item>\n          )}\n          {customerInfo?.address && (\n            <Descriptions.Item label=\"Address\" span={2}>\n              {customerInfo.address}\n            </Descriptions.Item>\n          )}\n        </Descriptions>\n        \n        {/* GST Information */}\n        <Divider />\n        <Descriptions bordered column={1} size=\"small\">\n          <Descriptions.Item label=\"GST Status\">\n            <Tag color={quotation.is_gst_included ? 'green' : 'orange'}>\n              {quotation.is_gst_included ? 'GST INCLUDED' : 'GST EXCLUDED'}\n            </Tag>\n            <span style={{ marginLeft: 8, fontSize: '12px', color: '#888' }}>\n              {quotation.is_gst_included \n                ? 'Tax is included in the prices shown' \n                : 'Tax will be added on top of the prices shown'}\n            </span>\n          </Descriptions.Item>\n        </Descriptions>\n\n        <Divider />\n\n        {/* Line Items */}\n        <div>\n          <Text strong style={{ fontSize: '16px' }}>\n            Line Items ({quotation.items?.length || 0})\n          </Text>\n          <Table\n            columns={lineItemsColumns}\n            dataSource={quotation.items || []}\n            pagination={false}\n            size=\"small\"\n            bordered\n            style={{ marginTop: 12 }}\n            rowKey={(record, index) => `item-${index}`}\n            summary={() => {\n              const subtotal = quotation.subtotal || 0;\n              const taxAmount = quotation.tax_amount || 0;\n              const discountAmount = quotation.discount_amount || 0;\n              const total = quotation.total_amount || 0;\n\n              return (\n                <Table.Summary fixed>\n                  <Table.Summary.Row>\n                    <Table.Summary.Cell index={0} colSpan={6} align=\"right\">\n                      <strong>Subtotal:</strong>\n                    </Table.Summary.Cell>\n                    <Table.Summary.Cell index={1} align=\"right\">\n                      <strong>{subtotal.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\n                    </Table.Summary.Cell>\n                  </Table.Summary.Row>\n                  {discountAmount > 0 && (\n                    <Table.Summary.Row>\n                      <Table.Summary.Cell index={0} colSpan={6} align=\"right\">\n                        <strong>Discount:</strong>\n                      </Table.Summary.Cell>\n                      <Table.Summary.Cell index={1} align=\"right\">\n                        <strong style={{ color: '#ff4d4f' }}>\n                          -{discountAmount.toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n                        </strong>\n                      </Table.Summary.Cell>\n                    </Table.Summary.Row>\n                  )}\n                  <Table.Summary.Row>\n                    <Table.Summary.Cell index={0} colSpan={6} align=\"right\">\n                      <strong>Tax Amount:</strong>\n                    </Table.Summary.Cell>\n                    <Table.Summary.Cell index={1} align=\"right\">\n                      <strong>{taxAmount.toLocaleString('en-IN', { minimumFractionDigits: 2 })}</strong>\n                    </Table.Summary.Cell>\n                  </Table.Summary.Row>\n                  <Table.Summary.Row>\n                    <Table.Summary.Cell index={0} colSpan={6} align=\"right\">\n                      <strong style={{ fontSize: '16px', color: '#52c41a' }}>\n                        <DollarOutlined /> Total Amount:\n                      </strong>\n                    </Table.Summary.Cell>\n                    <Table.Summary.Cell index={1} align=\"right\">\n                      <strong style={{ fontSize: '16px', color: '#52c41a' }}>\n                        {total.toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n                      </strong>\n                    </Table.Summary.Cell>\n                  </Table.Summary.Row>\n                </Table.Summary>\n              );\n            }}\n          />\n        </div>\n\n        {/* Conversion Info */}\n        {(quotation.converted_to_invoice_no || quotation.converted_to_sales_record_id) && (\n          <>\n            <Divider />\n            <Descriptions bordered column={1} size=\"small\">\n              <Descriptions.Item label=\"Converted To Invoice\">\n                <Tag color=\"green\" icon={<FileSyncOutlined />}>\n                  {quotation.converted_to_invoice_no || quotation.converted_to_sales_record_id}\n                </Tag>\n                {quotation.converted_date && (\n                  <span style={{ marginLeft: 8, color: '#888' }}>\n                    on {dayjs(quotation.converted_date).format('DD/MM/YYYY')}\n                  </span>\n                )}\n              </Descriptions.Item>\n            </Descriptions>\n          </>\n        )}\n\n        {/* Notes & Terms */}\n        {(quotation.notes || quotation.terms_conditions) && (\n          <>\n            <Divider />\n            {quotation.notes && (\n              <div style={{ marginBottom: 16 }}>\n                <Text strong>Notes:</Text>\n                <div style={{ marginTop: 8, padding: 12, background: '#f5f5f5', borderRadius: 4 }}>\n                  {quotation.notes}\n                </div>\n              </div>\n            )}\n            {quotation.terms_conditions && (\n              <div>\n                <Text strong>Terms & Conditions:</Text>\n                <div style={{ marginTop: 8, padding: 12, background: '#f5f5f5', borderRadius: 4 }}>\n                  {quotation.terms_conditions}\n                </div>\n              </div>\n            )}\n          </>\n        )}\n      </div>\n    </Modal>\n  );\n};\n\nexport default QuotationViewModal;\n\n","import React, { useState, useEffect, useMemo } from 'react';\nimport {\n  Modal,\n  Form,\n  Input,\n  DatePicker,\n  Select,\n  InputNumber,\n  message,\n  Space,\n  Tag,\n  Alert,\n  Divider,\n  Descriptions,\n  Table,\n  Row,\n  Col,\n  Checkbox,\n} from 'antd';\nimport {\n  FileSyncOutlined,\n  WarningOutlined,\n  DollarOutlined,\n  DatabaseOutlined,\n} from '@ant-design/icons';\nimport { useConvertQuotationToInvoiceMutation } from '../../services/redux/api/endpoints';\nimport dayjs from 'dayjs';\nimport { getCurrentUser } from '../../helpers/auth';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\ninterface QuotationConvertModalProps {\n  open: boolean;\n  onClose: () => void;\n  quotation: any;\n  onSuccess?: () => void;\n}\n\nconst QuotationConvertModal: React.FC<QuotationConvertModalProps> = ({\n  open,\n  onClose,\n  quotation,\n  onSuccess,\n}) => {\n  const [form] = Form.useForm();\n  const [convertQuotation, { isLoading }] = useConvertQuotationToInvoiceMutation();\n  const currentUser = getCurrentUser();\n  const lineItems = quotation?.items || [];\n  const hasLineItems = lineItems.length > 0;\n  \n  // Watch payment status for conditional rendering\n  const isPaid = Form.useWatch('is_paid', form);\n  const isPartiallyPaid = Form.useWatch('is_partially_paid', form);\n  \n  // Extract stock audit data from quotation items (already populated by API)\n  // No need for separate API call - quotation API already includes stock_audit data\n  const relevantStockAudit = useMemo(() => {\n    if (!lineItems || lineItems.length === 0) return [];\n    return lineItems\n      .filter((item: any) => item.stock_audit && item.stock_audit._id) // Only items with stock audit\n      .map((item: any) => ({\n        ...item.stock_audit,\n        // Add product info from item for display\n        product_name: item.product_name,\n        variant_name: item.variant_name,\n        product_id: item.product_id,\n        required_quantity: Number(item.quantity) || 0, // Required quantity from quotation\n      }));\n  }, [lineItems]);\n  \n  // Check if there's any insufficient stock\n  const hasInsufficientStock = useMemo(() => {\n    return relevantStockAudit.some((stock: any) => {\n      const availableQty = Number(stock.available_quantity) || 0;\n      const requiredQty = Number(stock.required_quantity) || 0;\n      return availableQty < requiredQty;\n    });\n  }, [relevantStockAudit]);\n  const lineItemColumns = useMemo(\n    () => [\n      {\n        title: '#',\n        key: 'index',\n        width: 50,\n        render: (_: any, __: any, index: number) => index + 1,\n      },\n      {\n        title: 'Product',\n        dataIndex: 'product_name',\n        key: 'product_name',\n        render: (text: string, record: any) => (\n          <div>\n            <strong>{text || '-'}</strong>\n            {record.variant_name && (\n              <div style={{ fontSize: 12, color: '#888' }}>{record.variant_name}</div>\n            )}\n          </div>\n        ),\n      },\n      {\n        title: 'Qty',\n        dataIndex: 'quantity',\n        key: 'quantity',\n        align: 'right' as const,\n      },\n      {\n        title: 'Unit Price',\n        dataIndex: 'unit_price',\n        key: 'unit_price',\n        align: 'right' as const,\n        render: (price: number) => `${(price || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}`,\n      },\n      {\n        title: 'Tax %',\n        dataIndex: 'tax_percentage',\n        key: 'tax_percentage',\n        align: 'right' as const,\n        render: (tax: number) => `${tax || 0}%`,\n      },\n      {\n        title: 'Line Total',\n        dataIndex: 'line_total',\n        key: 'line_total',\n        align: 'right' as const,\n        render: (total: number) => (\n          <strong style={{ color: '#52c41a' }}>\n            {(total || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n          </strong>\n        ),\n      },\n    ],\n    []\n  );\n  \n  // Initialize form when quotation changes\n  useEffect(() => {\n    if (quotation && open) {\n      form.setFieldsValue({\n        invoice_date: dayjs(),\n        payment_mode: 'cash',\n        is_paid: false,\n        is_partially_paid: false,\n        paid_amount: 0,\n        notes: `Converted from Quotation ${quotation.quotation_number}`,\n      });\n    }\n  }, [quotation, open, form]);\n  \n  // Validate stock availability before conversion\n  const validateStockAvailability = () => {\n    const insufficientStockItems: string[] = [];\n    \n    lineItems.forEach((item: any) => {\n      if (item.stock_audit && item.stock_audit._id) {\n        const availableQty = Number(item.stock_audit.available_quantity) || 0;\n        const requiredQty = Number(item.quantity) || 0;\n        \n        if (availableQty < requiredQty) {\n          insufficientStockItems.push(\n            `${item.product_name}${item.variant_name ? ` (${item.variant_name})` : ''} - Available: ${availableQty}, Required: ${requiredQty}`\n          );\n        }\n      }\n    });\n    \n    return insufficientStockItems;\n  };\n  \n  // Handle submit\n  const handleSubmit = async () => {\n    try {\n      const values = await form.validateFields();\n      \n      if (!quotation?._id) {\n        message.error('Quotation not found');\n        return;\n      }\n      \n      // Validate stock availability\n      const insufficientStock = validateStockAvailability();\n      if (insufficientStock.length > 0) {\n        message.error({\n          content: (\n            <div>\n              <div style={{ marginBottom: 8, fontWeight: 'bold' }}>Insufficient stock available:</div>\n              <ul style={{ margin: 0, paddingLeft: 20 }}>\n                {insufficientStock.map((item, index) => (\n                  <li key={index} style={{ marginBottom: 4 }}>{item}</li>\n                ))}\n              </ul>\n            </div>\n          ),\n          duration: 8,\n        });\n        return;\n      }\n      \n      // Validate payment amount\n      if (values.is_partially_paid && (!values.paid_amount || values.paid_amount <= 0)) {\n        message.error('Please enter paid amount for partial payment');\n        return;\n      }\n      \n      if (values.is_paid && values.paid_amount !== quotation.total_amount) {\n        form.setFieldsValue({ paid_amount: quotation.total_amount });\n        values.paid_amount = quotation.total_amount;\n      }\n      \n      const payload = {\n        id: quotation._id,\n        invoice_date: values.invoice_date ? dayjs(values.invoice_date).format('YYYY-MM-DD') : dayjs().format('YYYY-MM-DD'),\n        payment_mode: values.payment_mode || 'cash',\n        is_paid: values.is_paid || false,\n        is_partially_paid: values.is_partially_paid || false,\n        paid_amount: values.is_paid ? quotation.total_amount : (values.paid_amount || 0),\n        notes: values.notes || '',\n      };\n      \n      const result: any = await convertQuotation(payload).unwrap();\n      \n      if (result?.statusCode === 200 || result?.data) {\n        message.success('Quotation converted to invoice successfully!');\n        form.resetFields();\n        onSuccess?.();\n        onClose();\n      } else {\n        throw new Error(result?.message || 'Failed to convert quotation');\n      }\n    } catch (error: any) {\n      console.error('Convert quotation error:', error);\n      message.error(error?.data?.message || error?.message || 'Failed to convert quotation');\n    }\n  };\n  \n  // Handle payment mode change\n  const handlePaymentModeChange = (value: string) => {\n    form.setFieldsValue({ payment_mode: value });\n  };\n  \n  // Handle payment status change\n  const handlePaymentStatusChange = (isPaid: boolean, isPartiallyPaid: boolean) => {\n    if (isPaid) {\n      form.setFieldsValue({ \n        is_partially_paid: false,\n        paid_amount: quotation?.total_amount || 0,\n      });\n    } else if (isPartiallyPaid) {\n      form.setFieldsValue({ is_paid: false });\n    } else {\n      form.setFieldsValue({ paid_amount: 0 });\n    }\n  };\n  \n  if (!quotation) {\n    return null;\n  }\n  \n  return (\n    <Modal\n      title={\n        <Space>\n          <FileSyncOutlined />\n          <span>Convert Quotation to Invoice</span>\n        </Space>\n      }\n      open={open}\n      onCancel={onClose}\n      onOk={handleSubmit}\n      confirmLoading={isLoading}\n      width={1000}\n      okText=\"Convert to Invoice\"\n      cancelText=\"Cancel\"\n    >\n      <Alert\n        message=\"Converting Quotation to Invoice\"\n        description={`This will create a new sales record/invoice from quotation ${quotation.quotation_number}. Stock will be deducted automatically.`}\n        type=\"info\"\n        showIcon\n        style={{ marginBottom: 16 }}\n      />\n      \n      {/* Quotation Summary */}\n      <Descriptions bordered column={2} size=\"small\" style={{ marginBottom: 16 }}>\n        <Descriptions.Item label=\"Quotation Number\">\n          <Tag color=\"blue\">{quotation.quotation_number}</Tag>\n        </Descriptions.Item>\n        <Descriptions.Item label=\"Customer\">\n          {quotation.customer?.full_name || quotation.customer?.name || quotation.customer?.customer_name || quotation.CustomerItem?.customer_name || quotation.CustomerItem?.full_name || quotation.CustomerItem?.name || quotation.customer_name || quotation.full_name || quotation.name || '-'}\n        </Descriptions.Item>\n        <Descriptions.Item label=\"Total Items\">\n          {quotation.items?.length || 0} items\n        </Descriptions.Item>\n        <Descriptions.Item label=\"Total Amount\">\n          <strong style={{ color: '#52c41a', fontSize: '16px' }}>\n            <DollarOutlined /> {(quotation.total_amount || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n          </strong>\n        </Descriptions.Item>\n      </Descriptions>\n      \n      {hasLineItems && (\n        <>\n          <Divider />\n          <Table\n            columns={lineItemColumns}\n            dataSource={lineItems}\n            size=\"small\"\n            pagination={false}\n            bordered\n            rowKey={(record, index) => record?._id || `convert-item-${index}`}\n            scroll={{ y: 260 }}\n            title={() => (\n              <Space>\n                <FileSyncOutlined />\n                <span>Items / Stock List</span>\n              </Space>\n            )}\n            summary={() => (\n              <Table.Summary fixed>\n                <Table.Summary.Row>\n                  <Table.Summary.Cell index={0} colSpan={4} align=\"right\">\n                    Subtotal\n                  </Table.Summary.Cell>\n                  <Table.Summary.Cell index={1} colSpan={2} align=\"right\">\n                    <strong>\n                      {(quotation.subtotal || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n                    </strong>\n                  </Table.Summary.Cell>\n                </Table.Summary.Row>\n                {quotation.discount_amount > 0 && (\n                  <Table.Summary.Row>\n                    <Table.Summary.Cell index={0} colSpan={4} align=\"right\">\n                      Discount\n                    </Table.Summary.Cell>\n                    <Table.Summary.Cell index={1} colSpan={2} align=\"right\">\n                      <strong style={{ color: '#ff4d4f' }}>\n                        -{(quotation.discount_amount || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n                      </strong>\n                    </Table.Summary.Cell>\n                  </Table.Summary.Row>\n                )}\n                <Table.Summary.Row>\n                  <Table.Summary.Cell index={0} colSpan={4} align=\"right\">\n                    Tax Amount\n                  </Table.Summary.Cell>\n                  <Table.Summary.Cell index={1} colSpan={2} align=\"right\">\n                    <strong>\n                      {(quotation.tax_amount || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n                    </strong>\n                  </Table.Summary.Cell>\n                </Table.Summary.Row>\n                <Table.Summary.Row>\n                  <Table.Summary.Cell index={0} colSpan={4} align=\"right\">\n                    <strong style={{ fontSize: 16, color: '#52c41a' }}>Grand Total</strong>\n                  </Table.Summary.Cell>\n                  <Table.Summary.Cell index={1} colSpan={2} align=\"right\">\n                    <strong style={{ fontSize: 16, color: '#52c41a' }}>\n                      {(quotation.total_amount || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n                    </strong>\n                  </Table.Summary.Cell>\n                </Table.Summary.Row>\n              </Table.Summary>\n            )}\n          />\n        </>\n      )}\n      \n      <Divider />\n      \n      {/* Stock Audit Details */}\n      {hasLineItems && relevantStockAudit.length > 0 && (\n        <>\n          {hasInsufficientStock && (\n            <Alert\n              message=\"Insufficient Stock Warning\"\n              description=\"Some products have insufficient available stock. Please check the stock audit details below. Invoice conversion will be blocked if stock is insufficient.\"\n              type=\"warning\"\n              showIcon\n              style={{ marginBottom: 16 }}\n            />\n          )}\n          <div style={{ marginBottom: 16 }}>\n            <Space style={{ marginBottom: 8 }}>\n              <DatabaseOutlined />\n              <strong>Stock Audit Details</strong>\n            </Space>\n            <Table\n              columns={[\n                {\n                  title: 'Product',\n                  key: 'product',\n                  render: (_: any, record: any) => (\n                    <div>\n                      <strong>{record.product_name || '-'}</strong>\n                      {record.variant_name && (\n                        <div style={{ fontSize: 12, color: '#888' }}>\n                          {record.variant_name}\n                        </div>\n                      )}\n                    </div>\n                  ),\n                },\n                {\n                  title: 'Batch No',\n                  dataIndex: 'batch_no',\n                  key: 'batch_no',\n                  render: (text: string) => (\n                    <Tag color=\"purple\">{text || '-'}</Tag>\n                  ),\n                },\n                {\n                  title: 'Required Qty',\n                  dataIndex: 'required_quantity',\n                  key: 'required_quantity',\n                  align: 'right' as const,\n                  render: (qty: number) => (\n                    <strong>{qty || 0}</strong>\n                  ),\n                },\n                {\n                  title: 'Available Qty',\n                  dataIndex: 'available_quantity',\n                  key: 'available_quantity',\n                  align: 'right' as const,\n                  render: (qty: number, record: any) => {\n                    const availableQty = Number(qty) || 0;\n                    const requiredQty = Number(record.required_quantity) || 0;\n                    const isInsufficient = availableQty < requiredQty;\n                    return (\n                      <Tag color={isInsufficient ? 'red' : availableQty > 0 ? 'green' : 'red'}>\n                        {availableQty}\n                        {isInsufficient && (\n                          <span style={{ marginLeft: 4, fontSize: 11 }}>\n                             Insufficient\n                          </span>\n                        )}\n                      </Tag>\n                    );\n                  },\n                },\n                {\n                  title: 'Buy Price',\n                  dataIndex: 'buy_price',\n                  key: 'buy_price',\n                  align: 'right' as const,\n                  render: (price: any) => {\n                    const numPrice = Number(price) || 0;\n                    return `${numPrice.toFixed(2)}`;\n                  },\n                },\n                {\n                  title: 'Expiry Date',\n                  dataIndex: 'expiry_date',\n                  key: 'expiry_date',\n                  render: (date: string) => {\n                    if (!date) return '-';\n                    const expiryDate = dayjs(date);\n                    const today = dayjs();\n                    const isExpired = expiryDate.isBefore(today);\n                    const isNearExpiry = expiryDate.diff(today, 'days') <= 30 && expiryDate.diff(today, 'days') > 0;\n                    let color = 'green';\n                    if (isExpired) color = 'red';\n                    else if (isNearExpiry) color = 'orange';\n                    return (\n                      <Tag color={color}>\n                        {expiryDate.format('DD/MM/YYYY')}\n                      </Tag>\n                    );\n                  },\n                },\n              ]}\n              dataSource={relevantStockAudit}\n              size=\"small\"\n              pagination={false}\n              bordered\n              rowKey={(record: any) => record._id || `stock-${Math.random()}`}\n              scroll={{ y: 200 }}\n            />\n          </div>\n          <Divider />\n        </>\n      )}\n      \n      <Form\n        form={form}\n        layout=\"vertical\"\n        initialValues={{\n          invoice_date: dayjs(),\n          payment_mode: 'cash',\n          is_paid: false,\n          is_partially_paid: false,\n          paid_amount: 0,\n        }}\n      >\n        <Row gutter={16}>\n          <Col span={12}>\n            <Form.Item\n              name=\"invoice_date\"\n              label=\"Invoice Date\"\n              rules={[{ required: true, message: 'Invoice date is required' }]}\n            >\n              <DatePicker style={{ width: '100%' }} format=\"YYYY-MM-DD\" />\n            </Form.Item>\n          </Col>\n          <Col span={12}>\n            <Form.Item\n              name=\"payment_mode\"\n              label=\"Payment Mode\"\n              rules={[{ required: true, message: 'Payment mode is required' }]}\n            >\n              <Select onChange={handlePaymentModeChange}>\n                <Option value=\"cash\">Cash</Option>\n                <Option value=\"card\">Card</Option>\n                <Option value=\"upi\">UPI</Option>\n                <Option value=\"bank_transfer\">Bank Transfer</Option>\n                <Option value=\"cheque\">Cheque</Option>\n                <Option value=\"credit\">Credit</Option>\n                <Option value=\"other\">Other</Option>\n              </Select>\n            </Form.Item>\n          </Col>\n        </Row>\n        \n        <Form.Item label=\"Payment Status\">\n          <Space size=\"large\">\n            <Form.Item\n              name=\"is_paid\"\n              valuePropName=\"checked\"\n              noStyle\n            >\n              <Checkbox\n                onChange={(e) => {\n                  handlePaymentStatusChange(e.target.checked, false);\n                }}\n              >\n                Fully Paid\n              </Checkbox>\n            </Form.Item>\n            <Form.Item\n              name=\"is_partially_paid\"\n              valuePropName=\"checked\"\n              noStyle\n            >\n              <Checkbox\n                onChange={(e) => {\n                  handlePaymentStatusChange(false, e.target.checked);\n                }}\n              >\n                Partially Paid\n              </Checkbox>\n            </Form.Item>\n          </Space>\n        </Form.Item>\n        \n        {(isPartiallyPaid || isPaid) && (\n          <Form.Item\n            name=\"paid_amount\"\n            label=\"Paid Amount\"\n            rules={[\n              { required: true, message: 'Paid amount is required' },\n              {\n                validator: (_: any, value: number) => {\n                  if (value > (quotation?.total_amount || 0)) {\n                    return Promise.reject('Paid amount cannot exceed total amount');\n                  }\n                  return Promise.resolve();\n                },\n              },\n            ]}\n          >\n            <InputNumber\n              min={0}\n              max={quotation?.total_amount || 0}\n              precision={2}\n              style={{ width: '100%' }}\n              prefix=\"\"\n              placeholder=\"Enter paid amount\"\n            />\n          </Form.Item>\n        )}\n        \n        <Form.Item\n          name=\"notes\"\n          label=\"Notes\"\n        >\n          <TextArea rows={3} placeholder=\"Additional notes for the invoice\" />\n        </Form.Item>\n      </Form>\n      \n      <Alert\n        message={<><WarningOutlined /> Important</>}\n        description=\"Once converted, the quotation status will be updated to 'converted' and cannot be edited. Stock will be deducted automatically.\"\n        type=\"warning\"\n        showIcon\n        style={{ marginTop: 16 }}\n      />\n    </Modal>\n  );\n};\n\nexport default QuotationConvertModal;\n\n","import React, { useState, useEffect } from 'react';\nimport {\n  Modal,\n  Form,\n  Input,\n  message,\n  Space,\n  Tag,\n  Alert,\n  Descriptions,\n  Button,\n} from 'antd';\nimport {\n  MailOutlined,\n  SendOutlined,\n  PrinterOutlined,\n  DownloadOutlined,\n} from '@ant-design/icons';\nimport { useSendQuotationMutation } from '../../services/redux/api/endpoints';\n\nconst { TextArea } = Input;\n\ninterface QuotationSendModalProps {\n  open: boolean;\n  onClose: () => void;\n  quotation: any;\n}\n\nconst QuotationSendModal: React.FC<QuotationSendModalProps> = ({\n  open,\n  onClose,\n  quotation,\n}) => {\n  const [form] = Form.useForm();\n  const [sendQuotation, { isLoading }] = useSendQuotationMutation();\n  \n  // Initialize form when quotation changes\n  useEffect(() => {\n    if (quotation && open) {\n      const customerEmail = quotation.customer?.email || quotation.CustomerItem?.email || quotation.customer_email || '';\n      form.setFieldsValue({\n        email: customerEmail,\n        message: `Dear ${quotation.customer?.full_name || quotation.customer?.name || quotation.customer?.customer_name || quotation.CustomerItem?.customer_name || quotation.CustomerItem?.full_name || quotation.CustomerItem?.name || quotation.customer_name || quotation.full_name || quotation.name || 'Customer'},\n\nPlease find attached our quotation ${quotation.quotation_number} for your review.\n\nQuotation Details:\n- Quotation Number: ${quotation.quotation_number}\n- Valid Until: ${quotation.valid_until ? new Date(quotation.valid_until).toLocaleDateString() : 'N/A'}\n- Total Amount: ${(quotation.total_amount || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n\nWe look forward to your response.\n\nBest regards,\n${quotation.CreatedByUser?.username || 'Sales Team'}`,\n      });\n    }\n  }, [quotation, open, form]);\n  \n  // Handle submit\n  const handleSubmit = async () => {\n    try {\n      const values = await form.validateFields();\n      \n      if (!quotation?._id) {\n        message.error('Quotation not found');\n        return;\n      }\n      \n      if (!values.email) {\n        message.error('Customer email is required');\n        return;\n      }\n      \n      const payload = {\n        id: quotation._id,\n        email: values.email,\n        message: values.message || '',\n      };\n      \n      const result: any = await sendQuotation(payload).unwrap();\n      \n      if (result?.statusCode === 200 || result?.data) {\n        message.success('Quotation sent to customer successfully!');\n        form.resetFields();\n        onClose();\n      } else {\n        throw new Error(result?.message || 'Failed to send quotation');\n      }\n    } catch (error: any) {\n      console.error('Send quotation error:', error);\n      message.error(error?.data?.message || error?.message || 'Failed to send quotation');\n    }\n  };\n  \n  // Handle print\n  const handlePrint = () => {\n    message.info('Print functionality coming soon');\n    // TODO: Implement print functionality\n  };\n  \n  // Handle download PDF\n  const handleDownloadPDF = () => {\n    message.info('PDF download functionality coming soon');\n    // TODO: Implement PDF download\n  };\n  \n  if (!quotation) {\n    return null;\n  }\n  \n  const customerEmail = quotation.customer?.email || quotation.CustomerItem?.email || quotation.customer_email || quotation.email || '';\n  const customerName = quotation.customer?.full_name || quotation.customer?.name || quotation.customer?.customer_name || quotation.CustomerItem?.customer_name || quotation.CustomerItem?.full_name || quotation.CustomerItem?.name || quotation.customer_name || quotation.full_name || quotation.name || 'Customer';\n  \n  return (\n    <Modal\n      title={\n        <Space>\n          <MailOutlined />\n          <span>Send Quotation to Customer</span>\n        </Space>\n      }\n      open={open}\n      onCancel={onClose}\n      onOk={handleSubmit}\n      confirmLoading={isLoading}\n      width={700}\n      okText=\"Send Email\"\n      cancelText=\"Cancel\"\n      footer={[\n        <Button key=\"print\" icon={<PrinterOutlined />} onClick={handlePrint}>\n          Print\n        </Button>,\n        <Button key=\"pdf\" icon={<DownloadOutlined />} onClick={handleDownloadPDF}>\n          Download PDF\n        </Button>,\n        <Button key=\"cancel\" onClick={onClose}>\n          Cancel\n        </Button>,\n        <Button key=\"send\" type=\"primary\" icon={<SendOutlined />} loading={isLoading} onClick={handleSubmit}>\n          Send Email\n        </Button>,\n      ]}\n    >\n      <Alert\n        message=\"Sending Quotation\"\n        description={`This will send quotation ${quotation.quotation_number} to the customer via email. The quotation status will be updated to 'sent'.`}\n        type=\"info\"\n        showIcon\n        style={{ marginBottom: 16 }}\n      />\n      \n      {/* Quotation Summary */}\n      <Descriptions bordered column={2} size=\"small\" style={{ marginBottom: 16 }}>\n        <Descriptions.Item label=\"Quotation Number\">\n          <Tag color=\"blue\">{quotation.quotation_number}</Tag>\n        </Descriptions.Item>\n        <Descriptions.Item label=\"Customer\">\n          {customerName}\n        </Descriptions.Item>\n        <Descriptions.Item label=\"Total Amount\">\n          <strong style={{ color: '#52c41a' }}>\n            {(quotation.total_amount || 0).toLocaleString('en-IN', { minimumFractionDigits: 2 })}\n          </strong>\n        </Descriptions.Item>\n        <Descriptions.Item label=\"Valid Until\">\n          {quotation.valid_until ? new Date(quotation.valid_until).toLocaleDateString() : '-'}\n        </Descriptions.Item>\n      </Descriptions>\n      \n      <Form\n        form={form}\n        layout=\"vertical\"\n      >\n        <Form.Item\n          name=\"email\"\n          label=\"Customer Email\"\n          rules={[\n            { required: true, message: 'Customer email is required' },\n            { type: 'email', message: 'Please enter a valid email address' },\n          ]}\n        >\n          <Input\n            prefix={<MailOutlined />}\n            placeholder=\"customer@example.com\"\n          />\n        </Form.Item>\n        \n        <Form.Item\n          name=\"message\"\n          label=\"Email Message\"\n          rules={[{ required: true, message: 'Email message is required' }]}\n        >\n          <TextArea\n            rows={8}\n            placeholder=\"Enter email message to customer...\"\n          />\n        </Form.Item>\n      </Form>\n      \n      <Alert\n        message=\"Note\"\n        description=\"The quotation PDF will be attached automatically to the email. Make sure the customer email is correct before sending.\"\n        type=\"warning\"\n        showIcon\n        style={{ marginTop: 16 }}\n      />\n    </Modal>\n  );\n};\n\nexport default QuotationSendModal;\n\n","import React, { useState, useCallback, useMemo } from 'react';\nimport { message, Modal, Form, Input, Select, DatePicker, Switch } from 'antd';\nimport { GenericCrudPage } from '../../components/common/GenericCrudPage';\nimport { quotationColumns } from './columns';\nimport { apiSlice } from '../../services/redux/api/apiSlice';\nimport {\n  useSendQuotationMutation,\n  useAcceptQuotationMutation,\n  useRejectQuotationMutation,\n  useConvertQuotationToInvoiceMutation,\n} from '../../services/redux/api/endpoints';\nimport QuotationLineItemsTable from './QuotationLineItemsTable';\nimport QuotationViewModal from './QuotationViewModal';\nimport QuotationConvertModal from './QuotationConvertModal';\nimport QuotationSendModal from './QuotationSendModal';\nimport dayjs from 'dayjs';\nimport { getCurrentUser } from '../../helpers/auth';\nimport { canCreate, canUpdate, canDelete, RESOURCES } from '../../helpers/permissionHelper';\nimport { calculateAggregateTotals, normalizeLineItems } from '../../helpers/quotationCalculations';\n\nconst { TextArea } = Input;\nconst { Option } = Select;\n\nconst QuotationCrud: React.FC = () => {\n  const currentUser = getCurrentUser();\n  \n  // Modals state\n  const [viewModalOpen, setViewModalOpen] = useState(false);\n  const [convertModalOpen, setConvertModalOpen] = useState(false);\n  const [sendModalOpen, setSendModalOpen] = useState(false);\n  const [selectedQuotation, setSelectedQuotation] = useState<any>(null);\n  \n  // GST setting state\n  const [isGstIncluded, setIsGstIncluded] = useState<boolean>(true);\n  \n  // API queries - memoized params\n  const queryParams = useMemo(() => ({ pageNumber: 1, pageLimit: 100 }), []);\n  const { data: customersData, isLoading: customersLoading } = apiSlice.useGetCustomerQuery(queryParams);\n  \n  const customers = useMemo(() => (customersData as any)?.result || [], [customersData]);\n  \n  // Mutations\n  const [sendQuotation] = useSendQuotationMutation();\n  const [acceptQuotation] = useAcceptQuotationMutation();\n  const [rejectQuotation] = useRejectQuotationMutation();\n  const [convertQuotation] = useConvertQuotationToInvoiceMutation();\n  \n  // Optimized: Single source of truth for totals\n  const calculateTotals = useCallback(\n    (items: any[] = [], gstIncluded: boolean = isGstIncluded) =>\n      calculateAggregateTotals(items, gstIncluded),\n    [isGstIncluded]\n  );\n  \n  // Form items - memoized\n  const formItems = useMemo(() => [\n    {\n      name: 'quotation_number',\n      label: 'Quotation Number',\n      rules: [{ required: false, message: 'Quotation number is required' }],\n      component: <Input placeholder=\"Auto-generated or enter manually\" />,\n    },\n    {\n      name: 'quotation_date',\n      label: 'Quotation Date',\n      initialValue: dayjs(),\n      rules: [{ required: true, message: 'Quotation date is required' }],\n      component: <DatePicker style={{ width: '100%' }} format=\"YYYY-MM-DD\" />,\n    },\n    {\n      name: 'customer_id',\n      label: 'Customer',\n      rules: [{ required: true, message: 'Customer is required' }],\n      component: (\n        <Select\n          showSearch\n          placeholder=\"Select customer\"\n          loading={customersLoading}\n          filterOption={(input, option) => \n            String(option?.children || '').toLowerCase().includes(input.toLowerCase())\n          }\n        >\n          {customers.map((customer: any) => (\n            <Option key={customer._id} value={customer._id}>\n              {customer.full_name || customer.name || customer.customer_name || 'Unknown Customer'}\n              {customer.mobile || customer.phone ? ` - ${customer.mobile || customer.phone}` : ''}\n            </Option>\n          ))}\n        </Select>\n      ),\n    },\n    {\n      name: 'valid_until',\n      label: 'Valid Until',\n      initialValue: dayjs().add(30, 'days'),\n      rules: [{ required: true, message: 'Valid until date is required' }],\n      component: <DatePicker style={{ width: '100%' }} format=\"YYYY-MM-DD\" />,\n    },\n   \n    {\n      name: 'notes',\n      label: 'Notes',\n      component: <TextArea rows={3} placeholder=\"Additional notes or instructions\" />,\n    },\n    {\n      name: 'terms_conditions',\n      label: 'Terms & Conditions',\n      component: <TextArea rows={3} placeholder=\"Terms and conditions for this quotation\" />,\n    },\n   \n    {\n      name: 'items',\n      label: 'Line Items',\n      rules: [\n        { required: true, message: 'At least one item is required' },\n        {\n          validator: async (_: any, items: any[]) => {\n            if (!items || items.length === 0) {\n              throw new Error('At least one item is required');\n            }\n            const hasInvalidItems = items.some(\n              item => !item.product_id || !item.quantity || !item.unit_price\n            );\n            if (hasInvalidItems) {\n              throw new Error('All items must have product, quantity, and price');\n            }\n          },\n        },\n      ],\n      component: <QuotationLineItemsTable isGstIncluded={isGstIncluded} />,\n      colSpan: 3,\n    },\n    {\n      name: 'is_gst_included',\n      label: 'GST',\n      initialValue: true, // Default to GST INCLUDED\n      valuePropName: 'checked',\n      component: (\n        <Switch\n          checkedChildren=\"INCLUDED\"\n          unCheckedChildren=\"EXCLUDED\"\n          defaultChecked={true} // Ensure default is INCLUDED\n        />\n      ),\n    },\n  ], [customers, customersLoading, isGstIncluded]);\n  \n  // Column actions - memoized\n  const columnActions = useMemo(() => ({\n    onView: (record: any) => {\n      setSelectedQuotation(record);\n      setViewModalOpen(true);\n    },\n    onEdit: () => {}, // Handled by GenericCrudPage\n    onDelete: async (record: any) => message.info('Delete handled by GenericCrudPage'),\n    onSend: (record: any) => {\n      setSelectedQuotation(record);\n      setSendModalOpen(true);\n    },\n    onConvert: (record: any) => {\n      setSelectedQuotation(record);\n      setConvertModalOpen(true);\n    },\n    onAccept: async (record: any) => {\n      Modal.confirm({\n        title: 'Mark Quotation as Accepted?',\n        content: 'This will mark the quotation as accepted by the customer.',\n        onOk: async () => {\n          try {\n            await acceptQuotation({ id: record._id }).unwrap();\n            message.success('Quotation marked as accepted');\n          } catch (error: any) {\n            message.error(error?.data?.message || 'Failed to accept quotation');\n          }\n        },\n      });\n    },\n    onReject: async (record: any) => {\n      Modal.confirm({\n        title: 'Mark Quotation as Rejected?',\n        content: (\n          <div>\n            <p>Please provide a reason for rejection:</p>\n            <Input.TextArea\n              rows={3}\n              id=\"rejection-reason\"\n              placeholder=\"Enter reason...\"\n            />\n          </div>\n        ),\n        onOk: async () => {\n          const reason = (document.getElementById('rejection-reason') as HTMLTextAreaElement)?.value;\n          if (!reason) {\n            message.error('Rejection reason is required');\n            return Promise.reject();\n          }\n          try {\n            await rejectQuotation({ id: record._id, reason }).unwrap();\n            message.success('Quotation marked as rejected');\n          } catch (error: any) {\n            message.error(error?.data?.message || 'Failed to reject quotation');\n          }\n        },\n      });\n    },\n    onPrint: () => message.info('Print functionality coming soon'),\n  }), [acceptQuotation, rejectQuotation]);\n  \n  // Handle before save - calculate totals\n  const handleBeforeSave = useCallback((values: any) => {\n    // Ensure is_gst_included is always set (default to true if not provided)\n    // Use form value first, then state, then default to true\n    const gstIncluded = values.is_gst_included ?? isGstIncluded ?? true;\n    \n    // Normalize line items so payload always contains accurate derived values\n    // normalizeLineItems now explicitly preserves stock_audit_id\n    const normalizedItems = normalizeLineItems(values.items || [], gstIncluded);\n    \n    // Recalculate totals with the correct GST setting from form values\n    const totals = calculateTotals(normalizedItems, gstIncluded);\n\n    return {\n      ...values,\n      items: normalizedItems,\n      // Explicitly include all calculated totals to ensure they're in the payload\n      subtotal: totals.subtotal,\n      tax_amount: totals.tax_amount,\n      discount_amount: totals.discount_amount,\n      value_of_goods: totals.value_of_goods,\n      total_amount: totals.total_amount,\n      quotation_date: values.quotation_date ? dayjs(values.quotation_date).format('YYYY-MM-DD') : dayjs().format('YYYY-MM-DD'),\n      valid_until: values.valid_until ? \n        dayjs(values.valid_until).format('YYYY-MM-DD') : dayjs().add(30, 'days').format('YYYY-MM-DD'),\n      status: values._id ? values.status : 'draft',\n      is_gst_included: gstIncluded, // Always include is_gst_included in payload\n      created_by_id: currentUser?._id,\n      created_by_name: currentUser?.username,\n      branch_id: currentUser?.branch_id || (currentUser as any)?.branchItems?._id,\n      // Removed organisation_id and tenant_id as requested\n    };\n  }, [calculateTotals, currentUser, isGstIncluded]);\n  \n  // Handle form values change to sync GST state\n  const handleFormValuesChange = useCallback((changed: any, all: any, form?: any) => {\n    // Sync GST state from form value\n    const gstValue = changed.is_gst_included !== undefined \n      ? changed.is_gst_included \n      : all.is_gst_included !== undefined \n        ? all.is_gst_included \n        : isGstIncluded;\n    \n    if (gstValue !== isGstIncluded) {\n      setIsGstIncluded(gstValue);\n    }\n  }, [isGstIncluded]);\n  \n  // Config for GenericCrudPage with permissions\n  const config = useMemo(() => ({\n    title: 'Quotations',\n    entityName: 'Quotation',\n    columns: quotationColumns(columnActions),\n    formItems,\n    formColumns: 3,\n    drawerWidth: 1400,\n    beforeSave: handleBeforeSave,\n    canCreate: () => canCreate(RESOURCES.QUOTATION),\n    canEdit: (record: any) => {\n      const hasPermission = canUpdate(RESOURCES.QUOTATION);\n      const canEditByStatus = ['draft', 'rejected'].includes(record?.status);\n      return hasPermission && canEditByStatus;\n    },\n    canDelete: (record: any) => {\n      const hasPermission = canDelete(RESOURCES.QUOTATION);\n      const isDraft = record?.status === 'draft';\n      return hasPermission && isDraft;\n    },\n  }), [columnActions, formItems, handleBeforeSave]);\n  \n  return (\n    <>\n      <GenericCrudPage config={config} onValuesChange={handleFormValuesChange} />\n      \n      <QuotationViewModal\n        open={viewModalOpen}\n        onClose={() => {\n          setViewModalOpen(false);\n          setSelectedQuotation(null);\n        }}\n        quotation={selectedQuotation}\n      />\n      \n      <QuotationConvertModal\n        open={convertModalOpen}\n        onClose={() => {\n          setConvertModalOpen(false);\n          setSelectedQuotation(null);\n        }}\n        quotation={selectedQuotation}\n        onSuccess={() => {\n          setConvertModalOpen(false);\n          setSelectedQuotation(null);\n        }}\n      />\n      \n      <QuotationSendModal\n        open={sendModalOpen}\n        onClose={() => {\n          setSendModalOpen(false);\n          setSelectedQuotation(null);\n        }}\n        quotation={selectedQuotation}\n      />\n    </>\n  );\n};\n\nexport default QuotationCrud;\n\n","// This icon file is generated automatically.\nvar PrinterOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M820 436h-40c-4.4 0-8 3.6-8 8v40c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-40c0-4.4-3.6-8-8-8zm32-104H732V120c0-4.4-3.6-8-8-8H300c-4.4 0-8 3.6-8 8v212H172c-44.2 0-80 35.8-80 80v328c0 17.7 14.3 32 32 32h168v132c0 4.4 3.6 8 8 8h424c4.4 0 8-3.6 8-8V772h168c17.7 0 32-14.3 32-32V412c0-44.2-35.8-80-80-80zM360 180h304v152H360V180zm304 664H360V568h304v276zm200-140H732V500H292v204H160V412c0-6.6 5.4-12 12-12h680c6.6 0 12 5.4 12 12v292z\" } }] }, \"name\": \"printer\", \"theme\": \"outlined\" };\nexport default PrinterOutlined;\n","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport PrinterOutlinedSvg from \"@ant-design/icons-svg/es/asn/PrinterOutlined\";\nimport AntdIcon from \"../components/AntdIcon\";\nconst PrinterOutlined = (props, ref) => /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n  ref: ref,\n  icon: PrinterOutlinedSvg\n}));\n\n/**![printer](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTgyMCA0MzZoLTQwYy00LjQgMC04IDMuNi04IDh2NDBjMCA0LjQgMy42IDggOCA4aDQwYzQuNCAwIDgtMy42IDgtOHYtNDBjMC00LjQtMy42LTgtOC04em0zMi0xMDRINzMyVjEyMGMwLTQuNC0zLjYtOC04LThIMzAwYy00LjQgMC04IDMuNi04IDh2MjEySDE3MmMtNDQuMiAwLTgwIDM1LjgtODAgODB2MzI4YzAgMTcuNyAxNC4zIDMyIDMyIDMyaDE2OHYxMzJjMCA0LjQgMy42IDggOCA4aDQyNGM0LjQgMCA4LTMuNiA4LThWNzcyaDE2OGMxNy43IDAgMzItMTQuMyAzMi0zMlY0MTJjMC00NC4yLTM1LjgtODAtODAtODB6TTM2MCAxODBoMzA0djE1MkgzNjBWMTgwem0zMDQgNjY0SDM2MFY1NjhoMzA0djI3NnptMjAwLTE0MEg3MzJWNTAwSDI5MnYyMDRIMTYwVjQxMmMwLTYuNiA1LjQtMTIgMTItMTJoNjgwYzYuNiAwIDEyIDUuNCAxMiAxMnYyOTJ6IiAvPjwvc3ZnPg==) */\nconst RefIcon = /*#__PURE__*/React.forwardRef(PrinterOutlined);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'PrinterOutlined';\n}\nexport default RefIcon;"],"names":["_extends","Object","assign","bind","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","FileSyncOutlined","props","ref","React","AntdIcon","icon","FileSyncOutlinedSvg","statusConfig","draft","color","_jsx","EditOutlined","label","sent","SendOutlined","accepted","CheckCircleOutlined","rejected","CloseCircleOutlined","expired","WarningOutlined","converted","toNumber","value","fallback","undefined","parsed","Number","isFinite","roundToTwo","Math","round","EPSILON","toFixed","calculateLineItemTotals","item","gstIncluded","quantity","unitPrice","unit_price","taxPercentage","tax_percentage","discountValue","discount","baseAmount","discountAmount","discount_type","min","max","subtotal","taxAmount","lineTotal","valueOfGoods","line_total","item_subtotal","item_discount_amount","item_tax_amount","item_value_of_goods","_ref","onChange","disabled","isGstIncluded","productSearchString","setProductSearchString","useState","productDebouncedSearch","setProductDebouncedSearch","productPage","setProductPage","allProducts","setAllProducts","hasMoreProducts","setHasMoreProducts","productSearchTimerRef","useRef","isLoadingMoreProductsRef","useEffect","current","clearTimeout","setTimeout","productQueryParams","useMemo","pageNumber","pageLimit","searchString","data","productsData","isLoading","productsLoading","isFetching","productsFetching","apiSlice","useGetProductQuery","refetchOnMountOrArgChange","refetchOnFocus","refetchOnReconnect","_pagination","_pagination2","newProducts","result","totalCount","pagination","total","prev","existingIds","Set","map","p","_id","uniqueNewProducts","filter","has","updated","handleProductPopupScroll","useCallback","e","scrollTop","scrollHeight","clientHeight","onProductDropdownVisibleChange","open","products","StockAuditDropdownForRow","_ref2","record","index","onStockAuditSelect","setSearchString","debouncedSearch","setDebouncedSearch","page","setPage","allItems","setAllItems","hasMore","setHasMore","searchTimerRef","isLoadingMoreRef","prevProductIdRef","prevQueryParamsRef","dataLoadedRef","productId","product_id","queryParams","queryKey","JSON","stringify","paramsChanged","useGetStockAuditQuery","skip","_pagination3","_pagination4","newItems","_prev$","_newItems$","uniqueNewItems","handlePopupScroll","onDropdownVisibleChange","Select","showSearch","allowClear","placeholder","style","width","stock_audit_id","val","selectedStockAudit","find","sa","loading","onSearch","onPopupScroll","filterOption","notFoundContent","dropdownRender","menu","_jsxs","_Fragment","children","textAlign","padding","stockAudit","_stockAudit$ProductIt","_stockAudit$ProductIt2","_stockAudit$ProductIt3","Option","ProductItem","name","VariantItem","variant_name","concat","batch_no","prevProps","nextProps","handleAddItem","product_name","description","handleDeleteItem","_","getLineItemTotals","handleFieldChange","field","fieldValue","_objectSpread","includes","calculated","handleProductSelect","_product$CategoryItem","_product$category","_product$VariantItem","product","CategoryItem","category","sell_price","handleStockAuditSelect","stockAuditId","_stockAudit$ProductIt4","_stockAudit$ProductIt5","_stockAudit$category","prevGstRef","recalculatedItems","calculations","totals","aggregate","reduce","acc","itemTotals","columns","title","render","__","_product$VariantItem2","Input","InputNumber","precision","prefix","suffix","Space","Compact","Tooltip","toLocaleString","minimumFractionDigits","Popconfirm","onConfirm","Button","type","danger","size","DeleteOutlined","marginBottom","display","justifyContent","alignItems","fontSize","PlusOutlined","onClick","Table","dataSource","scroll","x","rowKey","bordered","footer","direction","gap","abs","CalculatorOutlined","Text","Typography","_quotation$items","onClose","quotation","quotationAny","shouldFetchCustomer","customer","CustomerItem","customer_id","customerData","useGetCustomerByIdQuery","customerInfo","customer_name","full_name","company_name","email","phone","mobile","address","gst_number","customerItem","contact_number","customer_company_name","customer_email","customer_phone","customer_address","FileTextOutlined","status","statusInfo","lineItemsColumns","dataIndex","text","align","qty","price","tax","isExpired","valid_until","dayjs","isBefore","Modal","Tag","onCancel","top","maxHeight","overflowY","Descriptions","column","Item","span","quotation_number","CalendarOutlined","quotation_date","format","marginLeft","Divider","UserOutlined","is_gst_included","strong","items","marginTop","summary","tax_amount","discount_amount","total_amount","Summary","fixed","Row","Cell","colSpan","DollarOutlined","converted_to_invoice_no","converted_to_sales_record_id","converted_date","notes","terms_conditions","background","borderRadius","TextArea","_quotation$customer","_quotation$customer2","_quotation$customer3","_quotation$CustomerIt","_quotation$CustomerIt2","_quotation$CustomerIt3","onSuccess","form","Form","useForm","convertQuotation","useConvertQuotationToInvoiceMutation","lineItems","getCurrentUser","hasLineItems","isPaid","useWatch","isPartiallyPaid","relevantStockAudit","stock_audit","required_quantity","hasInsufficientStock","some","stock","available_quantity","lineItemColumns","setFieldsValue","invoice_date","payment_mode","is_paid","is_partially_paid","paid_amount","handlePaymentStatusChange","onOk","async","values","validateFields","message","error","insufficientStock","validateStockAvailability","insufficientStockItems","forEach","availableQty","requiredQty","push","content","fontWeight","margin","paddingLeft","duration","payload","id","unwrap","statusCode","Error","success","resetFields","_error$data","console","confirmLoading","okText","cancelText","Alert","showIcon","y","DatabaseOutlined","isInsufficient","numPrice","date","expiryDate","today","isNearExpiry","diff","random","layout","initialValues","gutter","Col","rules","required","DatePicker","valuePropName","noStyle","Checkbox","checked","validator","Promise","reject","resolve","rows","_quotation$customer5","_quotation$CustomerIt5","_quotation$customer6","_quotation$customer7","_quotation$customer8","_quotation$CustomerIt6","_quotation$CustomerIt7","_quotation$CustomerIt8","sendQuotation","useSendQuotationMutation","_quotation$customer4","_quotation$CustomerIt4","_quotation$CreatedByU","customerEmail","Date","toLocaleDateString","CreatedByUser","username","handleSubmit","customerName","MailOutlined","PrinterOutlined","handlePrint","info","DownloadOutlined","handleDownloadPDF","QuotationCrud","currentUser","viewModalOpen","setViewModalOpen","convertModalOpen","setConvertModalOpen","sendModalOpen","setSendModalOpen","selectedQuotation","setSelectedQuotation","setIsGstIncluded","customersData","customersLoading","useGetCustomerQuery","customers","acceptQuotation","useAcceptQuotationMutation","rejectQuotation","useRejectQuotationMutation","calculateTotals","value_of_goods","calculateAggregateTotals","formItems","component","initialValue","input","option","String","toLowerCase","add","QuotationLineItemsTable","Switch","checkedChildren","unCheckedChildren","defaultChecked","columnActions","onView","onEdit","onDelete","onSend","onConvert","onAccept","confirm","onReject","_document$getElementB","reason","document","getElementById","_error$data2","onPrint","handleBeforeSave","_values$is_gst_includ","_branchItems","normalizedItems","normalizedItem","normalizeLineItems","created_by_id","created_by_name","branch_id","branchItems","handleFormValuesChange","changed","all","gstValue","config","entityName","actions","filters","keys","onFilter","Badge","recordAny","marginRight","sorter","a","b","unix","daysLeft","amount","salesRecordId","tooltipTitle","user","hasReadPerm","canRead","RESOURCES","QUOTATION","hasUpdatePerm","canUpdate","hasDeletePerm","canDelete","canEditByStatus","isDraft","canConvert","canSend","canEdit","canDeleteRecord","quotationActionsMenu","Menu","EyeOutlined","Dropdown","overlay","trigger","MoreOutlined","formColumns","drawerWidth","beforeSave","canCreate","hasPermission","GenericCrudPage","onValuesChange","QuotationViewModal","QuotationConvertModal","QuotationSendModal","PrinterOutlinedSvg"],"sourceRoot":""}